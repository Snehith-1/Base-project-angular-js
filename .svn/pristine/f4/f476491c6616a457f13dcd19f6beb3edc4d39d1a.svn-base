!function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g){function f(){a.hidediv=!0,a.showdiv=!1;var t="api/lawFirm/lawfirm2lawyer";d.get(t).then(function(t){a.lawfirm2lawyer_list=t.data.lawfirm2lawyer_list});var t="api/lawFirm/tempdelete";d.get(t).then(function(t){})}function v(){var t="api/lawFirm/Gettempmember";d.get(t).then(function(t){a.member_list=t.data.member_list})}var D=this;D.title="addLawfirmcontroller",f(),a.lawfirmSubmit=function(){var t=($("#lawyerdata :selected").text(),{firm_refno:a.txtfirm_refno,firm_name:a.txtfirm_name,contact_details:a.txtcontact_no,mail_address:a.txtemailaddress,fax_no:a.txtfaxno,firm_years:a.txtexperience,firm_address:a.txtaddress1,remarks:a.txtremarks,website:a.txtwebsite,lawfirm2lawyer_list:a.$parent.lawfirm2lawyer}),n="api/lawFirm/createLawfirm";lockUI(),d.post(n,t).then(function(t){1==t.data.status?(unlockUI(),f(),e.go("app.lawfirmSummary"),l.alert("Law Firm Added Successfully","success")):(unlockUI(),f(),e.go("app.lawfirmSummary"),l.alert("Error Occurred While Adding Law Firm","warning"))})},a.document_cancelclick=function(t,e){var n={document_gid:t},o="api/lawFirm/documentdelete";lockUI(),d.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3})})},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=g.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/lawFirm/Uploadbankcertificate";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.filename_list=t.data.UploadDocument,$("#addupload").val(""),1==t.data.status?(a.document_type="",unlockUI(),l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported"))})},a.lawfirmback=function(){var t="api/lawFirm/tempdelete";lockUI(),d.get(t).then(function(t){}),e.go("app.lawfirmSummary")},a.addlawfirm2member=function(){function t(t,a){t.enrolmentno_validation=function(){var a={enrolment_no:t.txtenrolment_no},e="api/lawFirm/GetLawfirmenrolment_validation";d.getparams(e,a).then(function(a){console.log(a.data.enrolment_no),"Y"==a.data.enrolment_no?t.validationMsg=!0:t.validationMsg=!1})},t.ok=function(){a.close("closed")},t.submitmember=function(){var e={lawyer_name:t.txtmember_name,mobile_no:t.txtmobileno,email_address:t.txtemailaddress,designation:t.txtdesignation,enrolment_no:t.txtenrolment_no},n="api/lawFirm/postmembers";lockUI(),d.post(n,e).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),v()):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}n.open({templateUrl:"/addmember.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},a.memberdelete=function(t,e){var n={lawfirmmember_gid:t};console.log(n);var o="api/lawFirm/memberdelete";lockUI(),d.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.member_list,function(e,n){e.lawfirmmember_gid==t&&a.member_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),v()):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3})})},a.taglawyer=function(){function t(t,a){t.ok=function(){a.close("closed")};var e="api/lawFirm/lawfirm2lawyer";d.get(e).then(function(a){t.lawfirm2lawyer_list=a.data.lawfirm2lawyer_list}),t.submittag=function(){var e={lawyerregister_gid:t.cbolawfirm2lawyer.lawyerregister_gid,designation:t.txtdesignation};console.log(e);var n="api/lawFirm/TagLawyer2lawfirm";lockUI(),d.post(n,e).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),v()):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}n.open({templateUrl:"/taglawyer.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("addLawfirmcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){y.open=function(t){t.preventDefault(),t.stopPropagation(),y.opened=!0},y.close=function(t){t.preventDefault(),t.stopPropagation(),y.closed=!0},y.formats=["dd-MM-yyyy"],y.format=y.formats[0],y.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.otherloan=!0,a.click=!0,a.initiatedn=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0;var t="api/misDataimport/getcustomerDNGID";lockUI();var e={urn:a.urn};console.log(e),d.getparams(t,e).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.otherloan_list=t.data.otherloan_list,a.customer_name=t.data.customer_name,a.cbo_status=t.data.cbo_status,"DN Sent"==t.data.cbo_status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn=!0),"DN Skip"==t.data.cbo_status&&(a.skip=!0)});var t="api/misDataimport/DN1ContentDTL";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.templatecontent=t.data.cbotemplate_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,console.log(t.data.DN1_status),"DN Generated"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN Reverted"==t.data.DN1_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.CBOhistory_list=t.data.CBOhistory_list,"DN Skip"!=t.data.cbo_status&&"DN Sent"!=t.data.cbo_status&&"DN Generated"!=t.data.cbo_status||(a.dndetails=!1)});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.CBOcouriered_by=t.data.CBOcouriered_by,a.CBOcourier_center=t.data.CBOcourier_center,a.CBOcourier_date=t.data.CBOcourier_date,a.CBOcourier_refno=t.data.CBOcourier_refno,a.CBOremarks=t.data.CBOremarks,a.CBOcourier_status=t.data.CBOcourier_status});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}var y=this;y.title="cboCustomer2loandetailscontroller",h(),a.cbogenerate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/cbogenerate",e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){1==t.data.status?l.alert("DN Generated  Successfully","success"):l.alert("Error Occurred While Generating DN"),h(),n.go("app.dnTrackerCBO")})},a.DNsend=function(){var t="api/misDataimport/CBOStatus",e={urn:a.urn,dncase_gid:a.dncase_gid,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(h(),l.alert("DN2 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN2 Status "),h(),n.go("app.dnTrackerCBO")}),a.courier_info=!1,a.info=!0},a.DNskip=function(){var t="api/misDataimport/CBOskip",e={urn:a.urn,dncase_gid:a.dncase_gid};d.post(t,e).then(function(t){1==t.data.status?(h(),l.alert("DN2 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN2 Status "),h()}),a.skip=!0},a.Dnback=function(){n.go("app.dnTrackerCBO")},a.cancel=function(){a.courier_info=!1,a.initiatedn=!0,a.sanctiondtl=!0,a.info=!1},a.clickinitiatedn=function(){a.initiatedn=!0,a.courier_info=!1,a.sanctiondtl=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnCBOsanctionref_no=t.data.sanction_refno,a.txtdnCBOsanction_date=t.data.sanction_date,a.txtdnCBOsanction_amount=t.data.sanction_amount,a.txtdnCBOref_no="SAMFIN/RMD/"});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnCBOref_no=t.data.dnCBOref_no,a.dnCBOsanctionref_no=t.data.dnCBOsanctionref_no,a.dnCBOsanction_date=t.data.dnCBO_date;var e=new Intl.NumberFormat("en-IN").format(t.data.dnCBOsanction_amount);a.dnCBOsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn_flag&&(a.initiatedn=!0,a.sanctiondtl=!1),"Y"==t.data.dnCBO_flag&&(a.initiatedn=!1,a.sanctiondtl=!0),"N"==t.data.dnCBO_flag&&(a.initiatedn=!0,a.sanctiondtl=!1)});var t="api/misDataimport/DNCBOContent",e={urn:a.urn};console.log(e),d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.otherloandetails=function(){a.otherloan=!1,a.click=!1},a.minimizeloan=function(){a.otherloan=!0,a.click=!0},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var o={urn:t,remarks:a.txtremarks};console.log(o);var r="api/misDataimport/RevertDN_CBO";lockUI(),d.post(r,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):(l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),e.close("closed")),n.go("app.dnTrackerCBO"),h()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var o={urn:t,remarks:a.txtremarks};console.log(o);var r="api/misDataimport/HoldDN_CBO";lockUI(),d.post(r,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):(l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),e.close("closed")),n.go("app.dnTrackerCBO"),h()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var o="api/misDataimport/UnholdDN_CBO";lockUI(),d.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):(l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),e.close("closed")),n.go("app.dnTrackerCBO"),h()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dnCBOsanctionsubmit=function(){var t="api/misDataimport/DNCBOsanctiondtl",e={urn:a.urn,dnCBOsanctionref_no:a.txtdnCBOsanctionref_no,dnCBOsanction_date:a.txtdnCBOsanction_date,dnCBOsanction_amount:a.txtdnCBOsanction_amount,dnCBOref_no:a.txtdnCBOref_no};console.log(e),d.post(t,e).then(function(t){if(1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnCBOref_no=t.data.dnCBOref_no,a.dnCBOsanctionref_no=t.data.dnCBOsanctionref_no,a.dnCBOsanction_date=t.data.dnCBOsanction_date;var e=new Intl.NumberFormat("en-IN").format(t.data.dnCBOsanction_amount);a.dnCBOsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn_flag&&(a.initiatedn=!1,a.sanctiondtl=!0),"Y"==t.data.dnCBO_flag&&(a.initiatedn=!1,a.sanctiondtl=!0)});var e="api/misDataimport/DNCBOContent",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.dnCBOcancel=function(){a.courier_info=!1,a.initiatedn=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnCBOsanctionref_no="",a.txtdnCBOsanction_date="",a.txtdnCBOsanction_amount="",a.txtdnCBOref_no=""},a.amountschange=function(){var t,e=document.getElementById("txtInput").value,n=e.split(",");for(t=0;t<n.length;t++){var o=e.replace(",","");e=o}var r=Number(o).toLocaleString("en-IN");a.txtdnCBOsanction_amount=r}}angular.module("angle").controller("cboCustomer2loandetailscontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.totalDisplayedpending=100,a.totalDisplayedcompleted=100,a.totalDisplayedrejected=100,a.totalDisplayedworkinprogress=100,a.totalDisplayedtaggedlawyer=100,a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"Pending"==n?a.tabpending=!0:"Completed"==n?a.tabcompleted=!0:"Rejected"==n?a.tabrejected=!0:"Tagged-Lawyer"==n?a.tabtaggedlawyer=!0:"Work-InProgress"==n&&(a.tabworkinprogress=!0):void 0==a.tab.activeTabId?a.tabpending=!0:"Pending"==a.tab.activeTabId?a.tabpending=!0:"Completed"==a.tab.activeTabId?a.tabcompleted=!0:"Rejected"==a.tab.activeTabId?a.tabrejected=!0:"Tagged-Lawyer"==a.tab.activeTabId?a.tabtaggedlawyer=!0:"Work-InProgress"==a.tab.activeTabId&&(a.tabworkinprogress=!0);var t="api/requestCompliance/Compliancemanagementsummary";lockUI(),d.get(t).then(function(t){unlockUI(),a.requestcompliance_data=t.data.requestcompliance_list,a.requestcomplianceworkinprogress_data=t.data.requestcomplianceworkinprogress_list,a.requestcompliancerejected_data=t.data.requestcompliancerejected_list,a.requestcompliancecompleted_data=t.data.requestcompliancecompleted_list,a.requestcompliancetaggedlawyer_data=t.data.requestcompliancetaggedlawyer_list,a.pending_count=t.data.pending_count,a.completed_count=t.data.completed_count,a.rejected_count=t.data.rejected_count,a.workinprogress_count=t.data.workinprogress_count,a.taggedlawyer_count=t.data.taggedlawyer_count;for(var e=0;e<a.requestcompliance_data.length;e++)if("Y"==a.requestcompliance_data[e].response_flag){a.pendingtab_alert="Y";break}for(var e=0;e<a.requestcomplianceworkinprogress_data.length;e++)if("Y"==a.requestcomplianceworkinprogress_data[e].response_flag){a.workinprogresstab_alert="Y";break}for(var e=0;e<a.requestcompliancerejected_data.length;e++)if("Y"==a.requestcompliancerejected_data[e].response_flag){a.rejectedtab_alert="Y";break}for(var e=0;e<a.requestcompliancecompleted_data.length;e++)if("Y"==a.requestcompliancecompleted_data[e].response_flag){a.completedtab_alert="Y";break}for(var e=0;e<a.requestcompliancetaggedlawyer_data.length;e++)if("Y"==a.requestcompliancetaggedlawyer_data[e].response_flag){a.taggedlawyertab_alert="Y";break}null==a.requestcompliance_data?a.pendingCount=0:a.pendingCount=a.requestcompliance_data.length,null==a.requestcomplianceworkinprogress_data?a.workinprogressCount=0:a.workinprogressCount=a.requestcomplianceworkinprogress_data.length,a.requestcompliancetaggedlawyer_data=t.data.requestcompliancetaggedlawyer_list,null==a.requestcompliancetaggedlawyer_data?a.taggedlawyerCount=0:a.taggedlawyerCount=a.requestcompliancetaggedlawyer_data.length,a.requestcompliancecompleted_data=t.data.requestcompliancecompleted_list,null==a.requestcompliancecompleted_data?a.completedCount=0:a.completedCount=a.requestcompliancecompleted_data.length,a.requestcompliancerejected_data=t.data.requestcompliancerejected_list,null==a.requestcompliancerejected_data?a.rejectedCount=0:a.rejectedCount=a.requestcompliancerejected_data.length})}var y=this;y.title="complianceManagementcontroller",h(),a.loadMorepending=function(t){lockUI();var e=parseInt(t);a.totalDisplayedpending+=e,unlockUI()},a.loadMorecompleted=function(t){lockUI();var e=parseInt(t);a.totalDisplayedcompleted+=e,unlockUI()},a.loadMorerejected=function(t){lockUI();var e=parseInt(t);a.totalDisplayedrejected+=e,unlockUI()},a.loadMoretaggedlawyer=function(t){lockUI();var e=parseInt(t);a.totalDisplayedtaggedlawyer+=e,unlockUI()},a.loadMoreworkinprogress=function(t){lockUI();var e=parseInt(t);a.totalDisplayedworkinprogress+=e,unlockUI()},a.pendingview360=function(t){a.requestcompliance_gid=t,a.requestcompliance_gid=localStorage.setItem("requestcompliance_gid",t),c.url("app/LglTrnCompliancePending?lstab=Pending")},a.rejectedview360=function(t){a.requestcompliance_gid=t,a.requestcompliance_gid=localStorage.setItem("requestcompliance_gid",t),c.url("app/LglTrnComplianceRejected?lstab=Rejected")},a.completedview360=function(t){a.requestcompliance_gid=t,a.requestcompliance_gid=localStorage.setItem("requestcompliance_gid",t),c.url("app/LglTrnComplianceCompleted?lstab=Completed")},a.taggedlawyerview360=function(t){a.requestcompliance_gid=t,a.requestcompliance_gid=localStorage.setItem("requestcompliance_gid",t),c.url("app/LglMstCompliance2TagLawyer?lstab=Tagged-Lawyer")},a.workinprogressview360=function(t){a.requestcompliance_gid=t,a.requestcompliance_gid=localStorage.setItem("requestcompliance_gid",t),c.url("app/requestCompliance360?lstab=Work-InProgress")},a.showPopover=function(t,a){function n(e,n){var o={requestcompliance_gid:t},r="api/requestCompliance/GetlawyerStatus";d.getparams(r,o).then(function(t){1==t.data.status&&(e.MdlLawyerSummary=t.data.MdlLawyerSummary,e.lawyeruser_name=t.data.lawyeruser_name,e.request_status=t.data.request_status,e.requestref_no=a)}),e.ok=function(){n.close("closed")}}e.open({templateUrl:"/addcompliance.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("complianceManagementcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c){function u(){a.urn=localStorage.getItem("urn");var t="api/misDataimport/Getcutomer2misdata",e={urn:a.urn};lockUI(),i.getparams(t,e).then(function(t){unlockUI(),a.customer_name=t.data.customer_name,a.urn=t.data.urn,a.mdlMisdataimport=t.data.mdlMisdataimport,console.log(t.data.customer_name)})}var m=this;m.title="editRegisterlawyercontroller",u(),a.requestback=function(){e.go("app.misDataimport")}}angular.module("angle").controller("customer2misdataController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],b.open=function(t){t.preventDefault(),t.stopPropagation(),b.opened=!0},b.close=function(t){t.preventDefault(),t.stopPropagation(),b.closed=!0},b.formats=["dd-MM-yyyy"],b.format=b.formats[0],b.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.otherloan=!0,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0;var t="api/misDataimport/getcustomerDNGID";lockUI();var n={urn:a.urn};console.log(n),d.getparams(t,n).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var t="api/misDataimport/getcustomer2Loan";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.otherloan_list=t.data.otherloan_list,a.customer_name=t.data.customer_name,a.DN1status=t.data.DN1status,a.DN2status=t.data.DN2status,console.log(t.data.DN1status),"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var t="api/misDataimport/DN1ContentDTL";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var t="api/misDataimport/getDN1Status";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var t="api/misDataimport/getcourierinfo";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,console.log(t.data.dn2courier_refno),console.log(t.data.dn2remarks),console.log(t.data.dn2courier_center)});var t="api/misDataimport/Getrevertdetails";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)})}function y(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var b=this;b.title="dn2Customer2loandetailscontroller",h(),a.DN2generate=function(){a.courier_info=!0,a.info=!0,a.dn1status=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(h(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2"),c.url("app/dnTracker?lstab=dn2tracker"),h()})},a.DN2send=function(){var t="api/misDataimport/DN2Status",e={urn:a.urn,dncase_gid:a.dncase_gid,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(h(),l.alert("DN2 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/dnTracker?lstab=dn2tracker"),h()}),a.courier_info=!1,a.dn1status=!0,a.info=!0},a.DN2skip=function(){var t="api/misDataimport/DN2skip",e={urn:a.urn,dncase_gid:a.dncase_gid};d.post(t,e).then(function(t){1==t.data.status?(h(),l.alert("DN2 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN2 Status "),h()}),a.skip=!0,a.dn1status=!0},a.Dn2back=function(){c.url("app/dnTracker?lstab=dn2tracker")},a.cancel=function(){a.courier_info=!1,a.initiatedn2=!0,a.sanctiondtl=!0,a.info=!1},a.clickinitiatedn2=function(){a.initiatedn2=!0,a.courier_info=!1,a.dn1status=!0,a.sanctiondtl=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdn2sanctionref_no=t.data.sanction_refno,a.txtdn2sanction_date=t.data.sanction_date,a.txtdn2sanction_amount=t.data.sanction_amount,a.txtdn2ref_no="SAMFIN/RMD/"});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dn2ref_no=t.data.dn2ref_no,a.dn2sanctionref_no=t.data.dn2sanctionref_no,a.dn2sanction_date=t.data.dn2_date;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dn2sanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn2_flag&&(a.initiatedn2=!0,a.sanctiondtl=!1),"Y"==t.data.dn2_flag&&(a.initiatedn2=!1,a.sanctiondtl=!0)});var t="api/misDataimport/DN2Content",e={urn:a.urn};console.log(e),d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.otherloandetails=function(){a.otherloan=!1,a.click=!1},a.minimizeloan=function(){a.otherloan=!0,a.click=!0},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN2";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/dnTracker?lstab=dn2tracker"),h()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN2";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/dnTracker?lstab=dn2tracker"),h()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN2";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/dnTracker?lstab=dn2tracker"),h()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn2sanctionsubmit=function(){var t="api/misDataimport/DN2sanctiondtl";lockUI();var e={urn:a.urn,dn2sanctionref_no:a.txtdn2sanctionref_no,dn2sanction_date:a.txtdn2sanction_date,dn2sanction_amount:a.txtdn2sanction_amount,dn2ref_no:a.txtdn2ref_no};d.post(t,e).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dn2ref_no=t.data.dn2ref_no,a.dn2sanctionref_no=t.data.dn2sanctionref_no,a.dn2sanction_date=t.data.dn2_date;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dn2sanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn_flag&&(a.initiatedn2=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn2=!1,a.sanctiondtl=!0)});var e="api/misDataimport/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.dn2cancel=function(){a.courier_info=!1,a.initiatedn2=!0,a.sanctiondtl=!0,a.info=!1,a.txtdn2sanctionref_no="",a.txtdn2sanction_date="",a.txtdn2sanction_amount="",a.txtdn2ref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=y(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdn2sanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdn2sanction_amount=n)}}angular.module("angle").controller("dn2Customer2loandetailscontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],y.open=function(t){t.preventDefault(),t.stopPropagation(),y.opened=!0},y.close=function(t){t.preventDefault(),t.stopPropagation(),y.closed=!0},y.formats=["dd-MM-yyyy"],y.format=y.formats[0],y.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.otherloan=!0,a.click=!0,a.initiatedn3=!0,a.dn3format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0;var t="api/misDataimport/DN1ContentDTL";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.content=t.data.dn3_content,document.getElementById("test").innerHTML+=a.content,a.DN1_status=t.data.DN1_status,"DN3 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn3format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN3 Reverted"==t.data.DN1_status&&(a.initiatedn3=!0,a.otherloan=!0,a.click=!0,a.dn3format=!0,a.button=!0,a.courier_info=!1,a.revert=!1),"DN3 Hold"==t.data.DN1_status&&(a.dn3format=!1,a.button=!1,a.courier_info=!1,a.info=!0)});var t="api/misDataimport/getcustomerDNGID";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid,console.log(t.data.dncase_gid)});var t="api/misDataimport/getcustomer2Loan";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.otherloan_list=t.data.otherloan_list,a.customer_name=t.data.customer_name,a.DN3status=t.data.DN3status,console.log(t.data.customer_name),"DN3 Sent"==t.data.DN3status&&(a.dn3format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn3=!0),"DN3 Skip"==t.data.DN3status&&(a.skip=!0)});var t="api/misDataimport/getDN1Status";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,a.dn3history_list=t.data.dn3history_list,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1),"DN2 Skip"!=t.data.DN2status&&"DN2 Sent"!=t.data.DN2status&&"DN2 Generated"!=t.data.DN2status||(a.dndetails=!1)});var t="api/misDataimport/getcourierinfo";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status});var t="api/misDataimport/Getrevertdetails";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)})}var y=this;y.title="dn3Customer2loandetailscontroller",
h(),a.DN3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(h(),n.go("app.dnTracker"),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),h(),c.url("app/dnTracker?lstab=dn3tracker")})},a.DN3send=function(){var t="api/misDataimport/DN3Status",e={urn:a.urn,dncase_gid:a.dncase_gid,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(h(),l.alert("DN3 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN3 Status "),h(),c.url("app/dnTracker?lstab=dn3tracker")}),a.courier_info=!1,a.skip=!1,a.info=!0,a.courierdetails=!0},a.DN3skip=function(){var t="api/misDataimport/DN3skip",e={urn:a.urn,dncase_gid:a.dncase_gid};d.post(t,e).then(function(t){1==t.data.status?(h(),l.alert("DN3 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN3 Status "),h()}),a.skip=!1},a.Dn3back=function(){c.url("app/dnTracker?lstab=dn3tracker")},a.cancel=function(){a.courier_info=!1,a.initiatedn3=!0,a.sanctiondtl=!0,a.info=!1},a.clickinitiatedn3=function(){a.courier_info=!0,a.initiatedn3=!0,a.info=!0,a.sanctiondtl=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdn3sanctionref_no=t.data.sanction_refno,a.txtdn3sanction_date=t.data.sanction_date,a.txtdn3sanction_amount=t.data.sanction_amount,a.txtdn3ref_no="SAMFIN/RMD/"});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dn3ref_no=t.data.dn3ref_no,a.dn3sanctionref_no=t.data.dn3sanctionref_no,a.dn3sanction_date=t.data.dn3_date;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dn3sanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn3_flag&&(a.initiatedn3=!0,a.sanctiondtl=!1),"Y"==t.data.dn3_flag&&(a.initiatedn3=!1,a.sanctiondtl=!0)});var t="api/misDataimport/DN3Content",e={urn:a.urn};console.log(e),d.getparams(t,e).then(function(t){a.content=t.data.template_content})},a.otherloandetails=function(){a.otherloan=!1,a.click=!1},a.minimizeloan=function(){a.otherloan=!0,a.click=!0},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN3";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/dnTracker?lstab=dn3tracker"),h()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN3";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/dnTracker?lstab=dn3tracker"),h()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN3";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/dnTracker?lstab=dn3tracker"),h()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn3sanctionsubmit=function(){var t="api/misDataimport/DN3sanctiondtl";lockUI();var e={urn:a.urn,dn3sanctionref_no:a.txtdn3sanctionref_no,dn3sanction_date:a.txtdn3sanction_date,dn3sanction_amount:a.txtdn3sanction_amount,dn3ref_no:a.txtdn3ref_no};console.log(e),d.post(t,e).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dn3ref_no=t.data.dn3ref_no,a.dn3sanctionref_no=t.data.dn3sanctionref_no,a.dn3sanction_date=t.data.dn3_date;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dn3sanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn_flag&&(a.initiatedn3=!0,a.sanctiondtl=!1),"Y"==t.data.dn3_flag&&(a.initiatedn3=!1,a.sanctiondtl=!0)});var e="api/misDataimport/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.dn3cancel=function(){a.courier_info=!1,a.initiatedn3=!0,a.sanctiondtl=!0,a.info=!1,a.txtdn3sanctionref_no="",a.txtdn3sanction_date="",a.txtdn3sanction_amount="",a.txtdn3ref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=inWords(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdn3sanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdn3sanction_amount=n)}}angular.module("angle").controller("dn3Customer2loandetailscontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!0,a.sanctiondtl=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,a.DN1status=t.data.DN1status,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Sent"==t.data.DN1status&&(a.info=!1,a.initiatedn1=!0),"DN1 Sent"!=t.data.DN1status&&"DN1 Skip"!=t.data.DN1status||(a.data=!0)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list});var t="api/misDataimport/DN1ContentDTL";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.DN1_status=t.data.DN1_status,"DN1 Generated"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Hold"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.DN1_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.couriered_by=t.data.couriered_by,a.courier_center=t.data.courier_center,a.courier_date=t.data.courier_date,a.courier_refno=t.data.courier_refno,a.courier_remarks=t.data.courier_remarks,a.courier_status=t.data.dn1courier_status});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function b(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var k=this;k.title="dnCustomer2loandetailscontroller",y(),a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(y(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),y()}),a.courier_info=!1,a.info=!0},a.dn1generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN1generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(y(),l.alert("DN1 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN1 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),y()})},a.dn2generate=function(){a.courier_info=!0,a.info=!0,console.log("dn2");var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(y(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),y()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0,console.log("test");var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(y(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),y()})},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(y(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),y()})},a.Dn1back=function(){c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn1_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),y()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),y()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),y()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)""!=a.cboguarantor&&void 0!=a.cboguarantor||(a.Sanctioninfo=!0);else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if("Legal-DN1"==a.cbotemplate.template_name){var o="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";lockUI(),d.post(o,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}else if("Legal-DN2"==a.cbotemplate.template_name){var o="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";lockUI(),d.post(o,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}else if("Legal-DN3"==a.cbotemplate.template_name){var o="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";lockUI(),d.post(o,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}}},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=b(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)}}angular.module("angle").controller("dnCustomer2loandetailscontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u){function m(){lockUI();var t="api/lglDashboard/getdnTAT";s.get(t).then(function(t){unlockUI(),a.dnTAT_list=t.data.dnTAT_list,console.log(t.data.dnTAT_list)})}var p=this;p.title="dnReportcontroller",m()}angular.module("angle").controller("dnReportcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.total=0,a.totalDisplayed=0,a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"pending"==n?a.tabpending=!0:"generated"==n?a.tabgenerated=!0:"skipped"==n?a.tabskipped=!0:"exclusion"==n?a.tabexclusion=!0:"legalsr"==n&&(a.tablegalsr=!0):void 0==a.tab.activeTabId?a.tabpending=!0:"pending"==a.tab.activeTabId?a.tabpending=!0:"generated"==a.tab.activeTabId?a.tabgenerated=!0:"skipped"==a.tab.activeTabId?a.tabskipped=!0:"exclusion"==a.tab.activeTabId?a.tabexclusion=!0:"legalsr"==a.tab.activeTabId&&(a.tablegalsr=!0),lockUI();var t="api/LglTrnDNTrackerCBO/getCBOPendingList";d.get(t).then(function(t){unlockUI(),a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))})}var y=this;y.title="dnTrackerCBOcontroller",h(),a.loadMore=function(t){if(void 0==t)return void l.alert("Enter the Total Summary Count","warning");lockUI();var e=parseInt(t);if(0!=a.total){if(!(t<a.total))return unlockUI(),void l.alert(" Total Summary "+a.total+" Records Only","warning");a.totalDisplayed+=e,a.total<a.totalDisplayed&&(a.totalDisplayed=a.total,l.alert(" Total Summary "+a.total+" Records Only","warning")),unlockUI()}unlockUI()},a.generated=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})},a.skipped=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOSkippedList";d.get(t).then(function(t){unlockUI(),a.DNskipped_list=t.data.DNskipped_list,null==a.DNskipped_list?(a.total=0,a.totalDisplayedskipped=0):(a.total=a.DNskipped_list.length,a.DNskipped_list.length<100&&(a.totalDisplayedskipped=a.DNskipped_list.length))})},a.exclusion=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOExclusionList";d.get(t).then(function(t){unlockUI(),a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})},a.pending=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOPendingList";d.get(t).then(function(t){unlockUI(),a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))})},a.legalsrlist=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOLegalSRList";d.get(t).then(function(t){unlockUI(),a.DNlegalsr_list=t.data.DNlegalsr_list,null==a.DNlegalsr_list?(a.total=0,a.totalDisplayedlegalsr=0):(a.total=a.DNlegalsr_list.length,a.DNlegalsr_list.length<100&&(a.totalDisplayedlegalsr=a.DNlegalsr_list.length))})},a.dn1generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerCBOGenerate?lstab=pending")},a.dn2generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerCBO2Generate?lstab=pending")},a.dn3generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerCBO3Generate?lstab=pending")},a.dngeneratedinfo=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNCBOGenerateTab?lstab=generated")},a.dnackstatus=function(t){function n(a,e){a.warningmsg=!1,a.ok=function(){e.close("closed")},a.changewarningmsg=function(){a.warningmsg=!1},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn1ackstatusupdation=function(){if("Delivered"==a.dn1ackstatus)if(""==a.txtdelivered_date||void 0==a.txtdelivered_date)a.warningmsg=!0;else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),h()})}else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),h()})}}}a.warningmsg=!1;e.open({templateUrl:"/dn1ackstatus.html",controller:n,size:"md"});y.open=function(t){t.preventDefault(),t.stopPropagation(),y.opened=!0},y.close=function(t){t.preventDefault(),t.stopPropagation(),y.closed=!0},y.formats=["dd-MM-yyyy"],y.format=y.formats[0],y.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.dn2ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn2ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn2delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn2ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),h()})}}console.log("dn2");e.open({templateUrl:"/dn2ackstatus.html",controller:a,size:"md"});y.open=function(t){t.preventDefault(),t.stopPropagation(),y.opened=!0},y.close=function(t){t.preventDefault(),t.stopPropagation(),y.closed=!0},y.formats=["dd-MM-yyyy"],y.format=y.formats[0],y.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn3ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn3ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn3delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn3ackstatusupdate";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),h()})}}console.log("dn3");e.open({templateUrl:"/dn3ackstatus.html",controller:a,size:"md"});y.open=function(t){t.preventDefault(),t.stopPropagation(),y.opened=!0},y.close=function(t){t.preventDefault(),t.stopPropagation(),y.closed=!0},y.formats=["dd-MM-yyyy"],y.format=y.formats[0],y.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.exclusioncustomer=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?e.Nohistoryexclusion=!0:e.historyexclusion=!0}),e.confirmExclusioncustomer=function(){var a={customer_urn:t,exclusion_reason:e.txtexclusion_reason},o="api/LglTrnDNTrackerVertical/GetExclusionCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),h()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),n.close("closed"))})}}console.log("test",t);e.open({templateUrl:"/exclusionpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.activateexclusion=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a,e.confirmActivation=function(){lockUI();var a={customer_urn:t,exclusion_reason:e.txtactivated_reason},o="api/LglTrnDNTrackerVertical/GetActivationCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),h()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}e.open({templateUrl:"/activateconfirmation.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.exclusionHistory=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory})}e.open({templateUrl:"/exclusionHistoryPopup.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},a.DNskip=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customer_name=a,e.confirmSkip=function(){lockUI();var a={urn:t,validity:e.txtskipvalid_date,skip_reason:e.txtskip_reason},o="api/misDataimport/DNskip";d.post(o,a).then(function(t){1==t.data.status?(h(),l.alert("DN Skipped Successfully","success")):l.alert("Error Occurred While Updating DN Skip "),n.close("closed")})}}e.open({templateUrl:"/skipdn.html",controller:n,size:"md"
});y.open=function(t){t.preventDefault(),t.stopPropagation(),y.opened=!0},y.close=function(t){t.preventDefault(),t.stopPropagation(),y.closed=!0},y.formats=["dd-MM-yyyy"],y.format=y.formats[0],y.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.legalsr=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customer_name=a,e.confirm=function(){lockUI();var o={customer_urn:t,customer_name:a,remarks:e.txtremarks};console.log(o);var r="api/LglTrnDNTrackerVertical/raiselegalsr";d.post(r,o).then(function(t){1==t.data.status?(h(),l.alert("Legal SR Raised Successfully","success")):l.alert("Error Occurred "),n.close("closed")})}}e.open({templateUrl:"/legalsr.html",controller:n,size:"md"});y.open=function(t){t.preventDefault(),t.stopPropagation(),y.opened=!0},y.close=function(t){t.preventDefault(),t.stopPropagation(),y.closed=!0},y.formats=["dd-MM-yyyy"],y.format=y.formats[0],y.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.raisesr=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),c.url("app/raiseSR2authentication?lstab=dntracker")},a.view=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",templegalsr_gid),a.customer_gid=localStorage.setItem("customer_gid",customer_gid),n.go("app.viewlegalSR")},a.dn1pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN1.pdf"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn2pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN2.pdf")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN3.pdf")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnTrackerCBOcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"dn1tracker"==n?a.tabdn1tracker=!0:"dn2tracker"==n?a.tabdn2tracker=!0:"dn3tracker"==n&&(a.tabdn3tracker=!0):void 0==a.tab.activeTabId?a.tabdn1tracker=!0:"dn1tracker"==a.tab.activeTabId?a.tabdn1tracker=!0:"dn2tracker"==a.tab.activeTabId?a.tabdn2tracker=!0:"dn3tracker"==a.tab.activeTabId&&(a.tabdn3tracker=!0),lockUI();var t="api/misDataimport/GetDN1list";d.get(t).then(function(t){a.DN1LIST=t.data.mdlMisdataimport});var t="api/misDataimport/GetDN2list";d.get(t).then(function(t){a.DN2LIST=t.data.mdlMisdataimport});var t="api/misDataimport/GetDN3list";d.get(t).then(function(t){unlockUI(),a.DN3LIST=t.data.mdlMisdataimport});var t="api/misDataimport/RecoveredCases";d.get(t).then(function(t){unlockUI(),a.RecoverCases=t.data.mdlMisdataimport});var t="api/misDataimport/GetDNcount";d.get(t).then(function(t){a.DN1_total_count=t.data.dn1_total_count,a.DN1_today_count=t.data.dn1_today_count,a.DN2_total_count=t.data.dn2_total_count,a.DN2_today_count=t.data.dn2_today_count,a.DN3_total_count=t.data.dn3_total_count,a.DN3_today_count=t.data.dn3_today_count,a.import_date=t.data.import_date,a.process_date=t.data.process_date,a.employee_name=t.data.employee_name})}var b=this;b.title="dnTrackercontroller",y(),a.dn1customerdetails=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/dnCustomer2loandetails?lstab=dn1tracker")},a.dn2customerdetails=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/dn2Customer2loandetails?lstab=dn2tracker")},a.dn3customerdetails=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/dn3Customer2loandetails?lstab=dn3tracker")},a.dn1ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn1ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}e.open({templateUrl:"/dn1ackstatus.html",controller:a,size:"md"});b.open=function(t){t.preventDefault(),t.stopPropagation(),b.opened=!0},b.close=function(t){t.preventDefault(),t.stopPropagation(),b.closed=!0},b.formats=["dd-MM-yyyy"],b.format=b.formats[0],b.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn2ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn2ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn2delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn2ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}e.open({templateUrl:"/dn2ackstatus.html",controller:a,size:"md"});b.open=function(t){t.preventDefault(),t.stopPropagation(),b.opened=!0},b.close=function(t){t.preventDefault(),t.stopPropagation(),b.closed=!0},b.formats=["dd-MM-yyyy"],b.format=b.formats[0],b.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn3ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn3ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn3delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn3ackstatusupdate";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}e.open({templateUrl:"/dn3ackstatus.html",controller:a,size:"md"});b.open=function(t){t.preventDefault(),t.stopPropagation(),b.opened=!0},b.close=function(t){t.preventDefault(),t.stopPropagation(),b.closed=!0},b.formats=["dd-MM-yyyy"],b.format=b.formats[0],b.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn1pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),unlockUI(),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn3pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),unlockUI(),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})}}angular.module("angle").controller("dnTrackercontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m){function p(){_.open=function(t){t.preventDefault(),t.stopPropagation(),_.opened=!0},_.close=function(t){t.preventDefault(),t.stopPropagation(),_.closed=!0},_.formats=["dd-MM-yyyy"],_.format=_.formats[0];var t=new Date,e=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2);a.date=[t.getFullYear(),e,n].join("-"),_.formats=["dd-MM-yyyy"],_.format=_.formats[0],_.dateOptions={formatYear:"yy",startingDay:1};var o={date:a.date},r="api/lglDashboard/GetdntrackerReport";lockUI(),s.getparams(r,o).then(function(t){a.dn_list=t.data.dn_list,a.dn1send_count=t.data.dn1send_count,a.dn2send_count=t.data.dn2send_count,a.dn3send_count=t.data.dn3send_count,a.dn1skip_count=t.data.dn1skip_count,a.dn2skip_count=t.data.dn2skip_count,a.dn3skip_count=t.data.dn3skip_count,unlockUI()})}var _=this;_.title="dnTrackerReportcontroller",p(),a["export"]=function(){var t={};lockUI();var a="api/lglDashboard/DNexport";s.post(a,t).then(function(t){console.log(t.data.status),1==t.data.status?(m.Downloaddocument(t.data.lspath,t.data.lsname),unlockUI()):(unlockUI(),d.alert("Error Occurred While Export !","success"),p())})},a.search=function(){if(void 0==a.date||""==a.date)var t="null";else var t=a.date,t=new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0];var e={date:t};console.log(e);var n="api/lglDashboard/GetdntrackerReport_IST";lockUI(),s.getparams(n,e).then(function(t){a.dn_list=t.data.dn_list,a.dn1send_count=t.data.dn1send_count,a.dn2send_count=t.data.dn2send_count,a.dn3send_count=t.data.dn3send_count,a.dn1skip_count=t.data.dn1skip_count,a.dn2skip_count=t.data.dn2skip_count,a.dn3skip_count=t.data.dn3skip_count,unlockUI()})}}angular.module("angle").controller("dnTrackerReportcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_){function g(){a.lawfirm2lawyerEdit=[];var t="api/lawFirm/lawfirm2lawyer";d.get(t).then(function(t){a.lawfirm2lawyer_list=t.data.lawfirm2lawyer_list}),a.lawfirm_gid=localStorage.getItem("lawfirm_gid");var t="api/lawFirm/Getlawfirmdetails",e={lawfirm_gid:a.lawfirm_gid};lockUI(),d.getparams(t,e).then(function(t){a.txtfirm_refnoedit=t.data.txtfirm_refnoedit,a.txtfirm_nameedit=t.data.txtfirm_nameedit,a.txtcontact_noedit=t.data.txtcontact_noedit,a.txtemailaddressedit=t.data.txtemailaddressedit,a.txtwebsiteedit=t.data.txtwebsiteedit,a.txtexperienceedit=t.data.txtexperienceedit,a.txtaddress1edit=t.data.txtaddress1edit,a.txtremarksedit=t.data.txtremarksedit,a.filename_list=t.data.UploadDocument;for(var e=0;e<t.data.lawyerlist_edit.length;e++){var n=a.lawfirm2lawyer_list.map(function(t){return t.lawyerregister_gid}).indexOf(t.data.lawyerlist_edit[e].lawyerregister_gid);a.lawfirm2lawyerEdit.push(a.lawfirm2lawyer_list[n])}});var t="api/lawFirm/tempdelete";d.get(t).then(function(t){});var t="api/lawFirm/getlawfirm2member";d.getparams(t,e).then(function(t){a.member_list=t.data.member_list}),unlockUI()}function f(){var t="api/lawFirm/getEditlawfirm2member",e={lawfirm_gid:a.lawfirm_gid};d.getparams(t,e).then(function(t){a.member_list=t.data.member_list})}var v=this;v.title="editLawfirmcontroller",g(),a.document_cancelclick=function(t,e){var n={document_gid:t},o="api/lawFirm/documentdelete";lockUI(),d.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3})})},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=_.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.lawfirm_gid=localStorage.getItem("lawfirm_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("lawfirm_gid",a.lawfirm_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/lawFirm/Editploadbankcertificate";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.filename_list=t.data.UploadDocument,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported"))})},a.lawfirmUpdate=function(){var t={lawfirm_gid:a.lawfirm_gid,txtfirm_refnoedit:a.txtfirm_refnoedit,txtfirm_nameedit:a.txtfirm_nameedit,txtcontact_noedit:a.txtcontact_noedit,txtemailaddressedit:a.txtemailaddressedit,txtexperienceedit:a.txtexperienceedit,txtaddress1edit:a.txtaddress1edit,txtremarksedit:a.txtremarksedit,txtwebsiteedit:a.txtwebsiteedit,lawyerlist_edit:a.lawfirm2lawyerEdit},n="api/lawFirm/updateLawfirm";d.post(n,t).then(function(t){1==t.data.status?(g(),e.go("app.lawfirmSummary"),l.alert("Lawfirm Updated Successfully","success")):l.alert("Error Occurred While Updating Lawfirm "),g()})},a.lawfirmback=function(){var t="api/lawFirm/tempdelete";lockUI(),d.get(t).then(function(t){}),e.go("app.lawfirmSummary")},a.addlawfirm2member=function(){function t(t,a){t.enrolmentno_validation=function(){var a={enrolment_no:t.txtenrolment_no},e="api/lawFirm/GetLawfirmenrolment_validation";d.getparams(e,a).then(function(a){console.log(a.data.enrolment_no),"Y"==a.data.enrolment_no?t.validationMsg=!0:t.validationMsg=!1})},t.ok=function(){a.close("closed")},t.submitmember=function(){var e={lawyer_name:t.txtmember_name,mobile_no:t.txtmobileno,email_address:t.txtemailaddress,designation:t.txtdesignation,enrolment_no:t.txtenrolment_no},n="api/lawFirm/postmembers";lockUI(),d.post(n,e).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}n.open({templateUrl:"/addmember.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},a.memberdelete=function(t,e){var n={lawfirmmember_gid:t};console.log(n);var o="api/lawFirm/memberdelete";lockUI(),d.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.member_list,function(e,n){e.lawfirmmember_gid==t&&a.member_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),f()):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3})})},a.taglawyer=function(){function t(t,a){t.ok=function(){a.close("closed")};var e="api/lawFirm/lawfirm2lawyer";d.get(e).then(function(a){t.lawfirm2lawyer_list=a.data.lawfirm2lawyer_list}),t.submittag=function(){var e={lawyerregister_gid:t.cbolawfirm2lawyer.lawyerregister_gid,designation:t.txtdesignation};console.log(e);var n="api/lawFirm/TagLawyer2lawfirm";lockUI(),d.post(n,e).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}n.open({templateUrl:"/taglawyer.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("editLawfirmcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){}var y=this;y.title="editLegalSRcontroller",h(),a.srback=function(t){n.go("app.legalSRsummary")}}angular.module("angle").controller("editLegalSRcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u){function m(){p.today=function(){p.dt=new Date},p.today(),a.hidephotodiv=!0,a.showphotodiv=!1,p.open=function(t){t.preventDefault(),t.stopPropagation(),p.opened=!0},p.close=function(t){t.preventDefault(),t.stopPropagation(),p.closed=!0};var t="api/registerlawyer/tempdelete";i.get(t).then(function(t){}),p.dateOptions={formatYear:"yy",startingDay:1},a.lawyerregister_gid=localStorage.getItem("lawyerregister_gid");var t="api/registerLawyer/Getlawyerdetails",e={lawyerregister_gid:a.lawyerregister_gid};lockUI(),i.getparams(t,e).then(function(t){a.txtlawyerref_noedit=t.data.txtlawyerref_noedit,a.txtlawyernameedit=t.data.txtlawyernameedit,a.txtdobedit=t.data.dobedit,a.txtdobedit=Date.parse(a.txtdobedit),a.genderedit=t.data.genderedit,a.txtmobilenoedit=t.data.txtmobilenoedit,a.txttelephonenoedit=t.data.txttelephonenoedit,a.txtemailaddressedit=t.data.txtemailaddressedit,a.txtqualificationedit=t.data.txtqualificationedit,a.txtdateenrol_counciledit=t.data.txtdateenrol_counciledit,a.txtdateenrol_counciledit=Date.parse(a.txtdateenrol_counciledit),a.txtpannoedit=t.data.txtpannoedit,a.txtexperienceedit=t.data.txtexperienceedit,a.txtplace_practiceedit=t.data.txtplace_practiceedit,a.txtaddress1edit=t.data.txtaddress1edit,a.txtaddress2edit=t.data.txtaddress2edit,a.txtstateedit=t.data.txtstateedit,a.txtcountryedit=t.data.txtcountryedit,a.txtpostalcodeedit=t.data.txtpostalcodeedit,a.filename_list=t.data.UploadDocumentList,a.txtenrolment_no=t.data.txtenrolment_no,a.txtaadhar_noedit=t.data.aadhar_no,a.txtbank_nameedit=t.data.bank_name,a.txtaccount_noedit=t.data.account_no,a.txtifsc_codeedit=t.data.ifsc_code,unlockUI(),console.log(t.data.txtlawyernameedit)})}var p=this;p.title="editRegisterlawyercontroller",m(),a.lawyerUpdate=function(){var t={lawyerregister_gid:a.lawyerregister_gid,txtlawyerref_noedit:a.txtlawyerref_noedit,txtlawyernameedit:a.txtlawyernameedit,dob_edit:a.txtdobedit,genderedit:a.genderedit,txtfather_nameedit:a.txtfather_nameedit,txtmobilenoedit:a.txtmobilenoedit,txttelephonenoedit:a.txttelephonenoedit,txtemailaddressedit:a.txtemailaddressedit,txtqualificationedit:a.txtqualificationedit,txt_dateenrol_counciledit:a.txtdateenrol_counciledit,txtgstnoedit:a.txtgstnoedit,txtpannoedit:a.txtpannoedit,txtexperienceedit:a.txtexperienceedit,txtplace_practiceedit:a.txtplace_practiceedit,txtaddress1edit:a.txtaddress1edit,txtaddress2edit:a.txtaddress2edit,txtstateedit:a.txtstateedit,txtcountryedit:a.txtcountryedit,txtpostalcodeedit:a.txtpostalcodeedit,txtenrolment_no:a.txtenrolment_no,aadhar_no:a.txtaadhar_noedit,bank_name:a.txtbank_nameedit,account_no:a.txtaccount_noedit,ifsc_code:a.txtifsc_codeedit};console.log(t);var n="api/registerLawyer/lawyerUpdate";i.post(n,t).then(function(t){1==t.data.status?(m(),e.go("app.lawyerManagement"),s.alert("Lawyer Details Updated Successfully","success")):s.alert("Error Occurred While Updating Lawyer Details")})},a.lawyerback=function(){var t="api/registerlawyer/tempdelete";lockUI(),i.get(t).then(function(t){}),e.go("app.lawyerManagement")},a.document_cancelclick=function(t,e){var n={document_gid:t},o="api/registerLawyer/documentdelete";i.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),s.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):s.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3})})},a.photo=function(t,e,n){var o={name:t[0].name,file:t[0]},r=u.fnCheckValidDocType(t[0].name,"photo");if(0==r)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var d=new FormData;d.append("fileupload",o.file),d.append("file_name",o.name),d.append("document_name",a.documentname),d.append("project_flag","photo"),a.uploadfrm=d,localStorage.setItem(a.uploadfrm,"$scope.uploadfrm");var l="api/registerLawyer/Uploadphoto";lockUI(),i.postFile(l,a.uploadfrm).then(function(t){$("#adduploadphoto").val(""),1==t.data.status?(unlockUI(),a.hidephotodiv=!1,a.showphotodiv=!0):(unlockUI(),s.alert("File Format Not Supported"))})},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=u.fnCheckValidDocType(t[0].name,"");if(0==r)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.lawyerregister_gid=localStorage.getItem("lawyerregister_gid");var d=new FormData;d.append("fileupload",o.file),d.append("file_name",o.name),d.append("document_name",a.documentname),d.append("document_type",a.document_type),d.append("lawyerregister_gid",a.lawyerregister_gid),d.append("project_flag","Default"),a.uploadfrm=d;var l="api/registerLawyer/edituploadEnrollcertificate";lockUI(),i.postFile(l,a.uploadfrm).then(function(t){a.filename_list=t.data.UploadDocumentList,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,s.alert("Document Uploaded Successfully","success")):(unlockUI(),s.alert("File Format Not Supported!"))})},a.enrolmentno_validation=function(){var t={enrolment_no:a.txtenrolment_no},e="api/registerlawyer/Getenrolment_validation";i.getparams(e,t).then(function(t){console.log(t.data.enrolment_no),"Y"==t.data.enrolment_no?a.validationMsg=!0:a.validationMsg=!1})}}angular.module("angle").controller("editRegisterlawyercontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.others_title=!1,b.open=function(t){t.preventDefault(),t.stopPropagation(),b.opened=!0},b.close=function(t){t.preventDefault(),t.stopPropagation(),b.closed=!0},b.dateOptions={formatYear:"yy",startingDay:1},a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid");var t="api/requestCompliance/Getrequestcompliance",e={requestcompliance_gid:a.requestcompliance_gid};lockUI(),d.getparams(t,e).then(function(t){a.txtrequestref_noedit=t.data.requestref_no,a.txtrequest_dateedit=t.data.request_date,a.cborequest_typeedit=t.data.requesttype_gid,a.txtothers_title=t.data.others_title,a.txtremarksedit=t.data.remarks,a.txtdocument_typeedit=t.data.document_type,a.filename_list=t.data.upload_list,"Others"==t.data.request_type?a.others_title=!0:a.others_title=!1,unlockUI()});var t="api/requestCompliance/getrequesttype2compliance";d.get(t).then(function(t){a.requesttype_list=t.data.requesttype_list});var t="api/requestCompliance/reqtempdelete";d.get(t).then(function(t){})}var b=this;b.title="editRequestcompliancecontroller",y(),a.onselectedrequsttype=function(){var t="api/requestCompliance/Geteditrequesttype",e={requesttype_gid:a.cborequest_typeedit};console.log(e),d.getparams(t,e).then(function(t){"Others"==t.data.request_type?a.others_title=!0:a.others_title=!1})},a.requestupdate=function(){var t="api/requestCompliance/editmandatory_check",e={requestcompliance_gid:a.requestcompliance_gid};d.getparams(t,e).then(function(t){if(0==t.data.status)l.alert(t.data.message,"warning");else{var e={requestcompliance_gid:a.requestcompliance_gid,requestref_no:a.txtrequestref_noedit,requesttype_gid:a.cborequest_typeedit,others_title:a.txtothers_title,remarks:a.txtremarksedit},o="api/requestCompliance/updateRequestcompliance";d.post(o,e).then(function(t){1==t.data.status?(y(),n.go("app.requestCompliancesummary"),l.alert(t.data.message,"success")):l.alert(t.data.message,"warning"),y()})}})},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=h.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.lawfirm_gid=localStorage.getItem("requestcompliance_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_type",a.document_type),i.append("requestcompliance_gid",a.requestcompliance_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/Edituploaddocument";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.filename_list=t.data.upload_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type=""):(unlockUI(),l.alert("File Format Not Supported"))})},a.document_cancelclick=function(t,e){var n={uploaddocument_gid:t},o="api/requestCompliance/documentdelete";lockUI(),d.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.uploaddocument_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3})})},a.requestback=function(){var t="api/requestCompliance/tempdelete";d.get(t).then(function(t){}),n.go("app.requestCompliancesummary")}}angular.module("angle").controller("editRequestcompliancecontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.totalDisplayed=100;var t="api/lawFirm/lawfirmdetail";lockUI(),d.get(t).then(function(t){unlockUI(),a.lawfirm_data=t.data.lawfirm_list,a.total=a.lawfirm_data.length})}var y=this;y.title="lawfirmSummarycontroller",h(),document.getElementById("pagecount").onkeyup=function(){if(null==a.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},a.loadMore=function(t){lockUI();var e=parseInt(t);a.totalDisplayed+=e,unlockUI()},a.popuplawfirm=function(){n.go("app.addLawfirm")},a.edit=function(t){a.lawfirm_gid=t,a.lawfirm_gid=localStorage.setItem("lawfirm_gid",t),n.go("app.editLawfirm")},a["delete"]=function(t){var a={lawfirm_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it",closeOnConfirm:!1},function(t){if(t){var e="api/lawFirm/lawfirmDelete";d.getparams(e,a).then(function(t){1==t.data.status?h():(l.alert("Error Occurred ",{status:"warning",pos:"top-right",timeout:3e3}),h())}),o.swal("Deleted Successfully")}})},a.Viewfirm=function(t){a.lawfirm_gid=t,a.lawfirm_gid=localStorage.setItem("lawfirm_gid",t),n.go("app.viewLawfirm")},a.logincreation=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.close=function(){e.close("closed")};var o="api/lawFirm/lawfirmView";d.getparams(o,n).then(function(t){a.firm_refno=t.data.firm_refno,a.firm_name=t.data.firm_name}),a.sendaccouncreate=function(){var n={lawfirmuser_code:a.firm_refno,lawfirmuser_password:a.lawfirm_userpassword,lawfirm_gid:t};console.log(n);var o="api/lawFirm/lawfirmlogincreation";lockUI(),d.post(o,n).then(function(t){console.log(t.data.status),1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),h()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI())})}}var n={lawfirm_gid:t};e.open({templateUrl:"/lawfirmLoginContent.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.viewlogin=function(t){function n(a,e){a.ok=function(){e.close("closed")},a.mandatorycheck=function(){a.mandatoryfields=!1},a.close=function(){e.close("closed")},a.resetpwd=function(){a.resetpassword=!0,a.lawfirmruser_password=""};var n="api/lawFirm/lawfirmView";d.getparams(n,o).then(function(t){a.firm_refno=t.data.firm_refno,a.firm_name=t.data.firm_name,a.lawfirmuser_password=t.data.lawfirmuser_password,a.loginuserstatus=t.data.lawfirmuser_status,a.lawyerstatus_remarks=t.data.block_remarks,a.block_remarks=t.data.block_remarks}),a.sendaccounstatus=function(){if("Block"!=a.loginuserstatus){if(""==a.lawyerstatus_remarks)var n=a.txtblockremarks;else n=a.lawyerstatus_remarks;var o={lawfirmuser_activation:a.loginuserstatus,lawfirm_gid:t,blockremarks:n,lawfirmuser_password:a.lawfirmuser_password};console.log(o);var r="api/lawFirm/lawfirmactivationstatus";d.post(r,o).then(function(t){1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),h()):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}else if(""==a.txtblockremarks||void 0==a.txtblockremarks)a.mandatoryfields=!0;else{if(a.mandatoryfields=!1,""==a.lawyerstatus_remarks)var n=a.txtblockremarks;else n=a.lawyerstatus_remarks;var o={lawfirmuser_activation:a.loginuserstatus,lawfirm_gid:t,blockremarks:n,lawfirmuser_password:a.lawfirmuser_password},r="api/lawFirm/lawfirmactivationstatus";d.post(r,o).then(function(t){1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),h()):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}}}var o={lawfirm_gid:t};a.resetpassword=!1;e.open({templateUrl:"/ViewlawfirmLoginContent.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.remarks=function(){a.mandatoryfields=!1}}angular.module("angle").controller("lawfirmSummarycontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.totalDisplayed=100;var t="api/registerLawyer/lawyerdetail";lockUI(),d.get(t).then(function(t){unlockUI(),a.lawyer_data=t.data.lawyer_list,a.total=a.lawyer_data.length})}var y=this;y.title="lawyerManagementcontroller",h(),document.getElementById("pagecount").onkeyup=function(){if(null==a.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},a.loadMore=function(t){lockUI();var e=parseInt(t);a.totalDisplayed+=e,unlockUI()},a.popuplawyer=function(){n.go("app.registerLawyer")},a.edit=function(t){a.lawyerregister_gid=t,a.lawyerregister_gid=localStorage.setItem("lawyerregister_gid",t),n.go("app.editRegisterlawyer")},a["delete"]=function(t){var a={lawyerregister_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var e="api/registerLawyer/lawyerDelete";d.getparams(e,a).then(function(t){1==t.data.status?(h(),o.swal(t.data.message)):(o.swal(t.data.message),
h())})}})},a.Viewfirm=function(t){a.lawyerregister_gid=t,a.lawyerregister_gid=localStorage.setItem("lawyerregister_gid",t),n.go("app.viewLawyer")},a.logincreation=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.close=function(){e.close("closed")};var o="api/registerLawyer/lawyerView";d.getparams(o,n).then(function(t){a.lawyerref_no=t.data.lawyerref_no,a.lawyer_name=t.data.lawyer_name,a.email_address=t.data.email_address}),a.sendaccouncreate=function(){var n={lawyeruser_code:a.lawyerref_no,lawyer_userpassword:a.lawyer_userpassword,email_address:a.email_address,lawyerregister_gid:t},o="api/registerLawyer/lawyerlogincreation";lockUI(),d.post(o,n).then(function(t){console.log(t.data.status),1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),h()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI())})}}var n={lawyerregister_gid:t};e.open({templateUrl:"/lawyerLoginContent.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.viewlogin=function(t){function n(a,e){a.ok=function(){e.close("closed")},a.mandatorycheck=function(){a.mandatoryfields=!1},a.close=function(){e.close("closed")},a.resetpwd=function(){a.resetpassword=!0,a.lawyeruser_password=""};var n="api/registerLawyer/lawyerView";d.getparams(n,o).then(function(t){a.lawyerref_no=t.data.lawyerref_no,a.lawyer_name=t.data.lawyer_name,a.lawyeruser_password=t.data.lawyeruser_password,a.loginuserstatus=t.data.lawyeruser_status,a.lawyerstatus_remarks=t.data.block_remarks,a.block_remarks=t.data.block_remarks,console.log(t.data.block_remarks)}),a.sendaccounstatus=function(){if("Block"!=a.loginuserstatus){if(""==a.lawyerstatus_remarks)var n=a.txtblockremarks;else n=a.lawyerstatus_remarks;var o={lawyeruser_activation:a.loginuserstatus,lawyerregister_gid:t,blockremarks:n,lawyeruser_password:a.lawyeruser_password},r="api/registerLawyer/lawyeractivationstatus";d.post(r,o).then(function(t){1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),h()):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}else if(""==a.txtblockremarks||void 0==a.txtblockremarks)a.mandatoryfields=!0;else{if(console.log(a.txtblockremarks),a.mandatoryfields=!1,""==a.lawyerstatus_remarks)var n=a.txtblockremarks;else n=a.lawyerstatus_remarks;var o={lawyeruser_activation:a.loginuserstatus,lawyerregister_gid:t,blockremarks:n,lawyeruser_password:a.lawyeruser_password},r="api/registerLawyer/lawyeractivationstatus";d.post(r,o).then(function(t){1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),h()):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}}}var o={lawyerregister_gid:t};a.resetpassword=!1;e.open({templateUrl:"/ViewlawyerLoginContent.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.remarks=function(){a.mandatoryfields=!1}}angular.module("angle").controller("lawyerManagementcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u){function m(){a.totalDisplayed=100;var t="api/LawyerInvoice/GetPaymentSummary";s.get(t).then(function(t){a.invoicelist=t.data.invoicedtl,a.total=a.invoicelist.length})}var p=this;p.title="lawyerPaymentcontroller",m(),document.getElementById("pagecount").onkeyup=function(){if(null==a.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},a.loadMore=function(t){lockUI();var e=parseInt(t);a.totalDisplayed+=e,unlockUI()},a.viewinvoice=function(t){localStorage.setItem("caseref_gid",t),e.go("app.LglTrnInvoiceSummary")}}angular.module("angle").controller("lawyerPaymentcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m){function p(){a.lawyerinvoicedtl_gid=localStorage.getItem("lawyerinvoicedtl_gid");var t={lawyerinvoicedtl_gid:localStorage.getItem("lawyerinvoicedtl_gid")},e="api/LawyerInvoice/getinvoicedetails";s.getparams(e,t).then(function(t){console.log(t),a.invoicedetail=t.data,a.filename_list=t.data.uploaddocument})}var _=this;_.title="lawyerPaymentViewcontroller",p(),a.downloads=function(t,a){m.Downloaddocument(t,a)},a.cancel=function(){e.go("app.LglTrnInvoiceSummary")},a.updatestatus=function(){function t(t,a){t.ok=function(){a.close("closed")};var e={lawyerinvoicedtl_gid:localStorage.getItem("lawyerinvoicedtl_gid")};console.log(e),lockUI();var n="api/LawyerInvoice/getinvoicedetails";s.getparams(n,e).then(function(a){unlockUI(),t.service_type=a.data.servicetype_gid,t.caseref_no=a.data.caseref_gid,t.invoiceref_no=a.data.invoice_refno,t.case_type=a.data.case_type,t.invoice_amount=a.data.invoice_amount,t.invoice_date=a.data.invoice_date,t.servicerender_date=a.data.servicerender_date,t.invoice_remarks=a.data.invoice_remarks,console.log(a.data.invoice_refno)}),t.submit=function(){var e="api/LawyerInvoice/updateinvoicestatus";lockUI();var n={lawyerinvoicedtl_gid:localStorage.getItem("lawyerinvoicedtl_gid"),invoice_status:t.cbostatus};s.post(e,n).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),p()):d.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),p()}),a.close("closed")}}o.open({templateUrl:"/statusupdation.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("lawyerPaymentViewcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){var t="api/raiseLegalSR/legalSRAppovesummary";lockUI(),d.get(t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.RaiselegalSR_list})}var y=this;y.title="legalapprovalmgmt",h(),a.approve360=function(t,e,o){a.legalsr_gid=localStorage.setItem("legalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),a.approval_status=localStorage.setItem("approval_status",o),n.go("app.legalSRapprovemgmt360"),console.log(e)}}angular.module("angle").controller("legalapprovalmgmt",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){var t="api/raiseLegalSR/getlegalSRAppovemgmtSummary";lockUI(),d.get(t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.RaiselegalSR_list,console.log(t.data)})}var y=this;y.title="legalSLNmgmt",h(),a.raiseapprove=function(t,e,o){a.legalsr_gid=localStorage.setItem("legalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),a.auth_status=localStorage.setItem("auth_status",o),n.go("app.legalSR360")}}angular.module("angle").controller("legalSLNmgmt",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v){function D(){a.uploaddclickdiv=!0,a.mailclickdiv=!0,a.legalsr_gid=localStorage.getItem("legalsr_gid");var t={customer_gid:localStorage.getItem("customer_gid"),legalsr_gid:localStorage.getItem("legalsr_gid")},e="api/raiseLegalSR/Getcustomerdetails";d.getparams(e,t).then(function(t){a.customerdetails=t.data});var e="api/raiseLegalSR/GetDemandNoticedtl";d.getparams(e,t).then(function(t){a.demandnotice_list=t.data.demandnotice_list,a.demand_status=t.data.demand_status});var e="api/raiseLegalSR/getsamgdetails";d.getparams(e,t).then(function(t){a.customer_name=t.data.customer_name,a.constitution=t.data.constitution,a.financed_by=t.data.financed_by,a.deal_year=t.data.deal_year,a.address=t.data.address,a.business_activity=t.data.business_activity,a.email_id=t.data.email_id,a.primary_securities=t.data.primary_securities,a.collateral_securities=t.data.collateral_securities,a.details_UDC_PDC=t.data.details_UDC_PDC,a.unit_working_status=t.data.unit_working_status,a.other_banker_exposures=t.data.other_banker_exposures,a.cibil_data=t.data.cibil_data,a.restructuring_data=t.data.restructuring_data,a.status_current_overdue=t.data.status_current_overdue,a.other_group_companies=t.data.other_group_companies,a.meeting_details=t.data.meeting_details,a.cycles_sanctiondated=t.data.cycles_sanctiondated,a.limit_sanction=t.data.limit_sanction,a.churing_account=t.data.churing_account,a.created_date=t.data.created_date,a.statuslegal_action=t.data.statuslegal_action,a.instances_PTP=t.data.instances_PTP,a.demandnotice_details=t.data.demandnotice_details,a.other_banker_borrower=t.data.other_banker_borrower,a.auth_remarks_list=t.data.auth_remarks_list});var e="api/raiseLegalSR/getcustomerPromoter";d.getparams(e,t).then(function(t){a.customerPromotorlist=t.data.customerPromoter});var e="api/raiseLegalSR/getcustomerGuarantors";d.getparams(e,t).then(function(t){a.guarantors_list=t.data.customerGuarantors,a.remarks=t.data.remarks});var e="api/CustomerDashboard/Getcustomerloandetails";d.getparams(e,t).then(function(t){a.loandetails=t.data.loandtl});var n={raiselegalSR_gid:a.legalsr_gid},e="api/raiseLegalSR/Getcontactdtl";d.getparams(e,n).then(function(t){a.contactdetailsRM=t.data.contactdetailsRM});var e="api/CustomerDashboard/Getcustomerdocumentdetails";d.getparams(e,t).then(function(t){a.filename_list=t.data.filename_list});var e="api/CustomerDashboard/Getcustomermaildetails";d.getparams(e,t).then(function(t){a.composemail_list=t.data.composemail});var e="api/requestCompliance/lawyerList";d.get(e).then(function(t){a.assignlawyerlist=t.data.assignlawyer});var e="api/CustomerDashboard/GetLawyerPayment";d.get(e).then(function(t){a.invoicelist=t.data.invoicedtl});var o={legalSR_gid:localStorage.getItem("legalsr_gid")},e="api/raiseLegalSR/getlegalSRapprovals";d.getparams(e,o).then(function(t){a.approvals=t.data.approvallist});var e="api/CustomerDashboard/GetlawyerSRassign";d.getparams(e,o).then(function(t){a.assign_lawyername=t.data.assign_lawyername,a.assignlawyer=t.data.assign_lawyergid,a.assignedlawyer_by=t.data.assignedlawyer_by,a.assigned_date=t.data.assigned_date,a.SLN_remarks=t.data.SLN_remarks});var e="api/raiseLegalSR/getSLNdocument";d.getparams(e,o).then(function(t){a.seeklawyerdocument=t.data.uploadseek_list});var e="api/raiseLegalSR/getcollateralinfo";d.getparams(e,o).then(function(t){a.customerCollateral=t.data.customerCollateral});var e="api/raiseLegalSR/getrequesteddtl";d.getparams(e,o).then(function(t){a.requesteddetails=t.data})}var h=this;h.title="legalSR360controller",D(),a.uploadclick=function(){a.uploadddiv=!0,a.uploaddclickdiv=!1},a.cancelupload=function(){a.uploadddiv=!1,a.uploaddclickdiv=!0,$("#addupload").val("")},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=v.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("customer_gid",localStorage.getItem("customer_gid")),i.append("project_flag","Default"),a.uploadfrm=i},a.handleFile=function(){var t="api/CustomerDashboard/UploadDocument";d.postFile(t,a.uploadfrm).then(function(t){a.filename_list=t.data.filename_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported","danger"))})},a.downloads=function(t,a){var e=t,n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()},a.createmail=function(){function t(t,a){t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.sendcomposemail=function(){var e={to_mail:t.tomail,cc_mail:t.ccmail,bcc_mail:t.bccmail,subject_mail:t.mailsubject,content_mail:t.mailcontent,customer_gid:localStorage.getItem("customer_gid")},n="api/CustomerDashboard/sendcomposemail";lockUI(),d.post(n,e).then(function(t){1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),D()):(l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),unlockUI())})}}e.open({templateUrl:"/CustomerCreateMailContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]},a.viewMailContent=function(t){function a(t,a){t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")};var e="api/CustomerDashboard/Getcustomermail";d.getparams(e,n).then(function(a){t.frommail_view=a.data.from_mail,t.tomail_view=a.data.to_mail,t.ccmail_view=a.data.cc_mail,t.bccmail_view=a.data.bcc_mail,t.mailsubject_view=a.data.subject_mail,t.mailcontent_view=a.data.content_mail,t.created_by=a.data.created_by,t.created_date=a.data.created_date})}var n={composemail_gid:t};e.open({templateUrl:"/CustomerViewMailContent.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.legarSRapprove=function(){var t={legalsr_gid:localStorage.getItem("legalsr_gid"),approval_remarks:a.txtremarks},e="api/raiseLegalSR/legalSRApproval";lockUI(),d.post(e,t).then(function(t){1==t.data.status?(unlockUI(),l.alert(" Successfully..!!","success")):(unlockUI(),l.alert(t.data.message)),D()})},a.legalSRreject=function(){var t={legalsr_gid:a.legalsr_gid},e="api/raiseLegalSR/legalSRreject";lockUI(),d.post(e,t).then(function(t){1==t.data.status?(unlockUI(),l.alert("Legal SR Hold","success")):(unlockUI(),l.alert("Error Occured While Updating the Status","warning"))})},a.assignLawyerSubmit=function(){function t(t,a){t.lawyeruser_name=o,t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),r.append("project_flag","Default"),t.uploadfrm=r;var i="api/raiseLegalSR/SLNUpload";d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addSLNupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpSLN_documentgid:a},n="api/raiseLegalSR/SLNuploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){var e={legalSR_gid:localStorage.getItem("legalsr_gid"),lawyeruser_gid:n,SLN_remarks:t.SLNlawyerremarks};lockUI();var o="api/CustomerDashboard/assignSRLawyer";d.post(o,e).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),D(),unlockUI()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.cboassignlawyer,o=$("#assignlawyer :selected").text(),r=({legalSR_gid:localStorage.getItem("legalsr_gid"),lawyeruser_gid:a.cboassignlawyer},"api/raiseLegalSR/tmpSLNdocumentclear");d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]},a.cancelassignLawyer=function(){a.cboassignlawyer=""},a.back=function(){n.go("app.legalSLNmgmt")}}angular.module("angle").controller("legalSR360controller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){var t="api/raiseLegalSR/GetraiselegalSR";lockUI(),d.get(t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.RaiselegalSR_list})}var y=this;y.title="legalSRapproval",h(),a.raiseapprove=function(t,a,e){c.url("app/legalSRapproval360?lslegalsr_gid="+t+"&customer_gid="+a+"&lsauth_status="+e)}}angular.module("angle").controller("legalSRapproval",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f){function v(){var t=window.location.href;t.split("lstab=");a.uploaddclickdiv=!0;var e=c.search().lslegalsr_gid,n=c.search().lsauth_status,o=c.search().customer_gid;a.legalsr_gid=e,a.auth_status=n;var r={customer_gid:o,legalsr_gid:e},t="api/raiseLegalSR/Getcustomerdetails";d.getparams(t,r).then(function(t){a.customerdetails=t.data,a.remarks=t.data.remarks});var t="api/raiseLegalSR/GetDemandNoticedtl";d.getparams(t,r).then(function(t){a.demandnotice_list=t.data.demandnotice_list,a.demand_status=t.data.demand_status});var t="api/raiseLegalSR/getsamgdetails";d.getparams(t,r).then(function(t){a.customer_name=t.data.customer_name,a.constitution=t.data.constitution,a.financed_by=t.data.financed_by,a.deal_year=t.data.deal_year,a.address=t.data.address,a.business_activity=t.data.business_activity,a.email_id=t.data.email_id,a.primary_securities=t.data.primary_securities,a.collateral_securities=t.data.collateral_securities,a.details_UDC_PDC=t.data.details_UDC_PDC,a.unit_working_status=t.data.unit_working_status,a.other_banker_exposures=t.data.other_banker_exposures,a.cibil_data=t.data.cibil_data,a.restructuring_data=t.data.restructuring_data,a.status_current_overdue=t.data.status_current_overdue,a.other_group_companies=t.data.other_group_companies,a.meeting_details=t.data.meeting_details,a.cycles_sanctiondated=t.data.cycles_sanctiondated,a.limit_sanction=t.data.limit_sanction,a.churing_account=t.data.churing_account,a.created_date=t.data.created_date,a.statuslegal_action=t.data.statuslegal_action,a.instances_PTP=t.data.instances_PTP,a.demandnotice_details=t.data.demandnotice_details,a.other_banker_borrower=t.data.other_banker_borrower,a.auth_remarks_list=t.data.auth_remarks_list,a.created_date=t.data.created_date,a.created_by=t.data.created_by});var t="api/raiseLegalSR/getcustomerPromoter";d.getparams(t,r).then(function(t){a.customerPromotorlist=t.data.customerPromoter});var t="api/raiseLegalSR/getcustomerGuarantors";d.getparams(t,r).then(function(t){a.guarantors_list=t.data.customerGuarantors,a.remarks=t.data.remarks});var t="api/CustomerDashboard/Getcustomerloandetails";d.getparams(t,r).then(function(t){a.loandetails=t.data.loandtl});var t="api/CustomerDashboard/Getcustomerdocumentdetails";d.getparams(t,r).then(function(t){a.filename_list=t.data.filename_list});var t="api/CustomerDashboard/Getcustomermaildetails";d.getparams(t,r).then(function(t){a.composemail_list=t.data.composemail});var i={raiselegalSR_gid:a.legalsr_gid},t="api/raiseLegalSR/Getcontactdtl";d.getparams(t,i).then(function(t){a.contactdetailsRM=t.data.contactdetailsRM});var s={legalsr_gid:a.legalsr_gid},t="api/raiseLegalSR/getlegalSRapprovals";d.getparams(t,s).then(function(t){a.approvals=t.data.approvallist});var t="api/raiseLegalSR/getcollateralinfo";d.getparams(t,s).then(function(t){a.customerCollateral=t.data.customerCollateral});var t="api/raiseLegalSR/getrequesteddtl";d.getparams(t,s).then(function(t){a.requesteddetails=t.data})}var D=this;D.title="legalSRapproval360",v(),a.uploadclick=function(){a.uploadddiv=!0,a.uploaddclickdiv=!1},a.cancelupload=function(){a.uploadddiv=!1,a.uploaddclickdiv=!0,$("#addupload").val("")},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=f.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("customer_gid",localStorage.getItem("customer_gid")),i.append("project_flag","Default"),a.uploadfrm=i},a.handleFile=function(){var t="api/CustomerDashboard/UploadDocument";d.postFile(t,a.uploadfrm).then(function(t){a.filename_list=t.data.filename_list,$("#addupload").val(""),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},a.downloads=function(t,a){console.log(t);var e=t,n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()},a.createmail=function(){function t(t,a){t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.sendcomposemail=function(){var e={to_mail:t.tomail,cc_mail:t.ccmail,bcc_mail:t.bccmail,subject_mail:t.mailsubject,content_mail:t.mailcontent,customer_gid:localStorage.getItem("customer_gid")},n="api/CustomerDashboard/sendcomposemail";lockUI(),d.post(n,e).then(function(t){1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),v()):(l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),unlockUI())})}}e.open({templateUrl:"/CustomerCreateMailContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]},a.viewMailContent=function(t){function a(t,a){t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")};var e="api/CustomerDashboard/Getcustomermail";d.getparams(e,n).then(function(a){console.log(a),t.frommail_view=a.data.from_mail,t.tomail_view=a.data.to_mail,t.ccmail_view=a.data.cc_mail,t.bccmail_view=a.data.bcc_mail,t.mailsubject_view=a.data.subject_mail,t.mailcontent_view=a.data.content_mail,t.created_by=a.data.created_by,t.created_date=a.data.created_date})}var n={composemail_gid:t};e.open({templateUrl:"/CustomerViewMailContent.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.legarSRapprove=function(){var t={legalsr_gid:a.legalsr_gid,approval_remarks:a.txtremarks},e="api/raiseLegalSR/legalSRApproval";lockUI(),d.post(e,t).then(function(t){1==t.data.status?(unlockUI(),a.auth_status=localStorage.setItem("auth_status","Approved"),v(),l.alert("Legal SR Approved Successfully..!!","success"),n.go("app.legalSRapproval")):(unlockUI(),l.alert("You are Not Able to Approve because Approval Hiearchy Not Assigned","warning")),v()})},a.legalSRreject=function(){var t={legalsr_gid:a.legalsr_gid,approval_remarks:a.txtremarks},e="api/raiseLegalSR/legalSRreject";lockUI(),d.post(e,t).then(function(t){1==t.data.status?(unlockUI(),c.url("app/legalSRapproval?lstab=legalsr"),l.alert("Legal SR in Hold","success")):(unlockUI(),l.alert("Error Occured While Updating the Status","warning"))})},a.legalSRrejected=function(){var t={legalsr_gid:a.legalsr_gid,approval_remarks:a.txtremarks},e="api/raiseLegalSR/legalSRrejected";lockUI(),d.post(e,t).then(function(t){1==t.data.status?(unlockUI(),c.url("app/legalSRapproval?lstab=legalsr"),l.alert("Legal SR Rejected","success")):(unlockUI(),l.alert("Error occured while reject","warning"))})},a.back=function(){n.go("app.legalSRapproval")}}angular.module("angle").controller("legalSRapproval360",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f){function v(){a.uploaddclickdiv=!0,a.legalsr_gid=localStorage.getItem("legalsr_gid"),a.approval_status=localStorage.getItem("approval_status");var t={customer_gid:localStorage.getItem("customer_gid"),legalsr_gid:localStorage.getItem("legalsr_gid")};console.log(localStorage.getItem("customer_gid"));var e="api/raiseLegalSR/Getcustomerdetails";d.getparams(e,t).then(function(t){a.customerdetails=t.data});var e="api/raiseLegalSR/GetDemandNoticedtl";d.getparams(e,t).then(function(t){a.demandnotice_list=t.data.demandnotice_list,a.demand_status=t.data.demand_status});var e="api/raiseLegalSR/getsamgdetails";d.getparams(e,t).then(function(t){a.customer_name=t.data.customer_name,a.constitution=t.data.constitution,a.financed_by=t.data.financed_by,a.deal_year=t.data.deal_year,a.address=t.data.address,a.business_activity=t.data.business_activity,a.email_id=t.data.email_id,a.primary_securities=t.data.primary_securities,a.collateral_securities=t.data.collateral_securities,a.details_UDC_PDC=t.data.details_UDC_PDC,a.unit_working_status=t.data.unit_working_status,a.other_banker_exposures=t.data.other_banker_exposures,a.cibil_data=t.data.cibil_data,a.restructuring_data=t.data.restructuring_data,a.status_current_overdue=t.data.status_current_overdue,a.other_group_companies=t.data.other_group_companies,a.meeting_details=t.data.meeting_details,a.cycles_sanctiondated=t.data.cycles_sanctiondated,a.limit_sanction=t.data.limit_sanction,a.churing_account=t.data.churing_account,a.created_date=t.data.created_date,a.statuslegal_action=t.data.statuslegal_action,a.instances_PTP=t.data.instances_PTP,a.demandnotice_details=t.data.demandnotice_details,a.other_banker_borrower=t.data.other_banker_borrower,a.auth_remarks_list=t.data.auth_remarks_list,yy});var e="api/raiseLegalSR/getcustomerPromoter";d.getparams(e,t).then(function(t){a.customerPromotorlist=t.data.customerPromoter});var e="api/raiseLegalSR/getcustomerGuarantors";d.getparams(e,t).then(function(t){a.guarantors_list=t.data.customerGuarantors,a.remarks=t.data.remarks});var e="api/CustomerDashboard/Getcustomerloandetails";d.getparams(e,t).then(function(t){a.loandetails=t.data.loandtl});var e="api/CustomerDashboard/Getcustomerdocumentdetails";d.getparams(e,t).then(function(t){a.filename_list=t.data.filename_list});var e="api/CustomerDashboard/Getcustomermaildetails";d.getparams(e,t).then(function(t){a.composemail_list=t.data.composemail});var n={raiselegalSR_gid:a.legalsr_gid},e="api/raiseLegalSR/Getcontactdtl";d.getparams(e,n).then(function(t){a.contactdetailsRM=t.data.contactdetailsRM});var o={legalsr_gid:a.legalsr_gid},e="api/raiseLegalSR/getlegalSRapprovals";d.getparams(e,o).then(function(t){a.approvals=t.data.approvallist});var e="api/raiseLegalSR/getcollateralinfo";d.getparams(e,o).then(function(t){a.customerCollateral=t.data.customerCollateral});var e="api/raiseLegalSR/getrequesteddtl";d.getparams(e,o).then(function(t){a.requesteddetails=t.data})}var D=this;D.title="legalSRapprovemgmt360",v(),a.uploadclick=function(){a.uploadddiv=!0,a.uploaddclickdiv=!1},a.cancelupload=function(){a.uploadddiv=!1,a.uploaddclickdiv=!0,$("#addupload").val("")},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=f.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("customer_gid",localStorage.getItem("customer_gid")),i.append("project_flag","Default"),a.uploadfrm=i},a.handleFile=function(){var t="api/CustomerDashboard/UploadDocument";d.postFile(t,a.uploadfrm).then(function(t){a.filename_list=t.data.filename_list,$("#addupload").val(""),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},a.downloads=function(t,a){var e=t,n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()},a.createmail=function(){function t(t,a){t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.sendcomposemail=function(){var e={to_mail:t.tomail,cc_mail:t.ccmail,bcc_mail:t.bccmail,subject_mail:t.mailsubject,content_mail:t.mailcontent,customer_gid:localStorage.getItem("customer_gid")},n="api/CustomerDashboard/sendcomposemail";lockUI(),d.post(n,e).then(function(n){if(1==n.data.status){a.close("closed"),l.alert(n.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI();var o="api/CustomerDashboard/Getcustomermaildetails";d.getparams(o,e).then(function(a){t.composemail_list=a.data.composemail})}else l.alert(n.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),unlockUI()})}}e.open({templateUrl:"/CustomerCreateMailContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]},a.viewMailContent=function(t){function a(t,a){t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")};var e="api/CustomerDashboard/Getcustomermail";d.getparams(e,n).then(function(a){console.log(a),t.frommail_view=a.data.from_mail,t.tomail_view=a.data.to_mail,t.ccmail_view=a.data.cc_mail,t.bccmail_view=a.data.bcc_mail,t.mailsubject_view=a.data.subject_mail,t.mailcontent_view=a.data.content_mail,t.created_by=a.data.created_by,t.created_date=a.data.created_date})}var n={composemail_gid:t};e.open({templateUrl:"/CustomerViewMailContent.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.legarSRapprove=function(){var t={legalsr_gid:localStorage.getItem("legalsr_gid"),approval_remarks:a.txtremarks},e="api/raiseLegalSR/legalSRApprovalMgmt";lockUI(),d.post(e,t).then(function(t){1==t.data.status?(unlockUI(),a.approval_status=localStorage.setItem("approval_status","Approved"),v(),l.alert("Legal SR Approved Successfully..!!","success")):(unlockUI(),l.alert("Error Occured while approve","success")),v()})},a.legalSRreject=function(){var t={legalsr_gid:a.legalsr_gid,approval_remarks:a.txtremarks},e="api/raiseLegalSR/legalSRrejectMgmt";lockUI(),d.post(e,t).then(function(t){1==t.data.status?(unlockUI(),a.approval_status=localStorage.setItem("approval_status","Rejected"),v(),l.alert("Legal SR in  Hold","success")):(unlockUI(),l.alert("Error Occured While Updating the Status","warning"))})},a.back=function(){n.go("app.legalapprovalmgmt")}}angular.module("angle").controller("legalSRapprovemgmt360",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m){function p(){var t="api/lglDashboard/Getlegalsrreport";lockUI(),s.get(t).then(function(t){unlockUI(),a.legalSR_list=t.data.legalSR_list})}var _=this;_.title="legalsrreportcontroller",p(),a["export"]=function(){var t={srref_no:a.srref_no,raised_by:a.raised_by,raised_date:a.raised_date,raised_by_department:a.raised_by_department,customer_urn:a.customer_urn,customer_name:a.customer_name,auth_status:a.auth_status,auth_date:a.auth_date,auth_remarks:a.auth_remarks,approval_status:a.approval_status};lockUI();var e="api/lglDashboard/GetSRexport";s.post(e,t).then(function(t){console.log(t.data.status),1==t.data.status?(m.Downloaddocument(t.data.lspath,t.data.lsname),unlockUI()):(unlockUI(),d.alert("Error Occurred While Export !","warning"),p())})},a.all=function(){
a.customername="",a.month_date="",a.year_date="",p()},a.search=function(){var t={customername:a.customer,month_date:a.month_date,year_date:a.year_date},e="api/lglDashboard/GetLegalreportsummary";lockUI(),s.post(e,t).then(function(t){unlockUI(),a.legalSR_list=t.data.Legalreportsummary})}}angular.module("angle").controller("legalsrreportcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){var t="api/raiseLegalSR/GetSR";lockUI(),d.get(t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.RaiselegalSR_list,console.log(t.data)})}var y=this;y.title="legalSRsummarycontroller",h(),a.raisesr=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),console.log(t),n.go("app.raiseSR2authentication")},a.view=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",templegalsr_gid),a.customer_gid=localStorage.setItem("customer_gid",customer_gid),console.log(templegalsr_gid),n.go("app.viewlegalSR")},a.popuplegalSR=function(){n.go("app.raiselegalSR")},a.edit=function(){n.go("app.editLegalSR")}}angular.module("angle").controller("legalSRsummarycontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u){function m(){a.lawyerempanelment=!0,a.legalservices=!0,a.legalcompliance=!0,a.report=!0;var t=localStorage.getItem("user_gid"),e="api/user/privilegelevel3";s.get(e+"?user_gid="+t).then(function(t){var e=(t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLERLRN"),t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLERLFM"),t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLDCMREC")),n=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLDCMCOM"),o=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMDNP"),r=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMDNC"),i=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLRPTDTR"),s=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMSRP"),d=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMARM"),l=(t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMSLN"),t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMLTP"),t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLRPTTAT"),t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMDAE")),c=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMDNC"),u=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMFPO"),m=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMOTV"),p=t.data.privilegelevel3.map(function(t){return t.project}).indexOf("LGLLCMRET");e!=-1&&(a.requestcompliance_show="Y"),n!=-1&&(a.managecompliance_show="Y"),o!=-1&&(a.dntracker_show="Y"),r!=-1&&(a.dntrackercbo_show="Y"),i!=-1&&(a.dntrackerreport_show="Y"),s!=-1&&(a.legalsrauthentication_show="Y"),d!=-1&&(a.legalsrapproval_show="Y"),l!=-1&&(a.dntracker_ae="Y"),c!=-1&&(a.dntracker_fpoac="Y"),u!=-1&&(a.dntracker_fpo="Y"),m!=-1&&(a.dntracker_others="Y"),p!=-1&&(a.dntracker_retail="Y")}),a.requestcompliance=function(){a.welcome_msg="Request Compliance"},a.managecompliance=function(){a.welcome_msg="Manage Compliance"},a.dntracker=function(){a.welcome_msg="DN Tracker"},a.dntrackercbo=function(){a.welcome_msg="DN Tracker CBO"},a.dntrackerreport=function(){a.welcome_msg="DN Tracker Report"},a.legalsrauthentication=function(){a.welcome_msg="Legal SR Authentication"},a.legalsrapproval=function(){a.welcome_msg="Legal SR Approval"}}var p=this;p.title="lglDashboardcontroller",m()}angular.module("angle").controller("lglDashboardcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y){function b(){lockUI(),a.lawyer_summary=!0;var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],console.log(a.relpath1),a.lawyerdocumentdetails=!1,a.click=!0,a.seeklawyer=!1;var t="api/requestCompliance/compliancemanagement360",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid"),d.getparams(t,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.assign_lawyergid=t.data.assign_lawyergid,a.assign_lawyername=t.data.assign_lawyername,a.assign_mobileno=t.data.assign_mobileno,a.assign_emailaddress=t.data.assign_emailaddress,a.assignedlawyer_by=t.data.assigned_by,a.seeklawyer_remarks=t.data.seeklawyer_remarks,a.assigned_date=t.data.assigned_date,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by,a.designation_name=t.data.designation_name,a.department_name=t.data.department_name,a.branch_name=t.data.branch_name,a.employee_photo=t.data.employee_photo,a.txtremarks=t.data.remarks,a.list=t.data.document_list,a.seeklawyerdocument=t.data.uploadseek_list,"---"!=t.data.correctedfile_name&&(a.updated_download=!0),console.log(t.data.requestref_no)});var t="api/requestCompliance/querieslist";d.getparams(t,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()});var t="api/requestCompliance/lawyerList";d.getparams(t,n).then(function(t){a.assignlawyerlist=t.data.assignlawyer});var t="api/requestCompliance/getcorrecteddocument";d.getparams(t,n).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,unlockUI()});var t="api/requestCompliance/Gettaggedlist";d.getparams(t,n).then(function(t){a.taggedlist=t.data.taggedinfo_list,a.taggeddoc_list=t.data.taggeddoc_list,console.log(t.data.taggedlawyerdoc_list),a.taggedlawyerdoc_list=t.data.taggedlawyerdoc_list});var t="api/requestCompliance/LawyerSummary";d.getparams(t,n).then(function(t){a.conlawyer_list=t.data.MdlLawyerSummary});var t="api/requestCompliance/LawyerGroupDtls";d.getparams(t,n).then(function(t){a.grouplastconversation=t.data.lastconversation,a.groupnewmsg_count=t.data.newmsg_count,a.lawyer_count=t.data.lawyer_count,a.group_member=t.data.group_member,a.totalmsg_count=t.data.totalmsg_count});var t="api/requestCompliance/tempdelete";d.get(t).then(function(t){})}var k=this;k.title="Compliance2taglawyercontroller",b(),a.viewdocument=function(t,e){var n={requestcompliance2lawyerdtl_gid:t},o="api/requestCompliance/Viewuploaddoc_lawyer";d.getparams(o,n).then(function(n){console.log(n.data.taggeddoc_list),a.taggedlist[e][t]=n.data.taggeddoc_list})},a.viewlawyerdocument=function(t,e){var n={requestcompliance2lawyerdtl_gid:t},o="api/requestCompliance/GetuploadbyLawyer";d.getparams(o,n).then(function(n){console.log(n.data.taggeddoc_list),a.taggedlist[e][t]=n.data.taggeddoc_list})},a.downloads=function(t,a){h.Downloaddocument(t,a)},a.downloadscorrected=function(t,a){h.Downloaddocument(t,a)},a.updateddoc_downloads=function(t,a){h.Downloaddocument(t,a)},a.assignLawyerSubmit=function(){function t(t,a){t.lawyeruser_name=o,t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),r.append("project_flag","Default"),t.uploadfrm=r;var i="api/requestCompliance/seekLawyerUpload";d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpseek_documentgid:a},n="api/requestCompliance/seekLawyerUploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){lockUI();var a={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),lawyeruser_gid:n,seeklawyerremarks:t.seeklawyerremarks},e="api/requestCompliance/assignLawyer";d.post(e,a).then(function(a){unlockUI(),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(a.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),t.ok(),b()})}}var n=a.cboassignlawyer,o=$("#assignlawyer :selected").text(),r=({requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),lawyeruser_gid:a.cboassignlawyer},"api/requestCompliance/tmpseekdocumentclear");d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]},a.requestback=function(t){c.url("app/complianceManagement?lstab="+t)},a.delete_correcteddoc=function(t){var e={uploaddocument_gid:t},n="api/requestCompliance/correcteddoc_delete";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.upload_document=function(t,a,o){function r(t,a){t.ok=function(){a.close("closed")},t.uploaddoc=function(a,e,n){var r={name:a[0].name,file:a[0],uploaddocument_gid:o},i=new FormData;i.append("fileupload",r.file),i.append("file_name",r.name),i.append("uploaddocument_gid",o),i.append("remarks",t.remarks),i.append("project_flag","Default"),t.uploadfrm=i},t.documentupload=function(){var e={uploadeddocument_type:t.document_type,uploadremarks:t.txtcorrected_remarks,uploaddocument_gid:o};console.log(e);var r="api/requestCompliance/uploadCorrectedDoc";lockUI(),d.postFile(r,t.uploadfrm).then(function(a){t.upload_list=a.data.upload_list,$("#addupload").val(""),1==a.data.status?(unlockUI(),l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported!")),b()});var r="api/requestCompliance/uploadremarrks";lockUI(),d.post(r,e).then(function(t){1==t.data.status?(unlockUI(),b(),n.go("app.requestCompliance360"),a.close("closed"),b()):unlockUI(),b()})}}e.open({templateUrl:"/uploadcorrecteddocument.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},a.sendclick=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),queries:a.txtqueries};console.log(t),lockUI();var e="api/requestCompliance/sendqueries";d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e="api/requestCompliance/querieslist",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(e,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()}),l.alert("Query sent Successfully","success"),a.txtqueries=""}else l.alert("Error Occurred","warning")})},a.cancelclick=function(){a.txtqueries=""},a.cancelassignLawyer=function(){a.cboassignlawyer="",a.seeklawyer=!1},a.lawyerdocument_details=function(){a.lawyer_document=!0,a.lawyerdoc=!0,a.click=!1},a.minimizedoc=function(){a.lawyer_document=!1,a.lawyerdoc=!1,a.click=!0},a.seeklawyeropinion=function(){a.seeklawyer=!0},a.updatestatus=function(t){function a(a,e){a.ok=function(){e.close("closed")};var n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};lockUI();var o="api/requestCompliance/compliancemanagement360";d.getparams(o,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by}),a.submit=function(){if("Rejected"==a.cbostatus)if(""==a.txtrejected_remarks||void 0==a.txtrejected_remarks)a.mandatoryfields=!0;else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}else if("Completed"==a.cbostatus)if(""==a.txtcompleted_remarks||void 0==a.txtcompleted_remarks)a.mandatoryfields=!0;else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,completed_remarks:a.txtcompleted_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}}}e.open({templateUrl:"/statusupdation.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=y.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("requestcompliance_gid",a.requestcompliance_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/UploadComplianceCorrected_doc";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.UploadDocumentList=t.data.Managecomplianuploaddoc_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,l.alert(t.data.message,"success")):(unlockUI(),l.alert(t.data.message))})},a.deletedocument=function(t){var e={document_gid:t};console.log(e);var n="api/requestCompliance/deletecorrecteddo_upload";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.UploadDocumentList,function(e,n){e.document_gid==t&&a.UploadDocumentList.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.correcteddoc_submit=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},e="api/requestCompliance/submitComplianceCorrected_doc";lockUI(),d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/getcorrecteddocument";d.getparams(n,e).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,a.UploadDocumentList=t.data.uploaddoc_list,unlockUI()}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),b()}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.downloadsdocument=function(t,a){h.Downloaddocument(t,a)},a.ShowConversation=function(t,e,n,o){a.lawyer_summary=!1,a.requestcompliance2lawyerdtl_gid=t,a.name_initial=e,a.newmsg_count=n,a.lawyeruser_name=o;var r={requestcompliance2lawyerdtl_gid:t,requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},i="api/requestCompliance/GetLawyerConversation";d.post(i,r).then(function(t){1==t.data.status?a.conversationList=t.data.MdlConversationSummary:a.conversationList=null})},a.CloseConversation=function(){a.lawyer_summary=!0;var t={requestcompliance_gid:a.requestcompliance_gid,requestcompliance2lawyerdtl_gid:a.requestcompliance2lawyerdtl_gid,user_flag:"Lawyer"};console.log(t);var e="api/requestCompliance/MsgViewed";d.post(e,t).then(function(t){})},a.LawyerConversation=function(){var t={requestcompliance2lawyerdtl_gid:a.requestcompliance2lawyerdtl_gid,requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),msgconversation:a.message_content,user_flag:"Admin"};console.log(t),lockUI();var e="api/requestCompliance/LawyerGroupConversation";d.post(e,t).then(function(t){if(1==t.data.status){a.message_content="",a.lawyer_summary=!0,l.alert(t.data.message,"success");var e={requestcompliance2lawyerdtl_gid:a.requestcompliance2lawyerdtl_gid,requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/GetLawyerConversation";d.post(n,e).then(function(t){1==t.data.status&&(a.conversationList=t.data.MdlConversationSummary)});var e={requestcompliance_gid:a.requestcompliance_gid,requestcompliance2lawyerdtl_gid:a.requestcompliance2lawyerdtl_gid,user_flag:"Lawyer"},n="api/requestCompliance/MsgViewed";d.post(n,e).then(function(t){})}else l.alert(t.data.message,"warning");b(),unlockUI()})},a.LawyerindividualConversation=function(){var t={requestcompliance2lawyerdtl_gid:a.requestcompliance2lawyerdtl_gid,requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),msgconversation:a.message_content,user_flag:"Admin"};console.log(t),lockUI();var e="api/requestCompliance/LawyerConversation";d.post(e,t).then(function(t){if(1==t.data.status){a.message_content="",a.lawyer_summary=!0,l.alert(t.data.message,"success");var e={requestcompliance2lawyerdtl_gid:a.requestcompliance2lawyerdtl_gid,requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/GetLawyerConversation";d.post(n,e).then(function(t){1==t.data.status&&(a.conversationList=t.data.MdlConversationSummary)});var e={requestcompliance_gid:a.requestcompliance_gid,requestcompliance2lawyerdtl_gid:a.requestcompliance2lawyerdtl_gid,user_flag:"Lawyer"},n="api/requestCompliance/MsgViewed";d.post(n,e).then(function(t){})}else l.alert(t.data.message,"warning");b(),unlockUI()})}}angular.module("angle").controller("Compliance2taglawyercontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y){function b(){lockUI();var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],console.log(a.relpath1),a.lawyerdocumentdetails=!1,a.click=!0,a.seeklawyer=!1;var t="api/requestCompliance/compliancemanagement360",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(t,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.assign_lawyergid=t.data.assign_lawyergid,a.assign_lawyername=t.data.assign_lawyername,a.assign_mobileno=t.data.assign_mobileno,a.assign_emailaddress=t.data.assign_emailaddress,a.assignedlawyer_by=t.data.assigned_by,a.seeklawyer_remarks=t.data.seeklawyer_remarks,a.assigned_date=t.data.assigned_date,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by,a.designation_name=t.data.designation_name,a.department_name=t.data.department_name,a.branch_name=t.data.branch_name,a.employee_photo=t.data.employee_photo,a.txtremarks=t.data.remarks,a.list=t.data.document_list,a.seeklawyerdocument=t.data.uploadseek_list,a.rejected_remarks=t.data.rejected_remarks,a.completed_remarks=t.data.completed_remarks,a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,"---"!=t.data.correctedfile_name&&(a.updated_download=!0),console.log(t.data.requestref_no)});var t="api/requestCompliance/querieslist";d.getparams(t,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()});var t="api/requestCompliance/lawyerList";d.getparams(t,n).then(function(t){a.lawyer_list=t.data.taggedlawyerList,a.lawfirm_list=t.data.taggedlawfirmList});var t="api/requestCompliance/getcorrecteddocument";d.getparams(t,n).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,unlockUI()})}var k=this;k.title="LglTrnComplianceCompleted",b(),a.downloads=function(t,a){h.Downloaddocument(t,a)},a.downloadscorrected=function(t,a){h.Downloaddocument(t,a)},a.updateddoc_downloads=function(t,a){h.Downloaddocument(t,a)},a.assignLawyerSubmit=function(){function t(t,a){var e=n,r=o;console.log("popup",e),t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),r.append("project_flag","Default"),t.uploadfrm=r;var i="api/requestCompliance/seekLawyerUpload";d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpseek_documentgid:a},n="api/requestCompliance/seekLawyerUploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){lockUI();var a={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),taggedlawyerList:e,taggedlawfirmList:r,seeklawyerremarks:t.seeklawyerremarks};console.log(a);var n="api/requestCompliance/assignLawyer";d.post(n,a).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+relpath1)):l.alert(a.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),t.ok(),b()})}}if(""==a.cboassignlawyer||void 0==a.cboassignlawyer)""!=a.cboassignlawfirm&&void 0!=a.cboassignlawfirm||l.alert("Select Atleast One Lawyer / Lawfirm",{status:"info",pos:"top-center",timeout:3e3});else{if(console.log("else"),console.log(a.$parent.cboassignlawyer),""!=a.$parent.cboassignlawyer||void 0!=a.$parent.cboassignlawyer)var n=a.$parent.cboassignlawyer;if(""!=a.$parent.cboassignlawfirm||void 0!=a.$parent.cboassignlawfirm)var o=a.$parent.cboassignlawfirm;var r="api/requestCompliance/tmpseekdocumentclear";d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]}},a.requestback=function(t){c.url("app/complianceManagement?lstab="+t)},a.delete_correcteddoc=function(t){var e={uploaddocument_gid:t},n="api/requestCompliance/correcteddoc_delete";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.upload_document=function(t,a,o){function r(t,a){t.ok=function(){a.close("closed")},t.uploaddoc=function(a,e,n){var r={name:a[0].name,file:a[0],uploaddocument_gid:o},i=new FormData;i.append("fileupload",r.file),i.append("file_name",r.name),i.append("uploaddocument_gid",o),i.append("remarks",t.remarks),i.append("project_flag","Default"),t.uploadfrm=i},t.documentupload=function(){var e={uploadeddocument_type:t.document_type,uploadremarks:t.txtcorrected_remarks,uploaddocument_gid:o};console.log(e);var r="api/requestCompliance/uploadCorrectedDoc";lockUI(),d.postFile(r,t.uploadfrm).then(function(a){t.upload_list=a.data.upload_list,$("#addupload").val(""),1==a.data.status?(unlockUI(),l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported!")),b()});var r="api/requestCompliance/uploadremarrks";lockUI(),d.post(r,e).then(function(t){1==t.data.status?(unlockUI(),b(),n.go("app.requestCompliance360"),a.close("closed"),b()):unlockUI(),b()})}}e.open({templateUrl:"/uploadcorrecteddocument.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},a.sendclick=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),queries:a.txtqueries};lockUI();var e="api/requestCompliance/sendqueries";d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e="api/requestCompliance/querieslist",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(e,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()}),l.alert("Query sent Successfully","success"),a.txtqueries=""}else l.alert("Error Occurred","warning")})},a.cancelclick=function(){a.txtqueries=""},a.cancelassignLawyer=function(){a.cboassignlawyer="",a.seeklawyer=!1},a.lawyerdocument_details=function(){a.lawyer_document=!0,a.lawyerdoc=!0,a.click=!1},a.minimizedoc=function(){a.lawyer_document=!1,a.lawyerdoc=!1,a.click=!0},a.seeklawyeropinion=function(){a.seeklawyer=!0},a.updatestatus=function(t){function a(a,e){a.mandatoryfields=!1,a.ok=function(){e.close("closed")};var n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};lockUI();var o="api/requestCompliance/compliancemanagement360";d.getparams(o,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by}),a.submit=function(){if(console.log(a.txtrejected_remarks),"Rejected"==a.cbostatus)if(""==a.txtrejected_remarks||void 0==a.txtrejected_remarks)a.mandatoryfields=!0;else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}}}e.open({templateUrl:"/statusupdation.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=y.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("requestcompliance_gid",a.requestcompliance_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/UploadComplianceCorrected_doc";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.UploadDocumentList=t.data.Managecomplianuploaddoc_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,l.alert(t.data.message,"success")):(unlockUI(),l.alert(t.data.message))})},a.deletedocument=function(t){var e={document_gid:t};console.log(e);var n="api/requestCompliance/deletecorrecteddo_upload";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.UploadDocumentList,function(e,n){e.document_gid==t&&a.UploadDocumentList.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.correcteddoc_submit=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},e="api/requestCompliance/submitComplianceCorrected_doc";lockUI(),d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/getcorrecteddocument";d.getparams(n,e).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,a.UploadDocumentList=t.data.uploaddoc_list,unlockUI()}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),b()}else l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},a.downloadsdocument=function(t,a){h.Downloaddocument(t,a)}}angular.module("angle").controller("LglTrnComplianceCompleted",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y){function b(){lockUI();var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],console.log(a.relpath1),a.lawyerdocumentdetails=!1,a.click=!0,a.seeklawyer=!1;var t="api/requestCompliance/compliancemanagement360",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(t,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.assign_lawyergid=t.data.assign_lawyergid,a.assign_lawyername=t.data.assign_lawyername,a.assign_mobileno=t.data.assign_mobileno,a.assign_emailaddress=t.data.assign_emailaddress,a.assignedlawyer_by=t.data.assigned_by,a.seeklawyer_remarks=t.data.seeklawyer_remarks,a.assigned_date=t.data.assigned_date,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by,a.designation_name=t.data.designation_name,a.department_name=t.data.department_name,a.branch_name=t.data.branch_name,a.employee_photo=t.data.employee_photo,a.txtremarks=t.data.remarks,a.list=t.data.document_list,a.seeklawyerdocument=t.data.uploadseek_list,a.rejected_remarks=t.data.rejected_remarks,"---"!=t.data.correctedfile_name&&(a.updated_download=!0),console.log(t.data.requestref_no)});var t="api/requestCompliance/querieslist";d.getparams(t,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()});var t="api/requestCompliance/lawyerList";d.getparams(t,n).then(function(t){a.lawyer_list=t.data.taggedlawyerList,a.lawfirm_list=t.data.taggedlawfirmList});var t="api/requestCompliance/getcorrecteddocument";d.getparams(t,n).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,unlockUI()})}var k=this;k.title="LglTrnCompliancePendingcontroller",b(),a.downloads=function(t,a){h.Downloaddocument(t,a)},a.downloadscorrected=function(t,a){h.Downloaddocument(t,a)},a.updateddoc_downloads=function(t,a){h.Downloaddocument(t,a)},a.assignLawyerSubmit=function(){function t(t,a){var e=n,r=o;console.log("popup",e),t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),r.append("project_flag","Default"),t.uploadfrm=r;var i="api/requestCompliance/seekLawyerUpload";
d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpseek_documentgid:a},n="api/requestCompliance/seekLawyerUploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){lockUI();var a={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),taggedlawyerList:e,taggedlawfirmList:r,seeklawyerremarks:t.seeklawyerremarks};console.log(a);var n="api/requestCompliance/assignLawyer";d.post(n,a).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+relpath1)):l.alert(a.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),t.ok(),b()})}}if(""==a.cboassignlawyer||void 0==a.cboassignlawyer)""!=a.cboassignlawfirm&&void 0!=a.cboassignlawfirm||l.alert("Select Atleast One Lawyer / Lawfirm",{status:"info",pos:"top-center",timeout:3e3});else{if(console.log("else"),console.log(a.$parent.cboassignlawyer),""!=a.$parent.cboassignlawyer||void 0!=a.$parent.cboassignlawyer)var n=a.$parent.cboassignlawyer;if(""!=a.$parent.cboassignlawfirm||void 0!=a.$parent.cboassignlawfirm)var o=a.$parent.cboassignlawfirm;var r="api/requestCompliance/tmpseekdocumentclear";d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]}},a.requestback=function(t){c.url("app/complianceManagement?lstab="+t)},a.delete_correcteddoc=function(t){var e={uploaddocument_gid:t},n="api/requestCompliance/correcteddoc_delete";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.upload_document=function(t,a,o){function r(t,a){t.ok=function(){a.close("closed")},t.uploaddoc=function(a,e,n){var r={name:a[0].name,file:a[0],uploaddocument_gid:o},i=new FormData;i.append("fileupload",r.file),i.append("file_name",r.name),i.append("uploaddocument_gid",o),i.append("remarks",t.remarks),i.append("project_flag","Default"),t.uploadfrm=i},t.documentupload=function(){var e={uploadeddocument_type:t.document_type,uploadremarks:t.txtcorrected_remarks,uploaddocument_gid:o};console.log(e);var r="api/requestCompliance/uploadCorrectedDoc";lockUI(),d.postFile(r,t.uploadfrm).then(function(a){t.upload_list=a.data.upload_list,$("#addupload").val(""),1==a.data.status?(unlockUI(),l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported!")),b()});var r="api/requestCompliance/uploadremarrks";lockUI(),d.post(r,e).then(function(t){1==t.data.status?(unlockUI(),b(),n.go("app.requestCompliance360"),a.close("closed"),b()):unlockUI(),b()})}}e.open({templateUrl:"/uploadcorrecteddocument.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},a.sendclick=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),queries:a.txtqueries};lockUI();var e="api/requestCompliance/sendqueries";d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e="api/requestCompliance/querieslist",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(e,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()}),l.alert("Query sent Successfully","success"),a.txtqueries=""}else l.alert("Error Occurred","warning")})},a.cancelclick=function(){a.txtqueries=""},a.cancelassignLawyer=function(){a.cboassignlawyer="",a.seeklawyer=!1},a.lawyerdocument_details=function(){a.lawyer_document=!0,a.lawyerdoc=!0,a.click=!1},a.minimizedoc=function(){a.lawyer_document=!1,a.lawyerdoc=!1,a.click=!0},a.seeklawyeropinion=function(){a.seeklawyer=!0},a.updatestatus=function(t){function a(a,e){a.mandatoryfields=!1,a.ok=function(){e.close("closed")};var n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};lockUI();var o="api/requestCompliance/compliancemanagement360";d.getparams(o,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by}),a.submit=function(){if(console.log(a.txtrejected_remarks),"Rejected"==a.cbostatus)if(""==a.txtrejected_remarks||void 0==a.txtrejected_remarks)a.mandatoryfields=!0;else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}}}e.open({templateUrl:"/statusupdation.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=y.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("requestcompliance_gid",a.requestcompliance_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/UploadComplianceCorrected_doc";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.UploadDocumentList=t.data.Managecomplianuploaddoc_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,l.alert(t.data.message,"success")):(unlockUI(),l.alert(t.data.message))})},a.deletedocument=function(t){var e={document_gid:t};console.log(e);var n="api/requestCompliance/deletecorrecteddo_upload";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.UploadDocumentList,function(e,n){e.document_gid==t&&a.UploadDocumentList.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.correcteddoc_submit=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},e="api/requestCompliance/submitComplianceCorrected_doc";lockUI(),d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/getcorrecteddocument";d.getparams(n,e).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,a.UploadDocumentList=t.data.uploaddoc_list,unlockUI()}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),b()}else l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},a.downloadsdocument=function(t,a){var e=t;console.log(t),console.log(a);var n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()}}angular.module("angle").controller("LglTrnCompliancePendingcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService","cmnfunctionService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y){function b(){lockUI();var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],console.log(a.relpath1),a.lawyerdocumentdetails=!1,a.click=!0,a.seeklawyer=!1;var t="api/requestCompliance/compliancemanagement360",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(t,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.assign_lawyergid=t.data.assign_lawyergid,a.assign_lawyername=t.data.assign_lawyername,a.assign_mobileno=t.data.assign_mobileno,a.assign_emailaddress=t.data.assign_emailaddress,a.assignedlawyer_by=t.data.assigned_by,a.seeklawyer_remarks=t.data.seeklawyer_remarks,a.assigned_date=t.data.assigned_date,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by,a.designation_name=t.data.designation_name,a.department_name=t.data.department_name,a.branch_name=t.data.branch_name,a.employee_photo=t.data.employee_photo,a.txtremarks=t.data.remarks,a.list=t.data.document_list,a.seeklawyerdocument=t.data.uploadseek_list,a.rejected_remarks=t.data.rejected_remarks,a.completed_remarks=t.data.completed_remarks,a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,"---"!=t.data.correctedfile_name&&(a.updated_download=!0),console.log(t.data.requestref_no)});var t="api/requestCompliance/querieslist";d.getparams(t,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()});var t="api/requestCompliance/lawyerList";d.getparams(t,n).then(function(t){a.lawyer_list=t.data.taggedlawyerList,a.lawfirm_list=t.data.taggedlawfirmList});var t="api/requestCompliance/getcorrecteddocument";d.getparams(t,n).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,unlockUI()})}var k=this;k.title="LglTrnComplianceRejected",b(),a.downloads=function(t,a){h.Downloaddocument(t,a)},a.downloadscorrected=function(t,a){h.Downloaddocument(t,a)},a.updateddoc_downloads=function(t,a){h.Downloaddocument(t,a)},a.assignLawyerSubmit=function(){function t(t,a){var e=n,r=o;console.log("popup",e),t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),t.uploadfrm=r;var i="api/requestCompliance/seekLawyerUpload";d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpseek_documentgid:a},n="api/requestCompliance/seekLawyerUploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){lockUI();var a={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),taggedlawyerList:e,taggedlawfirmList:r,seeklawyerremarks:t.seeklawyerremarks};console.log(a);var n="api/requestCompliance/assignLawyer";d.post(n,a).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+relpath1)):l.alert(a.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),t.ok(),b()})}}if(""==a.cboassignlawyer||void 0==a.cboassignlawyer)""!=a.cboassignlawfirm&&void 0!=a.cboassignlawfirm||l.alert("Select Atleast One Lawyer / Lawfirm",{status:"info",pos:"top-center",timeout:3e3});else{if(console.log("else"),console.log(a.$parent.cboassignlawyer),""!=a.$parent.cboassignlawyer||void 0!=a.$parent.cboassignlawyer)var n=a.$parent.cboassignlawyer;if(""!=a.$parent.cboassignlawfirm||void 0!=a.$parent.cboassignlawfirm)var o=a.$parent.cboassignlawfirm;var r="api/requestCompliance/tmpseekdocumentclear";d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]}},a.requestback=function(t){c.url("app/complianceManagement?lstab="+t)},a.delete_correcteddoc=function(t){var e={uploaddocument_gid:t},n="api/requestCompliance/correcteddoc_delete";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.upload_document=function(t,a,o){function r(t,a){t.ok=function(){a.close("closed")},t.uploaddoc=function(a,e,n){var r={name:a[0].name,file:a[0],uploaddocument_gid:o},i=new FormData;i.append("fileupload",r.file),i.append("file_name",r.name),i.append("uploaddocument_gid",o),i.append("remarks",t.remarks),i.append("project_flag","Default"),t.uploadfrm=i},t.documentupload=function(){var e={uploadeddocument_type:t.document_type,uploadremarks:t.txtcorrected_remarks,uploaddocument_gid:o};console.log(e);var r="api/requestCompliance/uploadCorrectedDoc";lockUI(),d.postFile(r,t.uploadfrm).then(function(a){t.upload_list=a.data.upload_list,$("#addupload").val(""),1==a.data.status?(unlockUI(),l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported!")),b()});var r="api/requestCompliance/uploadremarrks";lockUI(),d.post(r,e).then(function(t){1==t.data.status?(unlockUI(),b(),n.go("app.requestCompliance360"),a.close("closed"),b()):unlockUI(),b()})}}e.open({templateUrl:"/uploadcorrecteddocument.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},a.sendclick=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),queries:a.txtqueries};lockUI();var e="api/requestCompliance/sendqueries";d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e="api/requestCompliance/querieslist",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(e,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()}),l.alert("Query sent Successfully","success"),a.txtqueries=""}else l.alert("Error Occurred","warning")})},a.cancelclick=function(){a.txtqueries=""},a.cancelassignLawyer=function(){a.cboassignlawyer="",a.seeklawyer=!1},a.lawyerdocument_details=function(){a.lawyer_document=!0,a.lawyerdoc=!0,a.click=!1},a.minimizedoc=function(){a.lawyer_document=!1,a.lawyerdoc=!1,a.click=!0},a.seeklawyeropinion=function(){a.seeklawyer=!0},a.updatestatus=function(t){function a(a,e){a.mandatoryfields=!1,a.ok=function(){e.close("closed")};var n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};lockUI();var o="api/requestCompliance/compliancemanagement360";d.getparams(o,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by}),a.submit=function(){if(console.log(a.txtrejected_remarks),"Rejected"==a.cbostatus)if(""==a.txtrejected_remarks||void 0==a.txtrejected_remarks)a.mandatoryfields=!0;else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}}}e.open({templateUrl:"/statusupdation.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=y.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("requestcompliance_gid",a.requestcompliance_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/UploadComplianceCorrected_doc";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.UploadDocumentList=t.data.Managecomplianuploaddoc_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,l.alert(t.data.message,"success")):(unlockUI(),l.alert(t.data.message))})},a.deletedocument=function(t){var e={document_gid:t};console.log(e);var n="api/requestCompliance/deletecorrecteddo_upload";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.UploadDocumentList,function(e,n){e.document_gid==t&&a.UploadDocumentList.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.correcteddoc_submit=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},e="api/requestCompliance/submitComplianceCorrected_doc";lockUI(),d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/getcorrecteddocument";d.getparams(n,e).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,a.UploadDocumentList=t.data.uploaddoc_list,unlockUI()}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),b()}else l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},a.downloadsdocument=function(t,a){h.Downloaddocument(t,a)}}angular.module("angle").controller("LglTrnComplianceRejected",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e={urn:a.urn},t="api/MstRepayment/GetRepayment";d.getparams(t,e).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var t="api/MstTelecall/GetTelecall";d.getparams(t,e).then(function(t){a.telecall_list=t.data.telecall_list});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.history=!1,a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.document_path=t.data.document_path,a.document_name=t.data.document_name,a.tempdn1format_gid=t.data.tempdn1format_gid,console.log(t.data.tempdn1format_gid),a.dn_status=t.data.dn_status,"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.history=!0),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks});var t="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var e={urn:a.urn},t="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(t,e).then(function(t){console.log("allocation history",t),a.allocationHistoryList=t.data.overallhistoryallocationdtl,console.log(t.data.overallhistoryallocationdtl),a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var o={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},t="api/allocationManagement/getallocatedtls";d.getparams(t,o).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var t="api/visitReport/GetAllocationLogDetail";d.getparams(t,o).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var t="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(t,o).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var t="api/customerManagement/HistoryEscrowSummary";d.getparams(t,o).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var t="api/allocationManagement/getAllocationdocument";d.getparams(t,o).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var t="api/visitReport/getvisitreportdtl";d.getparams(t,o).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,
a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var t="api/visitReport/getvisitReportDocument";d.getparams(t,o).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var t="api/visitReport/getvisitReportPhoto";d.getparams(t,o).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var t="api/TierMeeting/GetViewTierObservationdtl";d.getparams(t,o).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var r={tier1format_gid:localStorage.getItem("tier1format_gid")},t="api/TierMeeting/GetTier1Format360Dtl";d.getparams(t,r).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var t="api/TierMeeting/GetTier2Report360Dtl";d.getparams(t,o).then(function(t){console.log(t),a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var t="api/TierMeeting/GetTier3Report360Dtl";d.getparams(t,o).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="dngeneratedcontroller",k(),a.trustAsHtml=function(t){return y.trustAsHtml(t)},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,unlockUI()}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewcustomerdtl=function(t,e){c.hash("down"),h(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};console.log(e),d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI(),console.log("dn2");var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){b.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;b.Downloaddocument(a,"Report - DN1.pdf"),unlockUI(),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn2pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;b.Downloaddocument(a,"Report - DN2.pdf"),unlockUI(),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn3pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;b.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dngeneratedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","$sce","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.history=!1,a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.document_path=t.data.document_path,a.document_name=t.data.document_name,a.dn_status=t.data.dn_status,"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.history=!0),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var e={urn:a.urn},t="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(t,e).then(function(t){console.log("allocation history",t),a.allocationHistoryList=t.data.overallhistoryallocationdtl,console.log(t.data.overallhistoryallocationdtl),a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var o={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},t="api/allocationManagement/getallocatedtls";d.getparams(t,o).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var t="api/visitReport/GetAllocationLogDetail";d.getparams(t,o).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var t="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(t,o).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var t="api/customerManagement/HistoryEscrowSummary";d.getparams(t,o).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var t="api/allocationManagement/getAllocationdocument";d.getparams(t,o).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var t="api/visitReport/getvisitreportdtl";d.getparams(t,o).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var t="api/visitReport/getvisitReportDocument";d.getparams(t,o).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var t="api/visitReport/getvisitReportPhoto";d.getparams(t,o).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var t="api/TierMeeting/GetViewTierObservationdtl";d.getparams(t,o).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var r={tier1format_gid:localStorage.getItem("tier1format_gid")},t="api/TierMeeting/GetTier1Format360Dtl";d.getparams(t,r).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var t="api/TierMeeting/GetTier2Report360Dtl";d.getparams(t,o).then(function(t){console.log(t),a.tier2zonal_name=t.data.zonal_name,
a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var t="api/TierMeeting/GetTier3Report360Dtl";d.getparams(t,o).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()})}function b(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var k=this;k.title="dnCBOGeneratetabontroller",y(),a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=generated")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI(),console.log("dn2");var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=generated")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=generated")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(y(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),y()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerCBO?lstab=generated")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerCBO?lstab=generated"),y()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerCBO?lstab=generated"),y()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerCBO?lstab=generated"),y()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=b(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.viewcustomerdtl=function(t,e){c.hash("down"),$anchorScroll(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.downloads=function(t,a){h.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnCBOGeneratetabontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.history=!1,a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,a.tempdn1format_gid=t.data.tempdn1format_gid,console.log(t.data.tempdn1format_gid),document.getElementById("test").innerHTML+=a.content,a.document_path=t.data.document_path,a.document_name=t.data.document_name,a.dn_status=t.data.dn_status,"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.history=!0)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var e={urn:a.urn},n="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(n,e).then(function(t){console.log("allocation history",t),a.allocationHistoryList=t.data.overallhistoryallocationdtl,console.log(t.data.overallhistoryallocationdtl),a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var o={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/getallocatedtls";d.getparams(n,o).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var n="api/visitReport/GetAllocationLogDetail";d.getparams(n,o).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var n="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(n,o).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var n="api/customerManagement/HistoryEscrowSummary";d.getparams(n,o).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var n="api/allocationManagement/getAllocationdocument";d.getparams(n,o).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var n="api/visitReport/getvisitreportdtl";d.getparams(n,o).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var n="api/visitReport/getvisitReportDocument";d.getparams(n,o).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var n="api/visitReport/getvisitReportPhoto";d.getparams(n,o).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var n="api/TierMeeting/GetViewTierObservationdtl";d.getparams(n,o).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var r={tier1format_gid:localStorage.getItem("tier1format_gid")},n="api/TierMeeting/GetTier1Format360Dtl";d.getparams(n,r).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var n="api/TierMeeting/GetTier2Report360Dtl";d.getparams(n,o).then(function(t){console.log(t),a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var n="api/TierMeeting/GetTier3Report360Dtl";d.getparams(n,o).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()})});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function b(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var k=this;k.title="dnFPOGeneratetabontroller",y(),a.onselectedchangeusertype=function(){if("guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.downloads=function(t,a){h.Downloaddocument(t,a)},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI(),console.log("dn2");var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(y(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),y()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerFPO?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=b(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.viewcustomerdtl=function(t,e){
c.hash("down"),$anchorScroll(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.dn1pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnFPOGeneratetabontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],b.open=function(t){t.preventDefault(),t.stopPropagation(),b.opened=!0},b.close=function(t){t.preventDefault(),t.stopPropagation(),b.closed=!0},b.formats=["dd-MM-yyyy"],b.format=b.formats[0],b.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.history=!1,a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,a.tempdn1format_gid=t.data.tempdn1format_gid,console.log(t.data.tempdn1format_gid),document.getElementById("test").innerHTML+=a.content,a.document_path=t.data.document_path,a.document_name=t.data.document_name,a.dn_status=t.data.dn_status,"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.history=!0),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,console.log(t.data.courier_refno),a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,console.log(t.data.dn2courier_refno),a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var e={urn:a.urn},n="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(n,e).then(function(t){console.log("allocation history",t),a.allocationHistoryList=t.data.overallhistoryallocationdtl,console.log(t.data.overallhistoryallocationdtl),a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var o={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/getallocatedtls";d.getparams(n,o).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var n="api/visitReport/GetAllocationLogDetail";d.getparams(n,o).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var n="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(n,o).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var n="api/customerManagement/HistoryEscrowSummary";d.getparams(n,o).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var n="api/allocationManagement/getAllocationdocument";d.getparams(n,o).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var n="api/visitReport/getvisitreportdtl";d.getparams(n,o).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var n="api/visitReport/getvisitReportDocument";d.getparams(n,o).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var n="api/visitReport/getvisitReportPhoto";d.getparams(n,o).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var n="api/TierMeeting/GetViewTierObservationdtl";d.getparams(n,o).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var r={tier1format_gid:localStorage.getItem("tier1format_gid")},n="api/TierMeeting/GetTier1Format360Dtl";d.getparams(n,r).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var n="api/TierMeeting/GetTier2Report360Dtl";d.getparams(n,o).then(function(t){console.log(t),a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var n="api/TierMeeting/GetTier3Report360Dtl";d.getparams(n,o).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()})});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function y(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var b=this;b.title="dnOthersGeneratetabontroller",h(),a.viewcustomerdtl=function(t,e){c.hash("down"),$anchorScroll(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(h(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),h()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerOthers?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=pending"),h()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=pending"),h()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=pending"),h()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=y(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){DownloaddocumentService.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnOthersGeneratetabontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.history=!1,a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,a.tempdn1format_gid=t.data.tempdn1format_gid,console.log(t.data.tempdn1format_gid),document.getElementById("test").innerHTML+=a.content,a.document_path=t.data.document_path,a.document_name=t.data.document_name,a.dn_status=t.data.dn_status,"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,
a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.history=!0),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var e={urn:a.urn},t="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(t,e).then(function(t){console.log("allocation history",t),a.allocationHistoryList=t.data.overallhistoryallocationdtl,console.log(t.data.overallhistoryallocationdtl),a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var o={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},t="api/allocationManagement/getallocatedtls";d.getparams(t,o).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var t="api/visitReport/GetAllocationLogDetail";d.getparams(t,o).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var t="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(t,o).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var t="api/customerManagement/HistoryEscrowSummary";d.getparams(t,o).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var t="api/allocationManagement/getAllocationdocument";d.getparams(t,o).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var t="api/visitReport/getvisitreportdtl";d.getparams(t,o).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var t="api/visitReport/getvisitReportDocument";d.getparams(t,o).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var t="api/visitReport/getvisitReportPhoto";d.getparams(t,o).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var t="api/TierMeeting/GetViewTierObservationdtl";d.getparams(t,o).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var r={tier1format_gid:localStorage.getItem("tier1format_gid")},t="api/TierMeeting/GetTier1Format360Dtl";d.getparams(t,r).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var t="api/TierMeeting/GetTier2Report360Dtl";d.getparams(t,o).then(function(t){console.log(t),a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var t="api/TierMeeting/GetTier3Report360Dtl";d.getparams(t,o).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()})}function b(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var k=this;k.title="dnRetailGeneratetabontroller",y(),a.viewcustomerdtl=function(t,e){c.hash("down"),$anchorScroll(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI(),console.log("dn2");var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks,tempdn1format_gid:a.tempdn1format_gid};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(y(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),y()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerRetail?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),y()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),y()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),y()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=b(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){h.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnRetailGeneratetabontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.totalDisplayedpending=100,a.totalDisplayedgenerated=100,a.totalDisplayedskipped=100,a.totalDisplayedexclusion=100,a.totalDisplayedlegalsr=100,a.total=0,a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"pending"==n?a.tabpending=!0:"generated"==n?a.tabgenerated=!0:"skipped"==n?a.tabskipped=!0:"exclusion"==n?a.tabexclusion=!0:"legalsr"==n&&(a.tablegalsr=!0):void 0==a.tab.activeTabId?a.tabpending=!0:"pending"==a.tab.activeTabId?a.tabpending=!0:"generated"==a.tab.activeTabId?a.tabgenerated=!0:"skipped"==a.tab.activeTabId?a.tabskipped=!0:"exclusion"==a.tab.activeTabId?a.tabexclusion=!0:"legalsr"==a.tab.activeTabId&&(a.tablegalsr=!0);var t="api/misDataimport/GetDNcount";lockUI(),d.get(t).then(function(t){a.import_date=t.data.import_date,a.process_date=t.data.process_date,a.employee_name=t.data.employee_name});var t="api/LglTrnDNTrackerAE/getAEPendingList";d.get(t).then(function(t){a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.pending_total=0,a.totalDisplayedpending=0):(a.pending_total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))});var t="api/LglTrnDNTrackerAE/GetAE_Count";unlockUI(),d.get(t).then(function(t){a.lblpending_count=t.data.lblpending_count,a.lblgenerated_count=t.data.lblgenerated_count,console.log(t.data.lblexclusion_count),a.lblskipped_count=t.data.lblskipped_count,a.lblexclusion_count=t.data.lblexclusion_count,a.lbllegalsr_count=t.data.lbllegalsr_count})}function b(){var t="api/LglTrnDNTrackerAE/getAEGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.generated_total=0,a.totalDisplayedgenerated=0):(a.generated_total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})}function k(){var t="api/LglTrnDNTrackerAE/getAEExclusionList";d.get(t).then(function(t){a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.exclusion_total=0,a.totalDisplayedexclusion=0):(a.exclusion_total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})}var N=this;N.title="dnTrackerAEcontroller",y(),a.dnskip=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerSkipped?lstab=AE")},a.dngenerated_history=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerHistory?lstab=AE")},a.loadMore=function(t){if(void 0==t)return void l.alert("Enter the Total Summary Count","warning");lockUI();var e=parseInt(t);if(0!=a.total){if(!(t<a.total))return unlockUI(),void l.alert(" Total Summary "+a.total+" Records Only","warning");a.totalDisplayed+=e,a.total<a.totalDisplayed&&(a.totalDisplayed=a.total,l.alert(" Total Summary "+a.total+" Records Only","warning")),unlockUI()}unlockUI()},a.pending=function(){lockUI();var t="api/LglTrnDNTrackerAE/getAEPendingList";d.get(t).then(function(t){unlockUI(),a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.pending_total=0,a.totalDisplayedpending=0):(a.pending_total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))})},a.generated=function(){lockUI();var t="api/LglTrnDNTrackerAE/getAEGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.generated_total=0,a.totalDisplayedgenerated=0):(a.generated_total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})},a.skipped=function(){lockUI();var t="api/LglTrnDNTrackerAE/getAESkippedList";d.get(t).then(function(t){unlockUI(),a.DNskipped_list=t.data.DNskipped_list,null==a.DNskipped_list?(a.skipped_total=0,a.totalDisplayedskipped=0):(a.skipped_total=a.DNskipped_list.length,a.DNskipped_list.length<100&&(a.totalDisplayedskipped=a.DNskipped_list.length))})},a.exclusion=function(){lockUI();var t="api/LglTrnDNTrackerAE/getAEExclusionList";d.get(t).then(function(t){unlockUI(),a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.exclusion_total=0,a.totalDisplayedexclusion=0):(a.exclusion_total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})},a.legalsrlist=function(){lockUI();var t="api/LglTrnDNTrackerAE/getAELegalSRList";d.get(t).then(function(t){unlockUI(),a.DNlegalsr_list=t.data.DNlegalsr_list,null==a.DNlegalsr_list?(a.legalsr_total=0,a.totalDisplayedlegalsr=0):(a.legalsr_total=a.DNlegalsr_list.length,a.DNlegalsr_list.length<100&&(a.totalDisplayedlegalsr=a.DNlegalsr_list.length))})},a.popupDNskip=function(t,n){function o(a,e){a.ok=function(){e.close("closed")};var o=new Date;a.txtskipvalid_date=new Date(o.setDate(o.getDate()+15)),a.customer_urn=t,a.customer_name=n,a.confirmSkip=function(){lockUI();var n={urn:t,skip_reason:a.txtskip_reason,valid_date:a.txtskipvalid_date};console.log(n);var o="api/misDataimport/DNskip";d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(y(),l.alert("DN Skipped Successfully","success")):l.alert("Error Occurred While Updating DN Skip "),e.close("closed")})}}e.open({templateUrl:"/skipdn.html",controller:o,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1};var r=new Date;a.txtskipvalid_date=new Date(r.setDate(r.getDate()+15)),o.$inject=["$scope","$modalInstance"]},a.dn1generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerAEGenerate?lstab=pending")},a.dn2generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerAE2Generate?lstab=pending")},a.dn3generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerAE3Generate?lstab=pending")},a.dngeneratedinfo=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),localStorage.setItem("MyZonalAllocationHistory","N"),c.url("app/LglTrnDN2GeneratedAE?lstab=dn2tracker")},a.dnackstatus=function(t){function n(a,e){a.warningmsg=!1,a.ok=function(){e.close("closed")},a.changewarningmsg=function(){a.warningmsg=!1},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn1ackstatusupdation=function(){if("Delivered"==a.dn1ackstatus)if(""==a.txtdelivered_date||void 0==a.txtdelivered_date)a.warningmsg=!0;else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),y(),b()):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),b()})}else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),y(),b()):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3})})}y()}}a.warningmsg=!1;e.open({templateUrl:"/dn1ackstatus.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.dn2ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn2ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn2delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn2ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn2");e.open({templateUrl:"/dn2ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn3ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn3ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn3delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn3ackstatusupdate";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn3");e.open({templateUrl:"/dn3ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.exclusioncustomer=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?e.Nohistoryexclusion=!0:e.historyexclusion=!0}),e.confirmExclusioncustomer=function(){var a={customer_urn:t,exclusion_reason:e.txtexclusion_reason},o="api/LglTrnDNTrackerVertical/GetExclusionCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),y()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),n.close("closed"))})}}console.log("test",t);e.open({templateUrl:"/exclusionpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.activateexclusion=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a,e.confirmActivation=function(){lockUI();var a={customer_urn:t,exclusion_reason:e.txtactivated_reason},o="api/LglTrnDNTrackerVertical/GetActivationCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),
y(),k()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}e.open({templateUrl:"/activateconfirmation.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.exclusionHistory=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory})}e.open({templateUrl:"/exclusionHistoryPopup.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},a.legalsr=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customer_name=a,e.confirm=function(){lockUI();var o={customer_urn:t,customer_name:a,remarks:e.txtremarks};console.log(o);var r="api/LglTrnDNTrackerVertical/raiselegalsr";d.post(r,o).then(function(t){1==t.data.status?(y(),l.alert("Legal SR Raised Successfully","success")):l.alert("Error Occurred "),n.close("closed")})}}e.open({templateUrl:"/legalsr.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.raisesr=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),c.url("app/raiseSR2authentication?lstab=dntracker")},a.view=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",templegalsr_gid),a.customer_gid=localStorage.setItem("customer_gid",customer_gid),n.go("app.viewlegalSR")},a.dn1pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnTrackerAEcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e={urn:a.urn},t="api/MstRepayment/GetRepayment";d.getparams(t,e).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var t="api/MstTelecall/GetTelecall";d.getparams(t,e).then(function(t){a.telecall_list=t.data.telecall_list});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.tempdn1format_gid=t.data.tempdn1format_gid});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomerDNGID";lockUI();var e={urn:a.urn};console.log(e),d.getparams(t,e).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/DN1ContentDTL";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var t="api/misDataimport/getDN1Status";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="DNTrackerAE2generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN2template_list";d.get(t).then(function(t){console.log(t),a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn2_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,
a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - D3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("DNTrackerAE2generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerAE3generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){
if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.account_no,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN3template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn3_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerAE3generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn");var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e={urn:a.urn},t="api/MstRepayment/GetRepayment";d.getparams(t,e).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var t="api/MstTelecall/GetTelecall";d.getparams(t,e).then(function(t){a.telecall_list=t.data.telecall_list});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",e={urn:a.urn};lockUI(),d.getparams(t,e).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,n=t.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!0,a.sanctiondtl=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,a.DN1status=t.data.DN1status,a.dn_status=t.data.dn_status,"DN1 Sent"==t.data.DN1status&&(a.info=!1,a.initiatedn1=!0),"DN1 Sent"!=t.data.DN1status&&"DN1 Skip"!=t.data.DN1status||(a.data=!0)});var t="api/misDataimport/DN1ContentDTL";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.DN1_status=t.data.DN1_status,"DN1 Generated"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Hold"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.DN1_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getcourierinfo";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.couriered_by=t.data.couriered_by,a.courier_center=t.data.courier_center,a.courier_date=t.data.courier_date,a.courier_refno=t.data.courier_refno,a.courier_remarks=t.data.courier_remarks,a.courier_status=t.data.dn1courier_status});var t="api/misDataimport/Getrevertdetails";lockUI();var e={urn:a.urn};d.getparams(t,e).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerAEgeneratedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t},o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t},o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,unlockUI()}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.onselectedchangeusertype=function(){if("guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.DN1send=function(){var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()}),a.courier_info=!1,a.info=!0},a.dn1generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN1generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN1 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN1 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})},a.dn3generate=function(){
a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker")},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn_type);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn1_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks},o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks},o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t},n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";lockUI(),d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no="",$("#addupload").val("")},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerAEgeneratedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.total=0,a.totalDisplayed=0,a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"pending"==n?a.tabpending=!0:"generated"==n?a.tabgenerated=!0:"skipped"==n?a.tabskipped=!0:"exclusion"==n?a.tabexclusion=!0:"legalsr"==n&&(a.tablegalsr=!0):void 0==a.tab.activeTabId?a.tabpending=!0:"pending"==a.tab.activeTabId?a.tabpending=!0:"generated"==a.tab.activeTabId?a.tabgenerated=!0:"skipped"==a.tab.activeTabId?a.tabskipped=!0:"exclusion"==a.tab.activeTabId?a.tabexclusion=!0:"legalsr"==a.tab.activeTabId&&(a.tablegalsr=!0);var t="api/misDataimport/GetDNcount";d.get(t).then(function(t){a.import_date=t.data.import_date,a.process_date=t.data.process_date,a.employee_name=t.data.employee_name}),lockUI();var t="api/LglTrnDNTrackerCBO/getCBOPendingList";d.get(t).then(function(t){a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))});var t="api/LglTrnDNTrackerCBO/GetCBO_Count";unlockUI(),d.get(t).then(function(t){a.lblpending_count=t.data.lblpending_count,a.lblgenerated_count=t.data.lblgenerated_count,a.lblskipped_count=t.data.lblskipped_count,a.lblexclusion_count=t.data.lblexclusion_count,a.lbllegalsr_count=t.data.lbllegalsr_count})}function b(){var t="api/LglTrnDNTrackerCBO/getCBOGeneratedList";d.get(t).then(function(t){a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})}function k(){var t="api/LglTrnDNTrackerCBO/getCBOExclusionList";d.get(t).then(function(t){a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})}var N=this;N.title="dnTrackerCBOcontroller",y(),a.dnskip=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerSkipped?lstab=CBO")},a.loadMore=function(t){if(void 0==t)return void l.alert("Enter the Total Summary Count","warning");lockUI();var e=parseInt(t);if(0!=a.total){if(!(t<a.total))return unlockUI(),void l.alert(" Total Summary "+a.total+" Records Only","warning");a.totalDisplayed+=e,a.total<a.totalDisplayed&&(a.totalDisplayed=a.total,l.alert(" Total Summary "+a.total+" Records Only","warning")),unlockUI()}unlockUI()},a.generated=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})},a.skipped=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOSkippedList";d.get(t).then(function(t){unlockUI(),a.DNskipped_list=t.data.DNskipped_list,null==a.DNskipped_list?(a.total=0,a.totalDisplayedskipped=0):(a.total=a.DNskipped_list.length,a.DNskipped_list.length<100&&(a.totalDisplayedskipped=a.DNskipped_list.length))})},a.exclusion=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOExclusionList";d.get(t).then(function(t){unlockUI(),a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})},a.pending=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOPendingList";d.get(t).then(function(t){unlockUI(),a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))})},a.legalsrlist=function(){lockUI();var t="api/LglTrnDNTrackerCBO/getCBOLegalSRList";d.get(t).then(function(t){unlockUI(),a.DNlegalsr_list=t.data.DNlegalsr_list,null==a.DNlegalsr_list?(a.total=0,a.totalDisplayedlegalsr=0):(a.total=a.DNlegalsr_list.length,a.DNlegalsr_list.length<100&&(a.totalDisplayedlegalsr=a.DNlegalsr_list.length))})},a.popupDNskip=function(t,a){function n(e,n){e.ok=function(){n.close("closed")};var o=new Date;e.txtskipvalid_date=new Date(o.setDate(o.getDate()+15)),e.customer_urn=t,e.customer_name=a,e.confirmSkip=function(){lockUI();var a={urn:t,skip_reason:e.txtskip_reason,valid_date:e.txtskipvalid_date},o="api/misDataimport/DNskip";d.post(o,a).then(function(t){unlockUI(),1==t.data.status?(y(),l.alert("DN Skipped Successfully","success")):l.alert("Error Occurred While Updating DN Skip "),n.close("closed")})}}e.open({templateUrl:"/skipdn.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.dn1generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerCBOGenerate?lstab=pending")},a.dn2generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerCBO2Generate?lstab=pending")},a.dn3generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerCBO3Generate?lstab=pending")},a.dngeneratedinfo=function(t,e){a.urn=t,a.urn=localStorage.setItem("urn",t),localStorage.setItem("MyZonalAllocationHistory","N"),c.url("app/lglTrnDNCBOGenerateTab?lstab=generated")},a.dnackstatus=function(t){function n(a,e){a.warningmsg=!1,a.ok=function(){e.close("closed")},a.changewarningmsg=function(){a.warningmsg=!1},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn1ackstatusupdation=function(){if("Delivered"==a.dn1ackstatus)if(""==a.txtdelivered_date||void 0==a.txtdelivered_date)a.warningmsg=!0;else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),b()})}else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),b()})}}}a.warningmsg=!1;e.open({templateUrl:"/dn1ackstatus.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.dn2ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn2ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn2delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn2ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn2");e.open({templateUrl:"/dn2ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn3ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn3ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn3delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn3ackstatusupdate";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn3");e.open({templateUrl:"/dn3ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.exclusioncustomer=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?e.Nohistoryexclusion=!0:e.historyexclusion=!0}),e.confirmExclusioncustomer=function(){var a={customer_urn:t,exclusion_reason:e.txtexclusion_reason},o="api/LglTrnDNTrackerVertical/GetExclusionCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),y()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),n.close("closed"))})}}console.log("test",t);e.open({templateUrl:"/exclusionpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.activateexclusion=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a,e.confirmActivation=function(){lockUI();var a={customer_urn:t,exclusion_reason:e.txtactivated_reason},o="api/LglTrnDNTrackerVertical/GetActivationCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),y(),k()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}e.open({templateUrl:"/activateconfirmation.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.exclusionHistory=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory})}e.open({templateUrl:"/exclusionHistoryPopup.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},a.legalsr=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customer_name=a,e.confirm=function(){lockUI();var o={customer_urn:t,customer_name:a,remarks:e.txtremarks};console.log(o);var r="api/LglTrnDNTrackerVertical/raiselegalsr";d.post(r,o).then(function(t){1==t.data.status?(y(),l.alert("Legal SR Raised Successfully","success")):l.alert("Error Occurred "),n.close("closed")})}}e.open({templateUrl:"/legalsr.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.raisesr=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),c.url("app/raiseSR2authentication?lstab=dntracker")},a.view=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",templegalsr_gid),a.customer_gid=localStorage.setItem("customer_gid",customer_gid),n.go("app.viewlegalSR")},a.dn1pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){t.data.file_path,t.data.file_name;h.Downloaddocument(t.data,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn2pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn3pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})}}angular.module("angle").controller("dnTrackerCBOcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,a.dn3history_list=t.data.dn3history_list});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";
lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),console.log(t.data.courier_status),"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="DNTrackerCBO2generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/GetCBODN2template_list";d.get(t).then(function(t){console.log(t),a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dncbo2_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dncbo2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN2Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-CBO-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-CBO-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-CBO-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-CBO-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/LglTrnDNTrackerFPO?lstab=pending"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/LglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/LglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/LglTrnDNTrackerCBO?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(a){d.post(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")}),unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("DNTrackerCBO2generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,
t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,a.dn3history_list=t.data.dn3history_list});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),console.log(t.data.dn2history_list),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn1couriered_by=t.data.couriered_by,a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerCBO3generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){if("guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/GetCBODN3template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,console.log(t.data.dncbo3_flag),a.dn_flag=t.data.dn_flag,"N"==t.data.dncbo3_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dncbo3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN3Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-CBO-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-CBO-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=pending"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/LglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/LglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/LglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/LglTrnDNTrackerCBO?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/LglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");
unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerCBO3generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!0,a.sanctiondtl=!0;var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,a.DN1status=t.data.DN1status,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Sent"==t.data.DN1status&&(a.info=!1,a.initiatedn1=!0),"DN1 Sent"!=t.data.DN1status&&"DN1 Skip"!=t.data.DN1status||(a.data=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,a.dn3history_list=t.data.dn3history_list});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.DN1_status=t.data.DN1_status,"DN1 Generated"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Hold"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.DN1_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.couriered_by=t.data.couriered_by,a.courier_center=t.data.courier_center,a.courier_date=t.data.courier_date,a.courier_refno=t.data.courier_refno,a.courier_remarks=t.data.courier_remarks,a.courier_status=t.data.dn1courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerCBOgeneratedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){if("guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()}),a.courier_info=!1,a.info=!0},a.dn1generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN1generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN1 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN1 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=pending"),k()})},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0,console.log("test");var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerCBO?lstab=pending"),k()})},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerCBO?lstab=pending")},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/GetCBOTemplate_List";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn1_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-CBO-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-CBO-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-CBO-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-CBO-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-CBO-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,
a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-CBO-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerCBOgeneratedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.totalDisplayedpending=100,a.totalDisplayedgenerated=100,a.totalDisplayedskipped=100,a.totalDisplayedexclusion=100,a.totalDisplayedlegalsr=100,a.total=0,a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"pending"==n?a.tabpending=!0:"generated"==n?a.tabgenerated=!0:"skipped"==n?a.tabskipped=!0:"exclusion"==n?a.tabexclusion=!0:"legalsr"==n&&(a.tablegalsr=!0):void 0==a.tab.activeTabId?a.tabpending=!0:"pending"==a.tab.activeTabId?a.tabpending=!0:"generated"==a.tab.activeTabId?a.tabgenerated=!0:"skipped"==a.tab.activeTabId?a.tabskipped=!0:"exclusion"==a.tab.activeTabId?a.tabexclusion=!0:"legalsr"==a.tab.activeTabId&&(a.tablegalsr=!0);var t="api/misDataimport/GetDNcount";d.get(t).then(function(t){a.import_date=t.data.import_date,a.process_date=t.data.process_date,a.employee_name=t.data.employee_name}),lockUI();var t="api/LglTrnDNTrackerFPO/getFPOPendingList";d.get(t).then(function(t){a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))});var t="api/LglTrnDNTrackerFPO/GetFPO_Count";unlockUI(),d.get(t).then(function(t){a.lblpending_count=t.data.lblpending_count,a.lblgenerated_count=t.data.lblgenerated_count,a.lblskipped_count=t.data.lblskipped_count,a.lblexclusion_count=t.data.lblexclusion_count,a.lbllegalsr_count=t.data.lbllegalsr_count})}function b(){var t="api/LglTrnDNTrackerFPO/getFPOGeneratedList";d.get(t).then(function(t){a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})}function k(){var t="api/LglTrnDNTrackerFPO/getFPOExclusionList";d.get(t).then(function(t){a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})}var N=this;N.title="dnTrackerFPOcontroller",y(),a.generated=function(){lockUI();var t="api/LglTrnDNTrackerFPO/getFPOGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})},a.dnskip=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerSkipped?lstab=FPO")},a.pending=function(){lockUI();var t="api/LglTrnDNTrackerFPO/getFPOPendingList";d.get(t).then(function(t){unlockUI(),a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))})},a.skipped=function(){lockUI();var t="api/LglTrnDNTrackerFPO/getFPOSkippedList";d.get(t).then(function(t){unlockUI(),a.DNskipped_list=t.data.DNskipped_list,null==a.DNskipped_list?(a.total=0,a.totalDisplayedskipped=0):(a.total=a.DNskipped_list.length,a.DNskipped_list.length<100&&(a.totalDisplayedskipped=a.DNskipped_list.length))})},a.exclusion=function(){lockUI();var t="api/LglTrnDNTrackerFPO/getFPOExclusionList";d.get(t).then(function(t){unlockUI(),a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})},a.legalsrlist=function(){lockUI();var t="api/LglTrnDNTrackerFPO/getFPOLegalSRList";d.get(t).then(function(t){unlockUI(),a.DNlegalsr_list=t.data.DNlegalsr_list,null==a.DNlegalsr_list?(a.total=0,a.totalDisplayedlegalsr=0):(a.total=a.DNlegalsr_list.length,a.DNlegalsr_list.length<100&&(a.totalDisplayedlegalsr=a.DNlegalsr_list.length))})},a.popupDNskip=function(t,a){function n(e,n){e.ok=function(){n.close("closed")};var o=new Date;e.txtskipvalid_date=new Date(o.setDate(o.getDate()+15)),e.customer_urn=t,e.customer_name=a,e.confirmSkip=function(){lockUI();var a={urn:t,skip_reason:e.txtskip_reason,valid_date:e.txtskipvalid_date},o="api/misDataimport/DNskip";d.post(o,a).then(function(t){unlockUI(),1==t.data.status?(y(),l.alert("DN Skipped Successfully","success")):l.alert("Error Occurred While Updating DN Skip "),n.close("closed")})}}e.open({templateUrl:"/skipdn.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.loadMore=function(t){if(console.log("courier_test"),void 0==t)return void l.alert("Enter the Total Summary Count","warning");lockUI();var e=parseInt(t);if(0!=a.total){if(!(t<a.total))return unlockUI(),void l.alert(" Total Summary "+a.total+" Records Only","warning");a.totalDisplayed+=e,a.total<a.totalDisplayed&&(a.totalDisplayed=a.total,l.alert(" Total Summary "+a.total+" Records Only","warning")),unlockUI()}unlockUI()},a.dn1generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerFPOGenerate?lstab=pending")},a.dn2generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerFPO2Generate?lstab=pending")},a.dn3generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerFPO3Generate?lstab=pending")},a.dngeneratedinfo=function(t,e){a.urn=t,a.urn=localStorage.setItem("urn",t),localStorage.setItem("MyZonalAllocationHistory","N"),c.url("app/lglTrnDNFPOGenerateTab?lstab=generated")},a.dnackstatus=function(t){function n(a,e){a.warningmsg=!1,a.ok=function(){e.close("closed")},a.changewarningmsg=function(){a.warningmsg=!1},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn1ackstatusupdation=function(){if("Delivered"==a.dn1ackstatus)if(""==a.txtdelivered_date||void 0==a.txtdelivered_date)a.warningmsg=!0;else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),b(),y()})}else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),b()})}}}a.warningmsg=!1;e.open({templateUrl:"/dn1ackstatus.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.dn2ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn2ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn2delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn2ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn2");e.open({templateUrl:"/dn2ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn3ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn3ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn3delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn3ackstatusupdate";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn3");e.open({templateUrl:"/dn3ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.exclusioncustomer=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?e.Nohistoryexclusion=!0:e.historyexclusion=!0}),e.confirmExclusioncustomer=function(){var a={customer_urn:t,exclusion_reason:e.txtexclusion_reason},o="api/LglTrnDNTrackerVertical/GetExclusionCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),y()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),n.close("closed"))})}}console.log("test",t);e.open({templateUrl:"/exclusionpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.activateexclusion=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a,e.confirmActivation=function(){lockUI();var a={customer_urn:t,exclusion_reason:e.txtactivated_reason},o="api/LglTrnDNTrackerVertical/GetActivationCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),y(),k()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}e.open({templateUrl:"/activateconfirmation.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.exclusionHistory=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory})}e.open({templateUrl:"/exclusionHistoryPopup.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},a.legalsr=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customer_name=a,e.confirm=function(){lockUI();var o={customer_urn:t,customer_name:a,remarks:e.txtremarks};console.log(o);var r="api/LglTrnDNTrackerVertical/raiselegalsr";d.post(r,o).then(function(t){1==t.data.status?(y(),l.alert("Legal SR Raised Successfully","success")):l.alert("Error Occurred "),n.close("closed")})}}e.open({templateUrl:"/legalsr.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.raisesr=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),c.url("app/raiseSR2authentication?lstab=dntracker")},a.view=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",templegalsr_gid),a.customer_gid=localStorage.setItem("customer_gid",customer_gid),n.go("app.viewlegalSR")},a.dn1pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnTrackerFPOcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerFPO2generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,
a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN2template_list";d.get(t).then(function(t){console.log(t),a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn2_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerFPO?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerFPO2generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.ShowAllocation360,a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,
a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerFPO3generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN3template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn3_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerFPO?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerFPO3generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.sanctiondtl=!0;var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,a.DN1status=t.data.DN1status,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Sent"==t.data.DN1status&&(a.info=!1,a.initiatedn1=!0),"DN1 Sent"!=t.data.DN1status&&"DN1 Skip"!=t.data.DN1status||(a.data=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.DN1_status=t.data.DN1_status,"DN1 Generated"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Hold"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.DN1_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/getcourierinfo";
lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.couriered_by=t.data.couriered_by,a.courier_center=t.data.courier_center,a.courier_date=t.data.courier_date,a.courier_refno=t.data.courier_refno,a.courier_remarks=t.data.courier_remarks,a.courier_status=t.data.dn1courier_status})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerFPOgeneratedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.viewcustomerdtl=function(t,e){c.hash("down"),h(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.onselectedchangeusertype=function(){if("guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list,console.log(t.data.customer2userdtl_list)})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()}),a.courier_info=!1,a.info=!0},a.dn1generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN1generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN1 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})},a.dn2generate=function(){a.courier_info=!0,a.info=!0,console.log("dn2");var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerFPO?lstab=pending")},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn1_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){console.log(t),a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning")}},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no="",$("#addupload").val("")},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn};console.log(t);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerFPOgeneratedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.ShowAllocation360,a.guarantorinfo=!1,a.Sanctioninfo=!1;var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var n={urn:a.urn},t="api/MstRepayment/GetRepayment";d.getparams(t,n).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var t="api/MstTelecall/GetTelecall";d.getparams(t,n).then(function(t){a.telecall_list=t.data.telecall_list});var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",n={urn:a.urn};lockUI(),d.getparams(t,n).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",n={urn:a.urn};lockUI(),d.getparams(t,n).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,
a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",n={urn:a.urn};lockUI(),d.getparams(t,n).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(t,n).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.history=!1,a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.history=!0),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getDN1Status";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,a.dn3history_list=t.data.dn3history_list});var t="api/lglTrnDn2CustomerDetails/GetDNGenerated_History";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dn_list=t.data.dn_list,console.log(t.data.dn_list)});var t="api/misDataimport/getcourierinfo";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var t="api/misDataimport/Getrevertdetails";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var o={customer_gid:localStorage.getItem("allocation_customer_gid")};a.allocation_customer_gid=o,console.log(o);var t="api/allocationManagement/getAllocationHistory";d.getparams(t,o).then(function(t){console.log("allocation history",t),a.allocationHistoryList=t.data.overallhistoryallocationdtl,console.log(t.data.overallhistoryallocationdtl),a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var r={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},t="api/allocationManagement/getallocatedtls";d.getparams(t,r).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var t="api/visitReport/GetAllocationLogDetail";d.getparams(t,r).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var t="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(t,r).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var t="api/customerManagement/HistoryEscrowSummary";d.getparams(t,r).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var t="api/allocationManagement/getAllocationdocument";d.getparams(t,r).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var t="api/visitReport/getvisitreportdtl";d.getparams(t,r).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var t="api/visitReport/getvisitReportDocument";d.getparams(t,r).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var t="api/visitReport/getvisitReportPhoto";d.getparams(t,r).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var t="api/TierMeeting/GetViewTierObservationdtl";d.getparams(t,r).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var i={tier1format_gid:localStorage.getItem("tier1format_gid")},t="api/TierMeeting/GetTier1Format360Dtl";d.getparams(t,i).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var t="api/TierMeeting/GetTier2Report360Dtl";d.getparams(t,r).then(function(t){console.log(t),a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var t="api/TierMeeting/GetTier3Report360Dtl";d.getparams(t,r).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()})}function b(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var k=this;k.title="dngeneratedhistorycontroller",y(),a.downloads=function(t,a){DownloaddocumentService.Downloaddocument(t,a)},a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.viewcustomerdtl=function(t,e){c.hash("down"),h(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI(),console.log("dn2");var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(y(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),y()})},a.Dn1back=function(){"others"==a.relpath1?c.url("app/lglTrnDNTrackerOthers?lstab=pending"):"retail"==a.relpath1?c.url("app/lglTrnDNTrackerRetail?lstab=pending"):"FPO"==a.relpath1?c.url("app/lglTrnDNTrackerFPO?lstab=pending"):"CBO"==a.relpath1?c.url("app/lglTrnDNTrackerCBO?lstab=pending"):"AE"==a.relpath1&&c.url("app/LglTrnDNTrackerAE?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=b(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)}}angular.module("angle").controller("dngeneratedhistorycontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.total=0,a.totalDisplayed=0,a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"pending"==n?a.tabpending=!0:"generated"==n?a.tabgenerated=!0:"skipped"==n?a.tabskipped=!0:"exclusion"==n?a.tabexclusion=!0:"legalsr"==n&&(a.tablegalsr=!0):void 0==a.tab.activeTabId?a.tabpending=!0:"pending"==a.tab.activeTabId?a.tabpending=!0:"generated"==a.tab.activeTabId?a.tabgenerated=!0:"skipped"==a.tab.activeTabId?a.tabskipped=!0:"exclusion"==a.tab.activeTabId?a.tabexclusion=!0:"legalsr"==a.tab.activeTabId&&(a.tablegalsr=!0);var t="api/misDataimport/GetDNcount";d.get(t).then(function(t){a.import_date=t.data.import_date,a.process_date=t.data.process_date,a.employee_name=t.data.employee_name}),lockUI();var t="api/LglTrnDNTrackerOthers/getOthersPendingList";d.get(t).then(function(t){a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))});var t="api/LglTrnDNTrackerOthers/GetOthers_Count";unlockUI(),d.get(t).then(function(t){a.lblpending_count=t.data.lblpending_count,a.lblgenerated_count=t.data.lblgenerated_count,a.lblskipped_count=t.data.lblskipped_count,a.lblexclusion_count=t.data.lblexclusion_count,a.lbllegalsr_count=t.data.lbllegalsr_count})}function y(){var t="api/LglTrnDNTrackerOthers/getOthersGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})}function b(){var t="api/LglTrnDNTrackerOthers/getOthersExclusionList";d.get(t).then(function(t){a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})}var k=this;k.title="dnTrackerOtherscontroller",h(),a.dngenerated_history=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerHistory?lstab=others")},a.dnskip=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerSkipped?lstab=others")},a.popupDNskip=function(t,a){function n(e,n){e.ok=function(){n.close("closed")};var o=new Date;e.txtskipvalid_date=new Date(o.setDate(o.getDate()+15)),e.customer_urn=t,e.customer_name=a,e.confirmSkip=function(){lockUI();var a={urn:t,skip_reason:e.txtskip_reason,valid_date:e.txtskipvalid_date},o="api/misDataimport/DNskip";d.post(o,a).then(function(t){unlockUI(),1==t.data.status?(h(),l.alert("DN Skipped Successfully","success")):l.alert("Error Occurred While Updating DN Skip "),n.close("closed")})}}e.open({templateUrl:"/skipdn.html",controller:n,size:"md"});k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.loadMore=function(t){if(void 0==t)return void l.alert("Enter the Total Summary Count","warning");lockUI();var e=parseInt(t);if(0!=a.total){if(!(t<a.total))return unlockUI(),void l.alert(" Total Summary "+a.total+" Records Only","warning");a.totalDisplayed+=e,a.total<a.totalDisplayed&&(a.totalDisplayed=a.total,l.alert(" Total Summary "+a.total+" Records Only","warning")),unlockUI()}unlockUI()},a.generated=function(){lockUI();var t="api/LglTrnDNTrackerOthers/getOthersGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})},a.skipped=function(){lockUI();var t="api/LglTrnDNTrackerOthers/getOthersSkippedList";d.get(t).then(function(t){unlockUI(),a.DNskipped_list=t.data.DNskipped_list,null==a.DNskipped_list?(a.total=0,a.totalDisplayedskipped=0):(a.total=a.DNskipped_list.length,a.DNskipped_list.length<100&&(a.totalDisplayedskipped=a.DNskipped_list.length))})},a.exclusion=function(){lockUI();var t="api/LglTrnDNTrackerOthers/getOthersExclusionList";d.get(t).then(function(t){unlockUI(),a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})},a.pending=function(){lockUI();var t="api/LglTrnDNTrackerOthers/getOthersPendingList";d.get(t).then(function(t){unlockUI(),a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))})},a.legalsrlist=function(){lockUI();var t="api/LglTrnDNTrackerOthers/getOthersLegalSRList";d.get(t).then(function(t){unlockUI(),a.DNlegalsr_list=t.data.DNlegalsr_list,null==a.DNlegalsr_list?(a.total=0,a.totalDisplayedlegalsr=0):(a.total=a.DNlegalsr_list.length,a.DNlegalsr_list.length<100&&(a.totalDisplayedlegalsr=a.DNlegalsr_list.length))})},a.dn1generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerOthersGenerate?lstab=pending")},a.dn2generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerOthers2Generate?lstab=pending")},a.dn3generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerOthers3Generate?lstab=pending")},a.dngeneratedinfo=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),localStorage.setItem("MyZonalAllocationHistory","N"),c.url("app/lglTrnDNOthersGenerateTab?lstab=generated")},a.dnackstatus=function(t){function n(a,e){a.warningmsg=!1,a.ok=function(){e.close("closed")},a.changewarningmsg=function(){a.warningmsg=!1},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn1ackstatusupdation=function(){if("Delivered"==a.dn1ackstatus)if(""==a.txtdelivered_date||void 0==a.txtdelivered_date)a.warningmsg=!0;else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),h()})}else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),h()})}}}a.warningmsg=!1;e.open({templateUrl:"/dn1ackstatus.html",controller:n,size:"md"});k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.dn2ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn2ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn2delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn2ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),h()})}}console.log("dn2");e.open({templateUrl:"/dn2ackstatus.html",controller:a,size:"md"});k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",
startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn3ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn3ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn3delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn3ackstatusupdate";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),h()})}}console.log("dn3");e.open({templateUrl:"/dn3ackstatus.html",controller:a,size:"md"});k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.exclusioncustomer=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?e.Nohistoryexclusion=!0:e.historyexclusion=!0}),e.confirmExclusioncustomer=function(){var a={customer_urn:t,exclusion_reason:e.txtexclusion_reason},o="api/LglTrnDNTrackerVertical/GetExclusionCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),h()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),n.close("closed"))})}}console.log("test",t);e.open({templateUrl:"/exclusionpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.activateexclusion=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a,e.confirmActivation=function(){lockUI();var a={customer_urn:t,exclusion_reason:e.txtactivated_reason},o="api/LglTrnDNTrackerVertical/GetActivationCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),h()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()),b()})}}e.open({templateUrl:"/activateconfirmation.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.exclusionHistory=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory})}e.open({templateUrl:"/exclusionHistoryPopup.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},a.legalsr=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customer_name=a,e.confirm=function(){lockUI();var o={customer_urn:t,customer_name:a,remarks:e.txtremarks};console.log(o);var r="api/LglTrnDNTrackerVertical/raiselegalsr";d.post(r,o).then(function(t){1==t.data.status?(h(),l.alert("Legal SR Raised Successfully","success")):l.alert("Error Occurred "),n.close("closed")})}}e.open({templateUrl:"/legalsr.html",controller:n,size:"md"});k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.raisesr=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),c.url("app/raiseSR2authentication?lstab=dntracker")},a.view=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",templegalsr_gid),a.customer_gid=localStorage.setItem("customer_gid",customer_gid),n.go("app.viewlegalSR")},a.dn1pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn2pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN2 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn3pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;DownloaddocumentService.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN3 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})}}angular.module("angle").controller("dnTrackerOtherscontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.tempdn1format_gid=t.data.tempdn1format_gid});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)}),d.getparams(e,t).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerOthers2generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN2template_list";d.get(t).then(function(t){console.log(t),a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn2_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),
d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerOthers?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)}}angular.module("angle").controller("LglTrnDNTrackerOthers2generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerOthers3generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,
a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN3template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn3_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerOthers?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerOthers3generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!0,a.sanctiondtl=!0;var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,a.DN1status=t.data.DN1status,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Sent"==t.data.DN1status&&(a.info=!1,a.initiatedn1=!0),"DN1 Sent"!=t.data.DN1status&&"DN1 Skip"!=t.data.DN1status||(a.data=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,a.dn3history_list=t.data.dn3history_list});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.DN1_status=t.data.DN1_status,"DN1 Generated"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Hold"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.DN1_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.couriered_by=t.data.couriered_by,a.courier_center=t.data.courier_center,a.courier_date=t.data.courier_date,a.courier_refno=t.data.courier_refno,a.courier_remarks=t.data.courier_remarks,a.courier_status=t.data.dn1courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerOthersgeneratedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,
a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.DN1send=function(){var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerAE?lstab=dn1tracker"),k()}),a.courier_info=!1,a.info=!0},a.dn1generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN1generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN1 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN1 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})},a.dn2generate=function(){a.courier_info=!0,a.info=!0,console.log("dn2");var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0,console.log("test");var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerOthers?lstab=dn1tracker"),k()})},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerOthers?lstab=pending")},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn1_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerAE?lstab=dn1tracker"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no="",$("#addupload").val("")},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerOthersgeneratedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.total=0,a.totalDisplayedpending=100,a.totalDisplayedgenerated=100,a.totalDisplayedskipped=100,a.totalDisplayedexclusion=100,a.totalDisplayedlegalsr=100,a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"pending"==n?a.tabpending=!0:"generated"==n?a.tabgenerated=!0:"skipped"==n?a.tabskipped=!0:"exclusion"==n?a.tabexclusion=!0:"legalsr"==n&&(a.tablegalsr=!0):void 0==a.tab.activeTabId?a.tabpending=!0:"pending"==a.tab.activeTabId?a.tabpending=!0:"generated"==a.tab.activeTabId?a.tabgenerated=!0:"skipped"==a.tab.activeTabId?a.tabskipped=!0:"exclusion"==a.tab.activeTabId?a.tabexclusion=!0:"legalsr"==a.tab.activeTabId&&(a.tablegalsr=!0);var t="api/misDataimport/GetDNcount";d.get(t).then(function(t){a.import_date=t.data.import_date,a.process_date=t.data.process_date,a.employee_name=t.data.employee_name}),lockUI();var t="api/LglTrnDNTrackerRetail/getRetailPendingList";d.get(t).then(function(t){a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))});var t="api/LglTrnDNTrackerRetail/GetRetail_Count";unlockUI(),d.get(t).then(function(t){a.lblpending_count=t.data.lblpending_count,a.lblgenerated_count=t.data.lblgenerated_count,a.lblskipped_count=t.data.lblskipped_count,a.lblexclusion_count=t.data.lblexclusion_count,a.lbllegalsr_count=t.data.lbllegalsr_count})}function b(){var t="api/LglTrnDNTrackerRetail/getRetailGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})}function k(){var t="api/LglTrnDNTrackerRetail/getRetailExclusionList";d.get(t).then(function(t){a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})}var N=this;N.title="dnTrackerRetailcontroller",y(),a.loadMore=function(t){if(void 0==t)return void l.alert("Enter the Total Summary Count","warning");lockUI();var e=parseInt(t);if(0!=a.total){if(!(t<a.total))return unlockUI(),void l.alert(" Total Summary "+a.total+" Records Only","warning");a.totalDisplayed+=e,a.total<a.totalDisplayed&&(a.totalDisplayed=a.total,l.alert(" Total Summary "+a.total+" Records Only","warning")),unlockUI()}unlockUI()},a.pending=function(){lockUI();var t="api/LglTrnDNTrackerRetail/getRetailPendingList";d.get(t).then(function(t){unlockUI(),a.DNpending_list=t.data.DNpending_list,null==a.DNpending_list?(a.total=0,a.totalDisplayedpending=0):(a.total=a.DNpending_list.length,a.DNpending_list.length<100&&(a.totalDisplayedpending=a.DNpending_list.length))})},a.generated=function(){lockUI();var t="api/LglTrnDNTrackerRetail/getRetailGeneratedList";d.get(t).then(function(t){unlockUI(),a.DNgenerated_list=t.data.DNgenerated_list,null==a.DNgenerated_list?(a.total=0,a.totalDisplayedgenerated=0):(a.total=a.DNgenerated_list.length,a.DNgenerated_list.length<100&&(a.totalDisplayedgenerated=a.DNgenerated_list.length))})},a.skipped=function(){lockUI();var t="api/LglTrnDNTrackerRetail/getRetailSkippedList";d.get(t).then(function(t){unlockUI(),a.DNskipped_list=t.data.DNskipped_list,null==a.DNskipped_list?(a.total=0,a.totalDisplayedskipped=0):(a.total=a.DNskipped_list.length,a.DNskipped_list.length<100&&(a.totalDisplayedskipped=a.DNskipped_list.length))})},a.exclusion=function(){lockUI();var t="api/LglTrnDNTrackerRetail/getRetailExclusionList";d.get(t).then(function(t){unlockUI(),a.DNexclusion_list=t.data.DNexclusion_list,null==a.DNexclusion_list?(a.total=0,a.totalDisplayedexclusion=0):(a.total=a.DNexclusion_list.length,a.DNexclusion_list.length<100&&(a.totalDisplayedexclusion=a.DNexclusion_list.length))})},a.legalsrlist=function(){lockUI();var t="api/LglTrnDNTrackerRetail/getRetailLegalSRList";d.get(t).then(function(t){unlockUI(),a.DNlegalsr_list=t.data.DNlegalsr_list,null==a.DNlegalsr_list?(a.total=0,a.totalDisplayedlegalsr=0):(a.total=a.DNlegalsr_list.length,a.DNlegalsr_list.length<100&&(a.totalDisplayedlegalsr=a.DNlegalsr_list.length))})},a.dn1generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerRetailGenerate?lstab=pending")},a.dn2generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerRetail2Generate?lstab=pending")},a.dn3generatepage=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/lglTrnDNTrackerRetail3Generate?lstab=pending")},a.dngeneratedinfo=function(t,e){a.urn=t,a.urn=localStorage.setItem("urn",t),localStorage.setItem("MyZonalAllocationHistory","N"),c.url("app/lglTrnDNRetailGenerateTab?lstab=generated")},a.dnackstatus=function(t){function n(a,e){a.warningmsg=!1,a.ok=function(){e.close("closed")},a.changewarningmsg=function(){a.warningmsg=!1},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn1ackstatusupdation=function(){if("Delivered"==a.dn1ackstatus)if(""==a.txtdelivered_date||void 0==a.txtdelivered_date)a.warningmsg=!0;else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),b()})}else{a.warningmsg=!1;var n={urn:t,courier_status:a.dn1ackstatus,delivered_date:a.txtdelivered_date,returened_date:a.txtreturned_date},o="api/misDataimport/dn1ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y(),b()})}}}a.warningmsg=!1;e.open({templateUrl:"/dn1ackstatus.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.dn2ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn2ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn2delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn2ackstatusupdate";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn2");e.open({templateUrl:"/dn2ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.dn3ackstatus=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.isShowHide=function(t){"show"==t?(a.showval=!0,a.hideval=!1,a.showdiv=!0):"hide"==t?(a.showval=!1,a.hideval=!0,a.showdiv=!0):(a.showval=!1,a.hideval=!1,a.showdiv=!0)},a.dn3ackstatusupdation=function(){var n={urn:t,courier_status:a.dn1ackstatus,dn3delivered_date:a.txtdelivered_date,dn2returned_date:a.txtreturned_date};console.log(n);var o="api/misDataimport/dn3ackstatusupdate";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),y()})}}console.log("dn3");e.open({templateUrl:"/dn3ackstatus.html",controller:a,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},a.$inject=["$scope","$modalInstance"]},a.exclusioncustomer=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?e.Nohistoryexclusion=!0:e.historyexclusion=!0}),e.confirmExclusioncustomer=function(){var a={customer_urn:t,exclusion_reason:e.txtexclusion_reason},o="api/LglTrnDNTrackerVertical/GetExclusionCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),y()):(l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),n.close("closed"))})}}console.log("test",t);e.open({templateUrl:"/exclusionpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.activateexclusion=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a,e.confirmActivation=function(){lockUI();var a={customer_urn:t,exclusion_reason:e.txtactivated_reason},o="api/LglTrnDNTrackerVertical/GetActivationCustomer";d.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),y(),k()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}e.open({templateUrl:"/activateconfirmation.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},a.exclusionHistory=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customername=a;var o={customer_urn:t},r="api/LglTrnDNTrackerVertical/GetExclusionCustomerHistory";d.getparams(r,o).then(function(t){e.exclusioncustomerHistory=t.data.exclusionhistory})}e.open({templateUrl:"/exclusionHistoryPopup.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},a.dnskip=function(t){console.log(t),a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerSkipped?lstab=retail")},a.popupDNskip=function(t,a){function n(e,n){e.ok=function(){n.close("closed")};var o=new Date;e.txtskipvalid_date=new Date(o.setDate(o.getDate()+15)),e.customer_urn=t,e.customer_name=a,e.confirmSkip=function(){lockUI();var a={urn:t,skip_reason:e.txtskip_reason,valid_date:e.txtskipvalid_date},o="api/misDataimport/DNskip";d.post(o,a).then(function(t){unlockUI(),1==t.data.status?(y(),l.alert("DN Skipped Successfully","success")):l.alert("Error Occurred While Updating DN Skip "),n.close("closed")})}}e.open({templateUrl:"/skipdn.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.legalsr=function(t,a){function n(e,n){e.ok=function(){n.close("closed")},e.customer_urn=t,e.customer_name=a,e.confirm=function(){lockUI();var o={customer_urn:t,customer_name:a,remarks:e.txtremarks};console.log(o);var r="api/LglTrnDNTrackerVertical/raiselegalsr";d.post(r,o).then(function(t){1==t.data.status?(y(),l.alert("Legal SR Raised Successfully","success")):l.alert("Error Occurred "),n.close("closed")})}}e.open({templateUrl:"/legalsr.html",controller:n,size:"md"});N.open=function(t){t.preventDefault(),t.stopPropagation(),N.opened=!0},N.close=function(t){t.preventDefault(),t.stopPropagation(),N.closed=!0},N.formats=["dd-MM-yyyy"],N.format=N.formats[0],N.dateOptions={formatYear:"yy",startingDay:1},n.$inject=["$scope","$modalInstance"]},a.raisesr=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",t),a.customer_gid=localStorage.setItem("customer_gid",e),c.url("app/raiseSR2authentication?lstab=dntracker")},a.view=function(t,e){a.templegalsr_gid=localStorage.setItem("templegalsr_gid",templegalsr_gid),a.customer_gid=localStorage.setItem("customer_gid",customer_gid),n.go("app.viewlegalSR")},a.dngenerated_history=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),c.url("app/LglTrnDNTrackerHistory?lstab=Retail")},a.dn1pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(t){var a={urn:t};console.log(a);var e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,a).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;h.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("dnTrackerRetailcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){
a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerRET2generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=y.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN2template_list";d.get(t).then(function(t){console.log(t),a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn2_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks
};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerRetail?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){b.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;b.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;b.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN2 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;b.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN3 Report Downloaded Successfully","success"),unlockUI()}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning")})}}angular.module("angle").controller("LglTrnDNTrackerRET2generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","cmnfunctionService","cmnfunctionService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.click=!0,a.initiatedn2=!0,a.dn2format=!0,a.button=!0,a.revert=!0,a.dn1status=!0,a.sanctiondtl=!0,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var e="api/misDataimport/getcustomerDNGID";lockUI();var t={urn:a.urn};console.log(t),d.getparams(e,t).then(function(t){unlockUI(),a.dncase_gid=t.data.dncase_gid});var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,"DN1 Sent"==t.data.DN1status&&(a.dn1status=!1),"DN1 Skip"==t.data.DN1status&&(a.dn1status=!1),"DN2 Sent"==t.data.DN2status&&(a.dn2format=!1,a.data=!0,a.courierdetails=!0,a.initiatedn2=!0,a.dn1status=!0),"DN2 Skip"==t.data.DN2status&&(a.skip=!0,a.dn1status=!0),"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/LglTrnDNTrackerVertical/template_content";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.templatecontent=t.data.dn2_content,document.getElementById("test").innerHTML+=a.templatecontent,a.DN1_status=t.data.DN1_status,"DN2 Generated"==t.data.DN1_status&&(console.log(t.data.DN1_status),a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0),"DN2 Reverted"==t.data.DN1_status&&(a.initiatedn2=!0,a.otherloan=!0,a.click=!0,a.dn2format=!0,a.button=!0,a.courier_info=!1,a.revert=!1,a.dn1status=!0),"DN2 Hold"==t.data.DN1_status&&(a.dn2format=!1,a.button=!1,a.courier_info=!1,a.info=!0,a.dn1status=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path,"DN1 Skip"!=t.data.DN1status&&"DN1 Sent"!=t.data.DN1status&&"DN1 Generated"!=t.data.DN1status||(a.dndetails=!1,a.dn1status=!0)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks,console.log(t.data.remarks)});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerRET3generatedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/SanctionDN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/DN3template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn3_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,
dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn2generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI();var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerRetail?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerRET3generatedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y,b){function k(){a.guarantorinfo=!1,a.Sanctioninfo=!1,a.ShowAllocation360,a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var t={urn:a.urn},e="api/MstRepayment/GetRepayment";d.getparams(e,t).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var e="api/MstTelecall/GetTelecall";d.getparams(e,t).then(function(t){a.telecall_list=t.data.telecall_list});var e="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var e="api/lglTrnDn2CustomerDetails/Getcustomerdetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var e="api/lglTrnDn2CustomerDetails/GetGuarantordetails",t={urn:a.urn};lockUI(),d.getparams(e,t).then(function(t){a.additional_list=t.data.customer2userdtl_list});var e="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(e,t).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var e=window.location.href,n=e.split("lstab=");a.relpath1=n[1],x.open=function(t){t.preventDefault(),t.stopPropagation(),x.opened=!0},x.close=function(t){t.preventDefault(),t.stopPropagation(),x.closed=!0},x.formats=["dd-MM-yyyy"],x.format=x.formats[0],x.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!0,a.sanctiondtl=!0;var e="api/misDataimport/getcustomer2Loan";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name,a.DN1status=t.data.DN1status,a.dn_status=t.data.dn_status,console.log(t.data.dn_status),"DN1 Sent"==t.data.DN1status&&(a.info=!1,a.initiatedn1=!0),"DN1 Sent"!=t.data.DN1status&&"DN1 Skip"!=t.data.DN1status||(a.data=!0)});var e="api/misDataimport/getDN1Status";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.tempdn1format_gid=t.data.tempdn1format_gid,a.DN1status=t.data.DN1status,a.DN1template_content=t.data.DN1template_content,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1status_created_date=t.data.dn1status_created_date,a.dn1couriersent_date=t.data.dn1couriersent_date,a.dn1status_created_by=t.data.dn1status_created_by,a.dn1annexuredocument_name=t.data.dn1annexuredocument_name,a.dn1annexuredocument_path=t.data.dn1annexuredocument_path,a.DN2status=t.data.DN2status,a.DN2template_content=t.data.DN2template_content,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2status_created_date=t.data.dn2status_created_date,a.dn2couriersent_date=t.data.dn2couriersent_date,a.dn2status_created_by=t.data.dn2status_created_by,a.dn2annexuredocument_name=t.data.dn2annexuredocument_name,a.dn2annexuredocument_path=t.data.dn2annexuredocument_path,a.DN3status=t.data.DN3status,a.DN3template_content=t.data.DN3template_content,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3status_created_date=t.data.dn3status_created_date,a.dn3couriersent_date=t.data.dn3couriersent_date,a.dn3status_created_by=t.data.dn3status_created_by,a.dn3annexuredocument_name=t.data.dn3annexuredocument_name,a.dn3annexuredocument_path=t.data.dn3annexuredocument_path});var e="api/misDataimport/DN1ContentDTL";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.DN1_status=t.data.DN1_status,"DN1 Generated"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Hold"==t.data.DN1_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.DN1_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var e="api/misDataimport/getcourierinfo";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.couriered_by=t.data.couriered_by,a.courier_center=t.data.courier_center,a.courier_date=t.data.courier_date,a.courier_refno=t.data.courier_refno,a.courier_remarks=t.data.courier_remarks,a.courier_status=t.data.dn1courier_status});var e="api/misDataimport/Getrevertdetails";lockUI();var t={urn:a.urn};d.getparams(e,t).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks})}function N(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var x=this;x.title="LglTrnDNTrackerRetailgeneratedcontroller",k();var I="api/LglTrnDNTrackerAE/Getcustomerupdatedetails",S={urn:a.urn};lockUI(),d.getparams(I,S).then(function(t){a.zonal_riskmanagerName=t.data.zonal_riskmanagerName,a.riskMonitoring_Name=t.data.riskMonitoring_Name,a.customer_gid=t.data.customer_gid,unlockUI()}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var S={urn:a.urn},I="api/LglTrnDNTrackerAE/GetAllocationHistory";d.getparams(I,S).then(function(t){a.allocationHistoryList=t.data.overallhistoryallocationdtl,a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var w={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},I="api/allocationManagement/getallocatedtls";d.getparams(I,w).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var I="api/visitReport/GetAllocationLogDetail";d.getparams(I,w).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var I="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(I,w).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var I="api/customerManagement/HistoryEscrowSummary";d.getparams(I,w).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var I="api/allocationManagement/getAllocationdocument";d.getparams(I,w).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var I="api/visitReport/getvisitreportdtl";d.getparams(I,w).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var I="api/visitReport/getvisitReportDocument";d.getparams(I,w).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var I="api/visitReport/getvisitReportPhoto";d.getparams(I,w).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var I="api/TierMeeting/GetViewTierObservationdtl";d.getparams(I,w).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var U={tier1format_gid:localStorage.getItem("tier1format_gid")},I="api/TierMeeting/GetTier1Format360Dtl";d.getparams(I,U).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var I="api/TierMeeting/GetTier2Report360Dtl";d.getparams(I,w).then(function(t){a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var I="api/TierMeeting/GetTier3Report360Dtl";d.getparams(I,w).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()}),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=b.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("project_flag","Default"),a.uploadfrm=i},a.dn2cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN2Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.dn3cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN3Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()}),a.courier_info=!1,a.info=!0},a.dn1generate=function(){a.courier_info=!0,a.info=!0;var t="api/misDataimport/DN1generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN1 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN1 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})},a.dn2generate=function(){a.courier_info=!0,a.info=!0,console.log("dn2");var t="api/misDataimport/DN2generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN2 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN2 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})},a.dn3generate=function(){a.courier_info=!0,a.info=!0,console.log("test");var t="api/misDataimport/DN3generate";lockUI();var e={urn:a.urn,template_content:a.content};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?(k(),l.alert("DN3 Generated  Successfully","success")):l.alert("Error Occurred While Generating DN3 Status "),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(k(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),k()})},a.Dn1back=function(){c.url("app/lglTrnDNTrackerRetail?lstab=pending")},a.clickinitiatedn1=function(){a.sanctiondtl=!1,a.initiatedn1=!0,a.courier_info=!1;var t="api/misDataimport/Getsanctionloandetails",e={urn:a.urn};d.getparams(t,e).then(function(t){a.txtdnsanctionref_no=t.data.sanction_refno,a.txtdnsanction_date=t.data.sanction_date,a.txtdnsanction_amount=t.data.sanction_amount,a.txtdnref_no="SAMFIN/RMD/"});var t="api/lglTrnDn2CustomerDetails/template_list";d.get(t).then(function(t){a.template_list=t.data.template_list});var t="api/misDataimport/GetSanctiondtl",e={urn:a.urn};d.getparams(t,e).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn_flag=t.data.dn_flag,"N"==t.data.dn1_flag&&(a.initiatedn1=!0,a.sanctiondtl=!1),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var t="api/lglTrnDn2CustomerDetails/DN1Content",e={urn:a.urn
};d.getparams(t,e).then(function(t){a.content=t.data.template_content}),a.info=!0},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype="",$("#addupload").val("")},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerRetail?lstab=pending"),k()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dnsanctionsubmit=function(){if("guarantor"==a.cbousertype)if(""==a.cboguarantor||void 0==a.cboguarantor)a.Sanctioninfo=!0;else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}else{if(a.Sanctioninfo=!1,"guarantor"==a.cbousertype)var t=a.cboguarantor.name,e=a.cboguarantor.customer2usertype_gid;else var t="",e="";var n={urn:a.urn,dnsanctionref_no:a.txtdnsanctionref_no,dnsanction_date:a.txtdnsanction_date,dnsanction_amount:a.txtdnsanction_amount,dnref_no:a.txtdnref_no,user_type:a.cbousertype,template_type:a.cbotemplate.template_name,template_gid:a.cbotemplate.template_gid,guarantor_name:t,guarantor_gid:e};if(lockUI(),"Legal-DN1"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN1AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN1Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn1ref_no,a.dnsanctionref_no=t.data.dn1sanctionref_no,a.dnsanction_date=t.data.dn1_date,a.dn_type=t.data.dn_type,console.log(t.data.dn1sanction_amount);var e=new Intl.NumberFormat("en-IN").format(t.data.dn1sanction_amount);a.dnsanction_amount=e,a.dn1_flag=t.data.dn1_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn1_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN1Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN2"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN2AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN2Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn2ref_no,a.dnsanctionref_no=t.data.dn2sanctionref_no,a.dnsanction_date=t.data.dn2_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn2sanction_amount);a.dnsanction_amount=e,a.dn2_flag=t.data.dn2_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn2_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN2Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning");else if("Legal-DN3"==a.cbotemplate.template_name)if(void 0!=a.uploadfrm){var o="api/lglTrnDn2CustomerDetails/PostDN3AnnexureUpload";d.postFile(o,a.uploadfrm).then(function(t){var e="api/lglTrnDn2CustomerDetails/PostDN3Sanctiondtl";d.post(e,n).then(function(t){if(unlockUI(),1==t.data.status){var e="api/misDataimport/GetSanctiondtl",n={urn:a.urn};d.getparams(e,n).then(function(t){a.dnref_no=t.data.dn3ref_no,a.dnsanctionref_no=t.data.dn3sanctionref_no,a.dnsanction_date=t.data.dn3_date,a.dn_type=t.data.dn_type;var e=new Intl.NumberFormat("en-IN").format(t.data.dn3sanction_amount);a.dnsanction_amount=e,a.dn3_flag=t.data.dn3_flag,"N"==t.data.dn_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0),"Y"==t.data.dn3_flag&&(a.initiatedn1=!1,a.sanctiondtl=!0)});var e="api/lglTrnDn2CustomerDetails/DN3Content",n={urn:a.urn};console.log(n),d.getparams(e,n).then(function(t){a.content=t.data.template_content}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})})}else unlockUI(),l.alert("Kindly Upload Annexure","warning")}},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no="",$("#addupload").val("")},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=N(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)},a.downloads=function(t,a){y.Downloaddocument(t,a)},a.dn1pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN1pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN1.pdf"),l.alert("DN1 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn2pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN2pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN2.pdf"),l.alert("DN2 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})},a.dn3pdf=function(){var t={urn:a.urn},e="api/misDataimport/DN3pdfcontent";lockUI(),d.getparams(e,t).then(function(t){if(1==t.data.status){var a=t.data.file_path;t.data.file_name;y.Downloaddocument(a,"Report - DN3.pdf"),l.alert("DN3 Report Downloaded Successfully","success")}else unlockUI(),l.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("LglTrnDNTrackerRetailgeneratedcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){a.ShowAllocation360,a.guarantorinfo=!1,a.Sanctioninfo=!1;var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],a.urn=localStorage.getItem("urn"),a.clickrepayment=!1,a.clicktelecall=!1;var n={urn:a.urn},t="api/MstRepayment/GetRepayment";d.getparams(t,n).then(function(t){a.repaymentaccount_list=t.data.repaymentaccount_list,angular.forEach(a.repaymentaccount_list,function(t,a){lockUI();var e={account_no:t.account_no},n="api/MstRepayment/GetRepayment_list";d.getparams(n,e).then(function(a){unlockUI(),t.repayment_list=a.data.repayment_list,t.expand=!1})})});var t="api/MstTelecall/GetTelecall";d.getparams(t,n).then(function(t){a.telecall_list=t.data.telecall_list});var t="api/lglTrnDn2CustomerDetails/Getcustomerupdatedetails",n={urn:a.urn};lockUI(),d.getparams(t,n).then(function(t){a.customerCode=t.data.customerCodeedit,a.customerName=t.data.customerNameedit,a.contactPerson=t.data.contactPersonedit,a.mobileNo=t.data.mobileNo_edit,a.contactno=t.data.contactno_edit,a.email=t.data.emailedit,a.txtaddress1=t.data.addressline1edit,a.txtaddress2=t.data.addressline2edit,a.region=t.data.regionedit,a.country=t.data.countryedit,a.vertical=t.data.vertical_gid,a.vertical_code=t.data.vertical_code,a.statename=t.data.state,a.state_gid=t.data.state_gid,a.riskmanager=t.data.risk_managernameedit,a.district_name=t.data.district_nameedit,a.postalcode=t.data.postalcode_edit,a.tomail=t.data.tomailedit,a.ccmail=t.data.ccmailedit,a.zonalHead=t.data.zonal_name,a.businessHead=t.data.businesshead_name,a.clustermanager=t.data.cluster_manager_name,a.creditmanager=t.data.creditmanager_name,a.relationshipMgmt=t.data.relationshipmgmt_name,a.customerURN=t.data.customer_urnedit,a.pan_number=t.data.pan_number,a.gst_number=t.data.gst_number,a.txtmajor_corporate=t.data.major_corporateedit,a.cboconstitution=t.data.constitution_gidedit,a.cboconstitutionname=t.data.constitution_nameedit,unlockUI()});var t="api/lglTrnDn2CustomerDetails/Getcustomerdetails",n={urn:a.urn};lockUI(),d.getparams(t,n).then(function(t){a.lblpan_number=t.data.pan_no,a.customer2userdtl_list=t.data.customer2userdtl_list,a.address_list=t.data.address_list,a.idproof_list=t.data.idproof_list,a.mobileno_list=t.data.mobileno_list,a.member_list=t.data.member_list,a.lblcustomer_type=t.data.customer_type,a.lblgst_no=t.data.gst_no,a.lblyear_business=t.data.year_business,a.lblcompany_type=t.data.company_type,a.lblcontactperson_designation=t.data.contactperson_designation,a.lblcin_no=t.data.cin_no,a.lblcin_date=t.data.cin_date,a.lbllandmark=t.data.landmark,a.lblmonth_business=t.data.month_business,a.lblcredit_rating=t.data.credit_rating,a.lblescrow=t.data.escrow,a.lblage=t.data.age,a.lblphoto_path=t.data.photo_path,a.lblphoto_name=t.data.photo_name,a.lblaadhar_no=t.data.aadhar_no,a.lblcontact_person=t.data.contact_person,a.lbltelephone_no=t.data.telephone_no,a.lblofficailemail_address=t.data.officailemail_address,a.lblpersonalemail_address=t.data.personalemail_address,a.lblgender=t.data.gender,a.lbldob=t.data.dob,a.lblname=t.data.name,a.lbluser_type=t.data.user_type,unlockUI()});var t="api/lglTrnDn2CustomerDetails/GetGuarantordetails",n={urn:a.urn};lockUI(),d.getparams(t,n).then(function(t){a.additional_list=t.data.customer2userdtl_list});var t="api/lglTrnDn2CustomerDetails/Getsanctionloandetails";d.getparams(t,n).then(function(t){a.sanctiondetails=t.data.sanctionloanListurn,a.sanctionDocument=t.data.upload_listurn;null==t.data.upload_list?a.previstdocumentflag="N":a.previstdocumentflag="Y",angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/lglTrnDn2CustomerDetails/GetloanListDetails";d.getparams(n,e).then(function(a){t.loandetails=a.data.loanListurn,t.expand=!1})})});var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0},k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.urn=localStorage.getItem("urn"),a.history=!1,a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.revert=!0,a.sanctiondtl=!0,a.courier_info=!0;var t="api/misDataimport/getcustomer2Loan";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.mdlMisdataimport,a.customer_name=t.data.customer_name});var t="api/LglTrnDNTrackerVertical/template_content";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.content=t.data.template_content,document.getElementById("test").innerHTML+=a.content,a.dn_status=t.data.dn_status,"DN1 Generated"!=t.data.dn_status&&"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status||(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Sent"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.dn1format=!1,a.button=!0,a.info=!1),"DN2 Generated"!=t.data.dn_status&&"DN3 Generated"!=t.data.dn_status&&"DN2 Sent"!=t.data.dn_status&&"DN3 Sent"!=t.data.dn_status||(a.history=!0),"DN1 Hold"==t.data.dn_status&&(a.dn1format=!1,a.button=!1,a.courier_info=!1,a.info=!0),"DN1 Reverted"==t.data.dn_status&&(a.initiatedn1=!0,a.otherloan=!0,a.click=!0,a.dn1format=!0,a.button=!0,a.courier_info=!1,a.revert=!1)});var t="api/misDataimport/getDN1Status";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dnhistory_list=t.data.dnhistory_list,a.dn2history_list=t.data.dn2history_list,a.dn3history_list=t.data.dn3history_list});var t="api/lglTrnDn2CustomerDetails/GetSkippedHistory";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dnskiphistory_list=t.data.dnskiphistory_list});var t="api/misDataimport/getcourierinfo";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.dncouriered_by=t.data.couriered_by,a.dncourier_center=t.data.courier_center,a.dncourier_date=t.data.courier_date,a.dncourier_refno=t.data.courier_refno,a.dnremarks=t.data.courier_remarks,a.dncourier_status=t.data.dn1courier_status,a.dn2couriered_by=t.data.dn2couriered_by,a.dn2courier_center=t.data.dn2courier_center,a.dn2courier_date=t.data.dn2courier_date,a.dn2courier_refno=t.data.dn2courier_refno,a.dn2remarks=t.data.dn2remarks,a.dn2courier_status=t.data.dn2courier_status,a.dn3couriered_by=t.data.dn3couriered_by,a.dn3courier_center=t.data.dn3courier_center,a.dn3courier_date=t.data.dn3courier_date,a.dn3courier_refno=t.data.dn3courier_refno,a.dn3remarks=t.data.dn3remarks,a.dn3courier_status=t.data.dn3courier_status,"DN1 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.couriered_by,a.dn1courier_center=t.data.courier_center,a.dn1courier_date=t.data.courier_date,a.dn1courier_refno=t.data.courier_refno,a.dn1remarks=t.data.courier_remarks,a.dn1courier_status=t.data.dn1courier_status):"DN2 Sent"==t.data.courier_status?(a.dn1couriered_by=t.data.dn2couriered_by,a.dn1courier_center=t.data.dn2courier_center,a.dn1courier_date=t.data.dn2courier_date,a.dn1courier_refno=t.data.dn2courier_refno,a.dn1remarks=t.data.dn2remarks,a.dn1courier_status=t.data.dn2courier_status):"DN3 Sent"==t.data.courier_status&&(a.dn1couriered_by=t.data.dn3couriered_by,a.dn1courier_center=t.data.dn3courier_center,a.dn1courier_date=t.data.dn3courier_date,a.dn1courier_refno=t.data.dn3courier_refno,a.dn1remarks=t.data.dn3remarks,a.dn1courier_status=t.data.dn3courier_status)});var t="api/misDataimport/Getrevertdetails";lockUI();var n={urn:a.urn};d.getparams(t,n).then(function(t){unlockUI(),a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.dn_status=t.data.dn_status,a.remarks=t.data.remarks}),a.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var o={customer_gid:localStorage.getItem("allocation_customer_gid")};a.allocation_customer_gid=o,console.log(o);var t="api/allocationManagement/getAllocationHistory";d.getparams(t,o).then(function(t){console.log("allocation history",t),a.allocationHistoryList=t.data.overallhistoryallocationdtl,console.log(t.data.overallhistoryallocationdtl),a.customername=t.data.overallhistoryallocationdtl[0].customername,a.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn});var r={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},t="api/allocationManagement/getallocatedtls";d.getparams(t,r).then(function(t){a.zonal_name=t.data.zonal_name,a.state_name=t.data.state_name,a.district_name=t.data.district_name,a.assigned_RM=t.data.assigned_RM,a.customername=t.data.customername,a.customer_urn=t.data.customer_urn,a.ZonalRMname=t.data.ZonalRMname,a.clientName=t.data.customername});var t="api/visitReport/GetAllocationLogDetail";d.getparams(t,r).then(function(t){a.scheduleList=t.data.schedulelogdtl,a.calllogdtlList=t.data.calllogdtl});var t="api/allocationManagement/GetAllocationCustomerDtl";d.getparams(t,r).then(function(t){a.customerdetails=t.data,a.sanctiondetails=t.data.loandtl,a.customerCollateral=t.data.collateraldtl,a.holdallocationlist=t.data.holdallocation,a.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),a.customerPromotorlist=t.data.Promoterdtl,angular.forEach(a.sanctiondetails,function(t,a){var e={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},n="api/allocationManagement/GetAllocateloanList";d.post(n,e).then(function(a){t.loandetails=a.data.loanList,t.expand=!1})})});var t="api/customerManagement/HistoryEscrowSummary";d.getparams(t,r).then(function(t){1==t.data.status&&(a.escrowlist=t.data.escrowSummary)});var t="api/allocationManagement/getAllocationdocument";d.getparams(t,r).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(a.upload_list=t.data.upload_list,a.documentUpload=!0):a.documentNotUpload=!0});var t="api/visitReport/getvisitreportdtl";d.getparams(t,r).then(function(t){if(a.visitreport_generateGid=t.data.visitreport_generateGid,a.customer_gid=t.data.customer_gid,a.txtbusiness_vintage=t.data.business_vintage,a.cbotypeof_loan=t.data.typeof_loanvertical,a.txtbusiness_sector=t.data.business_sector,a.txtregister_address=t.data.registeredoffice_address,a.cboriskcode=t.data.risk_code,a.txtactual_address=t.data.present_address,a.txtcontact_dtl1=t.data.contact_details1,a.txtcontact_dtl2=t.data.contact_details2,a.cborisk_reviewtype=t.data.typeof_riskreview,a.txtlattitude=t.data.visit_latitude,a.txtlongitude=t.data.visit_longitude,a.txtbusiness_client=t.data.clientbusiness_vintage,a.txtprimary_chain=t.data.primarysecondary_valuechain,a.cbogenetic_code=t.data.geneticcode_complied,a.cboRMD_gid=t.data.RMD_visitedGid,a.RMD_visitedname=t.data.RMD_visitedname,a.txtPPA_name=t.data.PPA_name,a.cbovisit_done=t.data.visit_done,a.txtpurposeof_loan=t.data.purpose_ofloan,a.txtrequestedloan_byclient=t.data.requestedamount_byclient,a.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,a.txtdisbursement_amount=t.data.disbursement_amount,a.txttotalloan_oustanding=t.data.totalloan_outstanding,a.cborepayment_track=t.data.repayment_track,a.cbobasic_records=t.data.basicrecords_maintain,a.txtturnover_lastfy=t.data.turnover_lastFY,a.txtpresent_fysales=t.data.presentFY_sales,a.txtdeferral_pendency=t.data.deferral_pendency,a.txtadditional_funding=t.data.adequacy_additionalfunding,a.txtcbototal_groups=t.data.total_noofGroups,a.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,a.txtRMDvisit_groupcount=t.data.RMD_visitgroups,a.txtassetverification_comment=t.data.assetverification_createdoutofloan,a.txtsecurity_details=t.data.assetverification_securitydtls,a.txtassetverification_mortagged=t.data.assetverification_mortgaged,a.txtROCcreation=t.data.assetverification_ROCcreation,a.txtbasicrecord_remarks=t.data.basicrecords_remarks,a.txtpurpose_funding=t.data.purposeof_funding,a.txt_utilisationdtls=t.data.utilisation_details,a.txtadequacyloan_samunnati=t.data.adequacy_loanamount,a.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,a.txtportfolio_noofmember=t.data.portfolio_noofmembers,a.txtportfolio_activemembers=t.data.portfolio_activemembers,a.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,a.txtportfolio_outstandingdate=t.data.outstanding_ondate,a.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,a.txtportfolio_overdueAmount=t.data.overdue_amount,a.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtsanctioned_limit=t.data.sanctioned_limit,a.txttenure_period=t.data.tenure_period,a.txtrepayment_trackremarks=t.data.repayment_trackremarks,a.txtoverdue=t.data.overdue,a.txtborrower_commitment=t.data.borrower_commitment,a.txtpending_documentation=t.data.pending_documentation,a.txtbriefdtls_client=t.data.briefdtls_client,a.txtenduse_loan=t.data.enduse_loan,a.txtoverall_remarks=t.data.overall_remarks,a.txtPDD_compliance=t.data.PDD_compliance,a.txtbriefrpt_financials=t.data.briefrpt_financials,a.txtbriefrpt_process=t.data.briefrpt_process,a.txtbriefrpt_customer=t.data.briefrpt_customer,a.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,a.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,a.txtbriefrpt_learnings=t.data.briefrpt_learnings,a.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,a.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(a.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(a.constitution=t.data.constitution),null!=t.data.credit_managername&&(a.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var e=t.data.visit_date.split(/\D/g);a.visitdate=[e[2],e[1],e[0]].join("-")}if(null!=t.data.dealing_withsince){var e=t.data.dealing_withsince.split(/\D/g);a.txtincorporated_date=[e[2],e[1],e[0]].join("-")}if(null!=t.data.disbursement_date){var e=t.data.disbursement_date.split(/\D/g);a.txtdisbursement_date=[e[2],e[1],e[0]].join("-")}});var t="api/visitReport/getvisitReportDocument";d.getparams(t,r).then(function(t){a.visitreportdocument=t.data.visitreportdocument});var t="api/visitReport/getvisitReportPhoto";d.getparams(t,r).then(function(t){a.visitreportphoto=t.data.visitreportphoto});var t="api/TierMeeting/GetViewTierObservationdtl";d.getparams(t,r).then(function(t){a.customer_name=t.data.customer_name,a.customer_urn=t.data.customer_urn,a.dateof_RMDvisit=t.data.dateof_RMDvisit,a.report_pertainingto=t.data.report_pertainingto,a.vertical=t.data.vertical,a.disbursement_amount=t.data.disbursement_amount,a.approving_authority=t.data.approving_authority,a.loansanction_date=t.data.loansanction_date,a.relationship_manager_name=t.data.relationship_manager_name,a.PPA_name=t.data.PPA_name,a.RMDvisit_officialname=t.data.RMDvisit_officialname,a.loandisbursement_date=t.data.loandisbursement_date,a.people_accompaniedRMD=t.data.people_accompaniedRMD,a.sanction_amount=t.data.sanction_amount,a.outstanding_amount=t.data.outstanding_amount,a.current_DPD=t.data.current_DPD,a.contact_details1=t.data.contact_details1,a.contact_details2=t.data.contact_details2,a.observation_flag=t.data.observation_flag,a.cboriskcode=t.data.risk_code,a.criticalobservation=t.data.criticalTierobservation,a.tiercodedtl=t.data.tierReportdtl,unlockUI()});var i={tier1format_gid:localStorage.getItem("tier1format_gid")},t="api/TierMeeting/GetTier1Format360Dtl";d.getparams(t,i).then(function(t){a.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(a.cboriskcode=t.data.tier1_code),a.txtrationale_justification=t.data.tier1_justification,a.txtprocess_gap=t.data.tier1_processgap,a.txtcode_changereason=t.data.tier1code_changereason,a.tier1code_changeflag=t.data.tier1code_changeflag,a.txtimprovement_recommendation=t.data.tier1_processrecommendation,a.txtmanagement_comments=t.data.tier1_managementcomments,a.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,a.txtATR_date=t.data.tier1_atrdate,a.tier1format_gid=t.data.tier1format_gid,a.tier1_approvalstatus=t.data.tier1_approvalstatus,a.tier1approvallog=t.data.tier1approvallog,"Y"==a.tier1code_changeflag?a.disablecodechangereasonshow=!0:a.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?a.nohistoryapproval=!0:a.historyapproval=!0});var t="api/TierMeeting/GetTier2Report360Dtl";d.getparams(t,r).then(function(t){console.log(t),a.tier2zonal_name=t.data.zonal_name,a.tier2_monthname=t.data.tier2_monthname,a.vertical=t.data.vertical,a.headRMD_name=t.data.headRMD_name,a.txttier2_remarks=t.data.tier2_remarks,a.tier2_approval_status=t.data.tier2_approval_status,a.tier2_submitteddate=t.data.created_date,a.tier2_submittedby=t.data.created_by,a.uploaddocument2_list=t.data.tier2document,a.tier2approvallog=t.data.tier2approvallog,a.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?a.tier2nohistoryapproval=!0:a.tier2historyapproval=!0,unlockUI()});var t="api/TierMeeting/GetTier3Report360Dtl";d.getparams(t,r).then(function(t){a.mlrc_date=t.data.MLRC_date,a.monthname=t.data.tier3_month,a.txttier3_followup=t.data.follow_up,a.tier3_status=t.data.tier3_status,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.uploaddocument3_list=t.data.tier3document,a.completed_date=t.data.completed_date,a.completed_by=t.data.completed_by,a.completed_flag=t.data.completed_flag,a.completed_remarks=t.data.completed_remarks,a.vertical=t.data.vertical,unlockUI()})}function b(t){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],e=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=t.toString();if(n=n.replace(/[\, ]/g,""),n!=parseFloat(n))return"";if((t=t.toString()).length>9)return"Overflow";var o=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(o){var r="";return r+=0!=o[1]?(a[Number(o[1])]||e[o[1][0]]+" "+a[o[1][1]])+"Crore ":"",r+=0!=o[2]?(a[Number(o[2])]||e[o[2][0]]+" "+a[o[2][1]])+"Lakh ":"",r+=0!=o[3]?(a[Number(o[3])]||e[o[3][0]]+" "+a[o[3][1]])+"Thousand ":"",r+=0!=o[4]?(a[Number(o[4])]||e[o[4][0]]+" "+a[o[4][1]])+"Hundred ":"",r+=0!=o[5]?(""!=r?"and ":"")+(a[Number(o[5])]||e[o[5][0]]+" "+a[o[5][1]])+"only ":""}}var k=this;k.title="dnskippedontroller",y(),a.viewrepayment=function(t){function a(a,e){var n={repyment_gid:t};console.log(n);var o="api/MstRepayment/GetRepayment_info";d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.repayment_date=t.data.repayment_date,a.transaction_date=t.data.transaction_date,a.transaction_id=t.data.transaction_id,a.repayment_amount=t.data.repayment_amount,a.principal=t.data.principal,a.normal_interest=t.data.normal_interest,a.penal_interest=t.data.penal_interest,a.for_feiture_waiver=t.data.for_feiture_waiver,a.user_id=t.data.user_id,a.instrument=t.data.instrument,a.repayment_type=t.data.repayment_type,a.dpd=t.data.dpd,a.old_dpd=t.data.old_dpd,a.account_code=t.data.account_code,a.interest_tds=t.data.interest_tds,a.remarks=t.data.remarks,a.URN=t.data.URN}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewrepayment.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.viewtelecall=function(t){function a(a,e){var n={telecall_gid:t};console.log(n);var o="api/MstTelecall/GetTelecall_info";lockUI(),d.getparams(o,n).then(function(t){a.account_no=t.data.account_no,a.start_time=t.data.start_time,a.completetion_time=t.data.completetion_time,a.email_address=t.data.email_address,a.name=t.data.name,a.relationship=t.data.relationship,a.customer_name=t.data.customer_name,a.typeof_call=t.data.typeof_call,a.call_details=t.data.call_details,a.spoken_to=t.data.spoken_to,a.natureof_business=t.data.natureof_business,a.reason_OD=t.data.reason_OD,a.telecall_status=t.data.telecall_status,a.courseof_action=t.data.courseof_action,a.ptp_date=t.data.ptp_date,a.ptp_amount=t.data.ptp_amount,a.remarksby_telecaller=t.data.remarksby_telecaller,a.followup_date=t.data.followup_date,a.ledger_balance=t.data.ledger_balance,a.total_demand_due=t.data.total_demand_due,a.URN=t.data.URN,
console.log(t.data.URN),unlockUI(),console.log(t.data.completetion_time)}),a.ok=function(){e.close("account_no")}}e.open({templateUrl:"/viewtelecall.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},a.Repayment=function(){a.clickrepayment=!0,a.clicktelecall=!1},a.telecall=function(){a.clicktelecall=!0,a.clickrepayment=!1},a.viewcustomerdtl=function(t,e){c.hash("down"),h(),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e),a.ShowAllocation360=!0},a.closeAllocation=function(){a.ShowAllocation360=!1},a.onselectedchangeusertype=function(){if(console.log(a.cbousertype),"guarantor"==a.cbousertype){a.guarantorinfo=!0;var t={urn:localStorage.getItem("urn")},e="api/lglTrnDn2CustomerDetails/GetGuarantorlist";d.getparams(e,t).then(function(t){a.guarantor_list=t.data.customer2userdtl_list})}else a.guarantorinfo=!1},a.checkall=function(t){angular.forEach(a.documentlist_gid,function(a){a.checked=t})},a.DN1send=function(){lockUI();var t="api/misDataimport/DN1Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN1 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN1 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN2send=function(){lockUI(),console.log("dn2");var t="api/misDataimport/DN2Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN2 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN2 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN3send=function(){lockUI();var t="api/misDataimport/DN3Status",e={urn:a.urn,courier_refno:a.txtcourierefno,courier_center:a.txtcouriercenter,courier_date:a.txtcourierdate,couriered_by:a.txtcourierby,courier_remarks:a.txtcourieredremarks};d.post(t,e).then(function(t){unlockUI(),1==t.data.status?l.alert("DN3 Status Updated Successfully","success"):l.alert("Error Occurred While Updating DN3 Status "),c.url("app/lglTrnDNTrackerFPO?lstab=pending")}),a.courier_info=!1,a.info=!0},a.DN1skip=function(){var t="api/misDataimport/DN1skip",e={urn:a.urn};d.post(t,e).then(function(t){1==t.data.status?(y(),l.alert("DN1 Status Updated Successfully","success")):l.alert("Error Occurred While Updating DN1 Status "),y()})},a.Dn1back=function(){"others"==a.relpath1?c.url("app/lglTrnDNTrackerOthers?lstab=pending"):"retail"==a.relpath1?c.url("app/lglTrnDNTrackerRetail?lstab=pending"):"FPO"==a.relpath1?c.url("app/lglTrnDNTrackerFPO?lstab=pending"):"CBO"==a.relpath1?c.url("app/lglTrnDNTrackerCBO?lstab=pending"):"AE"==a.relpath1&&c.url("app/LglTrnDNTrackerAE?lstab=pending")},a.close=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1},a.cancel=function(){var t="api/lglTrnDn2CustomerDetails/DN1Cancel",e={urn:a.urn};d.getparams(t,e).then(function(t){l.alert("Sanction Information canceled",{status:"info",pos:"top-center",timeout:3e3})}),a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.cbousertype=""},a.revert=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.revert_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/RevertDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/revertdn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.hold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.hold_yes=function(){var n={urn:t,remarks:a.txtremarks};console.log(n);var o="api/misDataimport/HoldDN1";lockUI(),d.post(o,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/holddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.unhold=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.unhold_yes=function(){var a={urn:t};console.log(a);var n="api/misDataimport/UnholdDN1";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed")):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),c.url("app/lglTrnDNTrackerFPO?lstab=pending"),y()})}}e.open({templateUrl:"/unholddn.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.dn1cancel=function(){a.courier_info=!1,a.initiatedn1=!0,a.sanctiondtl=!0,a.info=!1,a.txtdnsanctionref_no="",a.txtdnsanction_date="",a.txtdnsanction_amount="",a.txtdnref_no=""},a.amountschange=function(){var t=document.getElementById("txtInput").value,e=t.replace(/,/g,""),n=Number(e).toLocaleString("en-IN"),o=b(e);"NaN"==n?(l.alert("Accept Numeric Only..!",{status:"danger",pos:"top-center",timeout:3e3}),a.txtdnsanction_amount=""):(document.getElementById("sanctionamount_words").innerHTML=o,a.txtdnsanction_amount=n)}}angular.module("angle").controller("dnskippedontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","$anchorScroll"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u){function m(){var t={caseref_gid:localStorage.getItem("caseref_gid")},e="api/LawyerInvoice/GetinvoiceListSummary";s.getparams(e,t).then(function(t){a.invoicelist=t.data.invoicedtl,a.caseref_no=t.data.caseref_no,a.case_type=t.data.case_type})}var p=this;p.title="LglTrnInvoiceSummary",m(),a.viewinvoice=function(t){localStorage.setItem("lawyerinvoicedtl_gid",t),e.go("app.lawyerPaymentView")},a.back=function(){e.go("app.lawyerPayment")}}angular.module("angle").controller("LglTrnInvoiceSummary",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){lockUI();var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],console.log(a.relpath1),a.lawyerdocumentdetails=!1,a.click=!0,a.seeklawyer=!1;var t="api/requestCompliance/compliancemanagement360",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(t,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.assign_lawyergid=t.data.assign_lawyergid,a.assign_lawyername=t.data.assign_lawyername,a.assign_mobileno=t.data.assign_mobileno,a.assign_emailaddress=t.data.assign_emailaddress,a.assignedlawyer_by=t.data.assigned_by,a.seeklawyer_remarks=t.data.seeklawyer_remarks,a.assigned_date=t.data.assigned_date,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by,a.designation_name=t.data.designation_name,a.department_name=t.data.department_name,a.branch_name=t.data.branch_name,a.employee_photo=t.data.employee_photo,a.txtremarks=t.data.remarks,a.list=t.data.document_list,a.seeklawyerdocument=t.data.uploadseek_list,"---"!=t.data.correctedfile_name&&(a.updated_download=!0),console.log(t.data.requestref_no)});var t="api/requestCompliance/querieslist";d.getparams(t,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()});var t="api/requestCompliance/lawyerList";d.getparams(t,n).then(function(t){a.assignlawyerlist=t.data.assignlawyer});var t="api/requestCompliance/getcorrecteddocument";d.getparams(t,n).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,unlockUI()});var t="api/requestCompliance/Gettaggedlist";d.getparams(t,n).then(function(t){a.taggedlist=t.data.taggedinfo_list})}var b=this;b.title="compliance2tagginglawyercontroller",y(),a.viewdocument=function(t,e){var n={requestcompliance2lawyerdtl_gid:t},o="api/requestCompliance/Viewuploaddoc_lawyer";d.getparams(o,n).then(function(n){console.log(n.data.taggeddoc_list),a.taggedlist[e][t]=n.data.taggeddoc_list})},a.downloads=function(t,a){var e=t,n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()},a.downloadscorrected=function(t,a){var e=t,n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()},a.updateddoc_downloads=function(t,a){var e=t,n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()},a.assignLawyerSubmit=function(){function t(t,a){t.lawyeruser_name=o,t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),r.append("project_flag","Default"),t.uploadfrm=r;var i="api/requestCompliance/seekLawyerUpload";d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpseek_documentgid:a},n="api/requestCompliance/seekLawyerUploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){lockUI();var a={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),lawyeruser_gid:n,seeklawyerremarks:t.seeklawyerremarks},e="api/requestCompliance/assignLawyer";d.post(e,a).then(function(a){unlockUI(),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(a.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),t.ok(),y()})}}var n=a.cboassignlawyer,o=$("#assignlawyer :selected").text(),r=({requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),lawyeruser_gid:a.cboassignlawyer},"api/requestCompliance/tmpseekdocumentclear");d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]},a.requestback=function(t){c.url("app/complianceManagement?lstab="+t)},a.delete_correcteddoc=function(t){var e={uploaddocument_gid:t},n="api/requestCompliance/correcteddoc_delete";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),y()})},a.upload_document=function(t,a,o){function r(t,a){t.ok=function(){a.close("closed")},t.uploaddoc=function(a,e,n){var r={name:a[0].name,file:a[0],uploaddocument_gid:o},i=new FormData;i.append("fileupload",r.file),i.append("file_name",r.name),i.append("uploaddocument_gid",o),i.append("remarks",t.remarks),i.append("project_flag","Default"),t.uploadfrm=i},t.documentupload=function(){var e={uploadeddocument_type:t.document_type,uploadremarks:t.txtcorrected_remarks,uploaddocument_gid:o};console.log(e);var r="api/requestCompliance/uploadCorrectedDoc";lockUI(),d.postFile(r,t.uploadfrm).then(function(a){t.upload_list=a.data.upload_list,$("#addupload").val(""),1==a.data.status?(unlockUI(),l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported!")),y()});var r="api/requestCompliance/uploadremarrks";lockUI(),d.post(r,e).then(function(t){1==t.data.status?(unlockUI(),y(),n.go("app.requestCompliance360"),a.close("closed"),y()):unlockUI(),y()})}}e.open({templateUrl:"/uploadcorrecteddocument.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},a.sendclick=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),queries:a.txtqueries};lockUI();var e="api/requestCompliance/sendqueries";d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e="api/requestCompliance/querieslist",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(e,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()}),l.alert("Query sent Successfully","success"),a.txtqueries=""}else l.alert("Error Occurred","warning")})},a.cancelclick=function(){a.txtqueries=""},a.cancelassignLawyer=function(){a.cboassignlawyer="",a.seeklawyer=!1},a.lawyerdocument_details=function(){a.lawyer_document=!0,a.lawyerdoc=!0,a.click=!1},a.minimizedoc=function(){a.lawyer_document=!1,a.lawyerdoc=!1,a.click=!0},a.seeklawyeropinion=function(){a.seeklawyer=!0},a.updatestatus=function(t){function a(a,e){a.ok=function(){e.close("closed")};var n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};lockUI();var o="api/requestCompliance/compliancemanagement360";d.getparams(o,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by}),a.submit=function(){var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),y()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),y()}),e.close("closed")}}e.open({templateUrl:"/statusupdation.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=h.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("requestcompliance_gid",a.requestcompliance_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/UploadComplianceCorrected_doc";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.UploadDocumentList=t.data.Managecomplianuploaddoc_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,l.alert(t.data.message,"success")):(unlockUI(),l.alert(t.data.message))})},a.deletedocument=function(t){var e={document_gid:t};console.log(e);var n="api/requestCompliance/deletecorrecteddo_upload";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.UploadDocumentList,function(e,n){e.document_gid==t&&a.UploadDocumentList.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),y()})},a.correcteddoc_submit=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},e="api/requestCompliance/submitComplianceCorrected_doc";lockUI(),d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/getcorrecteddocument";d.getparams(n,e).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,a.UploadDocumentList=t.data.uploaddoc_list,unlockUI()}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),y()}else l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},a.downloadsdocument=function(t,a){var e=t;console.log(t),console.log(a);var n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o),d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()}}angular.module("angle").controller("compliance2tagginglawyercontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.totalDisplayed=100;var t="api/requestCompliance/getrequesttype";d.get(t).then(function(t){a.requesttype_list=t.data.requesttype_list,a.total=a.requesttype_list.length})}var y=this;y.title="requesttypecontroller",h(),document.getElementById("pagecount").onkeyup=function(){if(null==a.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},a.loadMore=function(t){lockUI();var e=parseInt(t);a.totalDisplayed+=e,unlockUI()},a.popuprequesttype=function(){function t(t,a){t.ok=function(){a.close("closed")},t.requestSubmit=function(){var e={request_type:t.txtrequesttype,request_code:t.txtrequestcode};console.log(e);var n="api/requestCompliance/postrequesttype";d.post(n,e).then(function(t){1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(a.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}))})}}e.open({templateUrl:"/addrequesttype.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},a.edit=function(t){function n(a,e){var n={requesttype_gid:t},o="api/requestCompliance/editrequesttype";d.getparams(o,n).then(function(t){a.txtrequestcodeedit=t.data.request_code,a.txtrequesttypeedit=t.data.request_type,a.requesttype_gid=t.data.requesttype_gid}),a.ok=function(){e.close("closed")},a.cancel=function(){e.dismiss("cancel")},a.requestUpdate=function(){var n={request_code:a.txtrequestcodeedit,request_type:a.txtrequesttypeedit,requesttype_gid:t},o="api/requestCompliance/updaterequesttype";d.post(o,n).then(function(t){1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h())})}}e.open({templateUrl:"/editrequesttype.html",controller:n,size:"md"});a.requesttype_gid=t,n.$inject=["$scope","$modalInstance"]},a["delete"]=function(t){var a={requesttype_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var e="api/requestCompliance/deleterequesttype";d.getparams(e,a).then(function(t){1==t.data.status?h():(l.alert("Error Occurred !",{status:"warning",pos:"top-right",timeout:3e3}),h())}),o.swal("Deleted Successfully!")}})}}angular.module("angle").controller("requesttypecontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.totalDisplayed=100;var t="api/lglMstServiceType/getservicetype";d.get(t).then(function(t){a.servicetype_list=t.data.servicetype_list,a.total=a.servicetype_list.length})}var y=this;y.title="servicetypecontroller",h(),document.getElementById("pagecount").onkeyup=function(){if(null==a.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},a.loadMore=function(t){lockUI();var e=parseInt(t);a.totalDisplayed+=e,unlockUI()},a.popupservicetype=function(){function t(t,a){t.ok=function(){a.close("closed")},t.Submit=function(){var e={service_type:t.txtservicetype,service_code:t.txtservicecode};console.log(e);var n="api/lglMstServiceType/postservicetype";d.post(n,e).then(function(t){1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(a.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}))})}}e.open({templateUrl:"/addservicetype.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},a.edit=function(t){function n(a,e){var n={servicetype_gid:t},o="api/lglMstServiceType/editservicetype";d.getparams(o,n).then(function(t){a.txtservicecodeedit=t.data.service_code,a.txtservicetypeedit=t.data.service_type,a.servicetype_gid=t.data.servicetype_gid}),a.ok=function(){e.close("closed")},a.cancel=function(){e.dismiss("cancel")},a.Update=function(){var n={service_code:a.txtservicecodeedit,service_type:a.txtservicetypeedit,servicetype_gid:t},o="api/lglMstServiceType/updateservicetype";d.post(o,n).then(function(t){1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h())})}}e.open({templateUrl:"/editservicetype.html",controller:n,size:"md"});a.servicetype_gid=t,n.$inject=["$scope","$modalInstance"]},a["delete"]=function(t){var a={servicetype_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var e="api/lglMstServiceType/deleteservicetype";d.getparams(e,a).then(function(t){1==t.data.status?(h(),l.alert("Deleted Successfully",{status:"warning",pos:"top-center",timeout:3e3})):(l.alert("Error Occurred !",{status:"warning",pos:"top-center",timeout:3e3}),h())}),o.swal("Deleted Successfully!")}})}}angular.module("angle").controller("servicetypecontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){lockUI();var t="api/misDataimport/Getmisdata";d.get(t).then(function(t){unlockUI(),a.imported_list=t.data.imported_list,a.show=!0})}var y=this;y.title="misDataimportcontroller",h(),a.openpanel=function(){a.show=!1,a.options=!0},a.cancel=function(){a.show=!0,a.options=!1,$("#addupload").val("")},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",a.documentname),r.append("project_flag","Default"),a.uploadfrm=r},a.handleFile=function(){var t="api/misDataimport/mistempdataupload";lockUI(),d.postFile(t,a.uploadfrm).then(function(t){a.options=!1,$("#addupload").val(""),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),h()})},a.viewloandetails=function(t){a.urn=t,a.urn=localStorage.setItem("urn",t),n.go("app.customer2misdata")},a.processdata=function(t){function a(a,e){var n={misdocumentimport_gid:t};console.log(n);var o="api/misDataimport/Getimporteddata";d.getparams(o,n).then(function(t){a.file_name=t.data.file_name,a.imported_date=t.data.imported_date}),a.ok=function(){e.close("closed")},a.process=function(){var a={misdocumentimport_gid:t},n="api/misDataimport/processdata";lockUI(),d.post(n,a).then(function(t){unlockUI(),1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h())})}}e.open({templateUrl:"/processdata.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("misDataimportcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u){function m(){a.master=!0,a.legalsr=!0,a.misdataimport=!0;var t="api/optDashboard/getprivilegeGID";lockUI(),s.get(t).then(function(t){unlockUI(),null!=t.data.master_list?(1==t.data.master_list.length&&("OPTMSTADM"==t.data.master_list[0].Gid?(a.master=!1,a.misdataimport=!1):a.misdataimport=!0,"OPTMSTLSR"==t.data.master_list[0].Gid?(a.master=!1,a.legalsr=!1):a.legalsr=!0),2==t.data.master_list.length&&("OPTMSTADM"==t.data.master_list[0].Gid||"OPTMSTADM"==t.data.master_list[1].Gid?(a.master=!1,a.misdataimport=!1):a.misdataimport=!0,"OPTMSTLSR"==t.data.master_list[1].Gid||"OPTMSTLSR"==t.data.master_list[1].Gid?(a.master=!1,a.legalsr=!1):a.legalsr=!0)):(a.master=!0,a.misdataimport=!0,a.legalsr=!0)})}var p=this;p.title="optDashboardcontroller",m(),a.misdataImport=function(){e.go("app.misDataimport")},a.legalSR=function(){e.go("app.legalSRsummary")}}angular.module("angle").controller("optDashboardcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p){function _(){g.open=function(t){t.preventDefault(),t.stopPropagation(),g.opened=!0},a.borrwer_dtl=!1,a.customer_dtl=!1,a.customer_panel=!1,a.loan_dtl=!1,g.close=function(t){t.preventDefault(),t.stopPropagation(),g.closed=!0},g.dateOptions={formatYear:"yy",startingDay:1};var t="api/raiseLegalSR/Customer";d.get(t).then(function(t){a.customer_list=t.data.customer_list})}var g=this;g.title="raiselegalSRcontroller",_(),a.legalSRback=function(t){c.url("app/requestCompliancesummary?lstab=legalsr")},a.onselectedchangecustomer=function(t){a.customer_gid=localStorage.setItem("onchangecustomer_gid",t);var e={customer_gid:a.cbocustomergid.customer_gid},n="api/raiseLegalSR/Getcustomerdtl";d.getparams(n,e).then(function(t){a.address=t.data.address,a.email=t.data.email_id,a.mobileno=t.data.mobile_no,console.log(t.data.mobile_no)}),a.borrwer_dtl=!0,a.customer_dtl=!0,a.customer_panel=!0,a.loan_dtl=!0,a.rm_dtl=!0},a.addfacility=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.customerfacilitySubmit=function(){var n={facility_type:a.txtfacility,limit:a.txtlimit,outstanding:a.txtoutstanding,customer_gid:t},o="api/raiseLegalSR/facility";d.post(o,n).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed");var n={customer_gid:localStorage.getItem("onchangecustomer_gid")};test();var o="api/raiseLegalSR/getfacilitydtl";d.getparams(o,n).then(function(t){a.facility_list=t.data.facility_list})}else l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3})})}}n.open({templateUrl:"/facilities.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]};var f={customer_gid:localStorage.getItem("onchangecustomer_gid")},v="api/raiseLegalSR/getfacilitydtl";d.getparams(v,f).then(function(t){a.facility_list=t.data.facility_list}),a.legalsrsubmit=function(t){var e=$("#customername :selected").text(),n={customer_gid:a.cbocustomergid.customer_gid,account_name:e,remarks:a.txtremarks},o="api/raiseLegalSR/raiselegalsr";lockUI(),d.post(o,n).then(function(t){1==t.data.status?(unlockUI(),_(),c.url("app/requestCompliancesummary?lstab=legalsr"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),_()})}}angular.module("angle").controller("raiselegalSRcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],a.templegalsr_gid=c.search().lstemplegalsr_gid,a.customer_gid=c.search().lscustomer_gid;var n={templegalsr_gid:a.templegalsr_gid,customer_gid:a.customer_gid},o={customer_gid:a.customer_gid},t="api/raiseLegalSR/getdeletetempcontRM";d.get(t).then(function(t){});var t="api/raiseLegalSR/gettemprmdtl";d.getparams(t,n).then(function(t){a.contactdetailsRM=t.data.contactdetailsRM});var t="api/raiseLegalSR/Getpromoter";d.getparams(t,n).then(function(t){a.promoters_list=t.data.promoter_list});var t="api/CustomerReport/Getsanctionloandetails";d.getparams(t,o).then(function(t){a.sanction_list=t.data.sanctionloanListurn,angular.forEach(a.sanction_list,function(t,a){var e={sanction_gid:t.sanction_gid},n="api/CustomerReport/GetloanFacilityDetails";d.getparams(n,e).then(function(a){t.loanfacilitytype=a.data.loanfacilitytype_list,t.expand=!1})})});var t="api/raiseLegalSR/Getguarantor";d.getparams(t,n).then(function(t){a.guarantors_list=t.data.guarantor_list,a.remarks=t.data.remarks});var t="api/customerManagement/getCollateraldetail";d.getparams(t,n).then(function(t){a.customerCollateral=t.data.customerCollateral});var t="api/raiseLegalSR/Getcustomerdetails";d.getparams(t,n).then(function(t){a.customerdetails=t.data});var t="api/raiseLegalSR/getlegalSRcontactdtl";d.getparams(t,n).then(function(t){a.contactdetailsRM=t.data.contactdetailsRM});var t="api/raiseLegalSR/getfacilitydtl";d.getparams(t,n).then(function(t){a.facility_list=t.data.facility_list});var t="api/raiseLegalSR/Getcustomerdtl";d.getparams(t,n).then(function(t){a.address=t.data.address,a.email=t.data.email_id,a.deal_year=t.data.deal_year});var t="api/raiseLegalSR/GetTempLegalSRdtls";d.getparams(t,n).then(function(t){a.legalSR_gid=t.data.legalSR_gid,a.raiselegalSR_gid=t.data.raiselegalSR_gid,a.account_name=t.data.account_name,a.rdbfinanced_by=t.data.financed_by,a.cboconstitution=t.data.constitution,a.deal_year=t.data.deal_year,a.txtcycles_date=t.data.cycles_sanctiondated,a.txtlimit_lastsanctioned=t.data.limit_sanction,a.txtbusiness_activity=t.data.business_activity,a.txtprimary_securities=t.data.primary_securities,a.txtcollateral_securities=t.data.collateral_securities,a.txtdetail_udc_pdc=t.data.details_UDC_PDC,a.txtunitworking_status=t.data.unit_working_status,a.txtother_banker=t.data.txtother_banker,a.txtbanker_exposures=t.data.other_banker_exposures,a.txtoverdue=t.data.status_current_overdue,a.txtcibil_data=t.data.cibil_data,a.txtchuring_data=t.data.churing_account,a.txtcompanies_dtl=t.data.other_group_companies,a.txtmeeting_dtl=t.data.meeting_details,a.rdbsrestructring=t.data.restructuring_data,a.txtother_banker=t.data.other_banker_borrower,a.txtptp=t.data.instances_PTP,a.txtlegalstatus=t.data.statuslegal_action,a.txtdemanddetails=t.data.demandnotice_details,a.created_date=t.data.created_date,a.remarks=t.data.remarks,a.auth_status=t.data.auth_status,a.auth_remarks_list=t.data.auth_remarks_list,a.created_date=t.data.created_date,a.created_by=t.data.created_by,a.auth_status=t.data.auth_status});var t="api/CustomerDashboard/Getcustomerloandetails";d.getparams(t,n).then(function(t){a.loandetails=t.data.loandtl;
});var t="api/raiseLegalSR/GetDemandNoticedtl";d.getparams(t,n).then(function(t){a.demandnotice_list=t.data.demandnotice_list,a.demand_status=t.data.demand_status});var t="api/raiseLegalSR/Getsanctionloandtl";d.getparams(t,n).then(function(t){a.sanctiondetails=t.data.customer2loandtl});var t="api/customer/Getconstitution";d.get(t).then(function(t){a.cboconstitution_list=[];for(var e=0;e<t.data.constitution_list.length;e++)a.cboconstitution_list.push(t.data.constitution_list[e].constitution_name)})}function y(){var t={customer_gid:a.customer_gid},e="api/raiseLegalSR/getlegalSRtmpcontactdtl";d.getparams(e,t).then(function(t){a.contactdetailsRM=t.data.contactdetailsRM})}var b=this;b.title="raisesr2authenticationController",h(),a.legalsrsave=function(t){var e={templegalsr_gid:t,account_name:a.customer_name,constitution:a.cboconstitution,financed_by:a.rdbfinanced_by,deal_year:a.deal_year,address:a.address,business_activity:a.txtbusiness_activity,email_id:a.email,cycles_sanctiondated:a.txtcycles_date,limit_sanction:a.txtlimit_lastsanctioned,primary_securities:a.txtprimary_securities,collateral_securities:a.txtcollateral_securities,details_UDC_PDC:a.txtdetail_udc_pdc,unit_working_status:a.txtunitworking_status,other_banker_exposures:a.txtbanker_exposures,cibil_data:a.txtcibil_data,restructuring_data:a.rdbsrestructring,churing_account:a.txtchuring_data,status_current_overdue:a.txtoverdue,other_group_companies:a.txtcompanies_dtl,meeting_details:a.txtmeeting_dtl,instances_PTP:a.txtptp,demandnotice_details:a.txtdemanddetails,statuslegal_action:a.txtlegalstatus,other_banker_borrower:a.txtother_banker},n="api/raiseLegalSR/savelegalsr";lockUI(),d.post(n,e).then(function(t){1==t.data.status?(unlockUI(),h(),c.url("app/requestCompliancesummary?lstab=legalsr"),l.alert("Legal SR saved  Successfully","success")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),h()})},a.addcontactdetails=function(t){function a(a,e){a.ok=function(){e.close("closed")},a.contactdetailsformsubmit=function(){var n={contact_name:a.txtname,contact_location:a.txtlocation,contact_mobileno:a.txtmobile,customer_gid:a.customer_gid,customer_gid:t};console.log(n);var o="api/raiseLegalSR/postlegalSRcontactdtl";d.post(o,n).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),y()):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3})})}}e.open({templateUrl:"/addcontactdetails.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.legalSRSubmit=function(t){var e={templegalsr_gid:t,account_name:a.customer_name,constitution:a.cboconstitution,financed_by:a.rdbfinanced_by,deal_year:a.deal_year,address:a.address,business_activity:a.txtbusiness_activity,email_id:a.email,cycles_sanctiondated:a.txtcycles_date,limit_sanction:a.txtlimit_lastsanctioned,primary_securities:a.txtprimary_securities,collateral_securities:a.txtcollateral_securities,details_UDC_PDC:a.txtdetail_udc_pdc,unit_working_status:a.txtunitworking_status,other_banker_exposures:a.txtbanker_exposures,cibil_data:a.txtcibil_data,restructuring_data:a.rdbsrestructring,churing_account:a.txtchuring_data,status_current_overdue:a.txtoverdue,other_group_companies:a.txtcompanies_dtl,meeting_details:a.txtmeeting_dtl,instances_PTP:a.txtptp,demandnotice_details:a.txtdemanddetails,statuslegal_action:a.txtlegalstatus,other_banker_borrower:a.txtother_banker,customer_gid:a.customer_gid},n="api/raiseLegalSR/submitraiselegalsr";lockUI(),d.post(n,e).then(function(t){1==t.data.status?(unlockUI(),h(),c.url("app/requestCompliancesummary?lstab=legalsr"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),h()})},a.legalSRUpdate=function(t){var e={legalSR_gid:a.legalSR_gid,raiselegalSR_gid:a.raiselegalSR_gid,templegalsr_gid:t,account_name:a.customer_name,constitution:a.cboconstitution,financed_by:a.rdbfinanced_by,deal_year:a.deal_year,address:a.address,business_activity:a.txtbusiness_activity,email_id:a.email,cycles_sanctiondated:a.txtcycles_date,limit_sanction:a.txtlimit_lastsanctioned,primary_securities:a.txtprimary_securities,collateral_securities:a.txtcollateral_securities,details_UDC_PDC:a.txtdetail_udc_pdc,unit_working_status:a.txtunitworking_status,other_banker_exposures:a.txtbanker_exposures,cibil_data:a.txtcibil_data,restructuring_data:a.rdbsrestructring,churing_account:a.txtchuring_data,status_current_overdue:a.txtoverdue,other_group_companies:a.txtcompanies_dtl,meeting_details:a.txtmeeting_dtl,instances_PTP:a.txtptp,demandnotice_details:a.txtdemanddetails,statuslegal_action:a.txtlegalstatus,other_banker_borrower:a.txtother_banker,customer_gid:a.customer_gid},n="api/raiseLegalSR/updateraiselegalsr";lockUI(),d.post(n,e).then(function(t){1==t.data.status?(unlockUI(),h(),c.url("app/requestCompliancesummary?lstab=legalsr"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),h()})},a.legalSRback=function(){var t="api/raiseLegalSR/getdeletetempcontRM";d.get(t).then(function(t){}),"dntracker"==a.relpath1?c.url("app/LglTrnDNTrackerAE"):c.url("app/requestCompliancesummary?lstab=legalsr")}}angular.module("angle").controller("raisesr2authenticationController",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m){function p(){a.hidephotodiv=!0,a.showphotodiv=!1,a.validationMsg=!1,_.open=function(t){t.preventDefault(),t.stopPropagation(),_.opened=!0},_.close=function(t){t.preventDefault(),t.stopPropagation(),_.closed=!0},_.formats=["dd-MM-yyyy"],_.format=_.formats[0],_.dateOptions={formatYear:"yy",startingDay:1};var t="api/registerlawyer/tempdelete";i.get(t).then(function(t){})}var _=this;_.title="addLawyerController",p(),a.lawyerback=function(){var t="api/registerlawyer/tempdelete";i.get(t).then(function(t){}),e.go("app.lawyerManagement")},a.lawyerSubmit=function(){localStorage.getItem(a.uploadfrm);var t={lawyerref_no:a.txtlawyerref_no,lawyer_name:a.txtlawyername,dob:a.dob,gender:a.gender,mobile_no:a.txtmobileno,telephone_no:a.txttelephoneno,email_address:a.txtemailaddress,educational_qualification:a.txtqualification,date_enrolment:a.txtdateenrol_council,pan_no:a.txtpanno,experience:a.txtexperience,place_practice:a.txtplace_practice,address_line1:a.txtaddress1,address_line2:a.txtaddress2,state:a.txtstate,country:a.txtcountry,postal_code:a.txtpostalcode,enrolment_no:a.txtenrolment_no,aadhar_no:a.txtaadhar_no,bank_name:a.txtbank_name,account_no:a.txtaccount_no,ifsc_code:a.txtifsc_code},n="api/registerlawyer/registerlawyer";lockUI(),i.post(n,t).then(function(t){1==t.data.status?(unlockUI(),p(),e.go("app.lawyerManagement"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),p()})},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=m.fnCheckValidDocType(t[0].name,"");if(0==r)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var d=new FormData;d.append("fileupload",o.file),d.append("file_name",o.name),d.append("document_name",a.documentname),d.append("document_type",a.document_type),d.append("project_flag","Default"),a.uploadfrm=d;var l="api/registerlawyer/UploadEnrollcertificate";lockUI(),i.postFile(l,a.uploadfrm).then(function(t){a.filename_list=t.data.UploadDocumentList,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,s.alert(t.data.message,"success")):(unlockUI(),s.alert(t.data.message))})},a.document_cancelclick=function(t,e){var n={document_gid:t},o="api/registerLawyer/documentdelete";i.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),s.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3})):s.alert(e.data.message,{status:"Warning",pos:"top-center",timeout:3e3})})},a.photo=function(t,e,n){var o={name:t[0].name,file:t[0]},r=m.fnCheckValidDocType(t[0].name,"photo");if(0==r)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var d=new FormData;d.append("fileupload",o.file),d.append("file_name",o.name),d.append("document_name",a.documentname),d.append("project_flag","Default"),a.uploadfrm=d,localStorage.setItem(a.uploadfrm,"$scope.uploadfrm");var l="api/registerLawyer/Uploadphoto";lockUI(),i.postFile(l,a.uploadfrm).then(function(t){unlockUI(),a.filename_list=t.data.filename_list,$("#adduploadphoto").val("");var e="api/registerLawyer/tempdocument";i.get(e).then(function(t){a.filename_list=t.data.UploadDocumentList}),1==t.data.status&&(a.hidephotodiv=!1,a.showphotodiv=!0)})},a.enrolmentno_validation=function(){var t={enrolment_no:a.txtenrolment_no},e="api/registerlawyer/Getenrolment_validation";i.getparams(e,t).then(function(t){console.log(t.data.enrolment_no),"Y"==t.data.enrolment_no?a.validationMsg=!0:a.validationMsg=!1})}}angular.module("angle").controller("addLawyerController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y){function b(){lockUI();var t=window.location.href,e=t.split("lstab=");a.relpath1=e[1],console.log(a.relpath1),a.lawyerdocumentdetails=!1,a.click=!0,a.seeklawyer=!1;var t="api/requestCompliance/compliancemanagement360",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(t,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.assign_lawyergid=t.data.assign_lawyergid,a.assign_lawyername=t.data.assign_lawyername,a.assign_mobileno=t.data.assign_mobileno,a.assign_emailaddress=t.data.assign_emailaddress,a.assignedlawyer_by=t.data.assigned_by,a.seeklawyer_remarks=t.data.seeklawyer_remarks,a.assigned_date=t.data.assigned_date,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by,a.designation_name=t.data.designation_name,a.department_name=t.data.department_name,a.branch_name=t.data.branch_name,a.employee_photo=t.data.employee_photo,a.txtremarks=t.data.remarks,a.list=t.data.document_list,a.seeklawyerdocument=t.data.uploadseek_list,a.rejected_remarks=t.data.rejected_remarks,"---"!=t.data.correctedfile_name&&(a.updated_download=!0),console.log(t.data.requestref_no)});var t="api/requestCompliance/querieslist";d.getparams(t,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()});var t="api/requestCompliance/lawyerList";d.getparams(t,n).then(function(t){a.lawyer_list=t.data.taggedlawyerList,a.lawfirm_list=t.data.taggedlawfirmList});var t="api/requestCompliance/getcorrecteddocument";d.getparams(t,n).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,unlockUI()});var t="api/requestCompliance/tempdelete";d.get(t).then(function(t){})}var k=this;k.title="request360controller",b(),a.downloads=function(t,a){h.Downloaddocument(t,a)},a.downloadscorrected=function(t,a){h.Downloaddocument(t,a)},a.updateddoc_downloads=function(t,a){h.Downloaddocument(t,a)},a.assignLawyerSubmit=function(){function t(t,a){var e=n,r=o;console.log("popup",e),t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),r.append("project_flag","Default"),t.uploadfrm=r;var i="api/requestCompliance/seekLawyerUpload";d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpseek_documentgid:a},n="api/requestCompliance/seekLawyerUploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){lockUI();var a={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),taggedlawyerList:e,taggedlawfirmList:r,seeklawyerremarks:t.seeklawyerremarks},n="api/requestCompliance/assignLawyer";d.post(n,a).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab=Work-InProgress")):l.alert(a.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),t.ok(),b()})}}function t(t,a){var e=n,r=o;console.log("popup",e),t.ok=function(){a.close("closed")},t.close=function(){a.close("closed")},t.uploadseek=function(a,e,n){var o={name:a[0].name,file:a[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_name",t.documentname),r.append("project_flag","Default"),t.uploadfrm=r;var i="api/requestCompliance/seekLawyerUpload";d.postFile(i,t.uploadfrm).then(function(a){t.uploadseek_list=a.data.uploadseek_list,$("#addupload").val(""),1==a.data.status?l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},t.uploadcancel=function(a){var e={tmpseek_documentgid:a},n="api/requestCompliance/seekLawyerUploadcancel";d.getparams(n,e).then(function(a){t.uploadseek_list=a.data.uploadseek_list})},t.assignconfirm=function(){lockUI();var a={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),taggedlawyerList:e,taggedlawfirmList:r,seeklawyerremarks:t.seeklawyerremarks};console.log(a);var n="api/requestCompliance/assignLawyer";d.post(n,a).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab=Work-InProgress")):l.alert(a.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),t.ok(),b()})}}if(""==a.cboassignlawyer||void 0==a.cboassignlawyer)if(""==a.cboassignlawfirm||void 0==a.cboassignlawfirm)l.alert("Select Atleast One Lawyer / Lawfirm",{status:"info",pos:"top-center",timeout:3e3});else{if(""!=a.$parent.cboassignlawyer||void 0!=a.$parent.cboassignlawyer)var n=a.$parent.cboassignlawyer;if(""!=a.$parent.cboassignlawfirm||void 0!=a.$parent.cboassignlawfirm)var o=a.$parent.cboassignlawfirm;var r="api/requestCompliance/tmpseekdocumentclear";d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]}else{if(""!=a.$parent.cboassignlawyer||void 0!=a.$parent.cboassignlawyer)var n=a.$parent.cboassignlawyer;if(""!=a.$parent.cboassignlawfirm||void 0!=a.$parent.cboassignlawfirm)var o=a.$parent.cboassignlawfirm;var r="api/requestCompliance/tmpseekdocumentclear";d.get(r).then(function(t){});e.open({templateUrl:"/lawyeruploadContent.html",controller:t,size:"lg"});t.$inject=["$scope","$modalInstance"]}},a.requestback=function(t){c.url("app/complianceManagement?lstab="+t)},a.delete_correcteddoc=function(t){var e={uploaddocument_gid:t},n="api/requestCompliance/correcteddoc_delete";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.upload_document=function(t,a,o){function r(t,a){t.ok=function(){a.close("closed")},t.uploaddoc=function(a,e,n){var r={name:a[0].name,file:a[0],uploaddocument_gid:o},i=new FormData;i.append("fileupload",r.file),i.append("file_name",r.name),i.append("uploaddocument_gid",o),i.append("remarks",t.remarks),i.append("project_flag","Default"),t.uploadfrm=i},t.documentupload=function(){var e={uploadeddocument_type:t.document_type,uploadremarks:t.txtcorrected_remarks,uploaddocument_gid:o};console.log(e);var r="api/requestCompliance/uploadCorrectedDoc";lockUI(),d.postFile(r,t.uploadfrm).then(function(a){t.upload_list=a.data.upload_list,$("#addupload").val(""),1==a.data.status?(unlockUI(),l.alert("Document Uploaded Successfully","success")):(unlockUI(),l.alert("File Format Not Supported!")),b()});var r="api/requestCompliance/uploadremarrks";lockUI(),d.post(r,e).then(function(t){1==t.data.status?(unlockUI(),b(),n.go("app.requestCompliance360"),a.close("closed"),b()):unlockUI(),b()})}}e.open({templateUrl:"/uploadcorrecteddocument.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},a.sendclick=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),queries:a.txtqueries};lockUI();var e="api/requestCompliance/sendqueries";d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e="api/requestCompliance/querieslist",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(e,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()}),l.alert("Query sent Successfully","success"),a.txtqueries=""}else l.alert("Error Occurred","warning")})},a.cancelclick=function(){a.txtqueries=""},a.cancelassignLawyer=function(){a.cboassignlawyer="",a.seeklawyer=!1},a.lawyerdocument_details=function(){a.lawyer_document=!0,a.lawyerdoc=!0,a.click=!1},a.minimizedoc=function(){a.lawyer_document=!1,a.lawyerdoc=!1,a.click=!0},a.seeklawyeropinion=function(){a.seeklawyer=!0},a.updatestatus=function(t){function a(a,e){a.mandatoryfields=!1,a.ok=function(){e.close("closed")};var n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};lockUI();var o="api/requestCompliance/compliancemanagement360";d.getparams(o,n).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by}),a.submit=function(){if(console.log(a.txtrejected_remarks),"Rejected"==a.cbostatus)if(""==a.txtrejected_remarks||void 0==a.txtrejected_remarks)a.mandatoryfields=!0;else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}else if("Completed"==a.cbostatus)if(""==a.txtcompleted_remarks||void 0==a.txtcompleted_remarks)a.mandatoryfields=!0;else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,completed_remarks:a.txtcompleted_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}else{a.mandatoryfields=!1;var n="api/requestCompliance/updatestatus";lockUI();var o={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),request_status:a.cbostatus,rejected_remarks:a.txtrejected_remarks};d.post(n,o).then(function(a){unlockUI(),1==a.data.status?(l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.url("app/complianceManagement?lstab="+t),b()):l.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),b()}),e.close("closed")}}}e.open({templateUrl:"/statusupdation.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=y.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;a.requestcompliance_gid=localStorage.getItem("requestcompliance_gid");var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_name",a.documentname),i.append("document_type",a.document_type),i.append("requestcompliance_gid",a.requestcompliance_gid),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/UploadComplianceCorrected_doc";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.UploadDocumentList=t.data.Managecomplianuploaddoc_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",a.showdiv=!0,a.hidediv=!1,l.alert(t.data.message,"success")):(unlockUI(),l.alert(t.data.message))})},a.deletedocument=function(t){var e={document_gid:t};console.log(e);var n="api/requestCompliance/deletecorrecteddo_upload";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.UploadDocumentList,function(e,n){e.document_gid==t&&a.UploadDocumentList.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),b()})},a.correcteddoc_submit=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},e="api/requestCompliance/submitComplianceCorrected_doc";lockUI(),d.post(e,t).then(function(t){if(unlockUI(),console.log(t.data.status),1==t.data.status){var e={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")},n="api/requestCompliance/getcorrecteddocument";d.getparams(n,e).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,a.UploadDocumentList=t.data.uploaddoc_list,unlockUI()}),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),b()}else l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.downloadsdocument=function(t,a){h.Downloaddocument(t,a)}}angular.module("angle").controller("request360controller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h,y){function b(){k.open=function(t){t.preventDefault(),t.stopPropagation(),k.opened=!0},k.close=function(t){t.preventDefault(),t.stopPropagation(),k.closed=!0};var t=new Date,e=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2);a.txtrequest_date=[t.getFullYear(),e,n].join("-"),k.formats=["dd-MM-yyyy"],k.format=k.formats[0],k.dateOptions={formatYear:"yy",startingDay:1},a.others_title=!1;var o="api/requestCompliance/tempdelete";d.get(o).then(function(t){});var o="api/requestCompliance/getrequesttype2compliance";d.get(o).then(function(t){a.requesttype_list=t.data.requesttype_list,console.log(t.data.requesttype_list)});var o="api/requestCompliance/reqtempdelete";d.get(o).then(function(t){})}var k=this;k.title="requestCompliancecontroller",b(),a.onselectedrequsttype=function(){"Others"==a.cborequest_type.request_type?a.others_title=!0:a.others_title=!1},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=y.fnCheckValidDocType(t[0].name,"");if(0==r)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var i=new FormData;i.append("fileupload",o.file),i.append("file_name",o.name),i.append("document_type",a.document_type),i.append("project_flag","Default"),a.uploadfrm=i;var s="api/requestCompliance/Uploaddocument";lockUI(),d.postFile(s,a.uploadfrm).then(function(t){a.filename_list=t.data.upload_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",l.alert("Document Uploaded Successfully..!!","success")):(unlockUI(),l.alert("File Format Not Supported!"))})},a.document_cancelclick=function(t,e){var n={uploaddocument_gid:t},o="api/requestCompliance/documentdelete";d.getparams(o,n).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.uploaddocument_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3}),b()):l.alert("Internal Error Occurred!",{status:"Warning",pos:"top-center",timeout:3e3})})},a.requestback=function(){var t="api/requestCompliance/tempdelete";d.get(t).then(function(t){}),n.go("app.requestCompliancesummary")},a.requestSubmit=function(){if("Others"==a.cborequest_type.request_type)if(""==a.txttitle||void 0==a.txttitle)l.alert("Kindly Enter Others Title","warning");else{var t="api/requestCompliance/mandatory_check";d.get(t).then(function(t){if(console.log(t.data.status),0==t.data.status)l.alert(t.data.message,"warning");else{var e={request_type:a.cborequest_type.request_type,requesttype_gid:a.cborequest_type.requesttype_gid,others_title:a.txttitle,remarks:a.txtremarks},o="api/requestCompliance/requestcompliance";lockUI(),d.post(o,e).then(function(t){1==t.data.status?(unlockUI(),n.go("app.requestCompliancesummary"),l.alert("Compliance Created Successfully","success")):(unlockUI(),l.alert("Error While Creating request compliance")),b()})}})}else{var t="api/requestCompliance/mandatory_check";d.get(t).then(function(t){if(console.log(t.data.status),0==t.data.status)l.alert(t.data.message,"warning");else{var e={request_type:a.cborequest_type.request_type,requesttype_gid:a.cborequest_type.requesttype_gid,others_title:a.txttitle,remarks:a.txtremarks},o="api/requestCompliance/requestcompliance";lockUI(),d.post(o,e).then(function(t){1==t.data.status?(unlockUI(),n.go("app.requestCompliancesummary"),l.alert("Compliance Created Successfully","success")):(unlockUI(),l.alert("Error While Creating request compliance")),b()})}})}}}angular.module("angle").controller("requestCompliancecontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D){function h(){a.totalDisplayedcompliance=100,a.totalDisplayedlegalsr=100;var t="api/requestCompliance/requestCompliancesummary";lockUI(),d.get(t).then(function(t){unlockUI(),a.requestcompliance_data=t.data.requestcompliance_list,a.complianceCount=a.requestcompliance_data.length});var t="api/raiseLegalSR/GetSR";lockUI(),d.get(t).then(function(t){unlockUI(),a.mdlMisdataimport=t.data.RaiselegalSR_list,a.legalsrCount=a.mdlMisdataimport.length}),a.tab={};var t=window.location.href,e=t.split("lstab="),n=e[1];void 0!=n?"compliance"==n?a.tabcompliance=!0:"legalsr"==n&&(a.tablegalsr=!0):void 0==a.tab.activeTabId?a.tabcompliance=!0:"compliance"==a.tab.activeTabId?a.tabcompliance=!0:"legalsr"==a.tab.activeTabId&&(a.tablegalsr=!0)}var y=this;y.title="requestCompliancesummarycontroller",h(),a.loadMorecompliance=function(t){lockUI();var e=parseInt(t);a.totalDisplayedcompliance+=e,unlockUI()},a.loadMorelegalsr=function(t){lockUI();var e=parseInt(t);a.totalDisplayedlegals+=e,unlockUI()},a.popuprequest=function(){n.go("app.requestcompliance")},a.raiselegalsr=function(){c.url("app/raiselegalSR?lstab=legalsr")},a.edit=function(t){a.requestcompliance_gid=t,a.requestcompliance_gid=localStorage.setItem("requestcompliance_gid",t),n.go("app.editRequestcompliance")},a.view360=function(t){a.requestcompliance_gid=t,console.log(a.requestcompliance_gid),a.requestcompliance_gid=localStorage.setItem("requestcompliance_gid",t),n.go("app.requestComplianceview")},a["delete"]=function(t){var a={requestcompliance_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var e="api/requestCompliance/requestcompliancedelete";d.getparams(e,a).then(function(t){1==t.data.status?h():(l.alert("Error Occurred !",{status:"warning",pos:"top-right",timeout:3e3}),h())}),o.swal("Deleted Successfully!")}})},a.raisesr=function(t,a){c.url("app/raiseSR2authentication?lstemplegalsr_gid="+t+"&lscustomer_gid="+a)}}angular.module("angle").controller("requestCompliancesummarycontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p,_,g,f,v,D,h){function y(){lockUI();var t="api/requestCompliance/requestcomplianceview",e={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(t,e).then(function(t){unlockUI(),a.requestref_no=t.data.requestref_no,a.requestcompliance_gid=t.data.requestcompliance_gid,a.request_type=t.data.request_type,a.request_date=t.data.request_date,a.requested_by=t.data.requested_by,a.designation_name=t.data.designation_name,a.department_name=t.data.department_name,a.branch_name=t.data.branch_name,a.employee_photo=t.data.employee_photo,a.txtremarks=t.data.remarks,a.list=t.data.document_list,a.rejected_remarks=t.data.rejected_remarks,a.completed_remarks=t.data.completed_remarks,a.updated_date=t.data.updated_date,a.updated_by=t.data.updated_by,a.request_status=t.data.request_status,"---"!=t.data.correctedfile_name&&(a.updated_download=!0)});var t="api/requestCompliance/querieslist";d.getparams(t,e).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()});var t="api/requestCompliance/getcorrecteddocument";d.getparams(t,e).then(function(t){a.file_list=t.data.Managecomplianuploaddoc_list,unlockUI()})}var b=this;b.title="requestComplianceview360controller",y(),a.requestback=function(){n.go("app.requestCompliancesummary")},a.downloads=function(t,a){h.Downloaddocument(t,a)},a.downloadsdocument=function(t,a){h.Downloaddocument(t,a)},a.upload=function(t,e,n){var o={name:t[0].name,file:t[0]},r=new FormData;r.append("fileupload",o.file),r.append("file_name",o.name),r.append("document_type",a.document_type),r.append("requestcompliance_gid",a.requestcompliance_gid),r.append("project_flag","Default"),a.uploadfrm=r,console.log(a.requestcompliance_gid);var i="api/requestCompliance/additionaldocupload";lockUI(),d.postFile(i,a.uploadfrm).then(function(t){a.filename_list=t.data.upload_list,$("#addupload").val(""),1==t.data.status?(unlockUI(),a.document_type="",l.alert("Document Uploaded Successfully","success"),y()):(unlockUI(),l.alert("File Format Not Supported")),y()})},a.delete_doc=function(t){var e={uploaddocument_gid:t},n="api/requestCompliance/documentdelete";d.getparams(n,e).then(function(e){1==e.data.status?(angular.forEach(a.filename_list,function(e,n){e.document_gid==t&&a.filename_list.splice(n,1)}),l.alert("Document Deleted Successfully",{status:"success",pos:"top-center",timeout:3e3})):l.alert("Internal Error Occurred",{status:"Warning",pos:"top-center",timeout:3e3}),y()})},a.updateddoc_downloads=function(t,a){var e=t,n=e.split("StoryboardAPI"),o=n[1].replace("\\","/"),r=window.location.host,i=location.protocol+"//",s=i.concat(r,o);console.log(s);var d=document.createElement("a"),l=a.split(".");d.download=l[0];var c=s;d.href=c,d.click()},a.query=function(t){function a(t,a){t.ok=function(){a.close("closed")};var e="api/requestCompliance/compliancemanagement360";d.getparams(e,n).then(function(a){1==a.data.status&&(t.requestref_no=a.data.requestref_no,t.request_type=a.data.request_type)}),t.querysubmit=function(){var e=$("#lawyer :selected").text(),n={
firm_refno:t.firm_refno,firm_name:t.firm_name,lawyer:e,remarks:t.remarks,lawfirm_gid:t.lawfirm_gid,lawyerregister_gid:t.lawyer},o="api/requestCompliance/querydetails";d.post(o,n).then(function(t){1==t.data.status?(a.close("closed"),l.alert("Query Details Added Successfully","success"),y()):(l.alert("Error Occurred While Query Details","warning"),y())})}}var n={requestcompliance_gid:t};console.log(t);e.open({templateUrl:"/requestcompliancequery.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]},a.sendclick=function(){var t={requestcompliance_gid:localStorage.getItem("requestcompliance_gid"),queries:a.txtqueries};lockUI();var e="api/requestCompliance/sendqueries";d.post(e,t).then(function(t){if(unlockUI(),1==t.data.status){var e="api/requestCompliance/querieslist",n={requestcompliance_gid:localStorage.getItem("requestcompliance_gid")};d.getparams(e,n).then(function(t){a.querieslog_list=t.data.querydetails,unlockUI()}),l.alert("Queries sent Successfully","success"),a.txtqueries=""}else l.alert("Error Occurred!","warning")})},a.cancelclick=function(){a.txtqueries=""}}angular.module("angle").controller("requestComplianceviewcontroller",t),t.$inject=["$rootScope","$scope","$modal","$state","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$cookies","$filter","ngTableParams","$resource","$timeout","ngTableDataService","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m){function p(){a.lawfirm_gid=localStorage.getItem("lawfirm_gid");var t={lawfirm_gid:a.lawfirm_gid,lawyerref_no:a.lawyerref_no,lawyer_name:a.lawyer_name,mobile_no:a.mobile_no,date_enrolment:a.date_enrolment},e="api/lawFirm/lawfirmView";s.getparams(e,t).then(function(t){a.Lawfirmupload=t.data,a.firm_refno=t.data.firm_refno,a.firm_name=t.data.firm_name,a.contact_no=t.data.contact_no,a.mail_address=t.data.mail_address,a.firm_years=t.data.firm_years,a.firm_address=t.data.firm_address,a.remarks=t.data.remarks,a.filename_list=t.data.UploadDocument,a.lawyer_list=t.data.lawfirm_list});var e="api/Lawfirm/viewmember";lockUI(),s.getparams(e,t).then(function(t){unlockUI(),a.member_list=t.data.member_list}),a.close=function(t){document.getElementById("userform").reset();var a=document.getElementById(t);a.style.display="none"}}var _=this;_.title="viewLawfirmcontroller",p(),a.downloads=function(t,a){m.Downloaddocument(t,a)},a.Back=function(){e.go("app.lawfirmSummary")}}angular.module("angle").controller("viewLawfirmcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m){function p(){a.lawyerregister_gid=localStorage.getItem("lawyerregister_gid");var t={lawyerregister_gid:a.lawyerregister_gid},e="api/registerLawyer/lawyerView";s.getparams(e,t).then(function(t){a.UploadDocumentname=t.data,a.lawyerref_no=t.data.lawyerref_no,a.lawyer_name=t.data.lawyer_name,a.dob=t.data.dob,a.gender=t.data.gender,a.mobile_no=t.data.mobile_no,a.telephone_no=t.data.telephone_no,a.email_address=t.data.email_address,a.educational_qualification=t.data.educational_qualification,a.date_enrolment=t.data.date_enrolment,a.pan_no=t.data.pan_no,a.experience=t.data.experience,a.place_practice=t.data.place_practice,a.address_line1=t.data.address_line1,a.address_line2=t.data.address_line2,a.state=t.data.state,a.country=t.data.country,a.postal_code=t.data.postal_code,a.document_name=t.data.document_name,a.lawyerphoto_name=t.data.lawyerphoto_name,a.document_path=t.data.document_path,a.filename_list=t.data.UploadDocumentList,a.aadhar_no=t.data.aadhar_no,a.bank_name=t.data.bank_name,a.account_no=t.data.account_no,a.ifsc_code=t.data.ifsc_code;var e=location.href.split("/"),n=(e[0],e[2]),o=location.protocol+"//"+n,r=t.data.lawyerphoto_path;r=r.substring(r.indexOf("StoryboardAPI")+13),a.lawyerphoto_path=o.concat(r)}),a.close=function(t){document.getElementById("userform").reset();var a=document.getElementById(t);a.style.display="none"}}var _=this;_.title="viewLawyercontroller",p(),a.downloads=function(t,a){m.Downloaddocument(t,a)},a.viewBack=function(){e.go("app.lawyerManagement")}}angular.module("angle").controller("viewLawyercontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService"]}(),function(){"use strict";function t(t,a,e,n,o,r,i,s,d,l,c,u,m,p){function _(){a.templegalsr_gid=localStorage.getItem("templegalsr_gid"),a.customer_gid=localStorage.getItem("customer_gid");var t={templegalsr_gid:a.templegalsr_gid,customer_gid:a.customer_gid},e="api/raiseLegalSR/Getpromoter";d.getparams(e,t).then(function(t){a.promoters_list=t.data.promoter_list});var e="api/raiseLegalSR/Getguarantor";d.getparams(e,t).then(function(t){a.guarantors_list=t.data.guarantor_list});var e="api/raiseLegalSR/Getcustomerdtl";d.getparams(e,t).then(function(t){a.address=t.data.address,a.email=t.data.email_id,a.customer_name=t.data.customer_name});var e="api/raiseLegalSR/getfacilitydtl";d.getparams(e,t).then(function(t){a.facility_list=t.data.facility_list});var n={raiselegalSR_gid:localStorage.getItem("templegalsr_gid")},e="api/raiseLegalSR/viewLegalSR";d.getparams(e,n).then(function(t){a.account_name=t.data.account_name,a.financed_by=t.data.financed_by,a.constitution=t.data.constitution,a.deal_year=t.data.deal_year,a.cycles_sanctiondated=t.data.cycles_sanctiondated,a.limit_sanction=t.data.limit_sanction,a.business_activity=t.data.business_activity,a.primary_securities=t.data.primary_securities,a.collateral_securities=t.data.collateral_securities,a.details_UDC_PDC=t.data.details_UDC_PDC,a.unit_working_status=t.data.unit_working_status,a.txtother_banker=t.data.txtother_banker,a.other_banker_exposures=t.data.other_banker_exposures,a.status_current_overdue=t.data.status_current_overdue,a.cibil_data=t.data.cibil_data,a.churing_account=t.data.churing_account,a.other_group_companies=t.data.other_group_companies,a.meeting_details=t.data.meeting_details,a.restructuring_data=t.data.restructuring_data,a.txtother_banker=t.data.otherbankers_borrower,a.instances_PTP=t.data.instances_PTP,a.statuslegal_action=t.data.statuslegal_action,a.demandnotice_details=t.data.demandnotice_details,a.created_date=t.data.created_date,console.log(t.data.created_date)});var e="api/raiseLegalSR/getlegalSRcontactdtl";d.getparams(e,n).then(function(t){console.log(t),a.contactdetailsRM=t.data.contactdetailsRM})}var g=this;g.title="viewlegalSRcontroller",_(),a.legalSRback=function(t){e.go("app.legalSRsummary")}}angular.module("angle").controller("viewlegalSRcontroller",t),t.$inject=["$rootScope","$scope","$state","$modal","SweetAlert","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}();