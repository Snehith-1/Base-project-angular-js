!function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstAuditDepartment/GetAuditDepartment";lockUI(),s.get(t).then(function(t){e.auditdepartment_list=t.data.auditdepartment_list,unlockUI()})}var _=this;_.title="AtmMstAuditDepartmentController",g(),e.popupaddauditdepartment=function(){function t(t,e){t.ok=function(){e.close("closed")},t.auditdepartmentSubmit=function(){var a={auditdepartment_gid:t.auditdepartment_gid,auditdepartment_name:t.txtaudit_department,department_code:t.txtdepartment_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstAuditDepartment/AddAuditDepartment";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),g()}),e.close("closed")}}a.open({templateUrl:"/addauditdepartment.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.edit=function(t){function e(e,a){var i={auditdepartment_gid:t},o="api/AtmMstAuditDepartment/EditAuditDepartment";s.getparams(o,i).then(function(t){e.txteditaudit_department=t.data.auditdepartment_name,e.txtdepartment_code=t.data.department_code,e.auditdepartment_gid=t.data.auditdepartment_gid,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code}),e.ok=function(){a.close("closed")},e.auditdepartmentUpdate=function(){var t="api/AtmMstAuditDepartment/UpdateAuditDepartment",i={auditdepartment_gid:e.auditdepartment_gid,auditdepartment_name:e.txteditaudit_department,lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code};lockUI(),s.post(t,i).then(function(t){unlockUI(),1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(a.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),g()}),a.close("closed")}}a.open({templateUrl:"/editauditdepartment.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={auditdepartment_gid:t},o="api/AtmMstAuditDepartment/EditAuditDepartment";s.getparams(o,i).then(function(t){e.auditdepartment_gid=t.data.auditdepartment_gid,e.txtaudit_department=t.data.auditdepartment_name,e.txtremarks=t.data.remarks,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var i={audit_department:e.lblaudit_department,remarks:e.txtremarks,rbo_status:e.rbo_status,auditdepartment_gid:t},o="api/AtmMstAuditDepartment/InactiveAuditDepartment";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")};var n={auditdepartment_gid:t},o="api/AtmMstAuditDepartment/AuditDepartmentInactiveLogview";lockUI(),s.getparams(o,n).then(function(t){e.auditdepartmentinactivelog_data=t.data.auditdepartment_list,unlockUI()})}a.open({templateUrl:"/statusauditdepartment.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e["delete"]=function(t){var e={auditdepartment_gid:t};n.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstAuditDepartment/DeleteAuditDepartment";s.getparams(a,e).then(function(t){1==t.data.status?(n.swal("Deleted Successfully!"),g()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g())})}})}}angular.module("angle").controller("AtmMstAuditDepartmentController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstAuditFrequency/GetAuditFrequency";lockUI(),s.get(t).then(function(t){e.auditfrequency_data=t.data.auditfrequency_list,unlockUI()})}var _=this;_.title="AtmMstAuditFrequencyController",g(),e.popupauditfrequency=function(){function t(t,e){t.ok=function(){e.close("closed")},t.auditfrequencySubmit=function(){var a={auditfrequency_gid:t.auditfrequency_gid,auditfrequency_name:t.txtaudit_frequency,auditfrequency_code:t.txtauditfrequency_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstAuditFrequency/CreateAuditFrequency";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(e.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),g()}),e.close("closed")}}a.open({templateUrl:"/myModalContent.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.editauditfrequency=function(t){function e(e,a){var i={auditfrequency_gid:t},o="api/AtmMstAuditFrequency/EditAuditFrequency";s.getparams(o,i).then(function(t){e.txteditauditfrequency_code=t.data.auditfrequency_code,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code,e.txteditaudit_frequency=t.data.auditfrequency_name,e.auditfrequency_gid=t.data.auditfrequency_gid}),e.ok=function(){a.close("closed")},e.auditfrequencyUpdate=function(){var t="api/AtmMstAuditFrequency/UpdateAuditFrequency",i={lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code,auditfrequency_code:e.txteditauditfrequency_code,auditfrequency_name:e.txteditaudit_frequency,auditfrequency_gid:e.auditfrequency_gid};lockUI(),s.post(t,i).then(function(t){unlockUI(),1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(a.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),g()}),a.close("closed")}}a.open({templateUrl:"/editauditfrequency.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={auditfrequency_gid:t},o="api/AtmMstAuditFrequency/EditAuditFrequency";s.getparams(o,i).then(function(t){e.auditfrequency_gid=t.data.auditfrequency_gid,e.txtaudit_frequency=t.data.auditfrequency_name,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var t={auditfrequency_name:e.txtaudit_frequency,auditfrequency_gid:e.auditfrequency_gid,remarks:e.txtremarks,rbo_status:e.rbo_status},i="api/AtmMstAuditFrequency/InactiveAuditFrequency";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),g()}),a.close("closed")};var o="api/AtmMstAuditFrequency/AuditFrequencyInactiveLogview";lockUI(),s.getparams(o,i).then(function(t){e.auditfrequencyinactivelog_data=t.data.auditfrequency_list,unlockUI()})}a.open({templateUrl:"/statusauditfrequency.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.deleteauditfrequency=function(t){var e={auditfrequency_gid:t};n.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstAuditFrequency/DeleteAuditFrequency";s.getparams(a,e).then(function(t){1==t.data.status?g():(l.alert("Error Occurred While Deleting Audit Frequency !!!",{status:"warning",pos:"top-center",timeout:3e3}),g())}),n.swal("Deleted Successfully!")}})}}angular.module("angle").controller("AtmMstAuditFrequencyController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstAuditMapping/GetAuditMapping";lockUI(),c.get(t).then(function(t){e.auditmapping_list=t.data.auditmapping_list,unlockUI()})}var _=this;_.title="AtmMstAuditMappingAddController",g(),e.auditmappingadd=function(){function t(t,e){t.ok=function(){e.close("closed")};var a="api/SystemMaster/GetEmployeelist";lockUI(),c.get(a).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.submit=function(){var a={employee:t.cboemployee,auditmapping_name:t.audit_mapping,auditmapping_code:t.txtauditmapping_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstAuditMapping/CreateAuditMapping";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),g()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}o.open({templateUrl:"/addauditmapping.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.editauditmapping=function(t){function e(e,a){var i={auditmapping_gid:t},o="api/AtmMstAuditMapping/EditAuditMapping";c.getparams(o,i).then(function(t){if(e.txteditauditmapping_code=t.data.auditmapping_code,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code,e.audit_mapping=t.data.auditmapping_name,e.auditmapping_gid=t.data.auditmapping_gid,e.cboemployee_editlist=t.data.employeeem_list,e.employee=t.data.employee,e.cboemployee_edit=[],null!=t.data.employee)for(var a=t.data.employee.length,i=0;i<a;i++){var o=e.cboemployee_editlist.map(function(t){return t.employee_gid}).indexOf(t.data.employee[i].employee_gid);e.cboemployee_edit.push(e.cboemployee_editlist[o]),e.$parent.cboSecondaryValueChain=e.cboSecondaryValueChain}}),e.ok=function(){a.close("closed")},e.update=function(){var t="api/AtmMstAuditMapping/UpdateAuditMapping",i={auditmapping_code:e.txteditauditmapping_code,auditmapping_name:e.audit_mapping,lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code,auditmapping_gid:e.auditmapping_gid,employee:e.cboemployee_edit};c.post(t,i).then(function(t){1==t.data.status?(a.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),g()):(a.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}))}),a.close("closed")}}o.open({templateUrl:"/editauditmapping.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function a(e,a){var i={auditmapping_gid:t};lockUI();var o="api/AtmMstAuditMapping/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.auditmapping_name=t.data.auditmapping_name}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/showemployee.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={auditmapping_gid:t},o="api/AtmMstAuditMapping/EditAuditMapping";c.getparams(o,i).then(function(t){e.auditmapping_gid=t.data.auditmapping_gid,e.audit_mapping=t.data.auditmapping_name,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var i={auditmapping_gid:t,auditmapping_name:e.txtauditmapping_name,remarks:e.txtremarks,rbo_status:e.rbo_status},o="api/AtmMstAuditMapping/InactiveAuditMapping";lockUI(),c.post(o,i).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g()}),a.close("closed")};var n={auditmapping_gid:t},o="api/AtmMstAuditMapping/AuditMappingInactiveLogview";lockUI(),c.getparams(o,n).then(function(t){e.auditmappinginactivelog_list=t.data.auditmapping_list,unlockUI()})}o.open({templateUrl:"/statusauditmapping.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.deleteauditmapping=function(t){var e={auditmapping_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstAuditMapping/DeleteAuditMapping";c.getparams(a,e).then(function(t){1==t.data.status?g():(s.alert("Error Occurred While Deleting Audit Mapping !!!",{status:"warning",pos:"top-center",timeout:3e3}),g())}),p.swal("Deleted Successfully!")}})}}angular.module("angle").controller("AtmMstAuditMappingAddController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstAuditPriority/GetAuditPriority";lockUI(),s.get(t).then(function(t){e.auditpriority_data=t.data.auditpriority_list,unlockUI()})}var _=this;_.title="AtmMstAuditPriorityController",g(),e.popupauditpriority=function(){function t(t,e){t.ok=function(){e.close("closed")},t.auditprioritySubmit=function(){var a={auditpriority_gid:t.auditpriority_gid,auditpriority_name:t.txtaudit_priority,auditpriority_code:t.txtauditpriority_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstAuditPriority/CreateAuditPriority";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),g()}),e.close("closed")}}a.open({templateUrl:"/myModalContent.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},e.editauditpriority=function(t){function e(e,a){var i={auditpriority_gid:t},o="api/AtmMstAuditPriority/EditAuditPriority";s.getparams(o,i).then(function(t){e.txteditauditpriority_code=t.data.auditpriority_code,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code,e.txteditaudit_priority=t.data.auditpriority_name,e.auditpriority_gid=t.data.auditpriority_gid}),e.ok=function(){a.close("closed")},e.auditpriorityUpdate=function(){var t="api/AtmMstAuditPriority/UpdateAuditPriority",i={lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code,auditpriority_code:e.txteditauditpriority_code,auditpriority_name:e.txteditaudit_priority,auditpriority_gid:e.auditpriority_gid};lockUI(),s.post(t,i).then(function(t){unlockUI(),1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(a.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),g()}),a.close("closed")}}a.open({templateUrl:"/editauditpriority.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={auditpriority_gid:t},o="api/AtmMstAuditPriority/EditAuditPriority";s.getparams(o,i).then(function(t){e.auditpriority_gid=t.data.auditpriority_gid,e.txtaudit_priority=t.data.auditpriority_name,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var t={auditpriority_name:e.txtaudit_priority,auditpriority_gid:e.auditpriority_gid,remarks:e.txtremarks,rbo_status:e.rbo_status},i="api/AtmMstAuditPriority/InactiveAuditPriority";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),g()}),a.close("closed")};var o="api/AtmMstAuditPriority/AuditPriorityInactiveLogview";lockUI(),s.getparams(o,i).then(function(t){e.auditpriorityinactivelog_data=t.data.auditpriority_list,unlockUI()})}a.open({templateUrl:"/statusauditpriority.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.deleteauditpriority=function(t){var e={auditpriority_gid:t};n.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstAuditPriority/DeleteAuditPriority";s.getparams(a,e).then(function(t){1==t.data.status?(n.swal("Deleted Successfully!"),g()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g())})}})}}angular.module("angle").controller("AtmMstAuditPriorityController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstAuditType/GetAuditType";lockUI(),s.get(t).then(function(t){e.audittype_data=t.data.audittype_list,unlockUI()})}var _=this;_.title="AtmMstAuditTypeController",g(),e.popupaudittype=function(){function t(t,e){t.ok=function(){e.close("closed")},t.audittypeSubmit=function(){var a={audittype_gid:t.audittype_gid,audittype_name:t.txtaudit_type,audittype_code:t.txtaudittype_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstAuditType/CreateAuditType";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):(e.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),g()}),e.close("closed")}}a.open({templateUrl:"/myModalContent.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.editaudittype=function(t){function e(e,a){var i={audittype_gid:t},o="api/AtmMstAuditType/EditAuditType";s.getparams(o,i).then(function(t){e.txteditaudittype_code=t.data.audittype_code,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code,e.txteditaudit_type=t.data.audittype_name,e.audittype_gid=t.data.audittype_gid}),e.ok=function(){a.close("closed")},e.audittypeUpdate=function(){var t="api/AtmMstAuditType/UpdateAuditType",i={lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code,audittype_code:e.txteditaudittype_code,audittype_name:e.txteditaudit_type,audittype_gid:e.audittype_gid};lockUI(),s.post(t,i).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g()}),a.close("closed")}}a.open({templateUrl:"/editaudittype.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={audittype_gid:t},o="api/AtmMstAuditType/EditAuditType";s.getparams(o,i).then(function(t){e.audittype_gid=t.data.audittype_gid,e.txtaudit_type=t.data.audittype_name,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var t={audittype_name:e.txtaudit_type,audittype_gid:e.audittype_gid,remarks:e.txtremarks,rbo_status:e.rbo_status},i="api/AtmMstAuditType/InactiveAuditType";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),g()}),a.close("closed")};var o="api/AtmMstAuditType/AuditTypeInactiveLogview";lockUI(),s.getparams(o,i).then(function(t){e.audittypeinactivelog_data=t.data.audittype_list,unlockUI()})}a.open({templateUrl:"/statusaudittype.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.deleteaudittype=function(t){var e={audittype_gid:t};n.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstAuditType/DeleteAuditType";s.getparams(a,e).then(function(t){1==t.data.status?(n.swal("Deleted Successfully!"),g()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g())})}})}}angular.module("angle").controller("AtmMstAuditTypeController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/MstApplication360/GetEntity";lockUI(),s.get(t).then(function(t){e.entity_data=t.data.application_list,unlockUI()});var t="api/AtmMstCheckpointGroup/GetCheckpointGroupActive";lockUI(),s.get(t).then(function(t){e.checkpointgroup_data=t.data.checkpointgroup_list,unlockUI()});var t="api/AtmMstAuditDepartment/GetAuditDepartmentActive";lockUI(),s.get(t).then(function(t){e.auditdepartment_list=t.data.auditdepartment_list,unlockUI()});var t="api/AtmMstAuditType/GetAuditTypeActive";lockUI(),s.get(t).then(function(t){e.audittype_data=t.data.audittype_list,unlockUI()});var t="api/SystemMaster/GetEmployeelist";lockUI(),s.get(t).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.checklistmasterback=function(t){i.go("app.AtmMstChecklistMasterSummary")};var t="api/AtmMstChecklistMaster/GetCheckpointStatus";lockUI(),s.get(t).then(function(t){e.checklistmaster_list=t.data.checklistmaster_list,unlockUI()})}var k=this;k.title="AtmMstChecklistMasterAddController",_(),e.onchangecheckpoint=function(){var t={checkpointgroup_list:e.cbocheckpoint},a="api/AtmMstChecklistMaster/GetMultipleCheckpointgroup";s.post(a,t).then(function(t){e.checkpointgroupadd_list=t.data.checkpointgroupadd_list})},e.submitAddChecklist=function(){var t="",a="";void 0==e.cboauditdepartment&&null==e.cboauditdepartment||(t=e.cboauditdepartment.auditdepartment_gid,a=e.cboauditdepartment.auditdepartment_name);var o="",n="";void 0==e.cboentity&&null==e.cboentity||(o=e.cboentity.entity_gid,n=e.cboentity.entity_name);var r="",c="";void 0==e.cbocheckpoint&&null==e.cbocheckpoint||(r=e.cbocheckpoint.checkpointgroup_gid,c=e.cbocheckpoint.checkpointgroup_name);var d="",p="";void 0==e.cboaudittype&&null==e.cboaudittype||(d=e.cboaudittype.audittype_gid,p=e.cboaudittype.audittype_name);var u="",m="";void 0==e.cboauditmaker&&null==e.cboauditmaker||(u=e.cboauditmaker.employee_gid,m=e.cboauditmaker.employee_name);var g="",_="";void 0==e.cboauditchecker&&null==e.cboauditchecker||(g=e.cboauditchecker.employee_gid,_=e.cboauditchecker.employee_name);var k={audittype_gid:d,audittype_name:p,entity_gid:o,entity_name:n,checkpointgroup_gid:r,checkpointgroup_name:c,auditdepartment_gid:t,auditdepartment_name:a,audit_name:e.txtaudit_name,audit_description:e.txtaudit_description,employee_gid:u,audit_maker:m,auditmapping_gid:g,audit_checker:_,checkpointgroupadd_list:e.cbocheckpoint},f="api/AtmMstChecklistMaster/PostChecklistMaster";lockUI(),s.post(f,k).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.go("app.AtmMstChecklistMasterSummary")):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkpointintent=function(t,e){function i(e,a){var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointNotestoAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmMstChecklistMasterAddController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmMstPositiveConfirmity/GetPositiveConfirmity";lockUI(),s.get(t).then(function(t){e.positiveconfirmity_data=t.data.positiveconfirmity_list,unlockUI()});var t="api/AtmMstRiskcategory/GetRiskcategory";lockUI(),s.get(t).then(function(t){e.riskcategory_list=t.data.riskcategory_list,unlockUI()})}var k=this;k.title="AtmMstChecklistMasterAuditController";var f=d.search().checklistmaster_gid;d.search().checklistmasteradd_gid;_(),e.changevalue=function(){var t=0,a=0,i=0,o=0,n=0;void 0==e.txtna_score&&null==e.txtna_score||(t=e.txtna_score),void 0==e.txtno_score&&null==e.txtno_score||(a=e.txtno_score),void 0==e.txtyes_score&&null==e.txtyes_score||(i=e.txtyes_score),void 0==e.txtpartial_score&&null==e.txtpartial_score||(o=e.txtpartial_score),n=t+a+i+o,e.txt_totalscore=parseFloat(n.toFixed(2))},e.submitChecklistmasterAdd=function(){var t="",a="";void 0==e.cboriskcategory&&null==e.cboriskcategory||(t=e.cboriskcategory.riskcategory_gid,a=e.cboriskcategory.riskcategory_name);var i="",o="";void 0==e.cbopositiveconfirmity&&null==e.cbopositiveconfirmity||(i=e.cbopositiveconfirmity.positiveconfirmity_gid,o=e.cbopositiveconfirmity.positiveconfirmity_name);var n={positiveconfirmity_gid:i,positiveconfirmity_name:o,riskcategory_gid:t,riskcategory_name:a,checklistmaster_gid:f,checkpoint_intent:e.txtcheckpoint_intent,checkpoint_description:e.txtcheckpoint_description,noteto_auditor:e.txtnoteto_auditor,yes_score:e.txtyes_score,yes_disposition:e.txtyes_disposition,no_score:e.txtno_score,no_disposition:e.txtno_disposition,partial_score:e.txtpartial_score,partial_disposition:e.txtpartial_disposition,na_score:e.txtna_score,na_disposition:e.txtna_disposition,total_score:e.txt_totalscore},r="api/AtmMstChecklistMaster/PostChecklistMasterAdd";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.cboriskcategory="",e.cbopositiveconfirmity="",e.txtcheckpoint_intent="",e.txtcheckpoint_description="",e.txtnoteto_auditor="",e.txtyes_score="",e.txtyes_disposition="",e.txtno_score="",e.txtno_disposition="",e.txtpartial_score="",e.txtpartial_disposition="",e.txtna_score="",e.txtna_disposition="",e.txt_totalscore="",l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checklistback=function(){d.url("app/AtmMstCheckpointSummary?checklistmaster_gid="+f)}}angular.module("angle").controller("AtmMstChecklistMasterAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d){function p(){var t="api/AtmMstRiskCategory/GetRiskCategory";lockUI(),r.get(t).then(function(t){e.riskcategory_list=t.data.riskcategory_list,unlockUI()});var t="api/AtmMstPositiveConfirmity/GetPositiveConfirmity";lockUI(),r.get(t).then(function(t){e.positiveconfirmity_data=t.data.positiveconfirmity_list,unlockUI()});var a={checklistmasteradd_gid:m},t="api/AtmMstChecklistMaster/EditChecklistMaster";lockUI(),r.getparams(t,a).then(function(t){e.cboriskcategoryedit=t.data.riskcategory_gid,e.cbopositiveconfirmityedit=t.data.positiveconfirmity_gid,e.txteditcheckpoint_intent=t.data.checkpoint_intent,e.txteditcheckpoint_description=t.data.checkpoint_description,e.txteditnoteto_auditor=t.data.noteto_auditor,e.txtedityes_score=parseFloat(t.data.yes_score),e.txtedityes_disposition=t.data.yes_disposition,e.txteditno_score=parseFloat(t.data.no_score),e.txteditno_disposition=t.data.no_disposition,e.txteditpartial_score=parseFloat(t.data.partial_score),e.txteditpartial_disposition=t.data.partial_disposition,e.txteditna_score=parseFloat(t.data.na_score),e.txteditna_disposition=t.data.na_disposition,e.txtedit_totalscore=parseFloat(t.data.total_score),unlockUI()})}var u=this;u.title="AtmMstChecklistMasterAuditEditController";var m=s.search().checklistmasteradd_gid;p(),e.changevalue=function(){var t=parseFloat(e.txteditna_score),a=parseFloat(e.txteditno_score),i=parseFloat(e.txtedityes_score),o=parseFloat(e.txteditpartial_score),n=parseFloat(e.txtedit_totalscore);void 0==e.txteditna_score&&null==e.txteditna_score||(t=parseFloat(e.txteditna_score)),void 0==e.txteditno_score&&null==e.txteditno_score||(a=parseFloat(e.txteditno_score)),void 0==e.txtedityes_score&&null==e.txtedityes_score||(i=parseFloat(e.txtedityes_score)),void 0==e.txteditpartial_score&&null==e.txteditpartial_score||(o=parseFloat(e.txteditpartial_score)),n=t+a+i+o,e.txtedit_totalscore=n},e.checklistmasterUpdate=function(){var t,i=e.riskcategory_list.map(function(t){return t.riskcategory_gid}).indexOf(e.cboriskcategoryedit);t=i==-1?"":e.riskcategory_list[i].riskcategory_name;var o,n=e.positiveconfirmity_data.map(function(t){return t.positiveconfirmity_gid}).indexOf(e.cbopositiveconfirmityedit);o=n==-1?"":e.positiveconfirmity_data[n].positiveconfirmity_name;var s={checklistmasteradd_gid:m,riskcategory_gid:e.cboriskcategoryedit,riskcategory_name:t,positiveconfirmity_gid:e.cbopositiveconfirmityedit,positiveconfirmity_name:o,checkpoint_intent:e.txteditcheckpoint_intent,checkpoint_description:e.txteditcheckpoint_description,noteto_auditor:e.txteditnoteto_auditor,yes_score:e.txtedityes_score,yes_disposition:e.txtedityes_disposition,no_score:e.txteditno_score,no_disposition:e.txteditno_disposition,partial_score:e.txteditpartial_score,partial_disposition:e.txteditpartial_disposition,na_score:e.txteditna_score,na_disposition:e.txteditna_disposition,total_score:e.txtedit_totalscore},l="api/AtmMstChecklistMaster/UpdateChecklistMaster";lockUI(),r.post(l,s).then(function(t){1==t.data.status?(unlockUI(),p(),a.go("app.AtmMstChecklistMasterSummary"),c.alert(t.data.message,"success")):(unlockUI(),c.alert(t.data.message,"warning"))})},e.back=function(t){a.go("app.AtmMstChecklistMasterSummary")}}angular.module("angle").controller("AtmMstChecklistMasterAuditEditController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d){function p(){var t="api/AtmMstChecklistMaster/EditChecklistMaster",a={checklistmasteradd_gid:m};lockUI(),r.getparams(t,a).then(function(t){e.cboriskcategory=t.data.riskcategory_gid,e.cboriskcategory=t.data.riskcategory_name,e.cbocheckpointgroup=t.data.checkpointgroup_gid,e.cbocheckpointgroup=t.data.checkpointgroup_name,e.cbopositiveconfirmity=t.data.positiveconfirmity_gid,e.cbopositiveconfirmity=t.data.positiveconfirmity_name,e.txtcheckpoint_intent=t.data.checkpoint_intent,e.txtcheckpoint_description=t.data.checkpoint_description,e.txtnoteto_auditor=t.data.noteto_auditor,e.txtyes_score=t.data.yes_score,e.txtyes_disposition=t.data.yes_disposition,e.txtno_score=t.data.no_score,
e.txtno_disposition=t.data.no_disposition,e.txtpartial_score=t.data.partial_score,e.txtpartial_disposition=t.data.partial_disposition,e.txtna_score=t.data.na_score,e.txtna_disposition=t.data.na_disposition,e.txt_totalscore=t.data.total_score,unlockUI()})}var u=this;u.title="AtmMstChecklistMasterAuditViewController";var m=s.search().checklistmasteradd_gid,m=s.search().checklistmasteradd_gid;s.search().checklistmaster_gid;p(),e.checklistback=function(){a.go("app.AtmMstChecklistMasterSummary")}}angular.module("angle").controller("AtmMstChecklistMasterAuditViewController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){e.cbocheckpointgroup_edit=[];var t="api/MstApplication360/GetEntity";lockUI(),c.get(t).then(function(t){e.entity_data=t.data.application_list,unlockUI()});var t="api/AtmMstCheckpointGroup/GetCheckpointGroupActive";lockUI(),c.get(t).then(function(t){e.checkpointgroup_data=t.data.checkpointgroup_list,unlockUI()});var t="api/AtmMstAuditDepartment/GetAuditDepartmentActive";lockUI(),c.get(t).then(function(t){e.auditdepartment_list=t.data.auditdepartment_list,unlockUI()});var t="api/AtmMstAuditType/GetAuditTypeActive";lockUI(),c.get(t).then(function(t){e.audittype_data=t.data.audittype_list,unlockUI()});var t="api/AtmMstChecklistMaster/GetCheckpointStatus";lockUI(),c.get(t).then(function(t){e.checklistmaster_list=t.data.checklistmaster_list,unlockUI()});var t="api/AtmMstChecklistMaster/EditChecklistMasterAudit",a={checklistmaster_gid:f};lockUI(),c.getparams(t,a).then(function(t){if(e.cboentityedit=t.data.entity_gid,e.cboauditdepartmentedit=t.data.auditdepartment_gid,e.cboaudittypeedit=t.data.audittype_gid,e.cboauditeechecker_edit=t.data.auditmapping_gid,e.cboauditeemaker_edit=t.data.employee_gid,e.txtauditname_edit=t.data.audit_name,e.txtauditedit_description=t.data.audit_description,e.checkpointaddgroup_list=t.data.checkpointaddgroup_list,e.checkpoint_list=t.data.checkpoint_list,e.cbocheckpointgroup_edit=[],null!=t.data.checkpoint_list)for(var a=t.data.checkpoint_list.length,i=0;i<a;i++){var o=e.checkpointaddgroup_list.map(function(t){return t.checkpointgroup_gid}).indexOf(t.data.checkpoint_list[i].checkpointgroup_gid);e.cbocheckpointgroup_edit.push(e.checkpointaddgroup_list[o]),e.$parent.cbocheckpointgroup_edit=e.cbocheckpointgroup_edit}unlockUI()});var t="api/AtmMstChecklistMaster/GetChecklistMasterAdd";lockUI(),c.getparams(t,a).then(function(t){e.checklistmasteradd_list=t.data.checklistmasteradd_list,unlockUI()})}var _=this;_.title="AtmMstChecklistMasterEditController";var k=m.decryptURL(l.search().hash),f=k.checklistmaster_gid;k.checkpointgroup_gid;g(),e.onchangecheckpoint=function(t){lockUI();var a={checkpointgroup_list:e.cbocheckpointgroup_edit,checklistmaster_gid:f},i="api/AtmMstChecklistMaster/GetEditMultipleCheckpointgroup";c.post(i,a).then(function(t){unlockUI(),e.checklistmasteradd_list=t.data.checkpointgroupadd_list})},e.UpdateChecklistMaster=function(){if(null==e.checklistmasteradd_list)return s.alert("Select Atleast One Checkpointgroup!","warning"),unlockUI(),!1;var t,i=e.entity_data.map(function(t){return t.entity_gid}).indexOf(e.cboentityedit);t=i==-1?"":e.entity_data[i].entity_name;var o,n=e.auditdepartment_list.map(function(t){return t.auditdepartment_gid}).indexOf(e.cboauditdepartmentedit);o=n==-1?"":e.auditdepartment_list[n].auditdepartment_name;var r,l=e.audittype_data.map(function(t){return t.audittype_gid}).indexOf(e.cboaudittypeedit);r=l==-1?"":e.audittype_data[l].audittype_name;var d,p=e.checkpoint_list.map(function(t){return t.checkpointgroup_gid}).indexOf(e.cbocheckpointgroup_edit);d=p==-1?"":e.checkpoint_list[p].checkpointgroup_name;var u={checklistmaster_gid:f,entity_gid:e.cboentityedit,entity_name:t,auditdepartment_gid:e.cboauditdepartmentedit,auditdepartment_name:o,audittype_gid:e.cboaudittypeedit,audittype_name:r,checkpoint_list:e.cbocheckpointgroup_edit,audit_name:e.txtauditname_edit,audit_description:e.txtauditedit_description},m="api/AtmMstChecklistMaster/UpdateChecklistMasterAudit";lockUI(),c.post(m,u).then(function(t){1==t.data.status?(unlockUI(),g(),a.go("app.AtmMstChecklistMasterSummary"),s.alert(t.data.message,"success")):(unlockUI(),s.alert(t.data.message,"warning"))})},e.back=function(t){a.go("app.AtmMstChecklistMasterSummary")},e.editcheckpoint=function(t){l.url("app/AtmMstChecklistMasterAuditEdit?checklistmasteradd_gid="+t)},e.viewcheckpoint=function(t){l.url("app/AtmMstChecklistMasterAuditView?checklistmasteradd_gid="+t)},e.deletechecklistmaster=function(t){var e={checklistmasteradd_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstChecklistMaster/DeleteChecklistMasterAdd";c.getparams(a,e).then(function(t){1==t.data.status?g():(s.alert("Error Occurred While Deleting ChecklistMaster !!!",{status:"warning",pos:"top-center",timeout:3e3}),g())}),o.swal("Deleted Successfully!")}})},e.checkpointintent=function(t,e){function a(t,a){t.txtcheckpointintent=e,t.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointintent.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(t,a){t.txtcheckpointdescription=e,t.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(t,a){t.txtnotetoauditor=e,t.ok=function(){a.close("closed")}}u.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.auditname=function(t,e){function a(e,a){var i={checklistmaster_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditorName";c.getparams(o,i).then(function(t){unlockUI(),e.txtaudit_description=t.data.audit_description}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/auditname.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmMstChecklistMasterEditController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstChecklistMaster/GetChecklistMaster";lockUI(),c.get(t).then(function(t){e.checklistmaster_list=t.data.checklistmaster_list,unlockUI()})}var _=this;_.title="AtmMstChecklistMasterSummaryController",g(),e.addchecklist=function(){a.go("app.AtmMstChecklistMasterAdd")},e.Edit=function(t,e){l.url("app/AtmMstChecklistMasterEdit?hash="+m.encryptURL("checklistmaster_gid="+t+"&checkpointgroup_gid="+e))},e.createchecklist=function(t){l.url("app/AtmMstCheckpointSummary?checklistmaster_gid="+t)},e.deletechecklist=function(t){var e={checklistmasteradd_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstChecklistMaster/DeleteChecklistMasterAdd";c.getparams(a,e).then(function(t){1==t.data.status?g():(s.alert("Error Occurred While Deleting ChecklistMaster !!!",{status:"warning",pos:"top-center",timeout:3e3}),g())}),o.swal("Deleted Successfully!")}})},e["delete"]=function(t){var e={checklistmaster_gid:t};o.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstChecklistMaster/DeleteChecklistMaster";c.getparams(a,e).then(function(t){1==t.data.status?g():(s.alert("Error Occurred While Deleting ChecklistMaster !!!",{status:"warning",pos:"top-center",timeout:3e3}),g())}),o.swal("Deleted Successfully!")}})},e.checkpointintent=function(t,e){function a(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointintent.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";c.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.auditname=function(t,e){function a(e,a){var i={checklistmaster_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditorName";c.getparams(o,i).then(function(t){unlockUI(),e.txtaudit_description=t.data.audit_description}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/auditname.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){e.checklistmaster_gid=t;e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelChecklist.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(t,i,o){var n=e.checklistmaster_gid,r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelChecklist"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:t[0].name,file:t[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("checklistmaster_gid",n),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmMstChecklistMaster/ImportExcelChecklist";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}u.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmMstChecklistMasterSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmMstPositiveConfirmity/GetPositiveConfirmity";lockUI(),s.get(t).then(function(t){e.positiveconfirmity_data=t.data.positiveconfirmity_list,unlockUI()});var t="api/AtmMstRiskcategory/GetRiskcategory";lockUI(),s.get(t).then(function(t){e.riskcategory_list=t.data.riskcategory_list,unlockUI()})}var k=this;k.title="AtmMstCheckpointAddController",e.checkpointgroup_gid=d.search().checkpointgroup_gid;var f=d.search().checkpointgroup_gid,f=e.checkpointgroup_gid;_(),e.changevalue=function(){var t=0,a=0,i=0,o=0,n=0;void 0==e.txtna_score&&null==e.txtna_score||(t=e.txtna_score),void 0==e.txtno_score&&null==e.txtno_score||(a=e.txtno_score),void 0==e.txtyes_score&&null==e.txtyes_score||(i=e.txtyes_score),void 0==e.txtpartial_score&&null==e.txtpartial_score||(o=e.txtpartial_score),n=t+a+i+o,e.txt_totalscore=parseFloat(n.toFixed(2))},e.submitAdd=function(){var t="",a="";void 0==e.cboriskcategory&&null==e.cboriskcategory||(t=e.cboriskcategory.riskcategory_gid,a=e.cboriskcategory.riskcategory_name);var i="",o="";void 0==e.cbopositiveconfirmity&&null==e.cbopositiveconfirmity||(i=e.cbopositiveconfirmity.positiveconfirmity_gid,o=e.cbopositiveconfirmity.positiveconfirmity_name);var n={positiveconfirmity_gid:i,positiveconfirmity_name:o,riskcategory_gid:t,riskcategory_name:a,checkpointgroup_gid:f,checkpoint_intent:e.txtcheckpoint_intent,checkpoint_description:e.txtcheckpoint_description,noteto_auditor:e.txtnoteto_auditor,yes_score:e.txtyes_score,yes_disposition:e.txtyes_disposition,no_score:e.txtno_score,no_disposition:e.txtno_disposition,partial_score:e.txtpartial_score,partial_disposition:e.txtpartial_disposition,na_score:e.txtna_score,na_disposition:e.txtna_disposition,total_score:e.txt_totalscore},r="api/AtmMstCheckpointGroup/PostCheckpointAdd";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.cboriskcategory="",e.cbopositiveconfirmity="",e.txtcheckpoint_intent="",e.txtcheckpoint_description="",e.txtnoteto_auditor="",e.txtyes_score="",e.txtyes_disposition="",e.txtno_score="",e.txtno_disposition="",e.txtpartial_score="",e.txtpartial_disposition="",e.txtna_score="",e.txtna_disposition="",e.txt_totalscore="",l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.back=function(t){i.go("app.AtmMstCheckpointGroupAdd")},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelCheckpoint.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelCheckpoint"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("checkpointgroup_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmMstCheckpointGroup/ImportExcelCheckpoint";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.go("app.AtmMstCheckpointGroupAdd"),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmMstCheckpointAddController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/TempDeleteAuditee";c.get(t).then(function(t){});var t="api/AtmMstCheckpointGroup/TempDeleteCheckpointList";c.get(t).then(function(t){});var t="api/AtmMstPositiveConfirmity/GetPositiveConfirmityActive";lockUI(),c.get(t).then(function(t){e.positiveconfirmity_data=t.data.positiveconfirmity_list,unlockUI()});var t="api/SystemMaster/GetEmployeelist";lockUI(),c.get(t).then(function(t){e.employee_list=t.data.employeelist,unlockUI()});var t="api/SystemMaster/GetEmployeelist";lockUI(),c.get(t).then(function(t){e.employee1_list=t.data.employeelist,unlockUI()});var t="api/AtmMstRiskcategory/GetRiskcategoryActive";lockUI(),c.get(t).then(function(t){e.riskcategory_list=t.data.riskcategory_list,unlockUI()});var a={checkpointgroup_gid:I},t="api/AtmMstCheckpointGroup/GetCheckpointAdd";lockUI(),c.getparams(t,a).then(function(t){e.checkpointgroupadd_list=t.data.checkpointgroupadd_list,unlockUI()});var a={checkpointgroup_gid:I},t="api/AtmMstCheckpointGroup/GetCheckpointGroupName";lockUI(),c.getparams(t,a).then(function(t){e.cbocheckpointgroup=t.data.checkpointgroup_name,unlockUI()})}function k(){var t="api/AtmMstCheckpointGroup/GetCheckListToCheckpoint";c.get(t).then(function(t){e.checklistpoint_list=t.data.checklistcheckpoint_list})}function f(t){var a={checkpointgroupadd_gid:t},i="api/AtmMstCheckpointGroup/GetTempCheckpointCheckList";c.getparams(i,a).then(function(t){e.checklist_list=t.data.checklistcheckpoint_list})}function h(){var t="api/AtmMstCheckpointGroup/GetCheckpointList";c.get(t).then(function(t){e.checklistpoint_list=t.data.checklistcheckpoint_list})}function v(){var t="api/AtmMstCheckpointGroup/GetAuditeeList";c.get(t).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})}function A(){var t="api/AtmMstCheckpointGroup/GetAuditeeList";c.get(t).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})}function y(t){var a={checkpointgroupadd_gid:t},i="api/AtmMstCheckpointGroup/GetTempAssignedAuditeeList";c.getparams(i,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})}var b=this;b.title="AtmMstCheckpointAddSummaryController";var U=g.decryptURL(l.search().hash);e.checkpointgroup_gid=U.checkpointgroup_gid;var I=e.checkpointgroup_gid;e.checkpointgroupadd_gid=U.checkpointgroupadd_gid;e.checkpointgroupadd_gid;e.IsVisible=!1,e.IsVisible1=!1,e.IsVisible2=!1,e.IsVisible3=!1,_(),e.addcheckpoint=function(t){e.IsVisible=!e.IsVisible,e.IsVisible1=!e.IsVisible1,e.IsVisible2=!1,e.IsVisible3=!1},e.changevalueadd=function(){var t=0,a=0,i=0,o=0,n=0;void 0==e.txtna_score&&null==e.txtna_score||(t=e.txtna_score),void 0==e.txtno_score&&null==e.txtno_score||(a=e.txtno_score),void 0==e.txtyes_score&&null==e.txtyes_score||(i=e.txtyes_score),void 0==e.txtpartial_score&&null==e.txtpartial_score||(o=e.txtpartial_score),n=i,e.txt_totalscore=parseFloat(n.toFixed(2))},e.submitAdd=function(){var t="",a="";void 0==e.cboriskcategory&&null==e.cboriskcategory||(t=e.cboriskcategory.riskcategory_gid,a=e.cboriskcategory.riskcategory_name);var i="",o="";void 0==e.cbopositiveconfirmity&&null==e.cbopositiveconfirmity||(i=e.cbopositiveconfirmity.positiveconfirmity_gid,o=e.cbopositiveconfirmity.positiveconfirmity_name);var n={positiveconfirmity_gid:i,positiveconfirmity_name:o,riskcategory_gid:t,riskcategory_name:a,checkpointgroup_gid:I,checkpoint_intent:e.txtcheckpoint_intent,checkpoint_description:e.txtcheckpoint_description,noteto_auditor:e.txtnoteto_auditor,yes_score:e.txtyes_score,yes_disposition:e.txtyes_disposition,no_score:e.txtno_score,no_disposition:e.txtno_disposition,partial_score:e.txtpartial_score,partial_disposition:e.txtpartial_disposition,na_score:e.txtna_score,na_disposition:e.txtna_disposition,total_score:e.txt_totalscore},r="api/AtmMstCheckpointGroup/PostCheckpointAdd";lockUI(),c.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.cboriskcategory="",e.cbopositiveconfirmity="",e.txtcheckpoint_intent="",e.txtcheckpoint_description="",e.txtnoteto_auditor="",e.txtyes_score="",e.txtyes_disposition="",e.txtno_score="",e.txtno_disposition="",e.txtpartial_score="",e.txtpartial_disposition="",e.txtna_score="",e.txtna_disposition="",e.txt_totalscore="",s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),location.reload(!0)):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.IsVisible1=!e.IsVisible1,e.IsVisible=!e.IsVisible},e.edit=function(t){e.checkpointgroupadd_gid=t;var a={checkpointgroupadd_gid:t},i="api/AtmMstCheckpointGroup/EditCheckpoint";lockUI(),c.getparams(i,a).then(function(t){e.cbocheckpointgroup=t.data.checkpointgroup_name,e.cboriskcategoryedit=t.data.riskcategory_gid,e.cbopositiveconfirmityedit=t.data.positiveconfirmity_gid,e.txteditcheckpoint_intent=t.data.checkpoint_intent,e.txteditcheckpoint_description=t.data.checkpoint_description,e.txteditnoteto_auditor=t.data.noteto_auditor,e.txtedityes_score=parseFloat(t.data.yes_score),e.txtedityes_disposition=t.data.yes_disposition,e.txteditno_score=parseFloat(t.data.no_score),e.txteditno_disposition=t.data.no_disposition,e.txteditpartial_score=parseFloat(t.data.partial_score),e.txteditpartial_disposition=t.data.partial_disposition,e.txteditna_score=parseFloat(t.data.na_score),e.txteditna_disposition=t.data.na_disposition,e.txtedit_totalscore=parseFloat(t.data.total_score),unlockUI()}),e.IsVisible2=!0,e.IsVisible3=!1,e.IsVisible1=!1,e.IsVisible=!e.IsVisible,e.id=t,_();var i="api/AtmMstCheckpointGroup/GetCheckpointCheckList";c.getparams(i,a).then(function(t){e.checklist_list=t.data.checklistcheckpoint_list});var i="api/AtmMstCheckpointGroup/GetAuditeeSummaryList";c.getparams(i,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})},e.changevalue=function(){var t=parseFloat(e.txteditna_score),a=parseFloat(e.txteditno_score),i=parseFloat(e.txtedityes_score),o=parseFloat(e.txteditpartial_score),n=parseFloat(e.txtedit_totalscore);void 0==e.txteditna_score&&null==e.txteditna_score||(t=parseFloat(e.txteditna_score)),void 0==e.txteditno_score&&null==e.txteditno_score||(a=parseFloat(e.txteditno_score)),void 0==e.txtedityes_score&&null==e.txtedityes_score||(i=parseFloat(e.txtedityes_score)),void 0==e.txteditpartial_score&&null==e.txteditpartial_score||(o=parseFloat(e.txteditpartial_score)),n=i,e.txtedit_totalscore=n},e.Update=function(t){var a,i=e.riskcategory_list.map(function(t){return t.riskcategory_gid}).indexOf(e.cboriskcategoryedit);a=i==-1?"":e.riskcategory_list[i].riskcategory_name;var o,n=e.positiveconfirmity_data.map(function(t){return t.positiveconfirmity_gid}).indexOf(e.cbopositiveconfirmityedit);o=n==-1?"":e.positiveconfirmity_data[n].positiveconfirmity_name;var r={checkpointgroupadd_gid:t,riskcategory_gid:e.cboriskcategoryedit,checkpointgroup_gid:I,riskcategory_name:a,positiveconfirmity_gid:e.cbopositiveconfirmityedit,positiveconfirmity_name:o,checkpoint_intent:e.txteditcheckpoint_intent,checkpoint_description:e.txteditcheckpoint_description,noteto_auditor:e.txteditnoteto_auditor,yes_score:e.txtedityes_score,yes_disposition:e.txtedityes_disposition,no_score:e.txteditno_score,no_disposition:e.txteditno_disposition,partial_score:e.txteditpartial_score,partial_disposition:e.txteditpartial_disposition,na_score:e.txteditna_score,na_disposition:e.txteditna_disposition,total_score:e.txtedit_totalscore},l="api/AtmMstCheckpointGroup/UpdateCheckpoint";lockUI(),c.post(l,r).then(function(t){1==t.data.status?(unlockUI(),location.reload(!0),s.alert(t.data.message,"success")):(unlockUI(),s.alert(t.data.message,"warning"))}),e.IsVisible2=!e.IsVisible2,e.IsVisible=!e.IsVisible},e.edit_back=function(t){e.IsVisible2=!e.IsVisible2,e.IsVisible=!1},e.viewback=function(){e.IsVisible3=!e.IsVisible3,e.IsVisible=!1},e.view=function(t){var a="api/AtmMstCheckpointGroup/EditCheckpoint",i={checkpointgroupadd_gid:t};lockUI(),c.getparams(a,i).then(function(t){e.txtcheckpoint1=t.data.checkpointgroup_name,e.cboriskcategory1=t.data.riskcategory_gid,e.cboriskcategory1=t.data.riskcategory_name,e.cbopositiveconfirmity1=t.data.positiveconfirmity_gid,e.cbopositiveconfirmity1=t.data.positiveconfirmity_name,e.txtcheckpoint_intent1=t.data.checkpoint_intent,e.txtcheckpoint_description1=t.data.checkpoint_description,e.txtnoteto_auditor1=t.data.noteto_auditor,e.txtyes_score1=t.data.yes_score,e.txtyes_disposition1=t.data.yes_disposition,e.txtno_score1=t.data.no_score,e.txtno_disposition1=t.data.no_disposition,e.txtpartial_score1=t.data.partial_score,e.txtpartial_disposition1=t.data.partial_disposition,e.txtna_score1=t.data.na_score,e.txtna_disposition1=t.data.na_disposition,e.txt_totalscore1=t.data.total_score,unlockUI()}),e.IsVisible3=!0,e.IsVisible2=!1,e.IsVisible1=!1,e.IsVisible=!e.IsVisible,e.id=t,_();var a="api/AtmMstCheckpointGroup/GetCheckListToCheckpointView";c.getparams(a,i).then(function(t){e.checklist_list=t.data.checklistcheckpoint_list});var a="api/AtmMstCheckpointGroup/GetAuditeeSummaryList";c.getparams(a,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})},e.backcheckpoint=function(t){a.go("app.AtmMstCheckpointGroupAdd")},e.checkpointintent=function(t,e,a){function i(e,a){var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointIntent";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent,e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointDescription";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointNotestoAuditor";c.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.deletecheckpoint=function(t){var e={checkpointgroupadd_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstCheckpointGroup/DeleteCheckpointAdd";c.getparams(a,e).then(function(t){1==t.data.status?_():(s.alert("Error Occurred While Deleting Check Point Group !!!",{status:"warning",pos:"top-center",timeout:3e3}),_())}),p.swal("Deleted Successfully!")}})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelCheckpoint.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelCheckpoint"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("checkpointgroup_gid",t),p.append("project_flag","Default"),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmMstCheckpointGroup/ImportExcelCheckpoint";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),location.reload(!0),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}o.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checklist_add=function(){if(void 0==e.txtchecklist||""==e.txtchecklist)s.alert("Enter Check List","warning");else{var t={checkpointgroup_gid:I,checklist_name:e.txtchecklist};lockUI();var a="api/AtmMstCheckpointGroup/CreateCheckListToCheckpoint";c.post(a,t).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),k(),e.txtchecklist=""})}},e.checklist_edit=function(t){if(void 0==e.txtchecklist||""==e.txtchecklist)s.alert("Enter Check List","warning");else{var a={checkpointgroup_gid:I,checkpointgroupadd_gid:t,checklist_name:e.txtchecklist};lockUI();var i="api/AtmMstCheckpointGroup/UpdateCheckListToCheckpoint";c.post(i,a).then(function(a){unlockUI(),1==a.data.status?s.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(a.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f(t),e.txtchecklist=""})}},e.checklist_delete=function(t,e){var a={checklist2checkpoint:t};lockUI();var i="api/AtmMstCheckpointGroup/DeleteChecklist2Checkpoint";c.getparams(i,a).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f(e)})},e.delete_checkpoint=function(t){var e={checklist2checkpoint:t},a="api/AtmMstCheckpointGroup/DeleteCheckpointList";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h()})},e.delete_checkpointchecklist=function(t){var e={checklist2checkpoint:t},a="api/AtmMstCheckpointGroup/DeleteCheckpointList";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),checkpointcheck_list()})},e.addauditee=function(){var t="",a="";void 0==e.cboauditeemaker&&null==e.cboauditeemaker||(t=e.cboauditeemaker.employee_gid,a=e.cboauditeemaker.employee_name);var i="",o="";if(void 0==e.cboauditeechecker&&null==e.cboauditeechecker||(i=e.cboauditeechecker.employee_gid,o=e.cboauditeechecker.employee_name),""==e.cboauditeemaker||null==e.cboauditeemaker||""==e.cboauditeechecker||null==e.cboauditeechecker)s.alert("Kindly Fill Auditee Details","warning");else{var n={auditeemaker_gid:t,auditeemaker_name:a,auditeechecker_gid:i,auditeechecker_name:o},r="api/AtmMstCheckpointGroup/PostMultipleAuditee";lockUI(),c.post(r,n).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),v()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),e.cboauditeemaker="",e.cboauditeechecker=""})}},e.delete_auditee=function(t){var e={multipleauditee_gid:t},a="api/AtmMstCheckpointGroup/DeleteAuditeeList";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),A();
})},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.add_auditee=function(t){var a="",i="";void 0==e.cboauditeemaker&&null==e.cboauditeemaker||(a=e.cboauditeemaker.employee_gid,i=e.cboauditeemaker.employee_name);var o="",n="";if(void 0==e.cboauditeechecker&&null==e.cboauditeechecker||(o=e.cboauditeechecker.employee_gid,n=e.cboauditeechecker.employee_name),""==e.cboauditeemaker||null==e.cboauditeemaker||""==e.cboauditeechecker||null==e.cboauditeechecker)s.alert("Kindly Fill Auditee Details","warning");else{var r={auditeemaker_gid:a,auditeemaker_name:i,auditeechecker_gid:o,auditeechecker_name:n,checkpointgroupadd_gid:t},l="api/AtmMstCheckpointGroup/MultipleAuditeeEdit";lockUI(),c.post(l,r).then(function(a){unlockUI(),1==a.data.status?s.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(a.data.message,{status:"warning",pos:"top-center",timeout:3e3}),y(t),e.cboauditeemaker="",e.cboauditeechecker=""})}},e.editdelete_auditee=function(t){var e={multipleauditee_gid:t},a="api/AtmMstCheckpointGroup/DeleteAuditee";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),y()})}}angular.module("angle").controller("AtmMstCheckpointAddSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d){function p(){var t="api/AtmMstRiskCategory/GetRiskCategory";lockUI(),r.get(t).then(function(t){e.riskcategory_list=t.data.riskcategory_list,unlockUI()});var t="api/AtmMstPositiveConfirmity/GetPositiveConfirmity";lockUI(),r.get(t).then(function(t){e.positiveconfirmity_data=t.data.positiveconfirmity_list,unlockUI()});var a={checkpointgroupadd_gid:m},t="api/AtmMstCheckpointGroup/EditCheckpoint";lockUI(),r.getparams(t,a).then(function(t){e.cboriskcategoryedit=t.data.riskcategory_gid,e.cbopositiveconfirmityedit=t.data.positiveconfirmity_gid,e.txteditcheckpoint_intent=t.data.checkpoint_intent,e.txteditcheckpoint_description=t.data.checkpoint_description,e.txteditnoteto_auditor=t.data.noteto_auditor,e.txtedityes_score=parseFloat(t.data.yes_score),e.txtedityes_disposition=t.data.yes_disposition,e.txteditno_score=parseFloat(t.data.no_score),e.txteditno_disposition=t.data.no_disposition,e.txteditpartial_score=parseFloat(t.data.partial_score),e.txteditpartial_disposition=t.data.partial_disposition,e.txteditna_score=parseFloat(t.data.na_score),e.txteditna_disposition=t.data.na_disposition,e.txtedit_totalscore=parseFloat(t.data.total_score),unlockUI()})}var u=this;u.title="AtmMstCheckpointEditController";var m=s.search().checkpointgroupadd_gid;p(),e.changevalue=function(){var t=parseFloat(e.txteditna_score),a=parseFloat(e.txteditno_score),i=parseFloat(e.txtedityes_score),o=parseFloat(e.txteditpartial_score),n=parseFloat(e.txtedit_totalscore);void 0==e.txteditna_score&&null==e.txteditna_score||(t=parseFloat(e.txteditna_score)),void 0==e.txteditno_score&&null==e.txteditno_score||(a=parseFloat(e.txteditno_score)),void 0==e.txtedityes_score&&null==e.txtedityes_score||(i=parseFloat(e.txtedityes_score)),void 0==e.txteditpartial_score&&null==e.txteditpartial_score||(o=parseFloat(e.txteditpartial_score)),n=t+a+i+o,e.txtedit_totalscore=n},e.Update=function(){var t,i=e.riskcategory_list.map(function(t){return t.riskcategory_gid}).indexOf(e.cboriskcategoryedit);t=i==-1?"":e.riskcategory_list[i].riskcategory_name;var o,n=e.positiveconfirmity_data.map(function(t){return t.positiveconfirmity_gid}).indexOf(e.cbopositiveconfirmityedit);o=n==-1?"":e.positiveconfirmity_data[n].positiveconfirmity_name;var s={checkpointgroupadd_gid:m,riskcategory_gid:e.cboriskcategoryedit,riskcategory_name:t,positiveconfirmity_gid:e.cbopositiveconfirmityedit,positiveconfirmity_name:o,checkpoint_intent:e.txteditcheckpoint_intent,checkpoint_description:e.txteditcheckpoint_description,noteto_auditor:e.txteditnoteto_auditor,yes_score:e.txtedityes_score,yes_disposition:e.txtedityes_disposition,no_score:e.txteditno_score,no_disposition:e.txteditno_disposition,partial_score:e.txteditpartial_score,partial_disposition:e.txteditpartial_disposition,na_score:e.txteditna_score,na_disposition:e.txteditna_disposition,total_score:e.txtedit_totalscore},l="api/AtmMstCheckpointGroup/UpdateCheckpoint";lockUI(),r.post(l,s).then(function(t){1==t.data.status?(unlockUI(),p(),a.go("app.AtmMstCheckpointGroupAdd"),c.alert(t.data.message,"success")):(unlockUI(),c.alert(t.data.message,"warning"))})},e.back=function(t){a.go("app.AtmMstCheckpointGroupAdd")}}angular.module("angle").controller("AtmMstCheckpointEditController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmMstCheckpointGroup/GetCheckpointGroup";lockUI(),c.get(t).then(function(t){e.checkpointgroup_data=t.data.checkpointgroup_list,unlockUI()})}var k=this;k.title="AtmMstCheckpointGroupAddController",_(),e.createchecklist=function(t){l.url("app/AtmMstCheckpointAddSummary?hash="+g.encryptURL("checkpointgroup_gid="+t))},e.edit=function(t){l.url("app/AtmMstCheckpointEdit?checkpointgroupadd_gid="+t)},e.view=function(t){l.url("app/AtmMstCheckpointView?checkpointgroupadd_gid="+t)},e.addCheckpointGroup=function(){function t(t,e){t.ok=function(){e.close("closed")},t.submit=function(){var a={checkpointgroup_name:t.txtcheckpointgroup_name,checkpointgroup_code:t.txtcheckpointgroup_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstCheckpointGroup/CreateCheckpointGroup";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),_()}),e.close("closed")}}o.open({templateUrl:"/addCheckpointGroup.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.editCheckpointGroup=function(t){function e(e,a){var i={checkpointgroup_gid:t},o="api/AtmMstCheckpointGroup/EditCheckpointGroup";c.getparams(o,i).then(function(t){e.txteditcheckpointgroup_code=t.data.checkpointgroup_code,e.txteditcheckpointgroup_name=t.data.checkpointgroup_name,e.checkpointgroup_gid=t.data.checkpointgroup_gid,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code}),e.ok=function(){a.close("closed")},e.update=function(){var t="api/AtmMstCheckpointGroup/UpdateCheckpointGroup",i={checkpointgroup_code:e.txteditcheckpointgroup_code,checkpointgroup_name:e.txteditcheckpointgroup_name,lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code,checkpointgroup_gid:e.checkpointgroup_gid};c.post(t,i).then(function(t){1==t.data.status?(a.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):(a.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}))}),a.close("closed")}}o.open({templateUrl:"/editCheckpointGroup.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={checkpointgroup_gid:t},o="api/AtmMstCheckpointGroup/EditCheckpointGroup";c.getparams(o,i).then(function(t){e.checkpointgroup_gid=t.data.checkpointgroup_gid,e.txtcheckpointgroup_name=t.data.checkpointgroup_name,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var t={checkpointgroup_name:e.txtcheckpointgroup_name,checkpointgroup_gid:e.checkpointgroup_gid,remarks:e.txtremarks,rbo_status:e.rbo_status},i="api/AtmMstCheckpointGroup/InactiveCheckpointGroup";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),_()}),a.close("closed")};var n={checkpointgroup_gid:t},o="api/AtmMstCheckpointGroup/CheckpointGroupInactiveLogview";lockUI(),c.getparams(o,n).then(function(t){e.checkpointgroupinactivelog_data=t.data.checkpointgroup_list,unlockUI()})}o.open({templateUrl:"/statusCheckpointGroup.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e["delete"]=function(t){var e={checkpointgroup_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstCheckpointGroup/DeleteCheckpointGroup";c.getparams(a,e).then(function(t){1==t.data.status?_():(s.alert("Error Occurred While Deleting Check Point Group !!!",{status:"warning",pos:"top-center",timeout:3e3}),_())}),p.swal("Deleted Successfully!")}})},e.checkpointintent=function(t,e){function a(e,a){var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointIntent";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/checkpointintent.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointDescription";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={checkpointgroupadd_gid:t};lockUI();var o="api/AtmMstCheckpointGroup/GetCheckpointNotestoAuditor";c.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.deletecheckpoint=function(t){var e={checkpointgroupadd_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstCheckpointGroup/DeleteCheckpointAdd";c.getparams(a,e).then(function(t){1==t.data.status?_():(s.alert("Error Occurred While Deleting Check Point Group !!!",{status:"warning",pos:"top-center",timeout:3e3}),_())}),p.swal("Deleted Successfully!")}})},e.importexcel=function(t){function e(e,i){e.ok=function(){i.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelCheckpoint.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(a,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelCheckpoint"))s.alert("File Name / Template Not Supported!","warning"),i.close("closed");else{var d={name:a[0].name,file:a[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("checkpointgroup_gid",t),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),i.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmMstCheckpointGroup/ImportExcelCheckpoint";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmMstCheckpointGroupAdd"),i.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),i.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}o.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmMstCheckpointGroupAddController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t={checklistmaster_gid:f},a="api/AtmMstChecklistMaster/GetChecklistMasterAdd";lockUI(),s.getparams(a,t).then(function(t){e.checklistmasteradd_list=t.data.checklistmasteradd_list,unlockUI()});var a="api/AtmMstRiskCategory/GetRiskCategoryActive";lockUI(),s.get(a).then(function(t){e.riskcategory_list=t.data.riskcategory_list,unlockUI()});var a="api/AtmMstPositiveConfirmity/GetPositiveConfirmityActive";lockUI(),s.get(a).then(function(t){e.positiveconfirmity_data=t.data.positiveconfirmity_list,unlockUI()});var a="api/AtmMstChecklistMaster/GetCheckpointStatus";lockUI(),s.get(a).then(function(t){e.checklistmaster_list=t.data.checklistmaster_list,unlockUI()})}var k=this;k.title="AtmMstCheckpointSummaryController";var f=d.search().checklistmaster_gid;d.search().checklistmasteradd_gid;e.IsVisible=!1,e.IsVisible1=!1,e.IsVisible2=!1,_(),e.addcheckpoint=function(){e.IsVisible=!e.IsVisible,e.IsVisible1=!e.IsVisible1,e.IsVisible2=!1,e.IsVisible3=!1},e.edit=function(t){var a={checklistmasteradd_gid:t},i="api/AtmMstChecklistMaster/EditChecklistMaster";lockUI(),s.getparams(i,a).then(function(t){e.cbocheckpointgroup_edit=t.data.checkpointgroup_gid,e.cboriskcategoryedit=t.data.riskcategory_gid,e.cbopositiveconfirmityedit=t.data.positiveconfirmity_gid,e.txteditcheckpoint_intent=t.data.checkpoint_intent,e.txteditcheckpoint_description=t.data.checkpoint_description,e.txteditnoteto_auditor=t.data.noteto_auditor,e.txtedityes_score=parseFloat(t.data.yes_score),e.txtedityes_disposition=t.data.yes_disposition,e.txteditno_score=parseFloat(t.data.no_score),e.txteditno_disposition=t.data.no_disposition,e.txteditpartial_score=parseFloat(t.data.partial_score),e.txteditpartial_disposition=t.data.partial_disposition,e.txteditna_score=parseFloat(t.data.na_score),e.txteditna_disposition=t.data.na_disposition,e.txtedit_totalscore=parseFloat(t.data.total_score),unlockUI()}),e.IsVisible2=!e.IsVisible2,e.IsVisible=!e.IsVisible,e.IsVisible3=!1,e.IsVisible1=!1,e.id=t,_()},e.changevalue=function(){var t=parseFloat(e.txteditna_score),a=parseFloat(e.txteditno_score),i=parseFloat(e.txtedityes_score),o=parseFloat(e.txteditpartial_score),n=parseFloat(e.txtedit_totalscore);void 0==e.txteditna_score&&null==e.txteditna_score||(t=parseFloat(e.txteditna_score)),void 0==e.txteditno_score&&null==e.txteditno_score||(a=parseFloat(e.txteditno_score)),void 0==e.txtedityes_score&&null==e.txtedityes_score||(i=parseFloat(e.txtedityes_score)),void 0==e.txteditpartial_score&&null==e.txteditpartial_score||(o=parseFloat(e.txteditpartial_score)),n=t+a+i+o,e.txtedit_totalscore=n},e.checklistmasterUpdate=function(t){var a,o=e.riskcategory_list.map(function(t){return t.riskcategory_gid}).indexOf(e.cboriskcategoryedit);a=o==-1?"":e.riskcategory_list[o].riskcategory_name;var n,r=e.positiveconfirmity_data.map(function(t){return t.positiveconfirmity_gid}).indexOf(e.cbopositiveconfirmityedit);n=r==-1?"":e.positiveconfirmity_data[r].positiveconfirmity_name;var c,d=e.checklistmaster_list.map(function(t){return t.checkpointgroup_gid}).indexOf(e.cbocheckpointgroup_edit);c=d==-1?"":e.checklistmaster_list[d].checkpointgroup_name;var p={checklistmasteradd_gid:t,riskcategory_gid:e.cboriskcategoryedit,riskcategory_name:a,checkpointgroup_gid:e.cbocheckpointgroup_edit,checkpointgroup_name:c,positiveconfirmity_gid:e.cbopositiveconfirmityedit,positiveconfirmity_name:n,checkpoint_intent:e.txteditcheckpoint_intent,checkpoint_description:e.txteditcheckpoint_description,noteto_auditor:e.txteditnoteto_auditor,yes_score:e.txtedityes_score,yes_disposition:e.txtedityes_disposition,no_score:e.txteditno_score,no_disposition:e.txteditno_disposition,partial_score:e.txteditpartial_score,partial_disposition:e.txteditpartial_disposition,na_score:e.txteditna_score,na_disposition:e.txteditna_disposition,total_score:e.txtedit_totalscore},u="api/AtmMstChecklistMaster/UpdateChecklistMaster";lockUI(),s.post(u,p).then(function(t){1==t.data.status?(unlockUI(),_(),i.go("app.AtmMstChecklistMasterSummary"),l.alert(t.data.message,"success")):(unlockUI(),l.alert(t.data.message,"warning"))}),e.IsVisible2=!e.IsVisible2,e.IsVisible=!e.IsVisible},e.changevalueadd=function(){var t=0,a=0,i=0,o=0,n=0;void 0==e.txtna_score&&null==e.txtna_score||(t=e.txtna_score),void 0==e.txtno_score&&null==e.txtno_score||(a=e.txtno_score),void 0==e.txtyes_score&&null==e.txtyes_score||(i=e.txtyes_score),void 0==e.txtpartial_score&&null==e.txtpartial_score||(o=e.txtpartial_score),n=t+a+i+o,e.txt_totalscore=parseFloat(n.toFixed(2))},e.submitChecklistmasterAdd=function(){var t="",a="";void 0==e.cboriskcategory&&null==e.cboriskcategory||(t=e.cboriskcategory.riskcategory_gid,a=e.cboriskcategory.riskcategory_name);var i="",o="";void 0==e.cbopositiveconfirmity&&null==e.cbopositiveconfirmity||(i=e.cbopositiveconfirmity.positiveconfirmity_gid,o=e.cbopositiveconfirmity.positiveconfirmity_name);var n="",r="";void 0==e.cbocheckpointgroup&&null==e.cbocheckpointgroup||(n=e.cbocheckpointgroup.checkpointgroup_gid,r=e.cbocheckpointgroup.checkpointgroup_name);var c={checkpointgroup_gid:n,checkpointgroup_name:r,positiveconfirmity_gid:i,positiveconfirmity_name:o,riskcategory_gid:t,riskcategory_name:a,checklistmaster_gid:f,checkpoint_intent:e.txtcheckpoint_intent,checkpoint_description:e.txtcheckpoint_description,noteto_auditor:e.txtnoteto_auditor,yes_score:e.txtyes_score,yes_disposition:e.txtyes_disposition,no_score:e.txtno_score,no_disposition:e.txtno_disposition,partial_score:e.txtpartial_score,partial_disposition:e.txtpartial_disposition,na_score:e.txtna_score,na_disposition:e.txtna_disposition,total_score:e.txt_totalscore},d="api/AtmMstChecklistMaster/PostChecklistMasterAdd";lockUI(),s.post(d,c).then(function(t){unlockUI(),1==t.data.status?(e.cboriskcategory="",e.cbopositiveconfirmity="",e.txtcheckpoint_intent="",e.txtcheckpoint_description="",e.txtnoteto_auditor="",e.txtyes_score="",e.txtyes_disposition="",e.txtno_score="",e.txtno_disposition="",e.txtpartial_score="",e.txtpartial_disposition="",e.txtna_score="",e.txtna_disposition="",e.txt_totalscore="",l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),location.reload(!0)}),e.IsVisible2=!e.IsVisible2,e.IsVisible=!e.IsVisible},e.edit_back=function(t){e.IsVisible2=!e.IsVisible2,e.IsVisible=!1},e.backcheckpoint=function(t){i.go("app.AtmMstChecklistMasterSummary")},e.viewback=function(){e.IsVisible3=!e.IsVisible3,e.IsVisible=!1},e.view=function(t){var a="api/AtmMstChecklistMaster/EditChecklistMaster",i={checklistmasteradd_gid:t};lockUI(),s.getparams(a,i).then(function(t){e.txtcheckpoint1=t.data.checkpointgroup_name,e.cboriskcategory1=t.data.riskcategory_gid,e.cboriskcategory1=t.data.riskcategory_name,e.cbopositiveconfirmity1=t.data.positiveconfirmity_gid,e.cbopositiveconfirmity1=t.data.positiveconfirmity_name,e.txtcheckpoint_intent1=t.data.checkpoint_intent,e.txtcheckpoint_description1=t.data.checkpoint_description,e.txtnoteto_auditor1=t.data.noteto_auditor,e.txtyes_score1=t.data.yes_score,e.txtyes_disposition1=t.data.yes_disposition,e.txtno_score1=t.data.no_score,e.txtno_disposition1=t.data.no_disposition,e.txtpartial_score1=t.data.partial_score,e.txtpartial_disposition1=t.data.partial_disposition,e.txtna_score1=t.data.na_score,e.txtna_disposition1=t.data.na_disposition,e.txt_totalscore1=t.data.total_score,unlockUI()}),e.IsVisible3=!0,e.IsVisible2=!1,e.IsVisible1=!1,e.IsVisible=!e.IsVisible,e.id=t,_()},e.addchecklist=function(){i.go("app.AtmMstChecklistMasterSummary")},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent,e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.auditname=function(t,e){function i(e,a){var i={checklistmaster_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditorName";s.getparams(o,i).then(function(t){unlockUI(),e.txtaudit_name=t.data.audit_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/auditname.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmMstCheckpointSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d){function p(){var t="api/AtmMstCheckpointGroup/EditCheckpoint",a={checkpointgroupadd_gid:m};lockUI(),r.getparams(t,a).then(function(t){e.cboriskcategory=t.data.riskcategory_gid,e.cboriskcategory=t.data.riskcategory_name,e.cbopositiveconfirmity=t.data.positiveconfirmity_gid,e.cbopositiveconfirmity=t.data.positiveconfirmity_name,e.txtcheckpoint_intent=t.data.checkpoint_intent,e.txtcheckpoint_description=t.data.checkpoint_description,e.txtnoteto_auditor=t.data.noteto_auditor,e.txtyes_score=t.data.yes_score,e.txtyes_disposition=t.data.yes_disposition,e.txtno_score=t.data.no_score,e.txtno_disposition=t.data.no_disposition,e.txtpartial_score=t.data.partial_score,e.txtpartial_disposition=t.data.partial_disposition,e.txtna_score=t.data.na_score,e.txtna_disposition=t.data.na_disposition,e.txt_totalscore=t.data.total_score,unlockUI()})}var u=this;u.title="AtmMstCheckpointViewController";var m=s.search().checkpointgroupadd_gid;p(),e.back=function(t){a.go("app.AtmMstCheckpointGroupAdd")}}angular.module("angle").controller("AtmMstCheckpointViewController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstPositiveConfirmity/GetPositiveConfirmity";lockUI(),s.get(t).then(function(t){e.positiveconfirmity_data=t.data.positiveconfirmity_list,unlockUI()})}var _=this;_.title="AtmMstPositiveConfirmityController",g(),e.popuppositiveconfirmity=function(){function t(t,e){t.ok=function(){e.close("closed")},t.positiveconfirmitySubmit=function(){var a={positiveconfirmity_gid:t.positiveconfirmity_gid,positiveconfirmity_name:t.txtpositive_confirmity,positiveconfirmity_code:t.txtpositiveconfirmity_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstPositiveConfirmity/CreatePositiveConfirmity";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),g()}),e.close("closed")}}a.open({templateUrl:"/myModalContent.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},e.editpositiveconfirmity=function(t){function e(e,a){var i={positiveconfirmity_gid:t},o="api/AtmMstPositiveConfirmity/EditPositiveConfirmity";s.getparams(o,i).then(function(t){e.txteditpositiveconfirmity_code=t.data.positiveconfirmity_code,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code,e.txteditpositive_confirmity=t.data.positiveconfirmity_name,e.positiveconfirmity_gid=t.data.positiveconfirmity_gid}),e.ok=function(){a.close("closed")},e.positiveconfirmityUpdate=function(){var t="api/AtmMstPositiveConfirmity/UpdatePositiveConfirmity",i={lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code,positiveconfirmity_code:e.txteditpositiveconfirmity_code,positiveconfirmity_name:e.txteditpositive_confirmity,positiveconfirmity_gid:e.positiveconfirmity_gid};lockUI(),s.post(t,i).then(function(t){unlockUI(),1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(a.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})),g()}),a.close("closed")}}a.open({templateUrl:"/editpositiveconfirmity.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={positiveconfirmity_gid:t},o="api/AtmMstPositiveConfirmity/EditPositiveConfirmity";s.getparams(o,i).then(function(t){e.positiveconfirmity_gid=t.data.positiveconfirmity_gid,e.txtpositive_confirmity=t.data.positiveconfirmity_name,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var t={positiveconfirmity_name:e.txtpositive_confirmity,positiveconfirmity_gid:e.positiveconfirmity_gid,remarks:e.txtremarks,rbo_status:e.rbo_status},i="api/AtmMstPositiveConfirmity/InactivePositiveConfirmity";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),g()}),a.close("closed")};var o="api/AtmMstPositiveConfirmity/PositiveConfirmityInactiveLogview";lockUI(),s.getparams(o,i).then(function(t){e.positiveconfirmityinactivelog_data=t.data.positiveconfirmity_list,unlockUI()})}a.open({templateUrl:"/statuspositiveconfirmity.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.deletepositiveconfirmity=function(t){var e={positiveconfirmity_gid:t};n.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstPositiveConfirmity/DeletePositiveConfirmity";s.getparams(a,e).then(function(t){1==t.data.status?g():(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g())}),n.swal("Deleted Successfully!")}})}}angular.module("angle").controller("AtmMstPositiveConfirmityController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmMstRiskCategory/GetRiskCategory";lockUI(),s.get(t).then(function(t){e.riskcategory_data=t.data.riskcategory_list,unlockUI()})}var _=this;_.title="AtmMstRiskCategoryController",g(),e.popupriskcategory=function(){function t(t,e){t.ok=function(){e.close("closed")},t.riskcategorySubmit=function(){var a={riskcategory_name:t.txtrisk_category,riskcategory_code:t.txtriskcategory_code,lms_code:t.txtlms_code,bureau_code:t.txtbureau_code},i="api/AtmMstRiskCategory/CreateRiskCategory";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),g()}),e.close("closed")}}a.open({templateUrl:"/myModalContent.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.edit=function(t){function e(e,a){var i={riskcategory_gid:t},o="api/AtmMstRiskCategory/EditRiskCategory";s.getparams(o,i).then(function(t){e.txteditriskcategory_code=t.data.riskcategory_code,e.txteditlms_code=t.data.lms_code,e.txteditbureau_code=t.data.bureau_code,e.txteditrisk_category=t.data.riskcategory_name,e.riskcategory_gid=t.data.riskcategory_gid}),e.ok=function(){a.close("closed")},e.riskcategoryUpdate=function(){var t="api/AtmMstRiskCategory/UpdateRiskCategory",i={lms_code:e.txteditlms_code,bureau_code:e.txteditbureau_code,riskcategory_code:e.txteditriskcategory_code,riskcategory_name:e.txteditrisk_category,riskcategory_gid:e.riskcategory_gid};s.post(t,i).then(function(t){1==t.data.status?(a.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),g()):(a.close("closed"),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}))}),a.close("closed")}}a.open({templateUrl:"/editriskcategory.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.Status_update=function(t){function e(e,a){var i={riskcategory_gid:t},o="api/AtmMstRiskCategory/EditRiskCategory";s.getparams(o,i).then(function(t){e.riskcategory_gid=t.data.riskcategory_gid,e.txtriskcategory_name=t.data.riskcategory_name,e.rbo_status=t.data.Status}),e.ok=function(){a.close("closed")},e.update_status=function(){var t={riskcategory_name:e.txtriskcategory_name,riskcategory_gid:e.riskcategory_gid,remarks:e.txtremarks,rbo_status:e.rbo_status},i="api/AtmMstRiskCategory/InactiveRiskCategory";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),g()}),a.close("closed")};var n={riskcategory_gid:t},o="api/AtmMstRiskCategory/RiskCategoryInactiveLogview";lockUI(),s.getparams(o,n).then(function(t){e.riskcategoryinactivelog_data=t.data.riskcategory_list,unlockUI()})}a.open({templateUrl:"/statusriskcategory.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e["delete"]=function(t){var e={riskcategory_gid:t};n.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmMstRiskCategory/DeleteRiskCategory";s.getparams(a,e).then(function(t){1==t.data.status?(n.swal("Deleted Successfully!"),g()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g())})}})}}angular.module("angle").controller("AtmMstRiskCategoryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){
var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_overallscore=t.data.sampleoverall_score,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmRptAuditReportSampleScoreViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=h.lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified?t.tag_verifiedradio=!0:"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(){d.url("app/AtmRptAuditReportView?hash="+g.encryptURL("auditcreation_gid="+v))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmRptAuditReportSampleScoreViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m){function g(){function t(){var t={auditcreation_gid:v},a="api/AtmTrnSampling/GetSampleDynamicdata";s.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.expandCount=3,e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}})}var a={auditcreation_gid:v},o="api/AtmRptAuditReports/EditAuditReports";lockUI(),s.getparams(o,a).then(function(t){e.txtentity_name=t.data.entity_name,e.txtauditdepartment_name=t.data.auditdepartment_name,e.txtaudit_name=t.data.audit_name,e.txtpriority_name=t.data.auditpriority_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_description=t.data.audit_description,e.txtend_date=t.data.due_date,e.txtfrom_date=t.data.auditperiod_fromdate,e.txtto_date=t.data.auditperiod_todate,e.txtauditee_maker=t.data.auditeemaker_name,e.txtauditee_checker=t.data.auditeechecker_name,e.txtauditor_maker=t.data.auditmaker_name,e.txtauditor_checker=t.data.auditchecker_name,e.txtauditor_approver=t.data.auditapprover_name,e.txtauditcreated_date=t.data.created_date,e.txtauditcreated_by=t.data.created_by,e.txtapproved_date=t.data.auditapproved_date,e.txtapproved_by=t.data.auditapproved_by,e.txttag_user=t.data.tagged_user,e.txtmaker_initiate=t.data.AuditorMakerInitiatedDate,e.txtauditee_initiate=t.data.AuditeeCheckerInitiatedDate,e.txtauditorapproved_date=t.data.AuditorApprovedDate,e.txtchecker_initiate=t.data.Auditorcheckerinitiated_date,unlockUI()});var o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:v};lockUI(),s.getparams(o,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.openquerycount=t.data.openquerycount,e.status_update=t.data.status_update,e.DBobservation_score=t.data.observation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,unlockUI()});var o="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),s.getparams(o,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var o="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),s.getparams(o,a).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()}),t();var a={auditcreation_gid:v},o="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),s.getparams(o,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list}),e.allobservationfilled=!0;var a={auditcreation_gid:v},o="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),s.getparams(o,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function _(){e.observationfillenable=!0}function k(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),s.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var f=this;f.title="AtmRptAuditReportViewController";var h=m.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;g(),e.back=function(){a.go("app.AtmMstAuditReportSummary")},e.onselected=function(t,a,i){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),g()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&_()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{o.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.openquerycount&&""!=e.DBobservation_score)l.alert("Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else if("Observation score for Audit & sample"==e.auditobservation_name&&"N"==e.checklistverified_flag)l.alert("Atleast one sample observation score saved",{status:"warning",pos:"top-center",timeout:3e3});else{var t=(e.txt_percent,{auditcreation_gid:e.auditcreation_gid,makerinitiate_approvalflag:"Y",observation_percentage:e.txt_percent}),i="api/AtmTrnAuditorMaker/PostMakerInitiateApproval";lockUI(),s.post(i,t).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.AtmTrnAuditorMakerSummary")):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,a){function i(t,e){var i={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";s.getparams(o,i).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";s.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var i="",o="";t.cboqueryto&&(i=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:a,query_title:t.txtquery_title,query_to:i,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);o.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),s.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),defaultdynamic()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var i={checklistmasteradd_gid:t,checklistmaster_gid:checklistmaster_gid},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,i).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),a.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){e.tagsamplebutton=!0,a.close("closed"),1==t.data.status?(defaultdynamic(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},g(),e.uploadexcelcancel=function(){$("#fileimport").val("")}}o.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,a){function i(e,i){e.lblcheckpoint_description=a;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){i.close("closed")}}o.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,a){function i(t,i){t.txtnotetoauditor=e,t.txtcheckpointdescription=a,t.ok=function(){i.close("closed")}}o.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function a(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/showemployee.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,a,i){function n(t,e){t.hide=0;var i={auditcreation_gid:a},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,i).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var i={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,i).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,i).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var i={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:a,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==i){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}o.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function a(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,
a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}o.open({templateUrl:"/raisequery.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function a(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}o.open({templateUrl:"/observationremarksupdate.html",controller:a,backdrop:"static",keyboard:!1,size:"lg"});a.$inject=["$scope","$modalInstance"]},e.observationquery=function(){a.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+m.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+lspage+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,a){function i(i,o){i.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:a},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),s.getparams(r,n).then(function(t){unlockUI(),i.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<i.checklistcheckpoint_list.length;e++)i.checklistcheckpoint_list[e].checked=!0;angular.forEach(i.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),i.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:a},i="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),s.post(i,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Observation Checkpoint Saved Successfully!","success")):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:a},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),s.getparams(r,n).then(function(t){i.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),i.ok=function(){o.close("closed")},i.onselected=function(t,a){i.document_verified=t,i.checklist2checkpoint=a;var o={auditcreation2checklist_gid:e,document_verified:i.document_verified,checklist2checkpoint:i.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(i.txttotal_score=t.data.total_amount,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),g()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}o.open({templateUrl:"/TagToDefferalEdit.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.sampleobservationquery=function(t,e,a,i){function n(o,n){o.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:a},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),o.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<o.checklistcheckpoint_list.length;e++)o.checklistcheckpoint_list[e].checked=!0;angular.forEach(o.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){o.sample_flag=t.data.sample_flag,unlockUI()}),o.ok=function(){n.close("closed")},o.onselected=function(t,a){o.document_verified=t,o.sample2checkpoint=a;var n={auditcreation2checklist_gid:e,document_verified:o.document_verified,sample2checkpoint:o.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(o.txttotal_score=t.data.total_amount,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),g()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},o.checkall=function(t){angular.forEach(o.checklistcheckpoint_list,function(e){e.checked=t})},o.samplecheckpointassign=function(){var t=[];if(angular.forEach(o.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:a,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},o.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(o.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:a,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}o.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmRptAuditReportSampleScoreView?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.dynamicsamplequeryscore=function(t,e,a,i){d.url("app/AtmRptAuditReportSampleScoreView?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.samplecheckerobservationscoreview=function(t,e,a,i){d.url("app/AtmRptAuditReportSampleScoreView?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmMstAuditReportSummary")},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),s.post(o,i).then(function(e){unlockUI(),1==e.data.status?(l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),k(t)):l.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}o.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,i,o){e.hide=0;var n={auditcreation_gid:v},n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";s.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var i={auditcreation_gid:v,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:a};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";s.post(o,i).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";s.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else l.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=v,e.auditraisequery_gid=t;var n={auditcreation_gid:v,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=m.fnCheckValidDocType(t[0].name,"");if(0==o)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),e.uploadfrm=c;var d="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),s.postFile(d,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),l.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";s.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),l.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){i.close("closed")}}var a="";"auditormakerOpen"==lspage?a="Auditor Maker":"auditorapproveropen"==lspage?a="Auditor Approver":"auditorcheckerOpen"==lspage?a="Auditor Checker":"auditeemakeropen"==lspage?a="Auditee Maker":"auditeecheckeropen"==lspage?a="Auditee Checker":"auditeemakertagged"==lspage&&(a="Tagged User");o.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}o.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmRptAuditReportViewController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmRptAuditReports/GetAuditVisitReportApprovalApprovedSummary";c.get(t).then(function(t){e.VisitReportList=t.data.VisitReportList});var t="api/AtmRptAuditReports/GetAuditVisitReportCounts";c.get(t).then(function(t){unlockUI(),e.pending=t.data.pending,e.approved=t.data.approved,e.approval_pending=t.data.approval_pending,e.approval_approved=t.data.approval_approved})}var _=this;_.title="AtmRptAuditVisitReportApprovalApprovedSummaryController",g(),e.approvalpending=function(){a.go("app.AtmRptAuditVisitReportApprovalSummary")},e.approvedapproved=function(){a.go("app.AtmRptAuditVisitReportApprovalApprovedSummary")},e.viewauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportApprovalApprovedView?hash="+m.encryptURL("auditvisit_gid="+t))}}angular.module("angle").controller("AtmRptAuditVisitReportApprovalApprovedSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditvisit_gid:f},a="api/AtmRptAuditReports/GetAuditVisitReportDtls";c.getparams(a,t).then(function(t){e.txtdate_ofvisit=t.data.auditvisit_date,e.txtname_inspecting=t.data.inspectingofficials_name,e.txtwhere_visitdone=t.data.visitdone_name,e.Visitpersondtl_list=t.data.mstVisitpersondtl_list,e.Visitpersonaddress_list=t.data.mstVisitpersonaddress_list,e.txtkmp_activities=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_onservation=t.data.overall_observations,e.txtinspecting_officials=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.txtentity_name=t.data.entity_name,e.reportingmanager_name=t.data.reportingmanager_name,e.txtsamfincustomer_name=t.data.samfincustomer_name,e.txtsamagrocustomer_name=t.data.samagrocustomer_name,unlockUI()});var a="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var a="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}var _=this;_.title="AtmRptAuditVisitReportApprovalApprovedViewController";var k=m.decryptURL(l.search().hash),f=k.auditvisit_gid;g(),e.visitreportmobileno_view=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";lockUI(),c.getparams(o,i).then(function(t){unlockUI(),1==t.data.status?(e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(){l.url("app/AtmRptAuditVisitReportApprovalApprovedSummary")},e.Document_Downloads=function(t,e){u.Downloaddocument(t,e)},e.photo_downloads=function(t,e){u.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.documentphotoviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.StaticMapAndPhotos_View=function(t,e,a,o,n){function r(i,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){i.staticmapImgUrl=t.data}),""==o)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",o.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?i.photoNotFound=!0:(i.photoUrlList=e,i.photoFound=!0)}),i.ok=function(){r.close("closed")}}i.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)u.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)u.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportApprovalApprovedViewController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmRptAuditReports/DeleteVisittmpDocument";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpPhoto";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpContact";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmppersondtl";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpAddress";c.get(t).then(function(t){}),v.calender1=function(t){t.preventDefault(),t.stopPropagation(),v.open1=!0},v.formats=["dd-MM-yyyy"],v.format=v.formats[0],v.dateOptions={formatYear:"yy",startingDay:1};var a={auditvisit_gid:y},t="api/AtmRptAuditReports/GetAuditVisitSamfinCustomerSummary";c.getparams(t,a).then(function(t){e.auditvisitreport_list=t.data.auditvisitreport_list});var t="api/AtmRptAuditReports/GetAuditVisitSamagroCustomerSummary";c.getparams(t,a).then(function(t){e.auditvisitreport_list1=t.data.auditvisitreport_list});var t="api/AtmRptAuditReports/GetVisitedplace";c.getparams(t,a).then(function(t){e.visitdone_list=t.data.mdlvisitdone});var t="api/employee/Employee";c.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/Marketing/GetEntity";c.get(t).then(function(t){e.entity_list=t.data.inboundentity_list});var t="api/AtmRptAuditReports/EditAuditVisitReport";c.getparams(t,a).then(function(t){if("Y"==t.data.draft_flag?(e.draft=!0,e.update=!1):(e.draft=!1,e.update=!0),e.draft_flag=t.data.draft_flag,e.txtdateof_visit=t.data.auditvisit_date,e.txtclient_kmp=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_observation=t.data.overall_observations,e.txtinspections_official=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.mstinspectingofficials=t.data.mstinspectingofficials,e.employeeedit_list=t.data.employeelist,e.visitdone_list=t.data.visitdone_list,e.msteditvisitlist=t.data.mdlvisitdone,e.cboentity=t.data.entity_gid,e.entity_name=t.data.entity_name,e.cbosamfin=t.data.samfincustomer_gid,e.cbosamagro=t.data.samagrocustomer_gid,e.cboinspecting_list=[],null!=t.data.mstinspectingofficials)for(var a=t.data.mstinspectingofficials.length,i=0;i<a;i++){var o=e.employeeedit_list.map(function(t){return t.employee_gid}).indexOf(t.data.mstinspectingofficials[i].employee_gid);e.cboinspecting_list.push(e.employeeedit_list[o])}if(e.cbovisit_done=[],null!=t.data.visitdone_list)for(var a=t.data.visitdone_list.length,i=0;i<a;i++){var o=e.msteditvisitlist.map(function(t){return t.visitdone_gid}).indexOf(t.data.visitdone_list[i].visitdone_gid);e.cbovisit_done.push(e.msteditvisitlist[o])}});var t="api/AtmRptAuditReports/GetAuditVisitPersondtlList";c.getparams(t,a).then(function(t){e.Visitpersondtl_list=t.data.mstVisitpersondtl_list});var t="api/AtmRptAuditReports/GetAuditVisitAddressList";c.getparams(t,a).then(function(t){e.Visitpersonaddressdtl_list=t.data.mstVisitpersonaddress_list});var t="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(t,a).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var t="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(t,a).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}function f(){var t={auditvisit_gid:y},a="api/AtmRptAuditReports/GetEditAuditVisitAddressList";c.getparams(a,t).then(function(t){e.Visitpersonaddressdtl_list=t.data.mstVisitpersonaddress_list})}function h(){var t={auditvisit_gid:y},a="api/AtmRptAuditReports/GetEditAuditVisitPersondtlList";c.getparams(a,t).then(function(t){e.Visitpersondtl_list=t.data.mstVisitpersondtl_list})}var v=this;v.title="AtmRptAuditVisitReportApprovalController";var A=_.decryptURL(l.search().hash);e.auditvisit_gid=A.auditvisit_gid;var y=e.auditvisit_gid;k(),e.changeentitiy=function(t){for(var a=0;a<e.entity_list.length;a++)t==e.entity_list[a].entity_gid&&(e.entity_name=e.entity_list[a].entity_name)},e.Back=function(){l.url("app/AtmRptAuditVisitReportApprovalSummary")},e.addaddress=function(){function t(t,e){var a="api/AddressType/GetAddressTypeASC";c.get(a).then(function(e){t.addresstype_list=e.data.addresstype_list}),t.onchangepostal_code=function(){var e={postal_code:t.txtpostal_code},a="api/Mstbuyer/GetPostalCodeDetails";c.getparams(a,e).then(function(e){t.txtcity=e.data.city,t.txttaluka=e.data.taluka,t.txtdistrict=e.data.district,t.txtstate=e.data.state_name})},t.ok=function(){e.close("closed")},t.getGeoCoding=function(){if(void 0==t.txtpostal_code)t.txtlatitude="",t.txtlongitude="";else if(6==t.txtpostal_code.length){if(void 0==t.txtaddressline2)var e="".concat(t.txtaddressline1.toString(),",",t.txtpostal_code.toString());else var e="".concat(t.txtaddressline1.toString(),",",t.txtaddressline2.toString(),",",t.txtpostal_code.toString());var a={address:e},i="api/GoogleMapsAPI/GetGeoCoding";c.getparams(i,a).then(function(e){"OK"==e.data.status?(t.txtlatitude=e.data.results[0].geometry.location.lat.toString(),t.txtlongitude=e.data.results[0].geometry.location.lng.toString(),t.geocodingFailed=!1):"ZERO_RESULTS"==e.data.status&&(t.geocodingFailed=!0)})}},t.txtcountry="India",t.addressSubmit=function(){var a={addresstype_name:t.cboaddresstype.address_type,addresstype_gid:t.cboaddresstype.address_gid,primary_status:t.rdbprimarystatus,address_line1:t.txtaddressline1,address_line2:t.txtaddressline2,landmark:t.txtLand_Mark,postal_code:t.txtpostal_code,taluk:t.txttaluka,city:t.txtcity,state_name:t.txtstate,district:t.txtdistrict,country:t.txtcountry,latitude:t.txtlatitude,longitude:t.txtlongitude},i="api/AtmRptAuditReports/PostAuditVisitAddress";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}o.open({templateUrl:"/addaddresstype.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]},e.addressdelete=function(t){var e={auditvisit2address_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Address ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var a="api/AtmRptAuditReports/DeleteAuditVisittmpAddressList";c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f()}),p.swal("Deleted Successfully!")}})},e.StaticMapAndPhotos_View=function(t,e,a,i,n){function r(o,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){o.staticmapImgUrl=t.data}),""==i)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",i.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?o.photoNotFound=!0:(o.photoUrlList=e,o.photoFound=!0)}),o.ok=function(){r.close("closed")}}o.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.addvisitedpersondetails=function(){function t(t,e){var a="api/Designation/GetDesignation";c.get(a).then(function(e){t.designation_list=e.data.designation_list}),t.ok=function(){e.close("closed")},t.mobileno_add=function(){var e={mobile_no:t.txtmobile_no,whatsapp_mobileno:t.rdbwhatsappmobile_no,primary_status:t.rdbprimarystatus},a="api/AtmRptAuditReports/PostAuditVisitContactNo";lockUI(),c.post(a,e).then(function(e){if(unlockUI(),1==e.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpContactList";c.get(a).then(function(e){t.Visitpersoncontact_list=e.data.mstVisitpersoncontact_list}),t.txtmobile_no="",t.rdbprimarystatus="",t.rdbwhatsappmobile_no="",s.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(e.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},t.mobileno_delete=function(e){var a={auditvisitperson2contact_gid:e};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Contact ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(e){if(e){var i="api/AtmRptAuditReports/DeleteAuditVisittmpContactList";c.getparams(i,a).then(function(e){if(1==e.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpContactList";c.get(a).then(function(e){t.Visitpersoncontact_list=e.data.mstVisitpersoncontact_list})}else s.alert("Error Occurred While Deleting Mobile Number!",{status:"warning",pos:"top-center",timeout:3e3})}),p.swal("Deleted Successfully!")}})},t.visitpersondtlSubmit=function(){if(""==t.Visitpersoncontact_list||void 0==t.Visitpersoncontact_list||null==t.Visitpersoncontact_list)s.alert("Add Atleast One Mobile Number","warning");else{var a={clientrepresentative_name:t.txtresp_client,clientrepresentative_designationgid:t.cboresp_designation.designation_gid,clientrepresentative_designationname:t.cboresp_designation.designation_type,clientrepresentative_personalmail:t.txtpersonalid_no,clientrepresentative_officemail:t.txtofficalid_no},i="api/AtmRptAuditReports/PostAuditPersonDetails";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}}o.open({templateUrl:"/addvisitpersondetails.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]},e.visitpersondtldelete=function(t){var e={auditvisit2person_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Visit Person Details ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmRptAuditReports/DeleteAuditVisittmppersondtlList";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h()}),p.swal("Deleted Successfully!")}})},e.editaddress=function(t){function e(e,a){var i="api/AddressType/GetAddressTypeASC";c.get(i).then(function(t){e.addresstype_list=t.data.addresstype_list});var o={auditvisit2address_gid:t},i="api/AtmRptAuditReports/EditAuditVisitaddress";c.getparams(i,o).then(function(t){e.cboeditaddresstype=t.data.addresstype_gid,e.rdbeditprimaryaddress=t.data.primary_status,e.txteditaddressline1=t.data.address_line1,e.txteditaddressline2=t.data.address_line2,e.txteditLand_Mark=t.data.landmark,e.txteditpostal_code=t.data.postal_code,e.txtedittaluka=t.data.taluk,e.txteditcity=t.data.city,e.txteditstate=t.data.state_name,e.txtlatitude=t.data.latitude,e.txtlongitude=t.data.longitude,e.txteditdistrict=t.data.district,e.txteditcountry=t.data.country}),e.onchangepostal_code=function(){var t={postal_code:e.txteditpostal_code},a="api/Mstbuyer/GetPostalCodeDetails";c.getparams(a,t).then(function(t){e.txteditcity=t.data.city,e.txtedittaluka=t.data.taluka,e.txteditdistrict=t.data.district,e.txteditstate=t.data.state_name})},e.ok=function(){a.close("closed")},e.getGeoCoding=function(){if(void 0==e.txtpostal_code)e.txtlatitude="",e.txtlongitude="";else if(6==e.txteditpostal_code.length){if(void 0==e.txteditaddressline2)var t="".concat(e.txteditaddressline1.toString(),",",e.txteditpostal_code.toString());else var t="".concat(e.txteditaddressline1.toString(),",",e.txteditaddressline2.toString(),",",e.txteditpostal_code.toString());var a={address:t},i="api/GoogleMapsAPI/GetGeoCoding";c.getparams(i,a).then(function(t){"OK"==t.data.status?(e.txtlatitude=t.data.results[0].geometry.location.lat.toString(),e.txtlongitude=t.data.results[0].geometry.location.lng.toString(),e.geocodingFailed=!1):"ZERO_RESULTS"==t.data.status&&(e.geocodingFailed=!0)})}},e.txtcountry="India",e.addressUpdate=function(){var i=$("#address_type :selected").text(),o="api/AtmRptAuditReports/PostAuditPersonaddressUpdate",n={auditvisit2address_gid:t,addresstype_name:i,addresstype_gid:e.cboeditaddresstype,primary_status:e.rdbeditprimaryaddress,address_line1:e.txteditaddressline1,address_line2:e.txteditaddressline2,landmark:e.txteditLand_Mark,postal_code:e.txteditpostal_code,taluk:e.txtedittaluka,city:e.txteditcity,state_name:e.txteditstate,district:e.txteditdistrict,latitude:e.txtlatitude,longitude:e.txtlongitude,country:e.txteditcountry};c.post(o,n).then(function(t){1==t.data.status?(a.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):(a.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f())})}}o.open({templateUrl:"/editaddresstype.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.auditvisitreportapprovalupdate=function(){var t,a=e.entity_list.map(function(t){return t.entity_gid}).indexOf(e.cboentity);t=a==-1?"":e.entity_list[a].entity_name;var i,o=e.auditvisitreport_list.map(function(t){return t.samfincustomer_gid}).indexOf(e.cbosamfin);i=o==-1?"":e.auditvisitreport_list[o].samfincustomer_name;var n,r=e.auditvisitreport_list1.map(function(t){return t.samagrocustomer_gid}).indexOf(e.cbosamagro);n=r==-1?"":e.auditvisitreport_list1[r].samagrocustomer_name;var d={auditvisit_gid:y,auditvisit_date:e.txtdateof_visit,auditvisitdate:e.txtdateof_visit,mstinspectingofficials:e.cboinspecting_list,mdlvisitdone:e.cbovisit_done,clientkmp_activities:e.txtclient_kmp,promoter_background:e.txtpromoter_background,overall_observations:e.txtoverall_observation,inspectingofficial_recommenation:e.txtinspections_official,trading_relationship:e.txttrading_relationship,summary:e.txtsummary,entity_gid:e.cboentity,entity_name:t,samfincustomer_gid:e.cbosamfin,samfincustomer_name:i,samagrocustomer_gid:e.cbosamagro,samagrocustomer_name:n},p="api/AtmRptAuditReports/PostAuditVisitReportApprovalUpdate";lockUI(),c.post(p,d).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),l.url("app/AtmRptAuditVisitReportApprovalSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.auditvisitreportapproval=function(){var t,a=e.entity_list.map(function(t){return t.entity_gid}).indexOf(e.cboentity);
t=a==-1?"":e.entity_list[a].entity_name;var i,o=e.auditvisitreport_list.map(function(t){return t.samfincustomer_gid}).indexOf(e.cbosamfin);i=o==-1?"":e.auditvisitreport_list[o].samfincustomer_name;var n,r=e.auditvisitreport_list1.map(function(t){return t.samagrocustomer_gid}).indexOf(e.cbosamagro);n=r==-1?"":e.auditvisitreport_list1[r].samagrocustomer_name;var d={auditvisit_gid:y,auditvisit_date:e.txtdateof_visit,auditvisitdate:e.txtdateof_visit,mstinspectingofficials:e.cboinspecting_list,mdlvisitdone:e.cbovisit_done,clientkmp_activities:e.txtclient_kmp,promoter_background:e.txtpromoter_background,overall_observations:e.txtoverall_observation,inspectingofficial_recommenation:e.txtinspections_official,trading_relationship:e.txttrading_relationship,summary:e.txtsummary,entity_gid:e.cboentity,entity_name:t,samfincustomer_gid:e.cbosamfin,samfincustomer_name:i,samagrocustomer_gid:e.cbosamagro,samagrocustomer_name:n},p="api/AtmRptAuditReports/PostAuditVisitReportApproval";lockUI(),c.post(p,d).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),l.url("app/AtmRptAuditVisitReportApprovalSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.mobileno_summary=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.VisitReportDocumentUpload=function(){var t=document.getElementById("file");if(t.files.length>0){lockUI();for(var a=new FormData,i=0;i<t.files.length;i++){a.append(t.files[i].name,t.files[i]);var o=(t.files.item(i).name,t.files.item(i).size,_.fnCheckValidDocType(t.files[i].name,"documentformatonly"));if(0==o)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1}a.append("document_name",e.txtreport_name),a.append("project_flag","documentformatonly"),e.uploadfrm=a;var n="api/AtmRptAuditReports/PostAuditVisitDocumentUpload";c.postFile(n,e.uploadfrm).then(function(t){if($("#file").val(""),unlockUI(),1==t.data.status){var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitDocumentList";c.getparams(i,a).then(function(t){e.UploadDocumentList=t.data.UploadDocumentList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()})}else s.alert("Please select a file.")},e.documentphotoviewer=function(t,e){lockUI();var a=_.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void g.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)g.Downloaddocument(t,e[a])},e.photo_downloads=function(t,e){g.Downloaddocument(t,e)},e.downloads=function(t,e){g.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=_.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void g.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)g.Downloaddocument(t,e[a])},e.uploaddocumentcancel=function(t){var a={auditvisit2document_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Document ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var i="api/AtmRptAuditReports/DeleteAuditVisittmpDocumentList";c.getparams(i,a).then(function(t){if(1==t.data.status){var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitDocumentList";c.getparams(i,a).then(function(t){e.UploadDocumentList=t.data.UploadDocumentList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()}),p.swal("Deleted Successfully!")}})},e.VisitReportPhotoUpload=function(){var t=document.getElementById("photo");if(t.files.length>0){lockUI();for(var a=new FormData,i=0;i<t.files.length;i++){a.append(t.files[i].name,t.files[i]);var o=(t.files.item(i).name,t.files.item(i).size,_.fnCheckValidDocType(t.files[i].name,"photo"));if(0==o)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1}a.append("photo_name",e.txtphoto_name),a.append("project_flag","photo"),e.uploadfrm=a;var n="api/AtmRptAuditReports/AuditVisitPhotoUpload";c.postFile(n,e.uploadfrm).then(function(t){if($("#photo").val(""),unlockUI(),1==t.data.status){var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitPhotoList";c.getparams(i,a).then(function(t){e.UploadphotoList=t.data.UploadphotoList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()})}else s.alert("Please select a file.")},e.uploadphotocancel=function(t){var a={auditvisit2photo_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Photo ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var i="api/AtmRptAuditReports/DeleteAuditVisittmpPhotoList";c.getparams(i,a).then(function(t){if(e.upload_list=t.data.upload_list,1==t.data.status){var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitPhotoList";c.getparams(i,a).then(function(t){e.UploadphotoList=t.data.UploadphotoList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()}),p.swal("Deleted Successfully!")}})},e.editvisitedpersondetails=function(t){function e(e,i){var o="api/Designation/GetDesignation";c.get(o).then(function(t){e.designation_list=t.data.designation_list});var n={auditvisit2person_gid:t},o="api/AtmRptAuditReports/EditAuditVisitpersondtl";c.getparams(o,n).then(function(t){e.txteditresp_client=t.data.clientrepresentative_name,e.cboeditresp_designation=t.data.clientrepresentative_designationgid,e.txteditpersonalid_no=t.data.clientrepresentative_personalmail,e.txteditofficialid_no=t.data.clientrepresentative_officemail});var o="api/AtmRptAuditReports/GetAuditVisitContactList";c.getparams(o,n).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.mobileno_delete=function(t){var i={auditvisitperson2contact_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Contact ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var o="api/AtmRptAuditReports/DeleteAuditVisittmpContactList";c.getparams(o,i).then(function(t){if(1==t.data.status){var i={auditvisit2person_gid:a},o="api/AtmRptAuditReports/GetEditAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list})}else s.alert("Error Occurred While Deleting Mobile Number!",{status:"warning",pos:"top-center",timeout:3e3})}),p.swal("Deleted Successfully!")}})},e.mobileno_edit=function(){if(void 0==e.txteditmobile_no||""==e.txteditmobile_no||void 0==e.rdbeditprimarystatus||void 0==e.rdbeditwhatsappmobile_no||""==e.rdbeditwhatsappmobile_no||""==e.rdbeditprimarystatus)s.alert("Enter mobile No/select primary status and whatsapp number","warning");else{var t={mobile_no:e.txteditmobile_no,whatsapp_mobileno:e.rdbeditwhatsappmobile_no,primary_status:e.rdbeditprimarystatus},i="api/AtmRptAuditReports/PostAuditVisitContactNo";lockUI(),c.post(i,t).then(function(t){if(unlockUI(),1==t.data.status){var i={auditvisit2person_gid:a},o="api/AtmRptAuditReports/GetEditAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.txteditmobile_no="",e.rdbeditprimarystatus="",e.rdbeditwhatsappmobile_no="",s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}},e.ok=function(){i.close("closed")},e.visitpersondtlupdate=function(){var t=$("#designation_type :selected").text(),o="api/AtmRptAuditReports/PostAuditPersonDetailsUpdate",n={auditvisit2person_gid:a,clientrepresentative_name:e.txteditresp_client,clientrepresentative_designationgid:e.cboeditresp_designation,clientrepresentative_designationname:t,clientrepresentative_personalmail:e.txteditpersonalid_no,clientrepresentative_officemail:e.txteditofficialid_no};c.post(o,n).then(function(t){1==t.data.status?(i.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(i.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h())})}}var a=(o.open({templateUrl:"/editvisitedpersondetails.html",controller:e,size:"lg"}),t);e.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)g.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)g.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportApprovalController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditvisit_gid:f},a="api/AtmRptAuditReports/GetAuditVisitReportDtls";c.getparams(a,t).then(function(t){e.txtdate_ofvisit=t.data.auditvisit_date,e.txtname_inspecting=t.data.inspectingofficials_name,e.txtwhere_visitdone=t.data.visitdone_name,e.Visitpersondtl_list=t.data.mstVisitpersondtl_list,e.Visitpersonaddress_list=t.data.mstVisitpersonaddress_list,e.txtkmp_activities=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_onservation=t.data.overall_observations,e.txtinspecting_officials=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.txtentity_name=t.data.entity_name,e.txtsamfincustomer_name=t.data.samfincustomer_name,e.txtsamagrocustomer_name=t.data.samagrocustomer_name,unlockUI()});var a="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var a="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}var _=this;_.title="AtmRptAuditVisitReportApprovalPendingViewController";var k=m.decryptURL(l.search().hash),f=k.auditvisit_gid;g(),e.visitreportmobileno_view=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";lockUI(),c.getparams(o,i).then(function(t){unlockUI(),1==t.data.status?(e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),addresslist()):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(){l.url("app/AtmRptAuditVisitReportApprovalSummary")},e.Document_Downloads=function(t,e){u.Downloaddocument(t,e)},e.photo_downloads=function(t,e){u.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.documentphotoviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.StaticMapAndPhotos_View=function(t,e,a,o,n){function r(i,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){i.staticmapImgUrl=t.data}),""==o)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",o.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?i.photoNotFound=!0:(i.photoUrlList=e,i.photoFound=!0)}),i.ok=function(){r.close("closed")}}i.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)u.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)u.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportApprovalPendingViewController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmRptAuditReports/GetAuditVisitReportApprovalPendingSummary";c.get(t).then(function(t){e.VisitReportList=t.data.VisitReportList});var t="api/AtmRptAuditReports/GetAuditVisitReportCounts";c.get(t).then(function(t){unlockUI(),e.pending=t.data.pending,e.approved=t.data.approved,e.approval_pending=t.data.approval_pending,e.approval_approved=t.data.approval_approved})}var _=this;_.title="AtmRptAuditVisitReportApprovalSummaryController",g(),e.approvalpending=function(){a.go("app.AtmRptAuditVisitReportApprovalSummary")},e.approvedapproved=function(){a.go("app.AtmRptAuditVisitReportApprovalApprovedSummary")},e.editauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportApproval?hash="+m.encryptURL("auditvisit_gid="+t))},e.viewauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportApprovalPendingView?hash="+m.encryptURL("auditvisit_gid="+t))}}angular.module("angle").controller("AtmRptAuditVisitReportApprovalSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmRptAuditReports/GetAuditVisitReportApprovedSummary";c.get(t).then(function(t){e.VisitReportList=t.data.VisitReportList});var t="api/AtmRptAuditReports/GetAuditVisitReportCounts";c.get(t).then(function(t){unlockUI(),e.pending=t.data.pending,e.approved=t.data.approved,e.approval_pending=t.data.approval_pending,e.approval_approved=t.data.approval_approved})}var _=this;_.title="AtmRptAuditVisitReportApprovedSummaryController",g(),e.reportpending=function(){a.go("app.AtmRptAuditVisitReportSummary")},e.reportapproved=function(){a.go("app.AtmRptAuditVisitReportApprovedSummary")},e.editauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportEdit?hash="+m.encryptURL("auditvisit_gid="+t))},e.viewauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportApprovedView?hash="+m.encryptURL("auditvisit_gid="+t))},e.createauditvisit=function(){a.go("app.AtmRptAuditVisitReport")}}angular.module("angle").controller("AtmRptAuditVisitReportApprovedSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditvisit_gid:f},a="api/AtmRptAuditReports/GetAuditVisitReportDtls";c.getparams(a,t).then(function(t){e.txtdate_ofvisit=t.data.auditvisit_date,e.txtname_inspecting=t.data.inspectingofficials_name,e.txtwhere_visitdone=t.data.visitdone_name,e.Visitpersondtl_list=t.data.mstVisitpersondtl_list,e.Visitpersonaddress_list=t.data.mstVisitpersonaddress_list,e.txtkmp_activities=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_onservation=t.data.overall_observations,e.txtinspecting_officials=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.reportingmanager_name=t.data.reportingmanager_name,e.txtentity_name=t.data.entity_name,e.txtsamfincustomer_name=t.data.samfincustomer_name,e.txtsamagrocustomer_name=t.data.samagrocustomer_name,unlockUI()});var a="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var a="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}var _=this;_.title="AtmRptAuditVisitReportApprovedViewController";var k=m.decryptURL(l.search().hash),f=k.auditvisit_gid;g(),e.visitreportmobileno_view=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";lockUI(),c.getparams(o,i).then(function(t){unlockUI(),1==t.data.status?(e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),addresslist()):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(){l.url("app/AtmRptAuditVisitReportApprovedSummary")},e.Document_Downloads=function(t,e){u.Downloaddocument(t,e)},e.photo_downloads=function(t,e){u.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.documentphotoviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.StaticMapAndPhotos_View=function(t,e,a,o,n){function r(i,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){i.staticmapImgUrl=t.data}),""==o)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",o.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?i.photoNotFound=!0:(i.photoUrlList=e,i.photoFound=!0)}),i.ok=function(){r.close("closed")}}i.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)u.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)u.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportApprovedViewController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmRptAuditReports/DeleteVisittmpDocument";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpPhoto";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpContact";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmppersondtl";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpAddress";c.get(t).then(function(t){}),v.calender1=function(t){t.preventDefault(),t.stopPropagation(),v.open1=!0},v.formats=["dd-MM-yyyy"],v.format=v.formats[0],v.dateOptions={formatYear:"yy",startingDay:1};var t="api/AtmRptAuditReports/GetVisitReportList";c.get(t).then(function(t){e.VisitReportList=t.data.VisitReportList});var t="api/MstApplicationVisitReport/GetVisitedplace";c.get(t).then(function(t){e.visitdone_list=t.data.mdlvisitdone});var t="api/employee/Employee";c.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/Marketing/GetEntity";c.get(t).then(function(t){e.entity_list=t.data.inboundentity_list});var t="api/AtmRptAuditReports/GetAuditVisitSamfinCustomerSummary";c.get(t).then(function(t){e.auditvisitreport_list=t.data.auditvisitreport_list});var t="api/AtmRptAuditReports/GetAuditVisitSamagroCustomerSummary";c.get(t).then(function(t){e.auditvisitreport_list1=t.data.auditvisitreport_list})}function f(){var t="api/AtmRptAuditReports/GetAuditVisittmpAddressList";c.get(t).then(function(t){e.Visitpersonaddressdtl_list=t.data.mstVisitpersonaddress_list})}function h(){var t="api/AtmRptAuditReports/GetAuditVisittmpPersondtlList";c.get(t).then(function(t){e.Visitpersondtl_list=t.data.mstVisitpersondtl_list})}var v=this;v.title="AtmRptAuditVisitReportController";l.search().application_gid;k(),e.editauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportEdit?hash="+_.encryptURL("auditvisit_gid="+t))},e.viewauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportView?hash="+_.encryptURL("auditvisit_gid="+t))},e.Back=function(){a.go("app.AtmRptAuditVisitReportSummary")},e.changeentitiy=function(t){for(var a=0;a<e.entity_list.length;a++)t==e.entity_list[a].entity_gid&&(e.entityselect=e.entity_list[a].entity_name)},e.addaddress=function(){function t(t,e){var a="api/AddressType/GetAddressTypeASC";c.get(a).then(function(e){t.addresstype_list=e.data.addresstype_list}),t.onchangepostal_code=function(){var e={postal_code:t.txtpostal_code},a="api/Mstbuyer/GetPostalCodeDetails";c.getparams(a,e).then(function(e){t.txtcity=e.data.city,t.txttaluka=e.data.taluka,t.txtdistrict=e.data.district,t.txtstate=e.data.state_name})},t.ok=function(){e.close("closed")},t.getGeoCoding=function(){if(void 0==t.txtpostal_code)t.txtlatitude="",t.txtlongitude="";else if(6==t.txtpostal_code.length){if(void 0==t.txtaddressline2)var e="".concat(t.txtaddressline1.toString(),",",t.txtpostal_code.toString());else var e="".concat(t.txtaddressline1.toString(),",",t.txtaddressline2.toString(),",",t.txtpostal_code.toString());var a={address:e},i="api/GoogleMapsAPI/GetGeoCoding";c.getparams(i,a).then(function(e){"OK"==e.data.status?(t.txtlatitude=e.data.results[0].geometry.location.lat.toString(),t.txtlongitude=e.data.results[0].geometry.location.lng.toString(),t.geocodingFailed=!1):"ZERO_RESULTS"==e.data.status&&(t.geocodingFailed=!0)})}},t.txtcountry="India",t.addressSubmit=function(){var a={addresstype_name:t.cboaddresstype.address_type,addresstype_gid:t.cboaddresstype.address_gid,primary_status:t.rdbprimarystatus,address_line1:t.txtaddressline1,address_line2:t.txtaddressline2,landmark:t.txtLand_Mark,postal_code:t.txtpostal_code,taluk:t.txttaluka,city:t.txtcity,state_name:t.txtstate,district:t.txtdistrict,country:t.txtcountry,latitude:t.txtlatitude,longitude:t.txtlongitude},i="api/AtmRptAuditReports/PostAuditVisitAddress";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}o.open({templateUrl:"/addaddresstype.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]},e.addressdelete=function(t){var e={auditvisit2address_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Visit Address ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmRptAuditReports/DeleteAuditVisittmpAddressList";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f()}),p.swal("Deleted Successfully!")}})},e.StaticMapAndPhotos_View=function(t,e,a,i,n){function r(o,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){o.staticmapImgUrl=t.data}),""==i)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",i.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?o.photoNotFound=!0:(o.photoUrlList=e,o.photoFound=!0)}),o.ok=function(){r.close("closed")}}o.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.addvisitedpersondetails=function(){function t(t,e){var a="api/Designation/GetDesignation";c.get(a).then(function(e){t.designation_list=e.data.designation_list}),t.ok=function(){e.close("closed")},t.mobileno_add=function(){var e={mobile_no:t.txtmobile_no,whatsapp_mobileno:t.rdbwhatsappmobile_no,primary_status:t.rdbprimarystatus},a="api/AtmRptAuditReports/PostAuditVisitContactNo";lockUI(),c.post(a,e).then(function(e){if(unlockUI(),1==e.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpContactList";c.get(a).then(function(e){t.Visitpersoncontact_list=e.data.mstVisitpersoncontact_list}),t.txtmobile_no="",t.rdbprimarystatus="",t.rdbwhatsappmobile_no="",s.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(e.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},t.mobileno_delete=function(e){var a={auditvisitperson2contact_gid:e};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(e){if(e){var i="api/AtmRptAuditReports/DeleteAuditVisittmpContactList";c.getparams(i,a).then(function(e){if(1==e.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpContactList";c.get(a).then(function(e){t.Visitpersoncontact_list=e.data.mstVisitpersoncontact_list})}else s.alert("Error Occurred While Deleting Mobile Number!",{status:"warning",pos:"top-center",timeout:3e3})}),p.swal("Deleted Successfully!")}})},t.visitpersondtlSubmit=function(){if(""==t.Visitpersoncontact_list||void 0==t.Visitpersoncontact_list||null==t.Visitpersoncontact_list)s.alert("Add Atleast One Mobile Number","warning");else{var a={clientrepresentative_name:t.txtresp_client,clientrepresentative_designationgid:t.cboresp_designation.designation_gid,clientrepresentative_designationname:t.cboresp_designation.designation_type,clientrepresentative_personalmail:t.txtpersonalid_no,clientrepresentative_officemail:t.txtofficalid_no},i="api/AtmRptAuditReports/PostAuditPersonDetails";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}}o.open({templateUrl:"/addvisitpersondetails.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]},e.visitpersondtldelete=function(t){var e={auditvisit2person_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Person Details ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmRptAuditReports/DeleteAuditVisittmppersondtlList";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h()}),p.swal("Deleted Successfully!")}})},e.editaddress=function(t){function e(e,a){var i={auditvisit2address_gid:t},o="api/AtmRptAuditReports/EditAuditVisitaddress";c.getparams(o,i).then(function(t){e.cboeditaddresstype=t.data.addresstype_gid,e.rdbeditprimaryaddress=t.data.primary_status,e.txteditaddressline1=t.data.address_line1,e.txteditaddressline2=t.data.address_line2,e.txteditLand_Mark=t.data.landmark,e.txteditpostal_code=t.data.postal_code,e.txtedittaluka=t.data.taluk,e.txteditcity=t.data.city,e.txteditstate=t.data.state_name,e.txtlatitude=t.data.latitude,e.txtlongitude=t.data.longitude,e.txteditdistrict=t.data.district,e.txteditcountry=t.data.country});var o="api/AddressType/GetAddressTypeASC";c.get(o).then(function(t){e.addresstype_list=t.data.addresstype_list}),e.onchangepostal_code=function(){var t={postal_code:e.txteditpostal_code},a="api/Mstbuyer/GetPostalCodeDetails";c.getparams(a,t).then(function(t){e.txteditcity=t.data.city,e.txtedittaluka=t.data.taluka,e.txteditdistrict=t.data.district,e.txteditstate=t.data.state_name})},e.ok=function(){a.close("closed")},e.getGeoCoding=function(){if(void 0==e.txtpostal_code)e.txtlatitude="",e.txtlongitude="";else if(6==e.txteditpostal_code.length){if(void 0==e.txteditaddressline2)var t="".concat(e.txteditaddressline1.toString(),",",e.txteditpostal_code.toString());else var t="".concat(e.txteditaddressline1.toString(),",",e.txteditaddressline2.toString(),",",e.txteditpostal_code.toString());var a={address:t},i="api/GoogleMapsAPI/GetGeoCoding";c.getparams(i,a).then(function(t){"OK"==t.data.status?(e.txtlatitude=t.data.results[0].geometry.location.lat.toString(),e.txtlongitude=t.data.results[0].geometry.location.lng.toString(),e.geocodingFailed=!1):"ZERO_RESULTS"==t.data.status&&(e.geocodingFailed=!0)})}},e.txtcountry="India",e.addressUpdate=function(){var i=$("#address_type :selected").text(),o="api/AtmRptAuditReports/PostAuditPersonaddressUpdate",n={auditvisit2address_gid:t,addresstype_name:i,addresstype_gid:e.cboeditaddresstype,primary_status:e.rdbeditprimaryaddress,address_line1:e.txteditaddressline1,address_line2:e.txteditaddressline2,landmark:e.txteditLand_Mark,postal_code:e.txteditpostal_code,taluk:e.txtedittaluka,city:e.txteditcity,state_name:e.txteditstate,district:e.txteditdistrict,latitude:e.txtlatitude,longitude:e.txtlongitude,country:e.txteditcountry};c.post(o,n).then(function(t){1==t.data.status?(a.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):(a.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f())})}}o.open({templateUrl:"/editaddresstype.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"];
},e.saveasauditvisitreport=function(){var t="",i="";t=$("#entity :selected").text(),i=e.cboentity;var o="",n="";void 0==e.cbosamfin&&null==e.cbosamfin||(n=e.cbosamfin.samfincustomer_gid,o=e.cbosamfin.samfincustomer_name);var r="",l="";void 0==e.cbosamagro&&null==e.cbosamagro||(l=e.cbosamagro.samagrocustomer_gid,r=e.cbosamagro.samagrocustomer_name);var d={auditvisit_date:e.txtdateof_visit,mstinspectingofficials:e.cboinspecting_list,mdlvisitdone:e.cbovisit_done,clientkmp_activities:e.txtclient_kmp,promoter_background:e.txtpromoter_background,overall_observations:e.txtoverall_observation,inspectingofficial_recommenation:e.txtinspections_official,trading_relationship:e.txttrading_relationship,summary:e.txtsummary,entity_gid:i,entity_name:t,samagrocustomer_gid:l,samagrocustomer_name:r,samfincustomer_gid:n,samfincustomer_name:o},p="api/AtmRptAuditReports/PostAuditVisitReport";lockUI(),c.post(p,d).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmRptAuditVisitReportSummary"),k(),e.txtdateof_visit="",e.cboinspecting_list="",e.cbovisit_done="",e.txtclient_kmp="",e.txtpromoter_background="",e.txtoverall_observation="",e.txtinspections_official="",e.txttrading_relationship="",e.txtsummary=""):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.submit_visitreport=function(){var t="",i="";t=$("#entity :selected").text(),i=e.cboentity;var o="",n="";void 0==e.cbosamagro&&null==e.cbosamagro||(n=e.cbosamagro.samagrocustomer_gid,o=e.cbosamagro.samagrocustomer_name);var r="",l="";if(void 0==e.cbosamfin&&null==e.cbosamfin||(l=e.cbosamfin.samfincustomer_gid,r=e.cbosamfin.samfincustomer_name),"SAMAGRO"!=t||null!=o&&""!=o)if("SAMFIN"!=t||null!=r&&""!=r)if(null!=r&&""!=r||null!=o&&""!=o){var d={auditvisit_date:e.txtdateof_visit,mstinspectingofficials:e.cboinspecting_list,mdlvisitdone:e.cbovisit_done,clientkmp_activities:e.txtclient_kmp,promoter_background:e.txtpromoter_background,overall_observations:e.txtoverall_observation,inspectingofficial_recommenation:e.txtinspections_official,trading_relationship:e.txttrading_relationship,summary:e.txtsummary,entity_gid:i,entity_name:t,samagrocustomer_gid:n,samagrocustomer_name:o,samfincustomer_gid:l,samfincustomer_name:r},p="api/AtmRptAuditReports/PostSubmitAuditVisitReport";lockUI(),c.post(p,d).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmRptAuditVisitReportSummary"),k(),e.txtdateof_visit="",e.cboinspecting_list="",e.cbovisit_done="",e.txtclient_kmp="",e.txtpromoter_background="",e.txtoverall_observation="",e.txtinspections_official="",e.txttrading_relationship="",e.txtsummary=""):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}else s.alert("Kindly Select Customer Name","warning");else s.alert("Kindly Select Customer Name","warning");else s.alert("Kindly Select Customer Name","warning")},e.mobileno_summary=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/mobileno_summary.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.VisitReportDocumentUpload=function(){var t=document.getElementById("file");if(t.files.length>0){lockUI();for(var a=new FormData,i=0;i<t.files.length;i++){a.append(t.files[i].name,t.files[i]);var o=(t.files.item(i).name,t.files.item(i).size,_.fnCheckValidDocType(t.files[i].name,"documentformatonly"));if(0==o)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1}a.append("document_name",e.txtreport_name),a.append("project_flag","documentformatonly"),e.uploadfrm=a;var n="api/AtmRptAuditReports/PostAuditVisitDocumentUpload";c.postFile(n,e.uploadfrm).then(function(t){if($("#file").val(""),unlockUI(),1==t.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpDocumentList";c.get(a).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()})}else s.alert("Please select a file.","warning")},e.downloads=function(t,e){g.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=_.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void g.DocumentViewer(t,e)},e.uploaddocumentcancel=function(t){var a={auditvisit2document_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Document ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var i="api/AtmRptAuditReports/DeleteAuditVisittmpDocumentList";c.getparams(i,a).then(function(t){if(1==t.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpDocumentList";c.get(a).then(function(t){e.UploadDocumentList=t.data.UploadDocumentList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()}),p.swal("Deleted Successfully!")}})},e.VisitReportPhotoUpload=function(){var t=document.getElementById("photo");if(t.files.length>0){lockUI();for(var a=new FormData,i=0;i<t.files.length;i++){a.append(t.files[i].name,t.files[i]);t.files.item(i).name,t.files.item(i).size}a.append("photo_name",e.txtphoto_name),a.append("project_flag","photo"),e.uploadfrm=a;var o="api/AtmRptAuditReports/AuditVisitPhotoUpload";c.postFile(o,e.uploadfrm).then(function(t){if($("#photo").val(""),unlockUI(),1==t.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpPhotosList";c.get(a).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()})}else s.alert("Please select a file.")},e.documentphotoviewer=function(t,e){lockUI();var a=_.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void g.DocumentViewer(t,e)},e.photo_downloads=function(t,e){g.Downloaddocument(t,e)},e.uploadphotocancel=function(t){var a={auditvisit2photo_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var i="api/AtmRptAuditReports/DeleteAuditVisittmpPhotoList";c.getparams(i,a).then(function(t){if(e.upload_list=t.data.upload_list,1==t.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpPhotosList";c.get(a).then(function(t){e.UploadphotoList=t.data.UploadphotoList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()}),p.swal("Deleted Successfully!")}})},e.editvisitedpersondetails=function(t){function e(e,i){var o="api/Designation/GetDesignation";c.get(o).then(function(t){e.designation_list=t.data.designation_list});var n={auditvisit2person_gid:t},o="api/AtmRptAuditReports/EditAuditVisitpersondtl";c.getparams(o,n).then(function(t){e.txteditresp_client=t.data.clientrepresentative_name,e.cboeditresp_designation=t.data.clientrepresentative_designationgid,e.txteditpersonalid_no=t.data.clientrepresentative_personalmail,e.txteditofficialid_no=t.data.clientrepresentative_officemail});var o="api/AtmRptAuditReports/GetAuditVisitContactList";c.getparams(o,n).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.mobileno_delete=function(t){var i={auditvisitperson2contact_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Contact ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var o="api/AtmRptAuditReports/DeleteAuditVisittmpContactList";c.getparams(o,i).then(function(t){if(1==t.data.status){var i={auditvisit2person_gid:a},o="api/AtmRptAuditReports/GetEditAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list})}else s.alert("Error Occurred While Deleting Mobile Number!",{status:"warning",pos:"top-center",timeout:3e3})}),p.swal("Deleted Successfully!")}})},e.mobileno_edit=function(){if(void 0==e.txteditmobile_no||""==e.txteditmobile_no||void 0==e.rdbeditprimarystatus||void 0==e.rdbeditwhatsappmobile_no||""==e.rdbeditwhatsappmobile_no||""==e.rdbeditprimarystatus)s.alert("Enter mobile No/select primary status and whatsapp number","warning");else{var t={mobile_no:e.txteditmobile_no,whatsapp_mobileno:e.rdbeditwhatsappmobile_no,primary_status:e.rdbeditprimarystatus},i="api/AtmRptAuditReports/PostAuditVisitContactNo";lockUI(),c.post(i,t).then(function(t){if(unlockUI(),1==t.data.status){var i={auditvisit2person_gid:a},o="api/AtmRptAuditReports/GetEditAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.txteditmobile_no="",e.rdbeditprimarystatus="",e.rdbeditwhatsappmobile_no="",s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}},e.ok=function(){i.close("closed")},e.visitpersondtlupdate=function(){var t=$("#designation_type :selected").text(),o="api/AtmRptAuditReports/PostAuditPersonDetailsUpdate",n={auditvisit2person_gid:a,clientrepresentative_name:e.txteditresp_client,clientrepresentative_designationgid:e.cboeditresp_designation,clientrepresentative_designationname:t,clientrepresentative_personalmail:e.txteditpersonalid_no,clientrepresentative_officemail:e.txteditofficialid_no};c.post(o,n).then(function(t){1==t.data.status?(i.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(i.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h())})}}var a=(o.open({templateUrl:"/editvisitedpersondetails.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"}),t);e.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)g.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)g.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmRptAuditReports/DeleteVisittmpDocument";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpPhoto";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpContact";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmppersondtl";c.get(t).then(function(t){});var t="api/AtmRptAuditReports/DeleteVisittmpAddress";c.get(t).then(function(t){}),v.calender1=function(t){t.preventDefault(),t.stopPropagation(),v.open1=!0},v.formats=["dd-MM-yyyy"],v.format=v.formats[0],v.dateOptions={formatYear:"yy",startingDay:1};var a={auditvisit_gid:y},t="api/AtmRptAuditReports/GetAuditVisitSamfinCustomerSummary";c.getparams(t,a).then(function(t){e.auditvisitreport_list=t.data.auditvisitreport_list});var t="api/AtmRptAuditReports/GetAuditVisitSamagroCustomerSummary";c.getparams(t,a).then(function(t){e.auditvisitreport_list1=t.data.auditvisitreport_list});var t="api/AtmRptAuditReports/GetVisitedplace";c.getparams(t,a).then(function(t){e.visitdone_list=t.data.mdlvisitdone});var t="api/employee/Employee";c.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/Marketing/GetEntity";c.get(t).then(function(t){e.entity_list=t.data.inboundentity_list});var t="api/AtmRptAuditReports/EditAuditVisitReport";c.getparams(t,a).then(function(t){if("Y"==t.data.draft_flag?(e.draft=!0,e.update=!1):(e.draft=!1,e.update=!0),e.draft_flag=t.data.draft_flag,e.txtdateof_visit=t.data.auditvisit_date,e.txtclient_kmp=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_observation=t.data.overall_observations,e.txtinspections_official=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.mstinspectingofficials=t.data.mstinspectingofficials,e.employeeedit_list=t.data.employeelist,e.visitdone_list=t.data.visitdone_list,e.msteditvisitlist=t.data.mdlvisitdone,e.cboentity=t.data.entity_gid,e.entity_name=t.data.entity_name,e.cbosamfin=t.data.samfincustomer_gid,e.cbosamagro=t.data.samagrocustomer_gid,e.approval_status=t.data.approval_status,e.cboinspecting_list=[],null!=t.data.mstinspectingofficials)for(var a=t.data.mstinspectingofficials.length,i=0;i<a;i++){var o=e.employeeedit_list.map(function(t){return t.employee_gid}).indexOf(t.data.mstinspectingofficials[i].employee_gid);e.cboinspecting_list.push(e.employeeedit_list[o])}if(e.cbovisit_done=[],null!=t.data.visitdone_list)for(var a=t.data.visitdone_list.length,i=0;i<a;i++){var o=e.msteditvisitlist.map(function(t){return t.visitdone_gid}).indexOf(t.data.visitdone_list[i].visitdone_gid);e.cbovisit_done.push(e.msteditvisitlist[o])}});var t="api/AtmRptAuditReports/GetAuditVisitPersondtlList";c.getparams(t,a).then(function(t){e.Visitpersondtl_list=t.data.mstVisitpersondtl_list});var t="api/AtmRptAuditReports/GetAuditVisitAddressList";c.getparams(t,a).then(function(t){e.Visitpersonaddressdtl_list=t.data.mstVisitpersonaddress_list});var t="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(t,a).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var t="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(t,a).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}function f(){var t={auditvisit_gid:y},a="api/AtmRptAuditReports/GetEditAuditVisitAddressList";c.getparams(a,t).then(function(t){e.Visitpersonaddressdtl_list=t.data.mstVisitpersonaddress_list})}function h(){var t={auditvisit_gid:y},a="api/AtmRptAuditReports/GetEditAuditVisitPersondtlList";c.getparams(a,t).then(function(t){e.Visitpersondtl_list=t.data.mstVisitpersondtl_list})}var v=this;v.title="AtmRptAuditVisitReportEditController";var A=_.decryptURL(l.search().hash);e.auditvisit_gid=A.auditvisit_gid;var y=e.auditvisit_gid;k(),e.changeentitiy=function(t){for(var a=0;a<e.entity_list.length;a++)t==e.entity_list[a].entity_gid&&(e.entity_name=e.entity_list[a].entity_name)},e.Back=function(){l.url("app/AtmRptAuditVisitReportSummary")},e.addaddress=function(){function t(t,e){var a="api/AddressType/GetAddressTypeASC";c.get(a).then(function(e){t.addresstype_list=e.data.addresstype_list}),t.onchangepostal_code=function(){var e={postal_code:t.txtpostal_code},a="api/Mstbuyer/GetPostalCodeDetails";c.getparams(a,e).then(function(e){t.txtcity=e.data.city,t.txttaluka=e.data.taluka,t.txtdistrict=e.data.district,t.txtstate=e.data.state_name})},t.ok=function(){e.close("closed")},t.getGeoCoding=function(){if(void 0==t.txtpostal_code)t.txtlatitude="",t.txtlongitude="";else if(6==t.txtpostal_code.length){if(void 0==t.txtaddressline2)var e="".concat(t.txtaddressline1.toString(),",",t.txtpostal_code.toString());else var e="".concat(t.txtaddressline1.toString(),",",t.txtaddressline2.toString(),",",t.txtpostal_code.toString());var a={address:e},i="api/GoogleMapsAPI/GetGeoCoding";c.getparams(i,a).then(function(e){"OK"==e.data.status?(t.txtlatitude=e.data.results[0].geometry.location.lat.toString(),t.txtlongitude=e.data.results[0].geometry.location.lng.toString(),t.geocodingFailed=!1):"ZERO_RESULTS"==e.data.status&&(t.geocodingFailed=!0)})}},t.txtcountry="India",t.addressSubmit=function(){var a={addresstype_name:t.cboaddresstype.address_type,addresstype_gid:t.cboaddresstype.address_gid,primary_status:t.rdbprimarystatus,address_line1:t.txtaddressline1,address_line2:t.txtaddressline2,landmark:t.txtLand_Mark,postal_code:t.txtpostal_code,taluk:t.txttaluka,city:t.txtcity,state_name:t.txtstate,district:t.txtdistrict,country:t.txtcountry,latitude:t.txtlatitude,longitude:t.txtlongitude},i="api/AtmRptAuditReports/PostAuditVisitAddress";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}o.open({templateUrl:"/addaddresstype.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]},e.addressdelete=function(t){var e={auditvisit2address_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Address ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var a="api/AtmRptAuditReports/DeleteAuditVisittmpAddressList";c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f()}),p.swal("Deleted Successfully!")}})},e.StaticMapAndPhotos_View=function(t,e,a,i,n){function r(o,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){o.staticmapImgUrl=t.data}),""==i)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",i.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?o.photoNotFound=!0:(o.photoUrlList=e,o.photoFound=!0)}),o.ok=function(){r.close("closed")}}o.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.addvisitedpersondetails=function(){function t(t,e){var a="api/Designation/GetDesignation";c.get(a).then(function(e){t.designation_list=e.data.designation_list}),t.ok=function(){e.close("closed")},t.mobileno_add=function(){var e={mobile_no:t.txtmobile_no,whatsapp_mobileno:t.rdbwhatsappmobile_no,primary_status:t.rdbprimarystatus},a="api/AtmRptAuditReports/PostAuditVisitContactNo";lockUI(),c.post(a,e).then(function(e){if(unlockUI(),1==e.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpContactList";c.get(a).then(function(e){t.Visitpersoncontact_list=e.data.mstVisitpersoncontact_list}),t.txtmobile_no="",t.rdbprimarystatus="",t.rdbwhatsappmobile_no="",s.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(e.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},t.mobileno_delete=function(e){var a={auditvisitperson2contact_gid:e};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Contact ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(e){if(e){var i="api/AtmRptAuditReports/DeleteAuditVisittmpContactList";c.getparams(i,a).then(function(e){if(1==e.data.status){var a="api/AtmRptAuditReports/GetAuditVisittmpContactList";c.get(a).then(function(e){t.Visitpersoncontact_list=e.data.mstVisitpersoncontact_list})}else s.alert("Error Occurred While Deleting Mobile Number!",{status:"warning",pos:"top-center",timeout:3e3})}),p.swal("Deleted Successfully!")}})},t.visitpersondtlSubmit=function(){if(""==t.Visitpersoncontact_list||void 0==t.Visitpersoncontact_list||null==t.Visitpersoncontact_list)s.alert("Add Atleast One Mobile Number","warning");else{var a={clientrepresentative_name:t.txtresp_client,clientrepresentative_designationgid:t.cboresp_designation.designation_gid,clientrepresentative_designationname:t.cboresp_designation.designation_type,clientrepresentative_personalmail:t.txtpersonalid_no,clientrepresentative_officemail:t.txtofficalid_no},i="api/AtmRptAuditReports/PostAuditPersonDetails";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}}o.open({templateUrl:"/addvisitpersondetails.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]},e.visitpersondtldelete=function(t){var e={auditvisit2person_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Visit Person Details ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/AtmRptAuditReports/DeleteAuditVisittmppersondtlList";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h()}),p.swal("Deleted Successfully!")}})},e.editaddress=function(t){function e(e,a){var i="api/AddressType/GetAddressTypeASC";c.get(i).then(function(t){e.addresstype_list=t.data.addresstype_list});var o={auditvisit2address_gid:t},i="api/AtmRptAuditReports/EditAuditVisitaddress";c.getparams(i,o).then(function(t){e.cboeditaddresstype=t.data.addresstype_gid,e.rdbeditprimaryaddress=t.data.primary_status,e.txteditaddressline1=t.data.address_line1,e.txteditaddressline2=t.data.address_line2,e.txteditLand_Mark=t.data.landmark,e.txteditpostal_code=t.data.postal_code,e.txtedittaluka=t.data.taluk,e.txteditcity=t.data.city,e.txteditstate=t.data.state_name,e.txtlatitude=t.data.latitude,e.txtlongitude=t.data.longitude,e.txteditdistrict=t.data.district,e.txteditcountry=t.data.country}),e.onchangepostal_code=function(){var t={postal_code:e.txteditpostal_code},a="api/Mstbuyer/GetPostalCodeDetails";c.getparams(a,t).then(function(t){e.txteditcity=t.data.city,e.txtedittaluka=t.data.taluka,e.txteditdistrict=t.data.district,e.txteditstate=t.data.state_name})},e.ok=function(){a.close("closed")},e.getGeoCoding=function(){if(void 0==e.txtpostal_code)e.txtlatitude="",e.txtlongitude="";else if(6==e.txteditpostal_code.length){if(void 0==e.txteditaddressline2)var t="".concat(e.txteditaddressline1.toString(),",",e.txteditpostal_code.toString());else var t="".concat(e.txteditaddressline1.toString(),",",e.txteditaddressline2.toString(),",",e.txteditpostal_code.toString());var a={address:t},i="api/GoogleMapsAPI/GetGeoCoding";c.getparams(i,a).then(function(t){"OK"==t.data.status?(e.txtlatitude=t.data.results[0].geometry.location.lat.toString(),e.txtlongitude=t.data.results[0].geometry.location.lng.toString(),e.geocodingFailed=!1):"ZERO_RESULTS"==t.data.status&&(e.geocodingFailed=!0)})}},e.txtcountry="India",e.addressUpdate=function(){var i=$("#address_type :selected").text(),o="api/AtmRptAuditReports/PostAuditPersonaddressUpdate",n={auditvisit2address_gid:t,addresstype_name:i,addresstype_gid:e.cboeditaddresstype,primary_status:e.rdbeditprimaryaddress,address_line1:e.txteditaddressline1,address_line2:e.txteditaddressline2,landmark:e.txteditLand_Mark,postal_code:e.txteditpostal_code,taluk:e.txtedittaluka,city:e.txteditcity,state_name:e.txteditstate,district:e.txteditdistrict,latitude:e.txtlatitude,longitude:e.txtlongitude,country:e.txteditcountry};c.post(o,n).then(function(t){1==t.data.status?(a.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):(a.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),f())})}}o.open({templateUrl:"/editaddresstype.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.saveasdraft_update=function(){if(""==e.txtdateof_visit||null==e.txtdateof_visit||void 0==e.txtdateof_visit)s.alert("Select Date Of Visit","warning");else{var t={auditvisit_gid:y,auditvisit_date:e.txtdateof_visit,auditvisitdate:e.txtdateof_visit,mstinspectingofficials:e.cboinspecting_list,mdlvisitdone:e.cbovisit_done,clientkmp_activities:e.txtclient_kmp,promoter_background:e.txtpromoter_background,overall_observations:e.txtoverall_observation,inspectingofficial_recommenation:e.txtinspections_official,trading_relationship:e.txttrading_relationship,summary:e.txtsummary},a="api/AtmRptAuditReports/PostSaveAuditVisitReportUpdate";lockUI(),c.post(a,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),l.url("app/MstVisitReportAdd?application_gid="+application_gid)):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}},e.visitreportSubmit=function(){var t={auditvisit_gid:y,auditvisit_date:e.txtdateof_visit,auditvisitdate:e.txtdateof_visit,mstinspectingofficials:e.cboinspecting_list,mdlvisitdone:e.cbovisit_done,clientkmp_activities:e.txtclient_kmp,promoter_background:e.txtpromoter_background,overall_observations:e.txtoverall_observation,inspectingofficial_recommenation:e.txtinspections_official,trading_relationship:e.txttrading_relationship,summary:e.txtsummary},a="api/AtmRptAuditReports/PostSubmitAuditVisitReportUpdate";lockUI(),c.post(a,t).then(function(t){if(unlockUI(),1==t.data.status){var a={application_gid:application_gid,statusupdated_by:"RM"},i="api/AtmRptAuditReports/GetAuditVisitReportList";c.getparams(i,a).then(function(t){e.VisitReportList=t.data.VisitReportList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),l.url("app/MstVisitReportAdd?application_gid="+application_gid)}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.visitreportUpdate=function(){var t,a=e.entity_list.map(function(t){return t.entity_gid}).indexOf(e.cboentity);t=a==-1?"":e.entity_list[a].entity_name;var i,o=e.auditvisitreport_list.map(function(t){return t.samfincustomer_gid}).indexOf(e.cbosamfin);i=o==-1?"":e.auditvisitreport_list[o].samfincustomer_name;var n,r=e.auditvisitreport_list1.map(function(t){return t.samagrocustomer_gid}).indexOf(e.cbosamagro);n=r==-1?"":e.auditvisitreport_list1[r].samagrocustomer_name;var d={auditvisit_gid:y,auditvisit_date:e.txtdateof_visit,auditvisitdate:e.txtdateof_visit,mstinspectingofficials:e.cboinspecting_list,mdlvisitdone:e.cbovisit_done,clientkmp_activities:e.txtclient_kmp,promoter_background:e.txtpromoter_background,overall_observations:e.txtoverall_observation,inspectingofficial_recommenation:e.txtinspections_official,trading_relationship:e.txttrading_relationship,summary:e.txtsummary,entity_gid:e.cboentity,entity_name:t,samfincustomer_gid:e.cbosamfin,samfincustomer_name:i,samagrocustomer_gid:e.cbosamagro,samagrocustomer_name:n},p="api/AtmRptAuditReports/PostUpdateAuditVisitReportUpdate";lockUI(),c.post(p,d).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),l.url("app/AtmRptAuditVisitReportSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.mobileno_summary=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.ok=function(){a.close("closed")}}o.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.VisitReportDocumentUpload=function(){var t=document.getElementById("file");if(t.files.length>0){lockUI();for(var a=new FormData,i=0;i<t.files.length;i++){a.append(t.files[i].name,t.files[i]);var o=(t.files.item(i).name,t.files.item(i).size,_.fnCheckValidDocType(t.files[i].name,"documentformatonly"));if(0==o)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1}a.append("document_name",e.txtreport_name),a.append("project_flag","documentformatonly"),e.uploadfrm=a;var n="api/AtmRptAuditReports/PostAuditVisitDocumentUpload";c.postFile(n,e.uploadfrm).then(function(t){if($("#file").val(""),unlockUI(),1==t.data.status){var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitDocumentList";c.getparams(i,a).then(function(t){e.UploadDocumentList=t.data.UploadDocumentList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()})}else s.alert("Please select a file.")},e.documentviewer=function(t,e){lockUI();var a=_.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void g.DocumentViewer(t,e)},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)g.Downloaddocument(t,e[a])},e.photo_downloads=function(t,e){g.Downloaddocument(t,e)},e.downloads=function(t,e){g.Downloaddocument(t,e)},e.documentphotoviewer=function(t,e){lockUI();var a=_.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void g.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)g.Downloaddocument(t,e[a])},e.uploaddocumentcancel=function(t){var a={auditvisit2document_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Document ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var i="api/AtmRptAuditReports/DeleteAuditVisittmpDocumentList";c.getparams(i,a).then(function(t){if(1==t.data.status){var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitDocumentList";c.getparams(i,a).then(function(t){e.UploadDocumentList=t.data.UploadDocumentList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()}),p.swal("Deleted Successfully!")}})},e.VisitReportPhotoUpload=function(){var t=document.getElementById("photo");if(t.files.length>0){lockUI();for(var a=new FormData,i=0;i<t.files.length;i++){a.append(t.files[i].name,t.files[i]);var o=(t.files.item(i).name,t.files.item(i).size,_.fnCheckValidDocType(t.files[i].name,"photo"));if(0==o)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1}a.append("photo_name",e.txtphoto_name),a.append("project_flag","photo"),e.uploadfrm=a;var n="api/AtmRptAuditReports/AuditVisitPhotoUpload";c.postFile(n,e.uploadfrm).then(function(t){if($("#photo").val(""),unlockUI(),1==t.data.status){var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitPhotoList";c.getparams(i,a).then(function(t){e.UploadphotoList=t.data.UploadphotoList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()})}else s.alert("Please select a file.")},e.uploadphotocancel=function(t){var a={auditvisit2photo_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Photo ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var i="api/AtmRptAuditReports/DeleteAuditVisittmpPhotoList";c.getparams(i,a).then(function(t){if(e.upload_list=t.data.upload_list,1==t.data.status){
var a={auditvisit_gid:y},i="api/AtmRptAuditReports/GetEditAuditVisitPhotoList";c.getparams(i,a).then(function(t){e.UploadphotoList=t.data.UploadphotoList}),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3});unlockUI()}),p.swal("Deleted Successfully!")}})},e.editvisitedpersondetails=function(t){function e(e,i){var o="api/Designation/GetDesignation";c.get(o).then(function(t){e.designation_list=t.data.designation_list});var n={auditvisit2person_gid:t},o="api/AtmRptAuditReports/EditAuditVisitpersondtl";c.getparams(o,n).then(function(t){e.txteditresp_client=t.data.clientrepresentative_name,e.cboeditresp_designation=t.data.clientrepresentative_designationgid,e.txteditpersonalid_no=t.data.clientrepresentative_personalmail,e.txteditofficialid_no=t.data.clientrepresentative_officemail});var o="api/AtmRptAuditReports/GetAuditVisitContactList";c.getparams(o,n).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.mobileno_delete=function(t){var i={auditvisitperson2contact_gid:t};p.swal({title:"Are you sure?",text:"Do You Want To Delete the Contact ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var o="api/AtmRptAuditReports/DeleteAuditVisittmpContactList";c.getparams(o,i).then(function(t){if(1==t.data.status){var i={auditvisit2person_gid:a},o="api/AtmRptAuditReports/GetEditAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list})}else s.alert("Error Occurred While Deleting Mobile Number!",{status:"warning",pos:"top-center",timeout:3e3})}),p.swal("Deleted Successfully!")}})},e.mobileno_edit=function(){if(void 0==e.txteditmobile_no||""==e.txteditmobile_no||void 0==e.rdbeditprimarystatus||void 0==e.rdbeditwhatsappmobile_no||""==e.rdbeditwhatsappmobile_no||""==e.rdbeditprimarystatus)s.alert("Enter mobile No/select primary status and whatsapp number","warning");else{var t={mobile_no:e.txteditmobile_no,whatsapp_mobileno:e.rdbeditwhatsappmobile_no,primary_status:e.rdbeditprimarystatus},i="api/AtmRptAuditReports/PostAuditVisitContactNo";lockUI(),c.post(i,t).then(function(t){if(unlockUI(),1==t.data.status){var i={auditvisit2person_gid:a},o="api/AtmRptAuditReports/GetEditAuditVisitContactList";c.getparams(o,i).then(function(t){e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list}),e.txteditmobile_no="",e.rdbeditprimarystatus="",e.rdbeditwhatsappmobile_no="",s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})}else s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}},e.ok=function(){i.close("closed")},e.visitpersondtlupdate=function(){var t=$("#designation_type :selected").text(),o="api/AtmRptAuditReports/PostAuditPersonDetailsUpdate",n={auditvisit2person_gid:a,clientrepresentative_name:e.txteditresp_client,clientrepresentative_designationgid:e.cboeditresp_designation,clientrepresentative_designationname:t,clientrepresentative_personalmail:e.txteditpersonalid_no,clientrepresentative_officemail:e.txteditofficialid_no};c.post(o,n).then(function(t){1==t.data.status?(i.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):(i.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),h())})}}var a=(o.open({templateUrl:"/editvisitedpersondetails.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"}),t);e.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)g.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)g.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportEditController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmRptAuditReports/GetAuditVisitReportManagementApprovedSummary";c.get(t).then(function(t){e.VisitReportList=t.data.VisitReportList});var t="api/AtmRptAuditReports/GetAuditVisitReportCounts";c.get(t).then(function(t){unlockUI(),e.pending=t.data.pending,e.approved=t.data.approved,e.approval_pending=t.data.approval_pending,e.approval_approved=t.data.approval_approved,e.management_pending=t.data.management_pending,e.management_approved=t.data.management_approved})}var k=this;k.title="AtmRptAuditVisitReportManagementApprovedSummaryController",_(),e.AuditVisitApprovedReport=function(){lockUI();var t="api/AtmRptAuditReports/ExportAuditVisitApprovedReport";c.get(t).then(function(t){1==t.data.status?(unlockUI(),m.Downloaddocument(t.data.lscloudpath,t.data.lsname)):(unlockUI(),s.alert("Error Occurred While Exporting !","warning"))})},e.approvalpending=function(){a.go("app.AtmRptAuditVisitReportManagementPendingSummary")},e.approvedapproved=function(){a.go("app.AtmRptAuditVisitReportManagementApprovedSummary")},e.viewauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportManagementApprovedView?hash="+g.encryptURL("auditvisit_gid="+t))}}angular.module("angle").controller("AtmRptAuditVisitReportManagementApprovedSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditvisit_gid:f},a="api/AtmRptAuditReports/GetAuditVisitReportDtls";c.getparams(a,t).then(function(t){e.txtdate_ofvisit=t.data.auditvisit_date,e.txtname_inspecting=t.data.inspectingofficials_name,e.txtwhere_visitdone=t.data.visitdone_name,e.Visitpersondtl_list=t.data.mstVisitpersondtl_list,e.Visitpersonaddress_list=t.data.mstVisitpersonaddress_list,e.txtkmp_activities=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_onservation=t.data.overall_observations,e.txtinspecting_officials=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.txtentity_name=t.data.entity_name,e.reportingmanager_name=t.data.reportingmanager_name,e.txtsamfincustomer_name=t.data.samfincustomer_name,e.txtsamagrocustomer_name=t.data.samagrocustomer_name,unlockUI()});var a="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var a="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}var _=this;_.title="AtmRptAuditVisitReportManagementApprovedViewController";var k=m.decryptURL(l.search().hash),f=k.auditvisit_gid;g(),e.visitreportmobileno_view=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";lockUI(),c.getparams(o,i).then(function(t){unlockUI(),1==t.data.status?(e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),addresslist()):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(){l.url("app/AtmRptAuditVisitReportManagementApprovedSummary")},e.Document_Downloads=function(t,e){u.Downloaddocument(t,e)},e.photo_downloads=function(t,e){u.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.documentphotoviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.StaticMapAndPhotos_View=function(t,e,a,o,n){function r(i,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){i.staticmapImgUrl=t.data}),""==o)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",o.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?i.photoNotFound=!0:(i.photoUrlList=e,i.photoFound=!0)}),i.ok=function(){r.close("closed")}}i.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)u.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)u.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportManagementApprovedViewController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmRptAuditReports/GetAuditVisitReportManagementPendingSummary";c.get(t).then(function(t){e.VisitReportList=t.data.VisitReportList});var t="api/AtmRptAuditReports/GetAuditVisitReportCounts";c.get(t).then(function(t){unlockUI(),e.pending=t.data.pending,e.approved=t.data.approved,e.approval_pending=t.data.approval_pending,e.approval_approved=t.data.approval_approved,e.management_pending=t.data.management_pending,e.management_approved=t.data.management_approved})}var k=this;k.title="AtmRptAuditVisitReportManagementPendingSummaryController",_(),e.AuditVisitPendingReport=function(){lockUI();var t="api/AtmRptAuditReports/ExportAuditVisitPendingReport";c.get(t).then(function(t){1==t.data.status?(unlockUI(),m.Downloaddocument(t.data.lscloudpath,t.data.lsname)):(unlockUI(),s.alert("Error Occurred While Exporting !","warning"))})},e.approvalpending=function(){a.go("app.AtmRptAuditVisitReportManagementPendingSummary")},e.approvedapproved=function(){a.go("app.AtmRptAuditVisitReportManagementApprovedSummary")},e.editauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportApproval?hash="+g.encryptURL("auditvisit_gid="+t))},e.viewauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportManagementPendingView?hash="+g.encryptURL("auditvisit_gid="+t))}}angular.module("angle").controller("AtmRptAuditVisitReportManagementPendingSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditvisit_gid:f},a="api/AtmRptAuditReports/GetAuditVisitReportDtls";c.getparams(a,t).then(function(t){e.txtdate_ofvisit=t.data.auditvisit_date,e.txtname_inspecting=t.data.inspectingofficials_name,e.txtwhere_visitdone=t.data.visitdone_name,e.Visitpersondtl_list=t.data.mstVisitpersondtl_list,e.Visitpersonaddress_list=t.data.mstVisitpersonaddress_list,e.txtkmp_activities=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_onservation=t.data.overall_observations,e.txtinspecting_officials=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.txtentity_name=t.data.entity_name,e.reportingmanager_name=t.data.reportingmanager_name,e.txtsamfincustomer_name=t.data.samfincustomer_name,e.txtsamagrocustomer_name=t.data.samagrocustomer_name,unlockUI()});var a="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var a="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}var _=this;_.title="AtmRptAuditVisitReportManagementPendingViewController";var k=m.decryptURL(l.search().hash),f=k.auditvisit_gid;g(),e.visitreportmobileno_view=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";lockUI(),c.getparams(o,i).then(function(t){unlockUI(),1==t.data.status?(e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),addresslist()):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(){l.url("app/AtmRptAuditVisitReportManagementPendingSummary")},e.Document_Downloads=function(t,e){u.Downloaddocument(t,e)},e.photo_downloads=function(t,e){u.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.documentphotoviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.StaticMapAndPhotos_View=function(t,e,a,o,n){function r(i,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){i.staticmapImgUrl=t.data}),""==o)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",o.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?i.photoNotFound=!0:(i.photoUrlList=e,i.photoFound=!0)}),i.ok=function(){r.close("closed")}}i.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)u.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)u.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportManagementPendingViewController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmRptAuditReports/GetVisitReportList";c.get(t).then(function(t){e.VisitReportList=t.data.VisitReportList});var t="api/AtmRptAuditReports/GetAuditVisitReportCounts";c.get(t).then(function(t){unlockUI(),e.pending=t.data.pending,e.approved=t.data.approved,e.approval_pending=t.data.approval_pending,e.approval_approved=t.data.approval_approved})}var _=this;_.title="AtmRptAuditVisitReportSummaryController",g(),e.reportpending=function(){a.go("app.AtmRptAuditVisitReportSummary")},e.reportapproved=function(){a.go("app.AtmRptAuditVisitReportApprovedSummary")},e.createauditvisit=function(){a.go("app.AtmRptAuditVisitReport")},e.editauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportEdit?hash="+m.encryptURL("auditvisit_gid="+t))},e.viewauditvisitreport=function(t){l.url("app/AtmRptAuditVisitReportView?hash="+m.encryptURL("auditvisit_gid="+t))}}angular.module("angle").controller("AtmRptAuditVisitReportSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditvisit_gid:f},a="api/AtmRptAuditReports/GetAuditVisitReportDtls";c.getparams(a,t).then(function(t){e.txtdate_ofvisit=t.data.auditvisit_date,e.txtname_inspecting=t.data.inspectingofficials_name,e.txtwhere_visitdone=t.data.visitdone_name,e.Visitpersondtl_list=t.data.mstVisitpersondtl_list,e.Visitpersonaddress_list=t.data.mstVisitpersonaddress_list,e.txtkmp_activities=t.data.clientkmp_activities,e.txtpromoter_background=t.data.promoter_background,e.txtoverall_onservation=t.data.overall_observations,e.txtinspecting_officials=t.data.inspectingofficial_recommenation,e.txttrading_relationship=t.data.trading_relationship,e.txtsummary=t.data.summary,e.txtentity_name=t.data.entity_name,e.reportingmanager_name=t.data.reportingmanager_name,e.txtsamfincustomer_name=t.data.samfincustomer_name,e.txtsamagrocustomer_name=t.data.samagrocustomer_name,unlockUI()});var a="api/AtmRptAuditReports/GetAuditVisitPhotosList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadphotoList=t.data.UploadphotoList});var a="api/AtmRptAuditReports/GetAuditVisitDocumentList";c.getparams(a,t).then(function(t){e.lsfilename=t.data.filesname,e.lsfilepath=t.data.filepath,e.UploadDocumentList=t.data.UploadDocumentList})}var _=this;_.title="AtmRptAuditVisitReportViewController";var k=m.decryptURL(l.search().hash),f=k.auditvisit_gid;g(),e.visitreportmobileno_view=function(t){function e(e,a){var i={auditvisit2person_gid:t},o="api/AtmRptAuditReports/GetAuditVisitContactList";lockUI(),c.getparams(o,i).then(function(t){unlockUI(),1==t.data.status?(e.Visitpersoncontact_list=t.data.mstVisitpersoncontact_list,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),addresslist()):s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3})}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/mobileno_summary.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(){l.url("app/AtmRptAuditVisitReportSummary")},e.Document_Downloads=function(t,e){u.Downloaddocument(t,e)},e.photo_downloads=function(t,e){u.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.documentphotoviewer=function(t,e){lockUI();var a=m.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void u.DocumentViewer(t,e)},e.downloadall1=function(t,e){for(var a=0;a<e.length;a++)u.Downloaddocument(t,e[a])},e.StaticMapAndPhotos_View=function(t,e,a,o,n){function r(i,r){var s={latitude:t,longitude:e},l="api/GoogleMapsAPI/GetStaticMapUrl";if(c.getparams(l,s).then(function(t){i.staticmapImgUrl=t.data}),""==o)var d="".concat(a.toString(),",",n.toString());else var d="".concat(a.toString(),",",o.toString(),",",n.toString());var s={address:d},l="api/GoogleMapsAPI/GetPlaceImage";c.getparams(l,s).then(function(t){for(var e=[],a=0;a<t.data.length;a++)null!=t.data[a]&&(e[a]=t.data[a]);0==e.length?i.photoNotFound=!0:(i.photoUrlList=e,i.photoFound=!0)}),i.ok=function(){r.close("closed")}}i.open({templateUrl:"/StaticMapAndPhotosView.html",controller:r,backdrop:"static",keyboard:!1,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.downloadall=function(){for(var t=0;t<e.UploadDocumentList.length;t++)u.Downloaddocument(e.UploadDocumentList[t].document_path,e.UploadDocumentList[t].filename)},e.downloadall_photo=function(){for(var t=0;t<e.UploadphotoList.length;t++)u.Downloaddocument(e.UploadphotoList[t].document_path,e.UploadphotoList[t].filename)}}angular.module("angle").controller("AtmRptAuditVisitReportViewController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t="api/AtmTrnAuditorMaker/GetInitialApproval";lockUI(),c.get(t).then(function(t){e.initialapproval_list=t.data.initialapproval_list,e.approvalhistory_list=t.data.approvalhistory_list,unlockUI()}),e.view=function(t,e){l.url("app/AtmTrnApprovalView?initialapproval_gid="+t+"&auditcreation_gid="+e)}}var g=this;g.title="AtmTrnApprovalController",m(),e.back=function(t){a.go("app.AtmTrnAuditorMakerSummary")}}angular.module("angle").controller("AtmTrnApprovalController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t={initialapproval_gid:k},a="api/AtmTrnAuditorMaker/GetInitialApprovalView";lockUI(),c.getparams(a,t).then(function(t){e.initialapprovalview_list=t.data.initialapprovalview_list,unlockUI()})}var g=this;g.title="AtmTrnApprovalViewController";var _=l.search().auditcreation_gid,k=l.search().initialapproval_gid;m(),e.approve_submit=function(){var t={initialapproval_gid:k,auditcreation_gid:_,approve_remark:e.reject_remarks},i="api/AtmTrnAuditorMaker/PostObservationApproval";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnApproval")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.reject_submit=function(){var t={initialapproval_gid:k,auditcreation_gid:_,approve_remark:e.reject_remark};lockUI();var i="api/AtmTrnAuditorMaker/PostObservationRejected";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnApproval")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.back=function(){a.go("app.AtmTrnApproval")}}angular.module("angle").controller("AtmTrnApprovalViewController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditorMaker/EditAuditorMakerCheckpointObservation",a={auditcreation_gid:k};lockUI(),s.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditorMakerCheckpointObservationView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,e){t.capture_score==t.yes_score?t.yes_radio=!0:t.capture_score==t.no_score?t.no_radio=!0:t.capture_score==t.partial_score?t.partialscore_radio=!0:t.capture_score==t.na_score&&(t.nascore_radio=!0)})});var t="api/AtmTrnSampling/GetSampleAuditor";s.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnApproverCheckpointObservationController";var k=d.search().auditcreation_gid;d.search().auditcreation2checklist_gid;e.sampleimport_gid=d.search().sampleimport_gid;e.sampleimport_gid;g(),e.onselected=function(t,a,i){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:k,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_totalscore:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),s.post(n,o).then(function(t){1==t.data.status?(e.txttotal_score=t.data.total_amount,unlockUI(),l.alert(t.data.message,{status:"success",pos:"bottom-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"bottom-center",timeout:3e3}),unlockUI())})},e.submitobservation=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t,auditcreation_gid:k},o="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Check point  Successfully!","success"),i.go("app.AtmTrnAuditorMakerSummary")):l.alert("Select Atleast One..!!","warning"),e.txttotal_score=""})},e.back=function(t){i.go("app.AtmTrnAuditorApproverSummary")},e.checkpointintent=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,e){function i(a,i){var o={sampleimport_gid:e},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.btnconfirm=function(){var o={employelist:a.cboemployee_name,sample_name:a.txtsample_name,sampleimport_gid:e,auditcreation_gid:t},n="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnMakerCheckpointObservation?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/taguser.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,employelist:a.cboemployee_name,description:a.txtdescription,auditcreation_gid:e},o="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(o,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnSampling?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.assignedquery=function(t,e){d.url("app/AtmTrnSampleAssignedQuery?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.view=function(t,a){e.sampleimport_gid,e.auditcreation_gid;d.url("app/AtmTrnSamplingView?auditcreation_gid="+t+"&sampleimport_gid="+a)},e.back=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.samplequery=function(t,e){d.url("app/AtmTrnSampleQueryAuditor?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(t,a,i){var o=document.getElementById("fileimport"),n=o.value;e.fileinputvalue=n;var r=/(\.xls|\.xlsx|\.csv)$/i;if(r.exec(n))if(0==n.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),$modalInstance.close("closed");else{var c={name:t[0].name,file:t[0]},s=new FormData;s.append("fileupload",c.file),s.append("file_name",c.name),s.append("auditcreation_gid",k),e.uploadfrm=s}else l.alert("File Format Not Supported!","warning"),$modalInstance.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){
1==t.data.status?(g(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnMakerCheckpointObservation?auditcreation_gid="+val1),$modalInstance.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),$modalInstance.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}angular.module("angle").controller("AtmTrnApproverCheckpointObservationController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:k},a="api/AtmTrnMyAuditTask/GetAssignedQuerySummary";s.getparams(a,t).then(function(t){e.AssignedQueryList=t.data.AssignedQueryList,unlockUI()});var a="api/AtmTrnSampling/GetSample";s.getparams(a,t).then(function(t){unlockUI(),k=t.data.auditcreation_gid,e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnAssignedQueryController",e.auditcreation_gid=d.search().auditcreation_gid;var k=e.auditcreation_gid;g(),e.Reply=function(){var t=e.auditcreation_gid;d.url("app/AtmTrnReplyToQuery?auditcreation_gid="+t)},e.replytoquery=function(t){function e(e,a){var i={raisequery_gid:t},o="api/AtmTrnMyAuditTask/EditAssignedQuery";s.getparams(o,i).then(function(t){e.raisequery_gid=t.data.raisequery_gid}),e.ok=function(){a.close("closed")},e.submit=function(){var t={raisequery_gid:e.raisequery_gid,reply_query:e.txtdescription},i="api/AtmTrnMyAuditTask/PostReplyToQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+val),a.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/replytoquery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.back=function(t){i.go("app.AtmTrnMyAuditTaskSummary")}}angular.module("angle").controller("AtmTrnAssignedQueryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","$sce"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:v};lockUI(),s.getparams(t,a).then(function(t){if(e.cboauditdepartment=t.data.auditdepartment_gid,e.auditobservation=t.data.auditobservation_name,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtrejected_remarks=t.data.rejected_remarks,e.txtaudit_desc=t.data.audit_description,"Open"==t.data.status_update){e.showAprrovalbutton=!0;var a={checklistmaster_gid:A,auditcreation_gid:v},i="api/AtmTrnAuditCreation/CheckpointCreation";lockUI(),s.getparams(i,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list,angular.forEach(e.checkpointsummary_list,function(t,e){t.checked=!0})})}else if("Initiate Audit Approval pending"==t.data.status_update){var a={checklistmaster_gid:A,auditcreation_gid:v},i="api/AtmTrnAuditCreation/CheckpointCreation";lockUI(),s.getparams(i,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list})}else{var a={auditcreation_gid:v},i="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),s.getparams(i,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list}),e.showAprrovalbutton=!1}"Audit Approval pending"==t.data.status_update||"Approved"==t.data.status_update?e.showsubmitbutton=!0:e.showsubmitbutton=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),k();var a={auditcreation_gid:v,sampleimport_gid:y},a={checklistmaster_gid:A,auditcreation_gid:v},t="api/AtmTrnAuditCreation/CheckpointCreation";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list,angular.forEach(e.checkpointsummary_list,function(t,e){"0"!=t.checklist_flag&&(t.checked=!0)})})}function k(){var t={auditcreation_gid:v},a="api/AtmTrnSampling/GetSampleDynamicdata";s.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].sampleimport_gid,delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].sampleimport_gid,delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}var f=this;f.title="AtmTrnAudit360ViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid,A=h.checklistmaster_gid;e.checklistmaster_gid=h.checklistmaster_gid;h.checklistmasteradd_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid;var y=h.sampleimport_gid;e.sampleimport_gid=h.sampleimport_gid,e.lspage=h.lspage;var b=e.lspage;_(),e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,a){function i(t,e){var i={sampleimport_gid:o},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,i).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var n="api/SystemMaster/GetEmployeelist";s.get(n).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var i="",n="";t.cboqueryto&&(i=t.cboqueryto.employee_gid,n=t.cboqueryto.employee_name);var r={sampleimport_gid:o,description:t.txtquery_desc,auditcreation_gid:a,query_title:t.txtquery_title,query_to:i,query_toname:n},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var o="",n=e.SampleDynamicTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid);m.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),s.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(t){lockUI();var i=[];if(angular.forEach(e.checkpointsummary_list,function(t){if(1==t.checked){var e=t.checklistmasteradd_gid;i.push(e);t.checklistmaster_gid}}),0==i.length)return l.alert("Select Atleast One Record!","warning"),unlockUI(),!1;var o={auditcreation_gid:v,checklistmasteradd_gid:i,checklistmaster_gid:A,submitevent:t},n="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(n,o).then(function(e){1==e.data.status?("Y"==t?l.alert("Checklist Assigned Successfully!","success"):l.alert(e.data.message,"success"),a.go("app.AtmTrnAuditCreationSummary"),unlockUI()):(l.alert("Error Occured..!","warning"),unlockUI())})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){a.close("closed"),1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}m.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,a){function i(e,i){e.lblcheckpoint_description=a;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){i.close("closed")}}m.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor});var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"lg"});a.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function a(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/showemployee.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,a,i){function o(t,e){t.hide=0;var i={auditcreation_gid:a},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,i).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var i={sampleimport_gid:n},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,i).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,i).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var i={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:n,auditcreation_gid:a,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="";if("Y"==i){var r=e.SampleraisedqueryTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid)}else{var r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid)}m.open({templateUrl:"/taguser.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function a(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}m.open({templateUrl:"/raisequery.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.back=function(t){"initiateaudit"==b?d.url("app/AtmTrnAuditCreationSummary"):"auditapproved"==b?d.url("app/AtmTrnInitiateAuditApproved"):"audithold"==b?d.url("app/AtmTrnInitiateAuditHold"):"auditclosed"==b?d.url("app/AtmTrnInitiateAuditClosed"):"auditcompleted"==b?d.url("app/AtmTrnInitiateAuditCompleted"):"auditrejected"==b&&d.url("app/AtmTrnInitiateAuditRejected")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+b))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAudit360ViewController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t="api/AtmTrnAuditorMaker/GetObservationApproval";lockUI(),c.get(t).then(function(t){e.approvalhistory_list=t.data.approvalhistory_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditApprovalHistory";lockUI(),c.get(t).then(function(t){e.auditapprovalhistory_list=t.data.auditapprovalhistory_list,unlockUI()}),e.auditview=function(t,e){l.url("app/AtmTrnAuditApprovalView?observationapproval_gid="+t+"&auditcreation_gid="+e)}}var g=this;g.title="AtmTrnAuditApprovalController",m(),e.back=function(t){a.go("app.AtmTrnAuditorMakerSummary")}}angular.module("angle").controller("AtmTrnAuditApprovalController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t={observationapproval_gid:k},a="api/AtmTrnAuditorMaker/GetAuditApprovalView";lockUI(),c.getparams(a,t).then(function(t){e.observationapprovalview_list=t.data.observationapprovalview_list,unlockUI()})}var g=this;g.title="AtmTrnAuditApprovalViewController";var _=l.search().auditcreation_gid,k=l.search().observationapproval_gid,f=l.search().initialapproval_gid;m(),e.auditapprove_submit=function(){var t={observationapproval_gid:k,auditcreation_gid:_,approve_remark:e.auditapproval_remarks},i="api/AtmTrnAuditorMaker/PostAuditApproval";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnApproval")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.auditreject_submit=function(){var t={initialapproval_gid:f,auditcreation_gid:_,approve_remark:e.auditapproval_remarks};lockUI();var i="api/AtmTrnAuditorMaker/PostAuditRejected";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnApproval")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.back=function(){a.go("app.AtmTrnApproval")}}angular.module("angle").controller("AtmTrnAuditApprovalViewController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){_.formats=["dd-MM-yyyy"],_.format=_.formats[0],_.calender1=function(t){t.preventDefault(),t.stopPropagation(),_.open1=!0},_.calender2=function(t){t.preventDefault(),t.stopPropagation(),_.open2=!0},_.calender3=function(t){t.preventDefault(),t.stopPropagation(),_.open3=!0},_.dateOptions={formatYear:"yy",startingDay:1};var t="api/AtmMstChecklistMaster/GetChecklistMaster";lockUI(),c.get(t).then(function(t){e.checklistmaster_list=t.data.checklistmaster_list,unlockUI()});var t="api/AtmTrnAuditCreation/TempDeleteAuditee";c.get(t).then(function(t){});var t="api/AtmMstAuditPriority/GetAuditPriorityActive";lockUI(),c.get(t).then(function(t){e.auditpriority_data=t.data.auditpriority_list,unlockUI()});var t="api/AtmMstAuditType/GetAuditTypeActive";lockUI(),c.get(t).then(function(t){e.audittype_list=t.data.audittype_list,unlockUI()});var t="api/AtmMstAuditMapping/GetAuditMappingMaker";lockUI(),c.get(t).then(function(t){unlockUI(),e.auditmapping1_list=t.data.auditmappingmaker_list});var t="api/AtmMstAuditMapping/GetAuditMappingChecker";lockUI(),c.get(t).then(function(t){unlockUI(),e.auditmapping_list=t.data.auditmappingchecker_list});var t="api/AtmMstAuditMapping/GetAuditMappingApprover";lockUI(),c.get(t).then(function(t){unlockUI(),e.auditmapping2_list=t.data.auditmappingapprover_list});var t="api/AtmMstAuditDepartment/GetAuditDepartment";lockUI(),c.get(t).then(function(t){e.auditdepartment_list=t.data.auditdepartment_list,unlockUI()});var t="api/SystemMaster/GetEmployeelist";lockUI(),c.get(t).then(function(t){e.employee_list=t.data.employeelist,unlockUI()});var t="api/SystemMaster/GetEmployeelist";lockUI(),c.get(t).then(function(t){e.employee1_list=t.data.employeelist,unlockUI()});var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:f};lockUI(),c.getparams(t,a).then(function(t){e.cboauditfrequencyedit=t.data.auditfrequency_gid,e.cboauditobservationedit=t.data.auditobservation_name,e.cboauditnameedit=t.data.checklistmaster_gid,e.cboauditdepartmentedit=t.data.auditdepartment_gid,e.cboaudittypeedit=t.data.audittype_gid,e.cboauditmakeredit=t.data.employee_gid,e.cboauditcheckeredit=t.data.auditmapping_gid,e.cboauditapproveredit=t.data.auditmapping2employee_gid,e.cboauditpriorityedit=t.data.auditpriority_gid,e.txteditaudit_ref_no=t.data.audit_uniqueno,e.txteditend_date=t.data.end_date,e.txteditperiod_from=t.data.periodfrom_date,e.txteditperiod_to=t.data.auditperiod_to,e.txteditaudit_ref_no=t.data.audit_uniqueno,e.cboauditeechecker_edit=t.data.auditeechecker_gid,e.cboauditeemaker_edit=t.data.auditeemaker_gid,e.txtentity_name=t.data.entity_name,e.txtcheckpointgroup_name=t.data.checkpointgroup_name,e.txtauditdescription_name=t.data.audit_description,unlockUI()});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()})}function g(){var t={auditcreation_gid:f},a="api/AtmTrnAuditCreation/GetTempAssignedAuditeeList";c.getparams(a,t).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})}var _=this;_.title="AtmTrnAuditCreationEditController";var k=u.decryptURL(l.search().hash),f=k.auditcreation_gid;e.lspage=k.lspage;var h=e.lspage;m(),e.auditname_change=function(t){var a={checklistmaster_gid:t},i="api/AtmTrnAuditCreation/GetAuditNameDetail";c.getparams(i,a).then(function(t){e.checklistmaster_gid=t.data.checklistmaster_gid,e.checkpointgroup_gid=t.data.checkpointgroup_gid,e.txtentity_name=t.data.entity_name,e.txtauditdescription_name=t.data.audit_description,e.txtcheckpointgroup_name=t.data.checkpointgroup_name}),e.txtentity_name=""},e.auditdepartmentname_change=function(t){var a={auditdepartment_gid:t},i="api/AtmTrnAuditCreation/GetAuditName";lockUI(),c.getparams(i,a).then(function(t){unlockUI(),e.checklistmaster_list=t.data.auditname_list})},e.UpdateAuditCreation=function(){var t,i=e.checklistmaster_list.map(function(t){return t.checklistmaster_gid}).indexOf(e.cboauditnameedit);t=i==-1?"":e.checklistmaster_list[i].audit_name;var o,n=e.auditpriority_data.map(function(t){return t.auditpriority_gid}).indexOf(e.cboauditpriorityedit);o=n==-1?"":e.auditpriority_data[n].auditpriority_name;var r,l=e.auditdepartment_list.map(function(t){return t.auditdepartment_gid}).indexOf(e.cboauditdepartmentedit);r=l==-1?"":e.auditdepartment_list[l].auditdepartment_name;var d,p=e.audittype_list.map(function(t){return t.audittype_gid}).indexOf(e.cboaudittypeedit);d=p==-1?"":e.audittype_list[p].audittype_name;var u,g=e.auditmapping1_list.map(function(t){return t.employee_gid}).indexOf(e.cboauditmakeredit);u=g==-1?"":e.auditmapping1_list[g].employee_name;var _,k=e.auditmapping_list.map(function(t){return t.auditmapping_gid}).indexOf(e.cboauditcheckeredit);_=k==-1?"":e.auditmapping_list[k].employee_name;var h,v=e.auditmapping2_list.map(function(t){return t.auditmapping2employee_gid}).indexOf(e.cboauditapproveredit);h=v==-1?"":e.auditmapping2_list[v].approver_name;var A,y=e.employee_list.map(function(t){return t.employee_gid}).indexOf(e.cboauditeemaker_edit);A=y==-1?"":e.employee_list[y].employee_name;var b,U=e.employee1_list.map(function(t){return t.employee_gid}).indexOf(e.cboauditeechecker_edit);b=U==-1?"":e.employee1_list[U].employee_name;var I={auditcreation_gid:f,checklistmaster_gid:e.cboauditnameedit,audit_name:t,auditdepartment_gid:e.cboauditdepartmentedit,auditdepartment_name:r,auditpriority_gid:e.cboauditpriorityedit,auditpriority_name:o,audittype_gid:e.cboaudittypeedit,audittype_name:d,auditmapping_gid:e.cboauditcheckeredit,audit_checker:_,employee_gid:e.cboauditmakeredit,audit_maker:u,auditmapping2employee_gid:e.cboauditapproveredit,audit_approver:h,audit_uniqueno:e.txteditaudit_ref_no,end_date:e.txteditend_date,periodfrom_date:e.txteditperiod_from,auditperiod_to:e.txteditperiod_to,auditobservation_name:e.cboauditobservationedit,checkpointgroup_name:e.txtcheckpointgroup_name,checkpointgroup_gid:e.checkpointgroup_gid},S="api/AtmTrnAuditCreation/UpdateAuditCreation";lockUI(),c.post(S,I).then(function(t){1==t.data.status?(unlockUI(),m(),a.go("app.AtmTrnAuditCreationSummary"),s.alert(t.data.message,"success")):(unlockUI(),s.alert(t.data.message,"warning"))})},e.back=function(t){"auditapproved"==h?l.url("app/AtmTrnInitiateAuditApproved"):"initiateaudit"==h&&l.url("app/AtmTrnAuditCreationSummary")},e.add_auditee=function(){var t="",a="";void 0==e.cboauditeemaker&&null==e.cboauditeemaker||(t=e.cboauditeemaker.employee_gid,a=e.cboauditeemaker.employee_name);var i="",o="";if(void 0==e.cboauditeechecker&&null==e.cboauditeechecker||(i=e.cboauditeechecker.employee_gid,o=e.cboauditeechecker.employee_name),""==e.cboauditeemaker||null==e.cboauditeemaker||""==e.cboauditeechecker||null==e.cboauditeechecker)s.alert("Kindly Fill Auditee Details","warning");else{var n={auditeemaker_gid:t,auditeemaker_name:a,auditeechecker_gid:i,auditeechecker_name:o},r="api/AtmTrnAuditCreation/MultipleAuditeeEdit";lockUI(),c.post(r,n).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g(),e.cboauditeemaker="",e.cboauditeechecker=""})}},e.delete_auditee=function(t){var e={multipleauditee_gid:t},a="api/AtmTrnAuditCreation/DeleteAuditee";lockUI(),c.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),g()})}}angular.module("angle").controller("AtmTrnAuditCreationEditController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetMyOpenAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list});var t="api/AtmTrnAuditCreation/GetAuditCreationCounts";c.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.Approvedaudit_count=t.data.Approvedaudit_count,e.completedaudit_count=t.data.completedaudit_count,e.rejectedaudit_count=t.data.rejectedaudit_count})}var _=this;_.title="AtmTrnAuditCreationSummaryController",g(),e.openaudit=function(){a.go("app.AtmTrnAuditCreationSummary")},e.approvedaudit=function(){a.go("app.AtmTrnInitiateAuditApproved")},e.auditsonhold=function(){a.go("app.AtmTrnInitiateAuditHold")},e.closedaudit=function(){a.go("app.AtmTrnInitiateAuditClosed")},e.rejectedaudit=function(){a.go("app.AtmTrnInitiateAuditRejected")},e.completedaudit=function(){a.go("app.AtmTrnInitiateAuditCompleted")},e.openaudit=function(){a.go("app.AtmTrnAuditCreationSummary")},e.approvedaudit=function(){a.go("app.AtmTrnInitiateAuditApproved")},e.auditsonhold=function(){a.go("app.AtmTrnInitiateAuditHold")},e.closedaudit=function(){a.go("app.AtmTrnInitiateAuditClosed")},e.rejectedaudit=function(){a.go("app.AtmTrnInitiateAuditRejected")},e.completedaudit=function(){a.go("app.AtmTrnInitiateAuditCompleted")},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.view=function(t,e,a){l.url("app/AtmTrnAudit360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=initiateaudit"))},e.edit=function(t){l.url("app/AtmTrnAuditCreationEdit?hash="+m.encryptURL("auditcreation_gid="+t+"&lspage=initiateaudit"))},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelSample"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}u.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditCreationSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:k};lockUI(),s.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.auditmapping2employee_gid,
e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnAuditCreation/ChecklistAssignView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.checklistassignview_list=t.data.checklistassignview_list});var a={auditcreation_gid:k},t="api/AtmTrnSampling/GetSampleAuditor";s.getparams(t,a).then(function(t){unlockUI(),k=t.data.auditcreation_gid,e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnAuditCreationViewController",e.auditcreation_gid=d.search().auditcreation_gid;var k=d.search().auditcreation_gid;g(),e.view=function(t){var a=e.auditcreation_gid;d.url("app/AtmTrnAuditCreationSampleView?auditcreation_gid="+a+"&sampleimport_gid="+t)},e.back=function(t){i.go("app.AtmTrnAuditCreationSummary")},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e){function i(e,a){var i={auditcreation2checklist_gid:t};lockUI();var o="api/AtmTrnAuditCreation/GetAuditCreationIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={auditcreation2checklist_gid:t};lockUI();var o="api/AtmTrnAuditCreation/GetAuditCreationDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={auditcreation2checklist_gid:t};lockUI();var o="api/AtmTrnAuditCreation/GetAuditCreationAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditCreationViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t="api/AtmTrnAuditorMaker/EditAuditorMaker",a={auditcreation_gid:_};lockUI(),c.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),c.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservationview_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score});var t="api/AtmTrnSampling/GetSampleAuditor";c.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var g=this;g.title="AtmTrnAuditeeCheckerApprovalController";var _=l.search().auditcreation_gid;e.sampleimport_gid=l.search().sampleimport_gid;e.sampleimport_gid,l.search().initialapproval_gid;m(),e.back=function(t){a.go("app.AtmTrnAuditorMakerSummary")},e.view=function(t,e){l.url("app/AtmTrnSamplingView?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.showPopover=function(t,e){function a(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/showemployee.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e){function a(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationIntent";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointintent.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationDescription";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationAuditor";c.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.auditeechecker_submit=function(){var t={auditcreation_gid:_,auditeeapproval_remark:e.auditeechecker_remark},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeCheckerApproval";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditeeCheckerSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.auditeereject_submit=function(){var t={auditcreation_gid:_,auditeerejected_remark:e.auditeechecker_remark};lockUI();var i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeCheckerRejected";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnMyAuditTaskAuditeeSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.back=function(t){a.go("app.AtmTrnMyAuditTaskAuditeeSummary")}}angular.module("angle").controller("AtmTrnAuditeeCheckerApprovalController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnMyAuditTaskAuditee/AuditeeSampleCheckerView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnAuditeeCheckerObservationViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=d.search().lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified?t.tag_verifiedradio=!0:"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditeecheckerpending"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditeeCheckerObservationViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnMyAuditTaskAuditee/AuditeeSampleCheckerView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnAuditeeCheckerOpenObservationViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=d.search().lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){
function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified?t.tag_verifiedradio=!0:"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnMyAuditeeTaskCheckerAuditeeView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditeecheckeropensummary"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditeeCheckerOpenObservationViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t={auditcreation_gid:f},a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist";c.getparams(a,t).then(function(t){e.Querydetaillist=t.data.Querydetaillist,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetTagUserAuditview";lockUI(),c.getparams(a,t).then(function(t){e.audittaguser_list=t.data.audittaguser_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/closequerysummary";lockUI(),c.getparams(a,t).then(function(t){e.closequery_list=t.data.closequery_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetclosequeryAudit";lockUI(),c.getparams(a,t).then(function(t){e.auditraisequery_status=t.data.auditraisequery_status,unlockUI()})}var k=this;k.title="AtmTrnAuditeeCheckerRaiseQueryController",e.auditcreation_gid=l.search().auditcreation_gid;var f=e.auditcreation_gid;_(),lockUI(),e.refresh=function(){lockUI(),_()},e.replytoquery=function(){var t={auditcreation_gid:f,remarks:e.txtqueries};lockUI();var a="api/AtmTrnMyAuditTaskAuditee/PostQuerydetail";c.post(a,t).then(function(t){if(unlockUI(),1==t.data.status){s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist",i={auditcreation_gid:f};c.getparams(a,i).then(function(t){unlockUI(),e.Querydetaillist=t.data.Querydetaillist,1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.Back=function(t){a.go("app.AtmTrnAuditeeCheckerSummary")},e.back=function(t){a.go("app.AtmTrnAuditeeCheckerSummary")},e.tagemployee=function(){function t(t,e){var a={auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuditee";c.getparams(i,a).then(function(e){t.auditcreation_gid=e.data.auditcreation_gid,t.txtaudit_name=e.data.audit_name}),t.ok=function(){e.close("closed")};var i="api/SystemMaster/GetEmployeelist";lockUI(),c.get(i).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={tagemployelist:t.cboemployee_name,audit_name:t.txtaudit_name,auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/PostTagUserAudit";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}i.open({templateUrl:"/tagemployee.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.close_query=function(){var t={auditcreation_gid:f,closing_description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/closequery";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorMakerSummary"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.showPopover=function(t){function e(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTaskAuditee/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/showemployee.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditeeCheckerRaiseQueryController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","$sce","$anchorScroll"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskAuditeeChecker";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count})}var k=this;k.title="AtmTrnAuditeeCheckerSummaryController",_(),e.maker=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.checker=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.Approver=function(){i.go("app.AtmTrnAuditorApproverSummary")},e.auditee_maker=function(){i.go("app.AtmTrnAuditeeMakerSummary")},e.auditee_checker=function(){i.go("app.AtmTrnAuditeeCheckerSummary")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.auditraisequery=function(t){d.url("app/AtmTrnAuditeeCheckerRaiseQuery?auditcreation_gid="+t)},e.updateobservations=function(t){d.url("app/AtmTrnMakerCheckpointObservation?auditcreation_gid="+t)},e.viewtask=function(t){d.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+t)},e.auditeecheckerapproval=function(t){d.url("app/AtmTrnAuditeeCheckerApproval?auditcreation_gid="+t)},e.assignedquery=function(t){d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.auditapproval=function(t){d.url("app/AtmTrnAuditApproval?auditcreation_gid="+t)},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditeeCheckerSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t={auditcreation_gid:f},a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist";c.getparams(a,t).then(function(t){e.Querydetaillist=t.data.Querydetaillist,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetTagUserAuditview";lockUI(),c.getparams(a,t).then(function(t){e.audittaguser_list=t.data.audittaguser_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/closequerysummary";lockUI(),c.getparams(a,t).then(function(t){e.closequery_list=t.data.closequery_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetclosequeryAudit";lockUI(),c.getparams(a,t).then(function(t){e.auditraisequery_status=t.data.auditraisequery_status,unlockUI()})}var k=this;k.title="AtmTrnAuditeeMakerRaiseQueryController",e.auditcreation_gid=l.search().auditcreation_gid;var f=e.auditcreation_gid;_(),lockUI(),e.refresh=function(){lockUI(),_()},e.replytoquery=function(){var t={auditcreation_gid:f,remarks:e.txtqueries};lockUI();var a="api/AtmTrnMyAuditTaskAuditee/PostQuerydetail";c.post(a,t).then(function(t){if(unlockUI(),1==t.data.status){s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist",i={auditcreation_gid:f};c.getparams(a,i).then(function(t){unlockUI(),e.Querydetaillist=t.data.Querydetaillist,1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.Back=function(t){a.go("app.AtmTrnMyAuditTaskAuditeeSummary")},e.back=function(t){a.go("app.AtmTrnAuditeeMakerSummary")},e.tagemployee=function(){function t(t,e){var a={auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuditee";c.getparams(i,a).then(function(e){t.auditcreation_gid=e.data.auditcreation_gid,t.txtaudit_name=e.data.audit_name}),t.ok=function(){e.close("closed")};var i="api/SystemMaster/GetEmployeelist";lockUI(),c.get(i).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={tagemployelist:t.cboemployee_name,audit_name:t.txtaudit_name,auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/PostTagUserAudit";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}i.open({templateUrl:"/tagemployee.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.close_query=function(){var t={auditcreation_gid:f,closing_description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/closequery";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorMakerSummary"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.showPopover=function(t){function e(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTaskAuditee/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/showemployee.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditeeMakerRaiseQueryController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","$sce","$anchorScroll"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskAuditeeMaker";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count})}var k=this;k.title="AtmTrnAuditeeMakerSummaryController",_(),e.maker=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.checker=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.Approver=function(){i.go("app.AtmTrnAuditorApproverSummary")},e.auditee_maker=function(){i.go("app.AtmTrnAuditeeMakerSummary")},e.auditee_checker=function(){i.go("app.AtmTrnAuditeeCheckerSummary")},e.auditraisequery=function(t){d.url("app/AtmTrnAuditeeMakerRaiseQuery?auditcreation_gid="+t)},e.updateobservations=function(t){d.url("app/AtmTrnMakerCheckpointObservation?auditcreation_gid="+t)},e.viewtask=function(t){d.url("app/AtmTrnMyAuditTaskAuditeeView?auditcreation_gid="+t)},e.approval=function(t){d.url("app/AtmTrnApproval?auditcreation_gid="+t)},e.assignedquery=function(t){d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.auditapproval=function(t){d.url("app/AtmTrnAuditApproval?auditcreation_gid="+t)},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update,e.status_remarks=t.data.status_remarks}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update,status_remarks:e.status_remarks},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditeeMakerSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t="api/AtmTrnAuditorMaker/EditAuditorMaker",a={auditcreation_gid:_};lockUI(),c.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),c.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservationview_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score});var t="api/AtmTrnSampling/GetSampleAuditor";c.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var g=this;g.title="AtmTrnAuditorApprovalController";var _=l.search().auditcreation_gid;l.search().observationapproval_gid,l.search().initialapproval_gid;m(),e.auditorapproval_submit=function(){var t={auditcreation_gid:_,auditorapproval_remark:e.auditorapproval_remark},i="api/AtmTrnAuditorMaker/PostAuditorApproval";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorApproverSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.auditorreject_submit=function(){var t={auditcreation_gid:_,auditorreject_remark:e.auditorapproval_remark};lockUI();var i="api/AtmTrnAuditorMaker/PostAuditorRejected";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorApproverSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.back=function(){a.go("app.AtmTrnAuditorApproverSummary")}}angular.module("angle").controller("AtmTrnAuditorApprovalController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";
function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetClosedAuditorApprover";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorApproverCounts";s.get(t).then(function(t){unlockUI(),e.auditsapproveronhold_count=t.data.auditsapproveronhold_count,e.closedapproveraudit_count=t.data.closedapproveraudit_count,e.openapproveraudit_count=t.data.openapproveraudit_count,e.pendingapproverapproval_count=t.data.auditapproverpending_count,e.completed_count=t.data.completedapproveraudit_count})}var f=this;f.title="AtmTrnAuditorApproverClosedAuditController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorApproverSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorApproverPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorApproverHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorApproverClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorApproverTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorApproverCompletedAudit")},e.viewtask=function(t){d.url("app/AtmTrnAuditorApproverView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorapproverClosed"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverClosedAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetCompletedAuditorApprover";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorApproverCounts";s.get(t).then(function(t){unlockUI(),e.auditsapproveronhold_count=t.data.auditsapproveronhold_count,e.closedapproveraudit_count=t.data.closedapproveraudit_count,e.openapproveraudit_count=t.data.openapproveraudit_count,e.pendingapproverapproval_count=t.data.auditapproverpending_count,e.completed_count=t.data.completedapproveraudit_count})}var f=this;f.title="AtmTrnAuditorApproverCompletedAuditController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorApproverSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorApproverPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorApproverHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorApproverClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorApproverTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorApproverCompletedAudit")},e.viewtask=function(t){d.url("app/AtmTrnAuditorApproverObservationView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorapproverCompleted"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverCompletedAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetOnholdAuditorApprover";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorApproverCounts";s.get(t).then(function(t){unlockUI(),e.auditsapproveronhold_count=t.data.auditsapproveronhold_count,e.closedapproveraudit_count=t.data.closedapproveraudit_count,e.openapproveraudit_count=t.data.openapproveraudit_count,e.pendingapproverapproval_count=t.data.auditapproverpending_count,e.completed_count=t.data.completedapproveraudit_count})}var f=this;f.title="AtmTrnAuditorApproverHoldAuditController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorApproverSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorApproverPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorApproverHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorApproverClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorApproverTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorApproverCompletedAudit")},e.viewtask=function(t){d.url("app/AtmTrnAuditorApproverView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorapproverHold"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverHoldAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_){function k(){function t(){var t={auditcreation_gid:y},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.expandCount=3,e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}})}var a="api/AtmTrnAuditCreation/EditAuditCreation",o={auditcreation_gid:y};lockUI(),l.getparams(a,o).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.openquerycount=t.data.openquerycount,e.status_update=t.data.status_update,e.DBobservation_score=t.data.observation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill&&"auditormakerOpen"==U&&"N"==e.auditormaker_approvalflag?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var a="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(a,o).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(a,o).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var a="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(a,o).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),l.getparams(a,o).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var a="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=U&&"auditeemakerhold"!=U&&"auditeemakerclosed"!=U&&"auditeemakertagged"!=U&&"auditeemakercompleted"!=U&&"auditeecheckeropen"!=U&&"auditeecheckerpending"!=U&&"auditeecheckerhold"!=U&&"auditeecheckerclosed"!=U&&"auditeecheckertagged"!=U&&"auditeecheckercompleted"!=U||(e.close_disabled=!0)}),t();var o={auditcreation_gid:y},a="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list}),e.allobservationfilled=!0;var o={auditcreation_gid:y},a="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function f(){e.observationfillenable=!0}function h(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var v=this;v.title="AtmTrnAuditorApproverObservationViewController";var A=_.decryptURL(p.search().hash);e.auditcreation_gid=A.auditcreation_gid;var y=e.auditcreation_gid;e.checklistmaster_gid=A.checklistmaster_gid;var b=e.checklistmaster_gid;e.checklistmasteradd_gid=A.checklistmasteradd_gid,e.sampleimport_gid=A.sampleimport_gid;e.sampleimport_gid;e.lspage=A.lspage;var U=e.lspage;e.data={},k(),e.onselected=function(t,a,i){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:y},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";l.post(i,a).then(function(t){if(1==t.data.status){d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:y},i="api/AtmTrnAuditorMaker/AuditorMakerView";l.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:y},a="api/AtmTrnAuditCreation/observationfill";l.getparams(a,t).then(function(t){1==t.data.status&&f()}),e.close("closed")}}if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.openquerycount&&""!=e.DBobservation_score)d.alert("Query is not closed",{status:"warning",
pos:"top-center",timeout:3e3});else if("Observation score for Audit & sample"==e.auditobservation_name&&"N"==e.checklistverified_flag)d.alert("Atleast one sample observation score saved",{status:"warning",pos:"top-center",timeout:3e3});else{var t=(e.txt_percent,{auditcreation_gid:e.auditcreation_gid,makerinitiate_approvalflag:"Y",observation_percentage:e.txt_percent}),a="api/AtmTrnAuditorMaker/PostMakerInitiateApproval";lockUI(),l.post(a,t).then(function(t){1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnAuditorMakerSummary")):(d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),defaultdynamic()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:b},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=u.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))d.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var l={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",l.file),p.append("file_name",l.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else d.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)d.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),l.postFile(t,e.uploadfrm).then(function(t){e.tagsamplebutton=!0,a.close("closed"),1==t.data.status?(defaultdynamic(),unlockUI(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},k(),e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),p.url("app/AtmTrnAudit360View?auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3),i.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),l.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){o.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+_.encryptURL("auditcreation_gid="+y+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?hash="+_.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.sampleobservationquery=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:i},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),l.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),l.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.sample2checkpoint=i;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),l.post(r,n).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";l.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Sample Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?hash="+_.encryptURL("auditcreation_gid="+o+"&lspage=auditormakerOpen"))):d.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";l.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Sample Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorApproverView?hash="+_.encryptURL("auditcreation_gid="+o+"&lspage=auditormakerOpen"))):d.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstApproverObservationScoreView?hash="+_.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.dynamicsamplequeryscore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstApproverObservationScoreView?hash="+_.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.samplecheckerobservationscoreview=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstApproverObservationScoreView?hash="+_.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){p.url("app/AtmTrnAuditorApproverCompletedAudit")},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),h(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:y},n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:y,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=y,e.auditraisequery_gid=t;var n={auditcreation_gid:y,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=_.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==U?i="Auditor Maker":"auditorapproveropen"==U?i="Auditor Approver":"auditorcheckerOpen"==U?i="Auditor Checker":"auditeemakeropen"==U?i="Auditee Maker":"auditeecheckeropen"==U?i="Auditee Checker":"auditeemakertagged"==U&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverObservationViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetAuditorApproverSummary";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorApproverCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsapproveronhold_count,e.closedaudit_count=t.data.closedapproveraudit_count,e.openaudit_count=t.data.openapproveraudit_count,e.pendingapproval_count=t.data.auditapproverpending_count,e.completed_count=t.data.completedapproveraudit_count})}var f=this;f.title="AtmTrnAuditorApproverPendingApprovalController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorApproverSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorApproverPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorApproverHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorApproverClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorApproverTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorApproverCompletedAudit")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.viewtask=function(t){d.url("app/AtmTrnAuditorApproverView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorapproverPending"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverPendingApprovalController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t={auditcreation_gid:f},a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist";c.getparams(a,t).then(function(t){e.Querydetaillist=t.data.Querydetaillist,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetTagUserAuditview";lockUI(),c.getparams(a,t).then(function(t){e.audittaguser_list=t.data.audittaguser_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/closequerysummary";lockUI(),c.getparams(a,t).then(function(t){e.closequery_list=t.data.closequery_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetclosequeryAudit";lockUI(),c.getparams(a,t).then(function(t){e.auditraisequery_status=t.data.auditraisequery_status,unlockUI()})}var k=this;k.title="AtmTrnAuditorApproverRaiseQueryController",e.auditcreation_gid=l.search().auditcreation_gid;var f=e.auditcreation_gid;e.lspage=l.search().lspage;var h=e.lspage;_(),lockUI(),e.refresh=function(){lockUI(),_()},e.replytoquery=function(){var t={auditcreation_gid:f,remarks:e.txtqueries};lockUI();var a="api/AtmTrnMyAuditTaskAuditee/PostQuerydetail";c.post(a,t).then(function(t){if(unlockUI(),1==t.data.status){s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist",i={auditcreation_gid:f};c.getparams(a,i).then(function(t){unlockUI(),e.Querydetaillist=t.data.Querydetaillist,1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.Back=function(t){"auditorapproveropen"==h?l.url("app/AtmTrnAuditorApproverSummary"):"auditorapproverPending"==h?l.url("app/AtmTrnAuditorApproverPendingApproval"):"auditorapproverHold"==h?l.url("app/AtmTrnAuditorApproverHoldAudit"):"auditorapproverClosed"==h?l.url("app/AtmTrnAuditorApproverClosedAudit"):"auditorapproverTagged"==h?l.url("app/AtmTrnAuditorApproverTaggedItems"):"auditorapproverCompleted"==h&&l.url("app/AtmTrnAuditorApproverCompletedAudit")},e.tagemployee=function(){function t(t,e){var a={auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuditee";c.getparams(i,a).then(function(e){t.auditcreation_gid=e.data.auditcreation_gid,t.txtaudit_name=e.data.audit_name}),t.ok=function(){e.close("closed")};var i="api/SystemMaster/GetEmployeelist";lockUI(),c.get(i).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={tagemployelist:t.cboemployee_name,audit_name:t.txtaudit_name,auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/PostTagUserAudit";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}i.open({templateUrl:"/tagemployee.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.close_query=function(){var t={auditcreation_gid:f,closing_description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/closequery";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorMakerSummary"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.showPopover=function(t){function e(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTaskAuditee/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/showemployee.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverRaiseQueryController",t),
t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","$sce","$anchorScroll"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditorMaker/GetOpenAuditorApprover";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorApproverCounts";s.get(t).then(function(t){unlockUI(),e.auditsapproveronhold_count=t.data.auditsapproveronhold_count,e.closedapproveraudit_count=t.data.closedapproveraudit_count,e.openapproveraudit_count=t.data.openapproveraudit_count})}var k=this;k.title="AtmTrnAuditorApproverSummaryController",_(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverSummary")},e.open_audit=function(){d.url("app/AtmTrnAuditorApproverSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorApproverPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorApproverHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorApproverClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorApproverTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorApproverCompletedAudit")},e.auditraisequery=function(t){d.url("app/AtmTrnAuditorApproverRaiseQuery?auditcreation_gid="+t+"&lspage=auditorapproveropen")},e.updateobservations=function(t){d.url("app/AtmTrnApproverCheckpointObservation?auditcreation_gid="+t)},e.viewtask=function(t){d.url("app/AtmTrnAuditorApproverView?auditcreation_gid="+t+"&lspage=auditorapproveropen")},e.approval=function(t){d.url("app/AtmTrnApproval?auditcreation_gid="+t)},e.assignedquery=function(t){d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.auditapproval=function(t){d.url("app/AtmTrnAuditorApproval?auditcreation_gid="+t)},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.statusremarks=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetStatusRemarks";s.getparams(o,i).then(function(t){unlockUI(),e.txtremarks=t.data.status_remarks}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/statusremarks.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditorMaker/GetAuditorApproverSummary";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count})}var k=this;k.title="AtmTrnAuditorApproverTaggedItemsController",_(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverSummary")},e.open_audit=function(){d.url("app/AtmTrnAuditorApproverSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorApproverPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorApproverHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorApproverClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorApproverTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorApproverCompletedAudit")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.auditraisequery=function(t){d.url("app/AtmTrnAuditorApproverRaiseQuery?auditcreation_gid="+t+"&lspage=auditorapproverTagged")},e.updateobservations=function(t){d.url("app/AtmTrnApproverCheckpointObservation?auditcreation_gid="+t)},e.viewtask=function(t){d.url("app/AtmTrnAuditorApproverView?auditcreation_gid="+t+"&lspage=auditorapproverTagged")},e.approval=function(t){d.url("app/AtmTrnApproval?auditcreation_gid="+t)},e.assignedquery=function(t){d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.auditapproval=function(t){d.url("app/AtmTrnAuditorApproval?auditcreation_gid="+t)},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverTaggedItemsController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:y};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.openquerycount=t.data.openquerycount,e.auditopenquerycount=t.data.auditopenquerycount,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,e.auditorapprover_approvalflag=t.data.auditorapprover_approvalflag,"auditorapproverPending"==I&&"N"==e.auditorapprover_approvalflag?e.proceedtocomplete=!0:e.proceedtocomplete=!1,unlockUI()});var a={auditcreation_gid:y},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a={auditcreation_gid:y},t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})});var t="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=I&&"auditeemakerhold"!=I&&"auditeemakerclosed"!=I&&"auditeemakertagged"!=I&&"auditeemakercompleted"!=I&&"auditeecheckeropen"!=I&&"auditeecheckerpending"!=I&&"auditeecheckerhold"!=I&&"auditeecheckerclosed"!=I&&"auditeecheckertagged"!=I&&"auditeecheckercompleted"!=I||(e.close_disabled=!0)}),f();var a={auditcreation_gid:y,sampleimport_gid:U}}function f(){var t={auditcreation_gid:y},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}function h(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var v=this;v.title="AtmTrnAuditorApproverViewController";var A=_.decryptURL(p.search().hash);e.auditcreation_gid=A.auditcreation_gid;var y=e.auditcreation_gid;e.checklistmaster_gid=A.checklistmaster_gid;var b=e.checklistmaster_gid;e.checklistmasteradd_gid=A.checklistmasteradd_gid,e.sampleimport_gid=A.sampleimport_gid;var U=e.sampleimport_gid;e.lspage=A.lspage;var I=e.lspage;k(),e.stripAddr=function(t){return t.replace("_"," ")},e.onselected=function(t,a,i){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?e.allobservationfilled=!0:e.allobservationfilled=!1,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:b},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=u.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))d.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var l={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",l.file),p.append("file_name",l.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else d.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)d.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),l.postFile(t,e.uploadfrm).then(function(t){a.close("closed"),1==t.data.status?(k(),unlockUI(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.auditorapproval_submit=function(t){if("0"!=e.openquerycount||"0"!=e.auditopenquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else if("Observation score for sample"==e.auditobservation_name){var a={auditcreation_gid:t,auditorapproval_remark:e.auditorapproval_remark},i="api/AtmTrnAuditorMaker/PostAuditorSampleApproval";lockUI(),l.post(i,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),o.go("app.AtmTrnAuditorApproverCompletedAudit")):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}else{var a=(e.txt_percent,{auditcreation_gid:t,auditorapproval_remark:e.auditorapproval_remark,observation_percentage:e.txt_percent}),i="api/AtmTrnAuditorMaker/PostAuditorApproval";lockUI(),l.post(i,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),o.go("app.AtmTrnAuditorApproverCompletedAudit")):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}},e.submitobservation=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t,auditcreation_gid:y},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Check point  Successfully!","success"),o.go("app.AtmTrnAuditorApproverPendingApproval")):d.alert("Select Atleast One..!!","warning"),e.txttotal_score=""})},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),l.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+_.encryptURL("auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o+"&lspage="+I));
},e.observationquery=function(t,e,i){function o(a,o){function n(){var e={checkpointgroupadd_gid:t,sampleimport_gid:U},i="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),l.getparams(i,e).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})})}a.ok=function(){o.close("closed")};var r={checkpointgroupadd_gid:t,auditcreation_gid:i},c="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?(t.document_radio=!0,t.document_radio1=!0):"No"==t.overall_detail?(t.tag_radio=!0,t.tag_radio1=!0):"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorApproverView?hash="+_.encryptURL("auditcreation_gid="+i+"&lspage=auditorapproverPending"))):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})},a.checkpointobservationupdate=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservationUpdate";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorApproverView?hash="+_.encryptURL("auditcreation_gid="+i+"&lspage=auditorapproverPending"))):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})};var r={checkpointgroupadd_gid:t,auditcreation_gid:i},c="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(c,r).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallselected=function(i){a.document_verified=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:U,checkpointgroupadd_gid:t},r="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),l.post(r,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallonselected=function(i){a.document_verified=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:U,checkpointgroupadd_gid:t},r="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),l.post(r,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallpartialselected=function(i){a.document_verified=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:U,checkpointgroupadd_gid:t},r="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),l.post(r,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallnaselected=function(i){a.document_verified=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:U,checkpointgroupadd_gid:t},r="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),l.post(r,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstApproverObservationScore?hash="+_.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.dynamicsamplequeryscore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstApproverObservationScore?hash="+_.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),h(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:y},n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:y,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=y,e.auditraisequery_gid=t;var n={auditcreation_gid:y,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=_.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==I?i="Auditor Maker":"auditorapproveropen"==I?i="Auditor Approver":"auditorcheckerOpen"==I?i="Auditor Checker":"auditeemakeropen"==I?i="Auditee Maker":"auditeecheckeropen"==I?i="Auditee Checker":"auditeemakertagged"==I&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(t){"auditorapproveropen"==I?p.url("app/AtmTrnAuditorApproverSummary"):"auditorapproverPending"==I?p.url("app/AtmTrnAuditorApproverPendingApproval"):"auditorapproverHold"==I?p.url("app/AtmTrnAuditorApproverHoldAudit"):"auditorapproverClosed"==I?p.url("app/AtmTrnAuditorApproverClosedAudit"):"auditorapproverTagged"==I?p.url("app/AtmTrnAuditorApproverTaggedItems"):"auditorapproverCompleted"==I&&p.url("app/AtmTrnAuditorApproverCompletedAudit")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorApproverViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t="api/AtmTrnAuditorMaker/EditAuditorMaker",a={auditcreation_gid:_};lockUI(),c.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),c.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservationview_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score});var t="api/AtmTrnSampling/GetSampleAuditor";c.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var g=this;g.title="AtmTrnAuditorCheckerApprovalController";var _=l.search().auditcreation_gid;e.sampleimport_gid=l.search().sampleimport_gid;e.sampleimport_gid,l.search().initialapproval_gid;m(),e.back=function(t){a.go("app.AtmTrnAuditorMakerSummary")},e.view=function(t,e){l.url("app/AtmTrnSamplingView?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.showPopover=function(t,e){function a(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/showemployee.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e){function a(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationIntent";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointintent.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationDescription";c.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationAuditor";c.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.checkerapproval_submit=function(){var t={auditcreation_gid:_,checkerapproval_remark:e.checkerapprove_remarks},i="api/AtmTrnAuditorMaker/PostAuditorCheckerApproval";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorCheckerSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkerreject_submit=function(){var t={auditcreation_gid:_,checkerapproval_remark:e.checkerapprove_remark};lockUI();var i="api/AtmTrnAuditorMaker/PostAuditorCheckerRejected";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorMakerSummary")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.back=function(t){a.go("app.AtmTrnAuditorMakerSummary")}}angular.module("angle").controller("AtmTrnAuditorCheckerApprovalController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetClosedAuditorChecker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.pendingcheckerapproval_count=t.data.pendingapprovalaudit_count,e.completed_count=t.data.completedcheckeraudit_count})}var f=this;f.title="AtmTrnAuditorCheckerClosedAuditController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorCheckerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorCheckerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorCheckerTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.viewtask=function(t){d.url("app/AtmTrnAuditorCheckerView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorcheckerClosed"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.trackingstatus=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/trackingstatus.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.getauditapproval=function(t){function e(e,a){var o="api/employee/employee";s.get(o).then(function(t){e.employee_list=t.data.employee_list}),e.ok=function(){i.close("closed")},e.getreapprovalclick=function(){var a={approval_name:e.cboapproval_member.employee_name,approval_gid:e.cboapproval_member.employee_gid,auditcreation_gid:t,getapproval_remark:e.getapproval_remark};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditorGetApproval";s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(i.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(i.close("closed"),l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var i=a.open({templateUrl:"/getReApprovalmodal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerClosedAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetAuditorCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.pendingcheckerapproval_count=t.data.pendingapprovalaudit_count,e.completed_count=t.data.completedcheckeraudit_count});var t="api/AtmTrnAuditorMaker/GetCompletedAuditorChecker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()})}var f=this;f.title="AtmTrnAuditorCheckerCompletedAuditController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorCheckerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorCheckerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorCheckerTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.viewtask=function(t){d.url("app/AtmTrnAuditorCheckerObservationView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorcheckerCompleted"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.getauditapproval=function(t){function e(e,a){var o="api/employee/employee";s.get(o).then(function(t){e.employee_list=t.data.employee_list}),e.ok=function(){i.close("closed")},e.getreapprovalclick=function(){var a={approval_name:e.cboapproval_member.employee_name,approval_gid:e.cboapproval_member.employee_gid,auditcreation_gid:t,getapproval_remark:e.getapproval_remark};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditorGetApproval";s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(i.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(i.close("closed"),l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var i=a.open({templateUrl:"/getReApprovalmodal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){
var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerCompletedAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetOnholdAuditorChecker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.pendingcheckerapproval_count=t.data.pendingapprovalaudit_count,e.completed_count=t.data.completedcheckeraudit_count})}var f=this;f.title="AtmTrnAuditorCheckerHoldAuditController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorCheckerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorCheckerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorCheckerTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.viewtask=function(t){d.url("app/AtmTrnAuditorCheckerView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorcheckerHold"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.trackingstatus=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/trackingstatus.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.getauditapproval=function(t){function e(e,a){var o="api/employee/employee";s.get(o).then(function(t){e.employee_list=t.data.employee_list}),e.ok=function(){i.close("closed")},e.getreapprovalclick=function(){var a={approval_name:e.cboapproval_member.employee_name,approval_gid:e.cboapproval_member.employee_gid,auditcreation_gid:t,getapproval_remark:e.getapproval_remark};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditorGetApproval";s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(i.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(i.close("closed"),l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var i=a.open({templateUrl:"/getReApprovalmodal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerHoldAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){function t(){var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.expandCount=3,e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}})}var a="api/AtmTrnAuditCreation/EditAuditCreation",o={auditcreation_gid:b};lockUI(),l.getparams(a,o).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.openquerycount=t.data.openquerycount,e.status_update=t.data.status_update,e.DBobservation_score=t.data.observation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill&&"auditormakerOpen"==I&&"N"==e.auditormaker_approvalflag?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var a="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(a,o).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(a,o).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var a="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(a,o).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),l.getparams(a,o).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()}),t();var o={auditcreation_gid:b},a="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list}),e.allobservationfilled=!0;var o={auditcreation_gid:b},a="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})});var a="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=I&&"auditeemakerhold"!=I&&"auditeemakerclosed"!=I&&"auditeemakertagged"!=I&&"auditeemakercompleted"!=I&&"auditeecheckeropen"!=I&&"auditeecheckerpending"!=I&&"auditeecheckerhold"!=I&&"auditeecheckerclosed"!=I&&"auditeecheckertagged"!=I&&"auditeecheckercompleted"!=I||(e.close_disabled=!0)})}function h(){e.observationfillenable=!0}function v(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var A=this;A.title="AtmTrnAuditorCheckerObservationViewController";var y=k.decryptURL(p.search().hash);e.auditcreation_gid=y.auditcreation_gid;var b=e.auditcreation_gid;e.checklistmaster_gid=y.checklistmaster_gid;var U=e.checklistmaster_gid;e.checklistmasteradd_gid=y.checklistmasteradd_gid,e.sampleimport_gid=y.sampleimport_gid;e.sampleimport_gid;e.lspage=y.lspage;var I=e.lspage;e.data={},f(),e.onselected=function(t,a,i){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:b},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";l.post(i,a).then(function(t){if(1==t.data.status){d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:b},i="api/AtmTrnAuditorMaker/AuditorMakerView";l.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:b},a="api/AtmTrnAuditCreation/observationfill";l.getparams(a,t).then(function(t){1==t.data.status&&h()}),e.close("closed")}}if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.openquerycount&&""!=e.DBobservation_score)d.alert("Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else if("Observation score for Audit & sample"==e.auditobservation_name&&"N"==e.checklistverified_flag)d.alert("Atleast one sample observation score saved",{status:"warning",pos:"top-center",timeout:3e3});else{var t=(e.txt_percent,{auditcreation_gid:e.auditcreation_gid,makerinitiate_approvalflag:"Y",observation_percentage:e.txt_percent}),a="api/AtmTrnAuditorMaker/PostMakerInitiateApproval";lockUI(),l.post(a,t).then(function(t){1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnAuditorMakerSummary")):(d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),defaultdynamic()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:U},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=u.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))d.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var l={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",l.file),p.append("file_name",l.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else d.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)d.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),l.postFile(t,e.uploadfrm).then(function(t){e.tagsamplebutton=!0,a.close("closed"),1==t.data.status?(defaultdynamic(),unlockUI(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},f(),e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),l.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){o.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?auditcreation_gid="+b+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+I+"&lsobservationfill_flag="+e.observationfill)},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+i+"&lspage=auditormakerOpen")):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.sampleobservationquery=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:i},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),l.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),l.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.sample2checkpoint=i;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:o
},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),l.post(r,n).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";l.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Sample Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+o+"&lspage=auditormakerOpen"))):d.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";l.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Sample Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+o+"&lspage=auditormakerOpen"))):d.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.dynamicsamplequeryscore=function(t,e,a,i){p.url("app/AtmTrnSampleQueryAgainstObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.samplecheckerobservationscoreview=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstCheckerObservationScoreView?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){p.url("app/AtmTrnAuditorCheckerPendingApproval")},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),v(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:b},r="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(r,n).then(function(t){e.approval_status=t.data.approval_status,unlockUI()});var n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:b,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=b,e.auditraisequery_gid=t;var n={auditcreation_gid:b,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==I?i="Auditor Maker":"auditorapproveropen"==I?i="Auditor Approver":"auditorcheckerOpen"==I?i="Auditor Checker":"auditeemakeropen"==I?i="Auditee Maker":"auditeecheckeropen"==I?i="Auditee Checker":"auditeemakertagged"==I&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerObservationViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:b};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.auditorchecker_approvalflag=t.data.auditorchecker_approvalflag,e.openquerycount=t.data.openquerycount,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,"auditorcheckerPending"==S&&"N"==e.auditorchecker_approvalflag?e.proceedtoapprover=!0:e.proceedtoapprover=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var t="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),l.getparams(t,a).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list});var a={auditcreation_gid:b},t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})});var t="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=S&&"auditeemakerhold"!=S&&"auditeemakerclosed"!=S&&"auditeemakertagged"!=S&&"auditeemakercompleted"!=S&&"auditeecheckeropen"!=S&&"auditeecheckerpending"!=S&&"auditeecheckerhold"!=S&&"auditeecheckerclosed"!=S&&"auditeecheckertagged"!=S&&"auditeecheckercompleted"!=S||(e.close_disabled=!0)}),h();var a={auditcreation_gid:b,sampleimport_gid:I}}function h(){var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){1==t.data.status&&(e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata))});var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}function v(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var A=this;A.title="AtmTrnAuditorCheckerOpenViewController";var y=k.decryptURL(p.search().hash);e.auditcreation_gid=y.auditcreation_gid;var b=e.auditcreation_gid;e.checklistmaster_gid=y.checklistmaster_gid;var U=e.checklistmaster_gid;e.checklistmasteradd_gid=y.checklistmasteradd_gid,e.sampleimport_gid=y.sampleimport_gid;var I=e.sampleimport_gid;e.lspage=y.lspage;var S=e.lspage;f(),e.getapprovalclick=function(t){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{var a=(e.txt_percent,{auditcreation_gid:t,getapproval_remark:e.getapproval_remark,observation_percentage:e.txt_percent});lockUI();var i="api/AtmTrnAuditorMaker/PostAuditorGetApproval";l.post(i,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnAuditorCheckerPendingApproval")):(modalInstance.close("closed"),d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace("_"," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:U},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=u.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))d.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var l={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",l.file),p.append("file_name",l.name),p.append("auditcreation_gid",t),p.append("project_flag","Default"),e.uploadfrm=p}else d.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)d.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),l.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(f(),unlockUI(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";l.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor});var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t){function e(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),f()}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.onselected=function(t,a,i){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?e.allobservationfilled=!0:e.allobservationfilled=!1,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},e.submitobservation=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t,auditcreation_gid:b},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Check point  Successfully!","success"),o.go("app.AtmTrnAuditorMakerSummary")):d.alert("Select Atleast One..!!","warning"),e.txttotal_score=""})},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),l.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){o.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+k.encryptURL("auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o+"&lspage="+S))},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?(t.document_radio=!0,t.document_radio1=!0):"No"==t.overall_detail&&(t.tag_radio=!0,t.tag_radio1=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditorcheckerPending"))):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})},a.checkpointobservationupdate=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservationUpdate";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditorcheckerPending"))):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstCheckerObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.dynamicsamplequeryscore=function(t,e,a,i){p.url("app/AtmTrnSampleQueryAgainstObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),v(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:b},n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:b,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=b,e.auditraisequery_gid=t;var n={auditcreation_gid:b,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==S?i="Auditor Maker":"auditorapproveropen"==S?i="Auditor Approver":"auditorcheckerOpen"==S?i="Auditor Checker":"auditeemakeropen"==S?i="Auditee Maker":"auditeecheckeropen"==S?i="Auditee Checker":"auditeemakertagged"==S&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(t){"auditorcheckerOpen"==S&&p.url("app/AtmTrnAuditorCheckerSummary")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]};
}angular.module("angle").controller("AtmTrnAuditorCheckerOpenViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetAuditorCheckerSummary";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.pendingcheckerapproval_count=t.data.pendingapprovalaudit_count,e.completed_count=t.data.completedcheckeraudit_count})}var f=this;f.title="AtmTrnAuditorCheckerPendingApprovalController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorCheckerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorCheckerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorCheckerTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.viewtask=function(t){d.url("app/AtmTrnAuditorCheckerView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorcheckerPending"))},e.viewobservation=function(t){d.url("app/AtmTrnAuditorCheckerObservationView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorcheckerPending"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.trackingstatus=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/trackingstatus.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.getauditapproval=function(t){function e(e,a){var o="api/employee/employee";s.get(o).then(function(t){e.employee_list=t.data.employee_list}),e.ok=function(){i.close("closed")},e.getreapprovalclick=function(){var a={approval_name:e.cboapproval_member.employee_name,approval_gid:e.cboapproval_member.employee_gid,auditcreation_gid:t,getapproval_remark:e.getapproval_remark};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditorGetApproval";s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(i.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(i.close("closed"),l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var i=a.open({templateUrl:"/getReApprovalmodal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerPendingApprovalController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t={auditcreation_gid:f},a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist";c.getparams(a,t).then(function(t){e.Querydetaillist=t.data.Querydetaillist,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetTagUserAuditview";lockUI(),c.getparams(a,t).then(function(t){e.audittaguser_list=t.data.audittaguser_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/closequerysummary";lockUI(),c.getparams(a,t).then(function(t){e.closequery_list=t.data.closequery_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetclosequeryAudit";lockUI(),c.getparams(a,t).then(function(t){e.auditraisequery_status=t.data.auditraisequery_status,unlockUI()})}var k=this;k.title="AtmTrnAuditorCheckerRaiseQueryController",e.auditcreation_gid=l.search().auditcreation_gid;var f=e.auditcreation_gid;e.lspage=l.search().lspage;var h=e.lspage;_(),lockUI(),e.refresh=function(){lockUI(),_()},e.replytoquery=function(){var t={auditcreation_gid:f,remarks:e.txtqueries};lockUI();var a="api/AtmTrnMyAuditTaskAuditee/PostQuerydetail";c.post(a,t).then(function(t){if(unlockUI(),1==t.data.status){s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist",i={auditcreation_gid:f};c.getparams(a,i).then(function(t){unlockUI(),e.Querydetaillist=t.data.Querydetaillist,1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.Back=function(t){"auditorcheckerOpen"==h?l.url("app/AtmTrnAuditorCheckerSummary"):"auditorcheckerPending"==h?l.url("app/AtmTrnAuditorCheckerPendingApproval"):"auditorcheckerClosed"==h?l.url("app/AtmTrnAuditorCheckerClosedAudit"):"auditorcheckerTagged"==h?l.url("app/AtmTrnAuditorCheckerTaggedItems"):"auditorcheckerHold"==h?l.url("app/AtmTrnAuditorCheckerHoldAudit"):"auditorcheckerCompleted"==h&&l.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.tagemployee=function(){function t(t,e){var a={auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuditee";c.getparams(i,a).then(function(e){t.auditcreation_gid=e.data.auditcreation_gid,t.txtaudit_name=e.data.audit_name}),t.ok=function(){e.close("closed")};var i="api/SystemMaster/GetEmployeelist";lockUI(),c.get(i).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={tagemployelist:t.cboemployee_name,audit_name:t.txtaudit_name,auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/PostTagUserAudit";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}i.open({templateUrl:"/tagemployee.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.close_query=function(){var t={auditcreation_gid:f,closing_description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/closequery";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorMakerSummary"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.showPopover=function(t){function e(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTaskAuditee/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/showemployee.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerRaiseQueryController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","$sce","$anchorScroll"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetOpenAuditorChecker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.pendingcheckerapproval_count=t.data.pendingapprovalaudit_count,e.completed_count=t.data.completedcheckeraudit_count})}var f=this;f.title="AtmTrnAuditorCheckerSummaryController",k(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorCheckerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorCheckerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorCheckerTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.viewchecker=function(t){d.url("app/AtmTrnAuditorCheckerOpenView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditorcheckerOpen"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update,status_remarks:e.txtremarks},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.trackingstatus=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/trackingstatus.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.statusremarks=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetStatusRemarks";s.getparams(o,i).then(function(t){unlockUI(),e.txtremarks=t.data.status_remarks}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/statusremarks.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.getauditapproval=function(t){function e(e,a){var o="api/employee/employee";s.get(o).then(function(t){e.employee_list=t.data.employee_list}),e.ok=function(){i.close("closed")},e.getreapprovalclick=function(){var a={approval_name:e.cboapproval_member.employee_name,approval_gid:e.cboapproval_member.employee_gid,auditcreation_gid:t,getapproval_remark:e.getapproval_remark};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditorGetApproval";s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(i.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(i.close("closed"),l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var i=a.open({templateUrl:"/getReApprovalmodal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditorMaker/GetAuditorCheckerSummary";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count})}var k=this;k.title="AtmTrnAuditorCheckerTaggedItemsController",_(),e.auditor_maker=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverSummary")},e.open_audit=function(){d.url("app/AtmTrnAuditorCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnAuditorCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnAuditorCheckerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorCheckerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorCheckerTaggedItems")},e.completed_audit=function(){d.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.auditraisequery=function(t){d.url("app/AtmTrnAuditorCheckerRaiseQuery?auditcreation_gid="+t+"&lspage=auditorcheckerTagged")},e.updateobservations=function(t){d.url("app/AtmTrnCheckerCheckpointObservation?auditcreation_gid="+t)},e.viewtask=function(t){d.url("app/AtmTrnAuditorCheckerView?auditcreation_gid="+t+"&lspage=auditorcheckerTagged")},e.checkerapproval=function(t){d.url("app/AtmTrnAuditorCheckerApproval?auditcreation_gid="+t)},e.assignedquery=function(t){d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.auditapproval=function(t){d.url("app/AtmTrnAuditApproval?auditcreation_gid="+t)},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.getauditapproval=function(t){function e(e,a){var o="api/employee/employee";s.get(o).then(function(t){e.employee_list=t.data.employee_list}),e.ok=function(){i.close("closed")},e.getreapprovalclick=function(){var a={approval_name:e.cboapproval_member.employee_name,approval_gid:e.cboapproval_member.employee_gid,auditcreation_gid:t,getapproval_remark:e.getapproval_remark};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditorGetApproval";s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(i.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(i.close("closed"),l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var i=a.open({templateUrl:"/getReApprovalmodal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerTaggedItemsController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"];
}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:b};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.auditorchecker_approvalflag=t.data.auditorchecker_approvalflag,e.openquerycount=t.data.openquerycount,e.auditopenquerycount=t.data.auditopenquerycount,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,"auditorcheckerPending"==S&&"N"==e.auditorchecker_approvalflag?e.proceedtoapprover=!0:e.proceedtoapprover=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var t="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),l.getparams(t,a).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list});var a={auditcreation_gid:b},t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})});var t="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=S&&"auditeemakerhold"!=S&&"auditeemakerclosed"!=S&&"auditeemakertagged"!=S&&"auditeemakercompleted"!=S&&"auditeecheckeropen"!=S&&"auditeecheckerpending"!=S&&"auditeecheckerhold"!=S&&"auditeecheckerclosed"!=S&&"auditeecheckertagged"!=S&&"auditeecheckercompleted"!=S||(e.close_disabled=!0)}),h();var a={auditcreation_gid:b,sampleimport_gid:I}}function h(){var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){1==t.data.status&&(e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata))});var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}function v(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var A=this;A.title="AtmTrnAuditorCheckerViewController";var y=k.decryptURL(p.search().hash);e.auditcreation_gid=y.auditcreation_gid;var b=e.auditcreation_gid;e.checklistmaster_gid=p.search().checklistmaster_gid;var U=e.checklistmaster_gid;e.checklistmasteradd_gid=y.checklistmasteradd_gid;e.checklistmasteradd_gid;e.sampleimport_gid=y.sampleimport_gid;var I=e.sampleimport_gid;e.lspage=y.lspage;var S=e.lspage;f(),e.getapprovalclick=function(t){if("0"!=e.openquerycount||"0"!=e.auditopenquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{var a=(e.txt_percent,{auditcreation_gid:t,getapproval_remark:e.getapproval_remark,observation_percentage:e.txt_percent});lockUI();var i="api/AtmTrnAuditorMaker/PostAuditorGetApproval";l.post(i,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnAuditorCheckerPendingApproval")):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}},e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace("_"," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:U},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=u.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))d.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var l={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",l.file),p.append("file_name",l.name),p.append("auditcreation_gid",t),p.append("project_flag","Default"),e.uploadfrm=p}else d.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)d.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),l.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(f(),unlockUI(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t){function e(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),f()}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.onselected=function(t,a,i){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?e.allobservationfilled=!0:e.allobservationfilled=!1,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},e.submitobservation=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t,auditcreation_gid:b},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Check point  Successfully!","success"),o.go("app.AtmTrnAuditorCheckerSummary")):d.alert("Select Atleast One..!!","warning"),e.txttotal_score=""})},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),l.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){o.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+k.encryptURL("auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o+"&lspage="+S))},e.observationquery=function(t,e,i){function o(a,o){function n(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},o="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(o,e).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?(t.document_radio=!0,t.document_radio1=!0):"No"==t.overall_detail?(t.tag_radio=!0,t.tag_radio1=!0):"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})})}a.ok=function(){o.close("closed")};var r={checkpointgroupadd_gid:t,auditcreation_gid:i},c="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?(t.document_radio=!0,t.document_radio1=!0):"No"==t.overall_detail?(t.tag_radio=!0,t.tag_radio1=!0):"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditorcheckerPending"))):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})},a.checkpointobservationupdate=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservationUpdate";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditorcheckerPending"))):(d.alert(t.data.message,{status:"Warning",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})};var r={checkpointgroupadd_gid:t,auditcreation_gid:i},c="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(c,r).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.overallselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallonselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallpartialselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallnaselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstCheckerObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.dynamicsamplequeryscore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstCheckerObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),v(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:b},n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:b,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=b,e.auditraisequery_gid=t;var n={auditcreation_gid:b,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==S?i="Auditor Maker":"auditorapproveropen"==S?i="Auditor Approver":"auditorcheckerOpen"==S?i="Auditor Checker":"auditeemakeropen"==S?i="Auditee Maker":"auditeecheckeropen"==S?i="Auditee Checker":"auditeemakertagged"==S&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(t){"auditorcheckerOpen"==S?p.url("app/AtmTrnAuditorCheckerSummary"):"auditorcheckerPending"==S?p.url("app/AtmTrnAuditorCheckerPendingApproval"):"auditorcheckerClosed"==S?p.url("app/AtmTrnAuditorCheckerClosedAudit"):"auditorcheckerTagged"==S?p.url("app/AtmTrnAuditorCheckerTaggedItems"):"auditorcheckerHold"==S?p.url("app/AtmTrnAuditorCheckerHoldAudit"):"auditorcheckerCompleted"==S&&p.url("app/AtmTrnAuditorCheckerCompletedAudit")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorCheckerViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetClosedAuditorMaker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnAuditorMakerClosedAuditController",k(),e.auditor_maker=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.hold_audit=function(){d.url("app/AtmTrnAuditorMakerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorMakerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorMakerTaggedAudit")},e.completed_audit=function(){d.url("app/AtmTrnAuditorMakerCompletedAudit")},e.viewtask=function(t){d.url("app/AtmTrnAuditorMakerView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditormakerClosed"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.trackingstatus=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/trackingstatus.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";
s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorMakerClosedAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetCompletedAuditorMaker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnAuditorMakerCompletedAuditController",k(),e.auditor_maker=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.hold_audit=function(){d.url("app/AtmTrnAuditorMakerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorMakerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorMakerTaggedAudit")},e.completed_audit=function(){d.url("app/AtmTrnAuditorMakerCompletedAudit")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.viewtask=function(t){d.url("app/AtmTrnAuditorMakerObservationView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditormakerCompleted"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorMakerCompletedAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetOnholdAuditorMaker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnAuditorMakerHoldAuditController",k(),e.auditor_maker=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.hold_audit=function(){d.url("app/AtmTrnAuditorMakerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorMakerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorMakerTaggedAudit")},e.completed_audit=function(){d.url("app/AtmTrnAuditorMakerCompletedAudit")},e.viewtask=function(t){d.url("app/AtmTrnAuditorMakerView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditormakerHold"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.trackingstatus=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/trackingstatus.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorMakerHoldAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){function t(){var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.expandCount=3,e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}})}e.nodivng=!0;var a="api/AtmTrnAuditCreation/EditAuditCreation",o={auditcreation_gid:b};lockUI(),l.getparams(a,o).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.openquerycount=t.data.openquerycount,e.status_update=t.data.status_update,e.DBobservation_score=t.data.observation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill&&"auditormakerOpen"==I&&"N"==e.auditormaker_approvalflag?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var a="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(a,o).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(a,o).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var a="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(a,o).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),l.getparams(a,o).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var a="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=I&&"auditeemakerhold"!=I&&"auditeemakerclosed"!=I&&"auditeemakertagged"!=I&&"auditeemakercompleted"!=I&&"auditeecheckeropen"!=I&&"auditeecheckerpending"!=I&&"auditeecheckerhold"!=I&&"auditeecheckerclosed"!=I&&"auditeecheckertagged"!=I&&"auditeecheckercompleted"!=I||(e.close_disabled=!0)}),t();var o={auditcreation_gid:b},a="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list}),e.allobservationfilled=!0;var o={auditcreation_gid:b},a="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(a,o).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function h(){e.observationfillenable=!0}function v(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var A=this;A.title="AtmTrnAuditorMakerObservationViewController";var y=k.decryptURL(p.search().hash),b=y.auditcreation_gid;e.auditcreation_gid=y.auditcreation_gid,e.checklistmaster_gid=y.checklistmaster_gid;var U=e.checklistmaster_gid;e.checklistmasteradd_gid=y.checklistmasteradd_gid;y.sampleimport_gid;e.sampleimport_gid=y.sampleimport_gid,e.lspage=y.lspage;var I=e.lspage;e.data={},f(),e.onselected=function(t,a,i){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:b},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";l.post(i,a).then(function(t){if(1==t.data.status){d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:b},i="api/AtmTrnAuditorMaker/AuditorMakerView";l.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:b},a="api/AtmTrnAuditCreation/observationfill";l.getparams(a,t).then(function(t){1==t.data.status&&h()}),e.close("closed")}}if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.openquerycount&&""!=e.DBobservation_score)d.alert("Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else if("Observation score for Audit & sample"==e.auditobservation_name&&"N"==e.checklistverified_flag)d.alert("Atleast one sample observation score saved",{status:"warning",pos:"top-center",timeout:3e3});else{var t=(e.txt_percent,{auditcreation_gid:e.auditcreation_gid,makerinitiate_approvalflag:"Y",observation_percentage:e.txt_percent}),a="api/AtmTrnAuditorMaker/PostMakerInitiateApproval";lockUI(),l.post(a,t).then(function(t){1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnAuditorMakerSummary")):(d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),defaultdynamic()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:U},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert("Select Atleast One..!!","warning")})},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=u.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;
e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))d.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var l={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",l.file),p.append("file_name",l.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else d.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)d.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),l.postFile(t,e.uploadfrm).then(function(t){e.tagsamplebutton=!0,a.close("closed"),1==t.data.status?(defaultdynamic(),unlockUI(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},f(),e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),l.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+k.encryptURL("auditcreation_gid="+b+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+I+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),p.url("app/MstMarketingSummary")):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.sampleobservationscoreview=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstMakerObservationScoreView?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),v(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:b},r="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(r,n).then(function(t){e.approval_status=t.data.approval_status,unlockUI()});var n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:b,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=b,e.auditraisequery_gid=t;var n={auditcreation_gid:b,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==I?i="Auditor Maker":"auditorapproveropen"==I?i="Auditor Approver":"auditorcheckerOpen"==I?i="Auditor Checker":"auditeemakeropen"==I?i="Auditee Maker":"auditeecheckeropen"==I?i="Auditee Checker":"auditeemakertagged"==I&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(t){"auditormakerOpen"==I?p.url("app/AtmTrnAuditorMakerSummary"):"auditormakerHold"==I?p.url("app/AtmTrnAuditorMakerHoldAudit"):"auditormakerClosed"==I?p.url("app/AtmTrnAuditorMakerClosedAudit"):"auditormakerTagged"==I?p.url("app/AtmTrnAuditorMakerTaggedAudit"):"auditormakerCompleted"==I&&p.url("app/AtmTrnAuditorMakerCompletedAudit")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorMakerObservationViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditorMaker/GetOpenAuditorMaker";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnAuditorMakerSummaryController",k(),e.auditor_maker=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.hold_audit=function(){d.url("app/AtmTrnAuditorMakerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorMakerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorMakerTaggedAudit")},e.completed_audit=function(){d.url("app/AtmTrnAuditorMakerCompletedAudit")},e.updateobservations=function(t){d.url("app/AtmTrnMakerCheckpointObservation?hash="+_.encryptURL("auditcreation_gid="+t))},e.viewtask=function(t){d.url("app/AtmTrnAuditorMakerView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditormakerOpen"))},e.viewobservation=function(t){d.url("app/AtmTrnAuditorMakerObservationView?hash="+_.encryptURL("auditcreation_gid="+t+"&lspage=auditormakerOpen"))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update,status_remarks:e.txtremarks},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.trackingstatus=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/trackingstatus.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.statusremarks=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetStatusRemarks";s.getparams(o,i).then(function(t){unlockUI(),e.txtremarks=t.data.status_remarks}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/statusremarks.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),k()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorMakerSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditorMaker/GetAuditorMakerSummary";lockUI(),s.get(t).then(function(t){e.myauditormaker_list=t.data.myauditormaker_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count})}var k=this;k.title="AtmTrnAuditorMakerTaggedAuditController",_(),e.auditor_maker=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.auditor_checker=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.auditor_approver=function(){i.go("app.AtmTrnAuditorApproverSummary")},e.open_audit=function(){d.url("app/AtmTrnAuditorMakerSummary")},e.hold_audit=function(){d.url("app/AtmTrnAuditorMakerHoldAudit")},e.closed_audit=function(){d.url("app/AtmTrnAuditorMakerClosedAudit")},e.tagged_items=function(){d.url("app/AtmTrnAuditorMakerTaggedAudit")},e.completed_audit=function(){d.url("app/AtmTrnAuditorMakerCompletedAudit")},e.taggedsamples=function(){var t="api/AtmTrnMyAuditTaskAuditee/GetTaggedSampleTask";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()})},e.auditraisequery=function(t){d.url("app/AtmTrnAuditorRaiseQuery?auditcreation_gid="+t+"&lspage=auditormakerTagged")},e.updateobservations=function(t){d.url("app/AtmTrnMakerCheckpointObservation?auditcreation_gid="+t)},e.viewtask=function(t){d.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+t+"&lspage=auditormakerTagged")},e.approval=function(t){d.url("app/AtmTrnApproval?auditcreation_gid="+t)},e.assignedquery=function(t){d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.auditapproval=function(t){d.url("app/AtmTrnAuditApproval?auditcreation_gid="+t)},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t,e){function o(a,o){var c={auditcreation_gid:t,checklistmaster_gid:e},d="api/AtmMstAuditMapping/GetAuditChecker";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.auditorchecker_list=t.data.auditorchecker_list});var d="api/AtmTrnAuditorMaker/TmpAllMembersDelete";s.get(d).then(function(t){}),a.ok=function(){n.close("closed")},a.ApprovalMembercancel=function(e){var i={tmpapprovalmember_gid:e,auditcreation_gid:t},o="api/AtmTrnAuditorMaker/TmpApprovalMembersDelete";s.post(o,i).then(function(t){a.approvalmember=t.data.approvalmember})},a.Changed=function(e){var o={approvalgid:a.cboapproval_membername.auditmapping_gid,approvalname:a.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnAuditorMaker/TempApprovalMember";s.post(n,o).then(function(e){if(1==e.data.status){l.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.current=i.current.name,r.store("dataldCtrl",a),a.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnAuditorMaker/TmpApprovalMembersView";s.getparams(n,o).then(function(t){a.approvalmember=t.data.approvalmember})}else l.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},a.getapprovalclick=function(){var e={approve_remarks:a.approve_remarks,approve_type:a.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnAuditorMaker/PostApprovalGet";s.post(i,e).then(function(t){unlockUI(),1==t.data.status?(n.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var n=a.open({templateUrl:"/getApprovalRequest.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMakerStatus";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnAuditorMaker/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSampleAuditor";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/Sampleexcelupload";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorMakerTaggedAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:U};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.openquerycount=t.data.openquerycount,e.status_update=t.data.status_update,e.DBobservation_score=t.data.observation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill&&"auditormakerOpen"==S&&"N"==e.auditormaker_approvalflag?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI();
});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var t="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),l.getparams(t,a).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=S&&"auditeemakerhold"!=S&&"auditeemakerclosed"!=S&&"auditeemakertagged"!=S&&"auditeemakercompleted"!=S&&"auditeecheckeropen"!=S&&"auditeecheckerpending"!=S&&"auditeecheckerhold"!=S&&"auditeecheckerclosed"!=S&&"auditeecheckertagged"!=S&&"auditeecheckercompleted"!=S||(e.close_disabled=!0)}),v();var a={auditcreation_gid:U},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list}),e.allobservationfilled=!0;var a={auditcreation_gid:U},t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function h(){e.observationfillenable=!0}function v(){var t={auditcreation_gid:U},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}function A(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var y=this;y.title="AtmTrnAuditorMakerViewController";var b=k.decryptURL(p.search().hash);e.auditcreation_gid=b.auditcreation_gid;var U=e.auditcreation_gid;e.checklistmaster_gid=b.checklistmaster_gid;var I=e.checklistmaster_gid;e.checklistmasteradd_gid=b.checklistmasteradd_gid,e.sampleimport_gid=b.sampleimport_gid;e.sampleimport_gid;e.lspage=b.lspage;var S=e.lspage;e.data={},f(),e.onselected=function(t,a,i,o){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.checkpointgroupadd_gid=o;var n={auditcreation_gid:e.auditcreation_gid,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,checkpointgroupadd_gid:e.checkpointgroupadd_gid},r="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),l.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_score=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},e.submitobservation=function(){if("0"!=e.openquerycount)d.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:U},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";l.post(i,a).then(function(t){if(1==t.data.status){d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:U},i="api/AtmTrnAuditorMaker/AuditorMakerView";l.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:U},a="api/AtmTrnAuditCreation/observationfill";l.getparams(a,t).then(function(t){1==t.data.status&&h()}),e.close("closed")}}a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]},e.makerinitiateapproval=function(){if("Observation score for Audit & sample"==e.auditobservation_name&&"N"==e.checklistverified_flag)d.alert("Atleast one sample observation score saved",{status:"warning",pos:"top-center",timeout:3e3});else if("Observation score for sample"==e.auditobservation_name){var t={auditcreation_gid:U,auditorapproval_remark:e.auditorapproval_remark},a="api/AtmTrnAuditorMaker/PostAuditorMakerInitiateSample";lockUI(),l.post(a,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),o.go("app.AtmTrnAuditorMakerSummary")):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}else{var t=(e.txt_percent,{auditcreation_gid:e.auditcreation_gid,makerinitiate_approvalflag:"Y",observation_percentage:e.txt_percent}),a="api/AtmTrnAuditorMaker/PostMakerInitiateApproval";lockUI(),l.post(a,t).then(function(t){1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnAuditorMakerSummary")):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}},e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),v()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:I},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),A(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=u.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))d.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var l={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",l.file),p.append("file_name",l.name),p.append("auditcreation_gid",t),p.append("project_flag","Default"),e.uploadfrm=p}else d.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)d.alert("Kindly Select the Excel file","warning"),a.close("closed");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),l.postFile(t,e.uploadfrm).then(function(t){e.tagsamplebutton=!0,a.close("closed"),1==t.data.status?(v(),unlockUI(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},f(),e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),l.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){o.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+k.encryptURL("auditcreation_gid="+U+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+S+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,i){function o(a,o){function n(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},o="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(o,e).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?(t.document_radio=!0,t.document_radio1=!0):"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})})}a.ok=function(){o.close("closed")};var r={checkpointgroupadd_gid:t,auditcreation_gid:i},c="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?(t.document_radio=!0,t.document_radio1=!0):"No"==t.overall_detail&&(t.tag_radio=!0,t.tag_radio1=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert(),p.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})},a.checkpointobservationupdate=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservationUpdate";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert(),p.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):(d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})};var r={checkpointgroupadd_gid:t,auditcreation_gid:i},c="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(c,r).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.checklist2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(r,n).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallonselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallpartialselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallnaselected=function(o){a.document_verified=o;var r={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,auditcreation_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstObservation";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f(),n()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){p.url("app/AtmTrnSampleAgainstObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.dynamicsamplequeryscore=function(t,e,a,i){p.url("app/AtmTrnSampleQueryAgainstObservationScore?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:U},n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:U,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=U,e.auditraisequery_gid=t;var n={auditcreation_gid:U,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==S?i="Auditor Maker":"auditorapproveropen"==S?i="Auditor Approver":"auditorcheckerOpen"==S?i="Auditor Checker":"auditeemakeropen"==S?i="Auditee Maker":"auditeecheckeropen"==S?i="Auditee Checker":"auditeemakertagged"==S&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.Back=function(t){"auditormakerOpen"==S?p.url("app/AtmTrnAuditorMakerSummary"):"auditormakerHold"==S?p.url("app/AtmTrnAuditorMakerHoldAudit"):"auditormakerClosed"==S?p.url("app/AtmTrnAuditorMakerClosedAudit"):"auditormakerTagged"==S?p.url("app/AtmTrnAuditorMakerTaggedAudit"):"auditormakerCompleted"==S&&p.url("app/AtmTrnAuditorMakerCompletedAudit")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditorMakerViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t={auditcreation_gid:f},a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist";c.getparams(a,t).then(function(t){e.Querydetaillist=t.data.Querydetaillist,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetTagUserAuditview";lockUI(),c.getparams(a,t).then(function(t){e.audittaguser_list=t.data.audittaguser_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/closequerysummary";lockUI(),c.getparams(a,t).then(function(t){e.closequery_list=t.data.closequery_list,unlockUI()});var a="api/AtmTrnMyAuditTaskAuditee/GetclosequeryAudit";lockUI(),c.getparams(a,t).then(function(t){e.auditraisequery_status=t.data.auditraisequery_status,unlockUI()})}var k=this;k.title="AtmTrnAuditRaiseQueryController",e.auditcreation_gid=l.search().auditcreation_gid;var f=e.auditcreation_gid;e.lspage=l.search().lspage;var h=e.lspage;_(),lockUI(),e.refresh=function(){lockUI(),_()},e.replytoquery=function(){var t={auditcreation_gid:f,remarks:e.txtqueries};lockUI();var a="api/AtmTrnMyAuditTaskAuditee/PostQuerydetail";c.post(a,t).then(function(t){if(unlockUI(),1==t.data.status){s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a="api/AtmTrnMyAuditTaskAuditee/GetQuerydetaillist",i={auditcreation_gid:f};c.getparams(a,i).then(function(t){unlockUI(),e.Querydetaillist=t.data.Querydetaillist,1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.Back=function(t){"auditeemakeropen"==h?l.url("app/AtmTrnMyAuditTaskAuditeeSummary"):"auditeemakerhold"==h?l.url("app/AtmTrnHoldAuditeeSummary"):"auditeemakerclosed"==h?l.url("app/AtmTrnClosedAuditeeSummary"):"auditeemakertagged"==h?l.url("app/AtmTrnTaggedAuditeeSummary"):"auditeemakercompleted"==h?l.url("app/AtmTrnCompletedAuditeeSummary"):"auditeecheckeropen"==h?l.url("app/AtmTrnMyAuditeeCheckerSummary"):"auditeecheckerpending"==h?l.url("app/AtmTrnCheckerPendingApproval"):"auditeecheckerhold"==h?l.url("app/AtmTrnCheckerHoldAuditee"):"auditeecheckerclosed"==h?l.url("app/AtmTrnCheckerClosedAuditee"):"auditeecheckertagged"==h?l.url("app/AtmTrnCheckerTaggedAuditee"):"auditeecheckercompleted"==h&&l.url("app/AtmTrnCheckerCompletedAuditee")},e.tagemployee=function(){function t(t,e){var a={auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuditee";c.getparams(i,a).then(function(e){t.auditcreation_gid=e.data.auditcreation_gid,t.txtaudit_name=e.data.audit_name}),t.ok=function(){e.close("closed")};var i="api/SystemMaster/GetEmployeelist";lockUI(),c.get(i).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={tagemployelist:t.cboemployee_name,audit_name:t.txtaudit_name,auditcreation_gid:f},i="api/AtmTrnMyAuditTaskAuditee/PostTagUserAudit";lockUI(),c.post(i,a).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}i.open({templateUrl:"/tagemployee.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.close_query=function(){var t={auditcreation_gid:f,closing_description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/closequery";lockUI(),c.post(i,t).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnAuditorMakerSummary"),_()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.showPopover=function(t){function e(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTaskAuditee/GetEmployeeName";c.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/showemployee.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnAuditRaiseQueryController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","$sce","$anchorScroll"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmRptAuditReports/GetAuditReportSummary";c.get(t).then(function(t){e.audit_list=t.data.auditreport_list,console.log(e.audit_list)})}var k=this;k.title="AtmTrnAuditReportSummaryController",_(),e.view=function(t){l.url("app/AtmRptAuditReportView?hash="+g.encryptURL("auditcreation_gid="+t))},e.exporauditreport=function(){var t="api/AtmRptAuditReports/GetAuditReportExcelExport";c.get(t).then(function(t){1==t.data.status?m.Downloaddocument(t.data.lscloudpath,t.data.lsname):(s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),_())})},e.query_report=function(t){var e={auditcreation_gid:t},a="api/AtmRptAuditReports/GetAuditSampleQueryReportExcelExport";c.getparams(a,e).then(function(t){1==t.data.status?m.Downloaddocument(t.data.lscloudpath,t.data.lsname):(s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),_())})},e.observationreport=function(t){
var e={auditcreation_gid:t},a="api/AtmRptAuditReports/GetAuditObservationReportExcelExport";c.getparams(a,e).then(function(t){1==t.data.status?m.Downloaddocument(t.data.lscloudpath,t.data.lsname):(s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),_())})},e.sample_report=function(t){var e={auditcreation_gid:t},a="api/AtmRptAuditReports/GetAuditSampleReportExcelExport";c.getparams(a,e).then(function(t){1==t.data.status?m.Downloaddocument(t.data.lscloudpath,t.data.lsname):(s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),_())})},e.sampleobservation_report=function(t){var e={auditcreation_gid:t},a="api/AtmRptAuditReports/GetAuditObservationSampleReportExcelExport";c.getparams(a,e).then(function(t){1==t.data.status?m.Downloaddocument(t.data.lscloudpath,t.data.lsname):(s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),_())})}}angular.module("angle").controller("AtmTrnAuditReportSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u){function m(){var t="api/AtmTrnAuditCreation/GetAuditCreation";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})}var g=this;g.title="AtmTrnAuditSummaryController",m(),e.view=function(t,e,a){l.url("app/AtmTrnAudit360View?auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a)},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")}}angular.module("angle").controller("AtmTrnAuditSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:f,sampleimport_gid:k},a="api/AtmTrnSampling/GetSample";s.getparams(a,t).then(function(t){unlockUI(),e.sample_list=t.data.sample_list});var a="api/AtmTrnSampling/GetEmployeeName";s.getparams(a,t).then(function(t){unlockUI(),e.employee_name=t.data.employee_name});var a="api/AtmTrnSampling/GetSampleView",t={sampleimport_gid:k,auditcreation_gid:f};lockUI(),s.getparams(a,t).then(function(t){e.txtsample_name=t.data.sample_name,e.txtsamfin_code=t.data.samfin_code,e.txtsamagro_code=t.data.samagro_code,e.txtcodecreation_date=t.data.codecreation_date,e.txtfield1=t.data.field1,e.txtfield2=t.data.field2,e.txtfield3=t.data.field3,e.txtfield4=t.data.field4,e.txtfield5=t.data.field5,e.txtfield6=t.data.field6,e.txtfield7=t.data.field7,e.txtfield8=t.data.field8,e.txtfield9=t.data.field9,e.txtfield10=t.data.field10,unlockUI()})}var _=this;_.title="AtmTrnAuditTaskSampleViewController",e.sampleimport_gid=d.search().sampleimport_gid;var k=e.sampleimport_gid;e.auditcreation_gid=d.search().auditcreation_gid;var f=e.auditcreation_gid;g(),e.back=function(){var t=e.auditcreation_gid,a=e.sampleimport_gid;d.url("app/AtmTrnMyAuditTaskAuditeeView?auditcreation_gid="+t+"&sampleimport_gid="+a)},e.Back=function(){var t=e.auditcreation_gid;d.url("app/AtmTrnAuditorMaker?auditcreation_gid="+t)}}angular.module("angle").controller("AtmTrnAuditTaskSampleViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditorMaker/EditAuditorMakerCheckpointObservation",a={auditcreation_gid:k};lockUI(),s.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditorMakerCheckpointObservationView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,e){t.capture_score==t.yes_score?t.yes_radio=!0:t.capture_score==t.no_score?t.no_radio=!0:t.capture_score==t.partial_score?t.partialscore_radio=!0:t.capture_score==t.na_score&&(t.nascore_radio=!0)})});var t="api/AtmTrnSampling/GetSampleAuditor";s.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnCheckerCheckpointObservationController";var k=d.search().auditcreation_gid;d.search().auditcreation2checklist_gid;e.sampleimport_gid=d.search().sampleimport_gid;e.sampleimport_gid;g(),e.onselected=function(t,a,i){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:k,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_totalscore:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),s.post(n,o).then(function(t){1==t.data.status?(e.txttotal_score=t.data.total_amount,unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.submitobservation=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t,auditcreation_gid:k},o="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Check point  Successfully!","success"),i.go("app.AtmTrnAuditorCheckerSummary")):l.alert("Select Atleast One..!!","warning"),e.txttotal_score=""})},e.back=function(t){i.go("app.AtmTrnAuditorCheckerSummary")},e.checkpointintent=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,e){function i(a,i){var o={sampleimport_gid:e},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.btnconfirm=function(){var o={employelist:a.cboemployee_name,sample_name:a.txtsample_name,sampleimport_gid:e,auditcreation_gid:t},n="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnCheckerCheckpointObservation?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/taguser.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,employelist:a.cboemployee_name,description:a.txtdescription,auditcreation_gid:e},o="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(o,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnSampling?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.assignedquery=function(t,e){d.url("app/AtmTrnSampleAssignedQuery?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.view=function(t,a){e.sampleimport_gid,e.auditcreation_gid;d.url("app/AtmTrnSamplingView?auditcreation_gid="+t+"&sampleimport_gid="+a)},e.back=function(){i.go("app.AtmTrnAuditorCheckerSummary")},e.samplequery=function(t,e){d.url("app/AtmTrnSampleQueryAuditor?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){a.close("closed"),1==t.data.status?(location.reload(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckerCheckpointObservationController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetCheckerClosedAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.taggedsample_count=t.data.taggedsample_count,e.pendingapproval_count=t.data.pendingapproval_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnCheckerClosedAuditeeController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnCheckerHoldAuditee")},e.closed_audit=function(){d.url("app/AtmTrnCheckerClosedAuditee")},e.tagged_items=function(){d.url("app/AtmTrnCheckerTaggedAuditee")},e.completed_audit=function(){d.url("app/AtmTrnCheckerCompletedAuditee")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeecheckerclosed"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckerClosedAuditeeController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetCheckerCompletedAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditscheckeronhold_count,e.closedaudit_count=t.data.closedcheckeraudit_count,e.openaudit_count=t.data.opencheckeraudit_count,e.taggedsample_count=t.data.taggedsample_count,e.pendingapproval_count=t.data.pendingapproval_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnCheckerCompletedAuditeeController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnCheckerHoldAuditee")},e.closed_audit=function(){d.url("app/AtmTrnCheckerClosedAuditee")},e.tagged_items=function(){d.url("app/AtmTrnCheckerTaggedAuditee")},e.completed_audit=function(){d.url("app/AtmTrnCheckerCompletedAuditee")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeecheckercompleted"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckerCompletedAuditeeController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetCheckerHoldAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.taggedsample_count=t.data.taggedsample_count,e.pendingapproval_count=t.data.pendingapproval_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnCheckerHoldAuditeeController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnCheckerHoldAuditee")},e.closed_audit=function(){d.url("app/AtmTrnCheckerClosedAuditee")},e.tagged_items=function(){d.url("app/AtmTrnCheckerTaggedAuditee")},e.completed_audit=function(){d.url("app/AtmTrnCheckerCompletedAuditee")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeecheckerhold"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),p.append("project_flag","Default"),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckerHoldAuditeeController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskAuditeeChecker";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,e.employee_gid=t.data.employee_gid});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditscheckeronhold_count,e.closed_count=t.data.closedcheckeraudit_count,e.openaudit_count=t.data.opencheckeraudit_count,e.taggedsample_count=t.data.taggedsample_count,e.pendingapproval_count=t.data.pendingapproval_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnCheckerPendingApprovalController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnCheckerHoldAuditee")},e.closed_audit=function(){d.url("app/AtmTrnCheckerClosedAuditee")},e.tagged_items=function(){d.url("app/AtmTrnCheckerTaggedAuditee")},e.completed_audit=function(){d.url("app/AtmTrnCheckerCompletedAuditee")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeecheckerpending"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,
file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckerPendingApprovalController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskAuditeeMaker";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.taggedsample_count=t.data.taggedsample_count})}var k=this;k.title="AtmTrnCheckerTaggedAuditeeController",e.lspage=d.search().lspage;e.lspage;_(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.pending_approval=function(){d.url("app/AtmTrnCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnCheckerHoldAuditee")},e.closed_audit=function(){d.url("app/AtmTrnCheckerClosedAuditee")},e.tagged_items=function(){d.url("app/AtmTrnCheckerTaggedAuditee")},e.completed_audit=function(){d.url("app/AtmTrnCheckerCompletedAuditee")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeView?auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeecheckertagged")},e.auditraisequery=function(t){d.url("app/AtmTrnAuditRaiseQuery?auditcreation_gid="+t+"&lspage=auditeecheckertagged")},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(_(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckerTaggedAuditeeController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnMyAuditTask/EditCheckpointObservation",a={auditcreation_gid:k};lockUI(),s.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnMyAuditTask/CheckpointObservationView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.checkpointobservation_list=t.data.checkpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.checkpointobservation_list.length;a++)e.checkpointobservation_list[a].checked=!0;angular.forEach(e.checkpointobservation_list,function(t,e){t.capture_score==t.yes_score?t.yes_radio=!0:t.capture_score==t.no_score?t.no_radio=!0:t.capture_score==t.partial_score?t.partialscore_radio=!0:t.capture_score==t.na_score&&(t.nascore_radio=!0)})});var t="api/AtmTrnSampling/GetSample";s.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnCheckpointObservationController";var k=d.search().auditcreation_gid;d.search().auditcreation2checklist_gid;e.sampleimport_gid=d.search().sampleimport_gid;e.sampleimport_gid;g(),e.onselected=function(t,a,i){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:k,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_totalscore:e.total_score},n="api/AtmTrnMyAuditTask/PostObservationTotalAmount";lockUI(),s.post(n,o).then(function(t){1==t.data.status?(e.txttotal_score=t.data.total_amount,unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.submitobservation=function(){var t=[];if(angular.forEach(e.checkpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t,auditcreation_gid:k},o="api/AtmTrnMyAuditTask/PostCheckpointObservation";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Check point  Successfully!","success"),i.go("app.AtmTrnMyAuditTaskSummary")):l.alert("Select Atleast One..!!","warning"),e.txttotal_score=""})},e.back=function(t){i.go("app.AtmTrnMyAuditTaskSummary")},e.checkpointintent=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTask/GetAuditCreationIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTask/GetAuditCreationDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTask/GetAuditCreationAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,e){function i(a,i){var o={sampleimport_gid:e},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.btnconfirm=function(){var o={employelist:a.cboemployee_name,sample_name:a.txtsample_name,sampleimport_gid:e,auditcreation_gid:t},n="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnCheckpointObservation?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/taguser.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,employelist:a.cboemployee_name,description:a.txtdescription,auditcreation_gid:e},o="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(o,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnSampling?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.assignedquery=function(t,e){d.url("app/AtmTrnSampleAssignedQuery?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.view=function(t,e){d.url("app/AtmTrnSamplingView?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.back=function(){i.go("app.AtmTrnMyAuditTaskSummary")}}angular.module("angle").controller("AtmTrnCheckpointObservationController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:k},a="api/AtmTrnAuditCreation/ChecklistAssignView";lockUI(),s.getparams(a,t).then(function(t){unlockUI(),e.checklistassignview_list=t.data.checklistassignview_list})}var _=this;_.title="AtmTrnCheckpointSummaryAssignController";var k=d.search().auditcreation_gid;g(),e.checkall=function(t){angular.forEach(e.checklistassignview_list,function(e){e.checked=t})},e.unassignchecklist=function(){var t=[];if(angular.forEach(e.checklistassignview_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t},o="api/AtmTrnAuditCreation/DeleteChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist UnAssigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.back=function(t){i.go("app.AtmTrnAuditCreationSummary")},e.checkpointintent=function(t,e){function i(e,a){var i={auditcreation2checklist_gid:t};lockUI();var o="api/AtmTrnAuditCreation/GetAuditCreationIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={auditcreation2checklist_gid:t};lockUI();var o="api/AtmTrnAuditCreation/GetAuditCreationDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={auditcreation2checklist_gid:t};lockUI();var o="api/AtmTrnAuditCreation/GetAuditCreationAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckpointSummaryAssignController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={checklistmaster_gid:k},a="api/AtmTrnAuditCreation/CheckpointCreation";lockUI(),s.getparams(a,t).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list,angular.forEach(e.checkpointsummary_list,function(t,e){"Y"==t.checklist_flag&&(t.checked=!0)})})}var _=this;_.title="AtmTrnCheckpointSummaryController";var k=d.search().checklistmaster_gid;e.checklistmaster_gid=d.search().checklistmaster_gid;var k=e.checklistmaster_gid;d.search().auditcreation_gid,d.search().checklistmasteradd_gid;e.checklistmasteradd_gid=d.search().checklistmasteradd_gid,g(),e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:k},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.back=function(t){i.go("app.AtmTrnAuditCreationSummary")},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCheckpointSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetClosedAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.taggedsample_count=t.data.taggedsample_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnClosedAuditeeSummaryController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.hold_audit=function(){d.url("app/AtmTrnHoldAuditeeSummary")},e.closed_audit=function(){d.url("app/AtmTrnClosedAuditeeSummary")},e.tagged_items=function(){d.url("app/AtmTrnTaggedAuditeeSummary")},e.completed_audit=function(){d.url("app/AtmTrnCompletedAuditeeSummary")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeemakerclosed"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnClosedAuditeeSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetCompletedAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.taggedsample_count=t.data.taggedsample_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnCompletedAuditeeSummaryController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.hold_audit=function(){d.url("app/AtmTrnHoldAuditeeSummary")},e.closed_audit=function(){d.url("app/AtmTrnClosedAuditeeSummary")},e.tagged_items=function(){d.url("app/AtmTrnTaggedAuditeeSummary")},e.completed_audit=function(){d.url("app/AtmTrnCompletedAuditeeSummary")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeemakercompleted"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnCompletedAuditeeSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){f.calender1=function(t){t.preventDefault(),t.stopPropagation(),f.open1=!0},f.calender2=function(t){t.preventDefault(),t.stopPropagation(),f.open2=!0},f.calender3=function(t){t.preventDefault(),t.stopPropagation(),f.open3=!0},f.formats=["dd-MM-yyyy"],f.format=f.formats[0],f.dateOptions={formatYear:"yy",startingDay:1};var t="api/AtmMstChecklistMaster/GetChecklistMaster";lockUI(),s.get(t).then(function(t){e.checklistmaster_list=t.data.checklistmaster_list,unlockUI()});var t="api/AtmTrnAuditCreation/TempDeleteAuditee";s.get(t).then(function(t){});var t="api/AtmMstAuditPriority/GetAuditPriorityActive";lockUI(),s.get(t).then(function(t){e.auditpriority_data=t.data.auditpriority_list,unlockUI()});var t="api/AtmMstAuditType/GetAuditTypeActive";lockUI(),s.get(t).then(function(t){e.audittype_list=t.data.audittype_list,unlockUI()});var t="api/AtmMstAuditMapping/GetAuditMappingMaker";lockUI(),s.get(t).then(function(t){unlockUI(),e.auditmapping1_list=t.data.auditmappingmaker_list});var t="api/AtmMstAuditMapping/GetAuditMappingChecker";lockUI(),s.get(t).then(function(t){unlockUI(),e.auditmapping_list=t.data.auditmappingchecker_list});var t="api/AtmMstAuditMapping/GetAuditMappingApprover";lockUI(),s.get(t).then(function(t){unlockUI(),e.auditmapping2_list=t.data.auditmappingapprover_list});var t="api/AtmMstAuditDepartment/GetMappingDepartment";lockUI(),s.get(t).then(function(t){e.auditdepartment_list=t.data.auditmappingdepartment_list,unlockUI()});var t="api/SystemMaster/GetEmployeelist";lockUI(),s.get(t).then(function(t){e.employee_list=t.data.employeelist,unlockUI()});var t="api/SystemMaster/GetEmployeelist";lockUI(),s.get(t).then(function(t){e.employee1_list=t.data.employeelist,unlockUI()});var a=new Date,i=(a.toLocaleString([],{hour:"2-digit",minute:"2-digit"}),new Date);0+i.getDate()+"-"+(i.getMonth()+1)+"-"+i.getFullYear();e.txttoday_date=i}function _(){var t="api/AtmTrnAuditCreation/GetAuditeeList";s.get(t).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})}function k(){var t="api/AtmTrnAuditCreation/GetAuditeeList";s.get(t).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list})}var f=this;f.title="AtmTrnCreateAuditController";var h=d.search().checklistmasteradd_gid;g(),e.auditname_change=function(t){var a={checklistmaster_gid:e.cboauditname.checklistmaster_gid},i="api/AtmTrnAuditCreation/GetAuditNameDetail";s.getparams(i,a).then(function(t){e.checklistmaster_gid=t.data.checklistmaster_gid,e.checkpointgroup_gid=t.data.checkpointgroup_gid,e.txtentity_name=t.data.entity_name,e.txtauditdescription_name=t.data.audit_description,e.txtcheckpointgroup_name=t.data.checkpointgroup_name}),e.txtentity_name=""},e.auditdepartmentname_change=function(t){var a={auditdepartment_gid:e.cboauditdepartment.auditdepartment_gid},i="api/AtmTrnAuditCreation/GetAuditName";lockUI(),s.getparams(i,a).then(function(t){unlockUI(),e.auditname_list=t.data.auditname_list})},e.submitcreateaudit=function(){var t="",a="";void 0==e.cboauditname&&null==e.cboauditname||(t=e.cboauditname.checklistmaster_gid,a=e.cboauditname.audit_name);var o="",n="";void 0==e.cboauditpriority&&null==e.cboauditpriority||(o=e.cboauditpriority.auditpriority_gid,n=e.cboauditpriority.auditpriority_name);var r="",c="";void 0==e.cboaudittype&&null==e.cboaudittype||(r=e.cboaudittype.audittype_gid,c=e.cboaudittype.audittype_name);var d="",p="";void 0==e.cboauditdepartment&&null==e.cboauditdepartment||(d=e.cboauditdepartment.auditdepartment_gid,p=e.cboauditdepartment.auditdepartment_name);var u="",m="";void 0==e.cboauditapprover&&null==e.cboauditapprover||(u=e.cboauditapprover.auditmapping2employee_gid,m=e.cboauditapprover.approver_name);var g="",_="";void 0==e.cboauditmaker&&null==e.cboauditmaker||(g=e.cboauditmaker.employee_gid,
_=e.cboauditmaker.employee_name);var k="",f="";void 0==e.cboauditchecker&&null==e.cboauditchecker||(k=e.cboauditchecker.auditmapping_gid,f=e.cboauditchecker.employee_name);var v={checklistmasteradd_gid:h,audit_uniqueno:e.txtaudit_ref_no,auditdepartment_gid:d,auditdepartment_name:p,audittype_gid:r,audittype_name:c,auditobservation_name:e.auditobservation,checklistmaster_gid:t,audit_name:a,auditpriority_gid:o,auditpriority_name:n,auditorapprover_gid:u,audit_approver:m,auditormaker_gid:g,audit_maker:_,auditorchecker_gid:k,audit_checker:f,end_date:e.txtend_date,periodfrom_date:e.txtperiod_from,auditperiod_to:e.txtperiod_to,entity_name:e.txtentity_name,checkpointgroup_name:e.txtcheckpointgroup_name,checkpointgroup_gid:e.checkpointgroup_gid,audit_description:e.txtauditdescription_name},A="api/AtmTrnAuditCreation/PostAuditCreation";lockUI(),s.post(A,v).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.go("app.AtmTrnAuditCreationSummary")):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.back=function(t){i.go("app.AtmTrnAuditCreationSummary")},e.addauditee=function(){var t="",a="";void 0==e.cboauditeemaker&&null==e.cboauditeemaker||(t=e.cboauditeemaker.employee_gid,a=e.cboauditeemaker.employee_name);var i="",o="";if(void 0==e.cboauditeechecker&&null==e.cboauditeechecker||(i=e.cboauditeechecker.employee_gid,o=e.cboauditeechecker.employee_name),""==e.cboauditeemaker||null==e.cboauditeemaker||""==e.cboauditeechecker||null==e.cboauditeechecker)l.alert("Kindly Fill Auditee Details","warning");else{var n={auditeemaker_gid:t,auditeemaker_name:a,auditeechecker_gid:i,auditeechecker_name:o},r="api/AtmTrnAuditCreation/PostMultipleAuditee";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),e.cboauditeemaker="",e.cboauditeechecker=""})}},e.delete_auditee=function(t){var e={multipleauditee_gid:t},a="api/AtmTrnAuditCreation/DeleteAuditeeList";lockUI(),s.getparams(a,e).then(function(t){unlockUI(),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),k()})}}angular.module("angle").controller("AtmTrnCreateAuditController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetHoldAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.taggedsample_count=t.data.taggedsample_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnHoldAuditeeSummaryController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.hold_audit=function(){d.url("app/AtmTrnHoldAuditeeSummary")},e.closed_audit=function(){d.url("app/AtmTrnClosedAuditeeSummary")},e.tagged_items=function(){d.url("app/AtmTrnTaggedAuditeeSummary")},e.completed_audit=function(){d.url("app/AtmTrnCompletedAuditeeSummary")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeemakerhold"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnHoldAuditeeSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetMyApprovedAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list});var t="api/AtmTrnAuditCreation/GetAuditCreationCounts";c.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.Approvedaudit_count=t.data.Approvedaudit_count,e.completedaudit_count=t.data.completedaudit_count,e.rejectedaudit_count=t.data.rejectedaudit_count})}var _=this;_.title="AtmTrnInitiateAuditApprovedController",g(),e.openaudit=function(){a.go("app.AtmTrnAuditCreationSummary")},e.approvedaudit=function(){a.go("app.AtmTrnInitiateAuditApproved")},e.auditsonhold=function(){a.go("app.AtmTrnInitiateAuditHold")},e.closedaudit=function(){a.go("app.AtmTrnInitiateAuditClosed")},e.rejectedaudit=function(){a.go("app.AtmTrnInitiateAuditRejected")},e.completedaudit=function(){a.go("app.AtmTrnInitiateAuditCompleted")},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";c.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update,e.status_remarks=t.data.status_remarks}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update,status_remarks:e.status_remarks},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),c.post(o,i).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),g()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}u.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.view=function(t,e,a){l.url("app/AtmTrnAudit360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=auditapproved"))},e.edit=function(t){l.url("app/AtmTrnAuditCreationEdit?hash="+m.encryptURL("auditcreation_gid="+t+"&lspage=auditapproved"))},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelSample"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}u.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnInitiateAuditApprovedController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetMyClosedAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list});var t="api/AtmTrnAuditCreation/GetAuditCreationCounts";c.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.Approvedaudit_count=t.data.Approvedaudit_count,e.completedaudit_count=t.data.completedaudit_count,e.rejectedaudit_count=t.data.rejectedaudit_count})}var _=this;_.title="AtmTrnInitiateAuditClosedController",g(),e.openaudit=function(){a.go("app.AtmTrnAuditCreationSummary")},e.approvedaudit=function(){a.go("app.AtmTrnInitiateAuditApproved")},e.auditsonhold=function(){a.go("app.AtmTrnInitiateAuditHold")},e.closedaudit=function(){a.go("app.AtmTrnInitiateAuditClosed")},e.rejectedaudit=function(){a.go("app.AtmTrnInitiateAuditRejected")},e.completedaudit=function(){a.go("app.AtmTrnInitiateAuditCompleted")},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.view=function(t,e,a){l.url("app/AtmTrnAudit360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=auditclosed"))},e.edit=function(t){l.url("app/AtmTrnAuditCreationEdit?hash="+m.encryptURL("auditcreation_gid="+t))},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";c.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update,e.status_remarks=t.data.status_remarks}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update,status_remarks:e.status_remarks},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),c.post(o,i).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),g()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}u.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelSample"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}u.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnInitiateAuditClosedController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetCompletedAudit";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.completedaudit_list});var t="api/AtmTrnAuditCreation/GetAuditCreationCounts";c.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.Approvedaudit_count=t.data.Approvedaudit_count,e.completedaudit_count=t.data.completedaudit_count,e.rejectedaudit_count=t.data.rejectedaudit_count})}var _=this;_.title="AtmTrnInitiateAuditCompletedController",g(),e.openaudit=function(){a.go("app.AtmTrnAuditCreationSummary")},e.approvedaudit=function(){a.go("app.AtmTrnInitiateAuditApproved")},e.auditsonhold=function(){a.go("app.AtmTrnInitiateAuditHold")},e.closedaudit=function(){a.go("app.AtmTrnInitiateAuditClosed")},e.rejectedaudit=function(){a.go("app.AtmTrnInitiateAuditRejected")},e.completedaudit=function(){a.go("app.AtmTrnInitiateAuditCompleted")},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.view=function(t,e,a){l.url("app/AtmTrnAudit360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=auditcompleted"))},e.edit=function(t){l.url("app/AtmTrnAuditCreationEdit?hash="+m.encryptURL("auditcreation_gid="+t))},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelSample"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}u.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnInitiateAuditCompletedController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetMyOnholdAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list});var t="api/AtmTrnAuditCreation/GetAuditCreationCounts";c.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.Approvedaudit_count=t.data.Approvedaudit_count,e.completedaudit_count=t.data.completedaudit_count,e.rejectedaudit_count=t.data.rejectedaudit_count})}var _=this;_.title="AtmTrnInitiateAuditHoldController",g(),e.openaudit=function(){a.go("app.AtmTrnAuditCreationSummary")},e.approvedaudit=function(){a.go("app.AtmTrnInitiateAuditApproved")},e.auditsonhold=function(){a.go("app.AtmTrnInitiateAuditHold")},e.closedaudit=function(){a.go("app.AtmTrnInitiateAuditClosed")},e.rejectedaudit=function(){a.go("app.AtmTrnInitiateAuditRejected")},e.completedaudit=function(){a.go("app.AtmTrnInitiateAuditCompleted")},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditorMaker/EditAuditorMaker";c.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update,e.status_remarks=t.data.status_remarks}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update,status_remarks:e.status_remarks},o="api/AtmTrnAuditorMaker/GetAuditorMakerStatus";lockUI(),c.post(o,i).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),g()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}u.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.view=function(t,e,a){l.url("app/AtmTrnAudit360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=audithold"))},e.edit=function(t){l.url("app/AtmTrnAuditCreationEdit?hash="+m.encryptURL("auditcreation_gid="+t))},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelSample"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}u.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnInitiateAuditHoldController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetAuditCreationRejected";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list});var t="api/AtmTrnAuditCreation/GetAuditCreationCounts";c.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.Approvedaudit_count=t.data.Approvedaudit_count,e.completedaudit_count=t.data.completedaudit_count,e.rejectedaudit_count=t.data.rejectedaudit_count})}var _=this;_.title="AtmTrnInitiateAuditRejectedController",g(),e.openaudit=function(){a.go("app.AtmTrnAuditCreationSummary")},e.approvedaudit=function(){a.go("app.AtmTrnInitiateAuditApproved")},e.auditsonhold=function(){a.go("app.AtmTrnInitiateAuditHold")},e.closedaudit=function(){a.go("app.AtmTrnInitiateAuditClosed")},e.rejectedaudit=function(){a.go("app.AtmTrnInitiateAuditRejected")},e.completedaudit=function(){a.go("app.AtmTrnInitiateAuditCompleted")},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.view=function(t,e,a){l.url("app/AtmTrnAudit360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=auditrejected"))},e.edit=function(t){l.url("app/AtmTrnAuditCreationEdit?hash="+m.encryptURL("auditcreation_gid="+t))},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=d.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var l=/(\.xls|\.xlsx|\.csv)$/i;if(l.exec(c))if(0==c.includes("ImportExcelSample"))s.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else s.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)s.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),c.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}u.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnInitiateAuditRejectedController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditorMaker/EditAuditorMakerCheckpointObservation",a={auditcreation_gid:k};lockUI(),s.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditorMakerCheckpointObservationView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,e){t.capture_score==t.yes_score?t.yes_radio=!0:t.capture_score==t.no_score?t.no_radio=!0:t.capture_score==t.partial_score?t.partialscore_radio=!0:t.capture_score==t.na_score&&(t.nascore_radio=!0)})});var t="api/AtmTrnAuditorMaker/GetMakerInitiateStatus";s.getparams(t,a).then(function(t){unlockUI(),e.makerstatus_flag=t.data.makerstatus_flag,e.makerapproval_flag=t.data.makerapproval_flag,e.maker_initiated=t.data.maker_initiated});var t="api/AtmTrnSampling/GetSampleAuditor";s.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnMakerCheckpointObservationController";
var k=d.search().auditcreation_gid;d.search().auditcreation2checklist_gid;e.sampleimport_gid=d.search().sampleimport_gid;e.sampleimport_gid;g(),e.onselected=function(t,a,i){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i;var o={auditcreation_gid:k,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_totalscore:e.total_score},n="api/AtmTrnAuditorMaker/PostAuditorMakerObservationTotalAmount";lockUI(),s.post(n,o).then(function(t){1==t.data.status?(e.txttotal_score=t.data.total_amount,unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.submitobservation=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={auditcreation2checklist_gid:t,auditcreation_gid:k},o="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Check point  Successfully!","success"),i.go("app.AtmTrnAuditorMakerSummary")):l.alert("Select Atleast One..!!","warning"),e.txttotal_score=""})},e.back=function(t){i.go("app.AtmTrnAuditorMakerSummary")},e.checkpointintent=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnAuditorMaker/GetAuditCreationAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,e){function i(a,i){var o={sampleimport_gid:e},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.btnconfirm=function(){var o={employelist:a.cboemployee_name,sample_name:a.txtsample_name,sampleimport_gid:e,auditcreation_gid:t},n="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnMakerCheckpointObservation?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/taguser.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,employelist:a.cboemployee_name,description:a.txtdescription,auditcreation_gid:e},o="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(o,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnSampling?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.assignedquery=function(t,e){d.url("app/AtmTrnSampleAssignedQuery?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.view=function(t,a){e.sampleimport_gid,e.auditcreation_gid;d.url("app/AtmTrnSamplingView?auditcreation_gid="+t+"&sampleimport_gid="+a)},e.back=function(){i.go("app.AtmTrnAuditorMakerSummary")},e.samplequery=function(t,e){d.url("app/AtmTrnSampleQueryAuditor?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(t,a,i){var o=document.getElementById("fileimport"),n=o.value;e.fileinputvalue=n;var r=/(\.xls|\.xlsx|\.csv)$/i;if(r.exec(n))if(0==n.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),$modalInstance.close("closed");else{var c={name:t[0].name,file:t[0]},s=new FormData;s.append("fileupload",c.file),s.append("file_name",c.name),s.append("auditcreation_gid",k),e.uploadfrm=s}else l.alert("File Format Not Supported!","warning"),$modalInstance.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(g(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnMakerCheckpointObservation?auditcreation_gid="+val1),$modalInstance.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),$modalInstance.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}angular.module("angle").controller("AtmTrnMakerCheckpointObservationController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetMyApprovedAudit";lockUI(),c.get(t).then(function(t){e.approvedaudit_list=t.data.auditcreationapproved_list,unlockUI()});var t="api/AtmTrnAuditCreation/GetApprovedAuditCounts";c.get(t).then(function(t){unlockUI(),e.pendingapprovalaudit_count=t.data.pendingapproval_count,e.approvedaudit_count=t.data.approved_count,e.rejectedaudit_count=t.data.rejected_count})}var _=this;_.title="AtmTrnMyApprovedAuditSummaryController",g(),e.pendingapproval_audit=function(){l.url("app/AtmTrnMyAuditApproverSummary")},e.approved_audit=function(){l.url("app/AtmTrnMyApprovedAuditSummary")},e.rejected_audit=function(){l.url("app/AtmTrnMyRejectedAuditSummary")},e.pendingaudit=function(){var t="api/AtmTrnAuditCreation/GetAuditCreation";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.closedaudit=function(){var t="api/AtmTrnAuditCreation/GetMyClosedAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.openaudit=function(){var t="api/AtmTrnAuditCreation/GetMyOpenAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.auditsonhold=function(){var t="api/AtmTrnAuditCreation/GetMyOnholdAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.approverview=function(t,e,a){l.url("app/AtmTrnMyAuditApprover360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=Myapprovedaudits"))}}angular.module("angle").controller("AtmTrnMyApprovedAuditSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g){function _(){e.lspage=h.lspage;var t=e.lspage;"Mypendingapproval"==t?(e.pendingapproval_show=!0,e.approvedaudit_show=!1,e.impoerexcel_show=!0,e.pendingdelete_show=!0):"Myapprovedaudits"==t&&(e.pendingapproval_show=!1,e.approvedaudit_show=!0,e.impoerexcel_show=!1,e.pendingdelete_show=!1);var a="api/AtmTrnAuditCreation/EditAuditCreation",i={auditcreation_gid:v};lockUI(),s.getparams(a,i).then(function(a){e.cboauditdepartment=a.data.auditdepartment_gid,e.cboauditdepartment=a.data.auditdepartment_name,e.cboauditname=a.data.checklistmaster_gid,e.cboauditname=a.data.audit_name,e.cboauditmaker=a.data.employee_gid,e.cboauditmaker=a.data.audit_maker,e.cboauditchecker=a.data.auditmapping_gid,e.cboauditchecker=a.data.audit_checker,e.cboauditapprover=a.data.employee_gid,e.cboauditapprover=a.data.audit_approver,e.cboauditpriority=a.data.auditpriority_gid,e.cboauditpriority=a.data.auditpriority_name,e.txtdue_date=a.data.end_date,e.txtreport_date=a.data.report_date,e.txtperiod_from=a.data.periodfrom_date,e.txtperiod_to=a.data.auditperiod_to,e.txtaudit_ref_no=a.data.audit_uniqueno,e.cboauditeemaker=a.data.auditeemaker_name,e.cboauditeechecker=a.data.auditeechecker_name,e.created_by=a.data.created_by,e.created_date=a.data.created_date,e.txtentity_name=a.data.entity_name,e.txtaudit_type=a.data.audittype_name,e.txtcheckpoint_group=a.data.checkpointgroup_name,e.txtaudit_desc=a.data.audit_description,e.auditobservation_name=a.data.auditobservation_name,e.openquerycount=a.data.openquerycount,"Mypendingapproval"==t&&"0"==e.openquerycount?e.approve=!0:e.approve=!1,unlockUI()});var a="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),s.getparams(a,i).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var a="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(a,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),k();var i={auditcreation_gid:v,sampleimport_gid:y};if("Myapprovedaudits"==t){var i={auditcreation_gid:v},a="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),s.getparams(a,i).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list})}else{var i={checklistmaster_gid:A,auditcreation_gid:v},a="api/AtmTrnAuditCreation/Checkpointcreation";lockUI(),s.getparams(a,i).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list,angular.forEach(e.checkpointsummary_list,function(t,e){"0"!=t.checklist_flag?(t.Checked=!0,t.checklist_flag="Y"):(t.Checked=!1,t.checklist_flag="N")})})}}function k(){var t={auditcreation_gid:v},a="api/AtmTrnSampling/GetSampleDynamicdata";s.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].sampleimport_gid,delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].sampleimport_gid,delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}var f=this;f.title="AtmTrnMyAuditApprover360ViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.lspage=h.lspage;var b=e.lspage;_(),e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,a){function i(t,e){var i={sampleimport_gid:o},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,i).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var n="api/SystemMaster/GetEmployeelist";s.get(n).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var i="",n="";t.cboqueryto&&(i=t.cboqueryto.employee_gid,n=t.cboqueryto.employee_name);var r={sampleimport_gid:o,description:t.txtquery_desc,auditcreation_gid:a,query_title:t.txtquery_title,query_to:i,query_toname:n},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),_()}),e.close("closed")}}var o="",n=e.SampleDynamicTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid);m.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.assignrejectedchecklist=function(){function t(t,i){t.ok=function(){e.close("closed")},t.rejectSubmit=function(){var i={auditcreation_gid:v,rejected_remarks:t.txtreject_remarks},o="api/AtmTrnAuditCreation/InitiateAuditRejected";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),a.go("app.AtmTrnMyAuditApproverSummary")):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),e.close("closed"))}),a.go("app.AtmTrnMyAuditApproverSummary")}}var e=m.open({templateUrl:"/rejectapproval.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),s.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.Checked=t})},e.assignchecklist=function(){if("0"!=e.openquerycount)l.alert("Approval can't be done, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.Checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!","warning"),unlockUI(),!1;var i={auditcreationapproval:e.checkpointsummary_list,checklistmaster_gid:A,auditcreation_gid:v};lockUI();var o="api/AtmTrnAuditCreation/PostAuditApprovalChecklistAssign";s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnMyAuditApproverSummary")):l.alert(t.data.message,{status:"error",pos:"top-center",timeout:3e3})})}},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){a.close("closed"),1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}m.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,a){function i(e,i){e.lblcheckpoint_description=a;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){i.close("closed")}}m.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor});var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"lg"});a.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function a(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/showemployee.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,a,i){function o(t,e){var i={sampleimport_gid:n},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,i).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,i).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var i={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:n,auditcreation_gid:a,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="";if("Y"==i){var r=e.SampleraisedqueryTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid)}else{var r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid)}m.open({templateUrl:"/taguser.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function a(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAudit360View?hash="+g.encryptURL("auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3)),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}m.open({templateUrl:"/raisequery.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.back=function(t){"Mypendingapproval"==b?a.go("app.AtmTrnMyAuditApproverSummary"):"Myapprovedaudits"==b&&a.go("app.AtmTrnMyApprovedAuditSummary")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+b))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditApprover360ViewController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetAuditCreationApprover";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var t="api/AtmTrnAuditCreation/GetApprovedAuditCounts";c.get(t).then(function(t){unlockUI(),e.pendingapprovalaudit_count=t.data.pendingapproval_count,e.approvedaudit_count=t.data.approved_count,e.rejectedaudit_count=t.data.rejected_count})}var _=this;_.title="AtmTrnMyAuditApproverSummaryController",g(),e.pendingapproval_audit=function(){l.url("app/AtmTrnMyAuditApproverSummary")},e.approved_audit=function(){l.url("app/AtmTrnMyApprovedAuditSummary")},e.rejected_audit=function(){l.url("app/AtmTrnMyRejectedAuditSummary")},e.pendingaudit=function(){var t="api/AtmTrnAuditCreation/GetAuditCreation";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.closedaudit=function(){var t="api/AtmTrnAuditCreation/GetMyClosedAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.openaudit=function(){var t="api/AtmTrnAuditCreation/GetMyOpenAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.auditsonhold=function(){var t="api/AtmTrnAuditCreation/GetMyOnholdAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.approverview=function(t,e,a){l.url("app/AtmTrnMyAuditApprover360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&lspage=Mypendingapproval"))}}angular.module("angle").controller("AtmTrnMyAuditApproverSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetCheckerOpenAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCheckerCounts";s.get(t).then(function(t){unlockUI(),e.auditscheckeronhold_count=t.data.auditscheckeronhold_count,e.closedcheckeraudit_count=t.data.closedcheckeraudit_count,e.opencheckeraudit_count=t.data.opencheckeraudit_count,e.taggedsample_count=t.data.taggedsample_count,e.pendingapproval_count=t.data.pendingapproval_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnMyAuditeeCheckerSummaryController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnCheckerPendingApproval")},e.open_audit=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.pending_approval=function(){d.url("app/AtmTrnCheckerPendingApproval")},e.hold_audit=function(){d.url("app/AtmTrnCheckerHoldAuditee")},e.closed_audit=function(){d.url("app/AtmTrnCheckerClosedAuditee")},e.tagged_items=function(){d.url("app/AtmTrnCheckerTaggedAuditee")},e.completed_audit=function(){d.url("app/AtmTrnCheckerCompletedAuditee")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditeeTaskCheckerAuditeeView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeecheckeropensummary"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"];
}}angular.module("angle").controller("AtmTrnMyAuditeeCheckerSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:b};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.txttotal_score=t.data.observation_score,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.auditeechecker_approvalflag=t.data.auditeechecker_approvalflag,e.openquerycount=t.data.openquerycount,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,e.raisequeryoption_disabled=!1,"auditeemakeropen"==S||"auditeemakerhold"==S||"auditeemakerclosed"==S||"auditeemakertagged"==S||"auditeemakercompleted"==S?e.raisequeryoption_disabled=!0:e.raisequeryoption_disabled=!1,unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetMultipleAuditeecheckerApproval";lockUI(),l.getparams(t,a).then(function(t){e.auditee_flag=t.data.auditee_flag,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnMyAuditTaskAuditee/AuditeeCheckerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,e){t.capture_score==t.yes_score?t.yes_radio=!0:t.capture_score==t.no_score?t.no_radio=!0:t.capture_score==t.partial_score?t.partialscore_radio=!0:t.capture_score==t.na_score&&(t.nascore_radio=!0)})});var t="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=S&&"auditeemakerhold"!=S&&"auditeemakerclosed"!=S&&"auditeemakertagged"!=S&&"auditeemakercompleted"!=S&&"auditeecheckeropen"!=S&&"auditeecheckerpending"!=S&&"auditeecheckerhold"!=S&&"auditeecheckerclosed"!=S&&"auditeecheckertagged"!=S&&"auditeecheckercompleted"!=S||(e.close_disabled=!0)}),h();var a={auditcreation_gid:b,sampleimport_gid:I}}function h(){var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}function v(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var A=this;A.title="AtmTrnMyAuditeeTaskCheckerAuditeeViewController";var y=k.decryptURL(p.search().hash);e.auditcreation_gid=y.auditcreation_gid;var b=e.auditcreation_gid;e.checklistmaster_gid=y.checklistmaster_gid;var U=e.checklistmaster_gid;e.checklistmasteradd_gid=y.checklistmasteradd_gid,e.sampleimport_gid=y.sampleimport_gid;var I=e.sampleimport_gid;e.lspage=y.lspage;var S=e.lspage;f(),e.stripAddr=function(t){return t.replace("_"," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),f(),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:U},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.getapprovalclick=function(t){var a={auditeechecker:"Y",auditcreation_gid:t,getapproval_remark:e.getapproval_remark,observation_percentage:e.txt_percent};lockUI();var i="api/AtmTrnAuditorMaker/PostAuditeeGetApproval";l.post(i,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnCheckerPendingApproval")):(modalInstance.close("closed"),d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+k.encryptURL("auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o+"&lspage="+S))},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),v(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:b},n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:b,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=b,e.auditraisequery_gid=t;var n={auditcreation_gid:b,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"Default");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==S?i="Auditor Maker":"auditorapproveropen"==S?i="Auditor Approver":"auditorcheckerOpen"==S?i="Auditor Checker":"auditeemakeropen"==S?i="Auditee Maker":"auditeecheckeropen"==S?i="Auditee Checker":"auditeemakertagged"==S&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.samplecheckerobservationscoreview=function(t,e,a,i){p.url("app/AtmTrnAuditeeCheckerOpenObservationView?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.Back=function(t){"auditeemakeropen"==S&&p.url("app/AtmTrnMyAuditTaskAuditeeSummary"),"auditeecheckeropensummary"==S?p.url("app/AtmTrnMyAuditeeCheckerSummary"):"auditeemakerhold"==S?p.url("app/AtmTrnHoldAuditeeSummary"):"auditeemakerclosed"==S?p.url("app/AtmTrnClosedAuditeeSummary"):"auditeemakertagged"==S?p.url("app/AtmTrnTaggedAuditeeSummary"):"auditeemakercompleted"==S?p.url("app/AtmTrnCompletedAuditeeSummary"):"auditeecheckeropen"==S?p.url("app/AtmTrnMyAuditeeCheckerSummary"):"auditeecheckerpending"==S?p.url("app/AtmTrnCheckerPendingApproval"):"auditeecheckerhold"==S?p.url("app/AtmTrnCheckerHoldAuditee"):"auditeecheckerclosed"==S?p.url("app/AtmTrnCheckerClosedAuditee"):"auditeecheckertagged"==S?p.url("app/AtmTrnCheckerTaggedAuditee"):"auditeecheckercompleted"==S&&p.url("app/AtmTrnCheckerCompletedAuditee")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditeeTaskCheckerAuditeeViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g){function _(){e.lspage=h.lspage;var t=e.lspage;"Mypendingapproval"==t?(e.pendingapproval_show=!0,e.approvedaudit_show=!1,e.impoerexcel_show=!0,e.pendingdelete_show=!0):"Myapprovedaudits"==t&&(e.pendingapproval_show=!1,e.approvedaudit_show=!0,e.impoerexcel_show=!1,e.pendingdelete_show=!1);var a="api/AtmTrnAuditCreation/EditAuditCreation",i={auditcreation_gid:v};lockUI(),s.getparams(a,i).then(function(a){e.cboauditdepartment=a.data.auditdepartment_gid,e.cboauditdepartment=a.data.auditdepartment_name,e.cboauditname=a.data.checklistmaster_gid,e.cboauditname=a.data.audit_name,e.cboauditmaker=a.data.employee_gid,e.cboauditmaker=a.data.audit_maker,e.cboauditchecker=a.data.auditmapping_gid,e.cboauditchecker=a.data.audit_checker,e.cboauditapprover=a.data.employee_gid,e.cboauditapprover=a.data.audit_approver,e.cboauditpriority=a.data.auditpriority_gid,e.cboauditpriority=a.data.auditpriority_name,e.txtdue_date=a.data.end_date,e.txtreport_date=a.data.report_date,e.txtperiod_from=a.data.periodfrom_date,e.txtperiod_to=a.data.auditperiod_to,e.txtaudit_ref_no=a.data.audit_uniqueno,e.cboauditeemaker=a.data.auditeemaker_name,e.cboauditeechecker=a.data.auditeechecker_name,e.created_by=a.data.created_by,e.created_date=a.data.created_date,e.txtentity_name=a.data.entity_name,e.txtaudit_type=a.data.audittype_name,e.txtcheckpoint_group=a.data.checkpointgroup_name,e.txtaudit_desc=a.data.audit_description,e.auditobservation_name=a.data.auditobservation_name,e.openquerycount=a.data.openquerycount,"Mypendingapproval"==t&&"0"==e.openquerycount?e.approve=!0:e.approve=!1,unlockUI()});var a="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),s.getparams(a,i).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var a="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(a,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),k();var i={auditcreation_gid:v,sampleimport_gid:A},a="api/AtmTrnSampling/GetAssignedQuerySummary";s.getparams(a,i).then(function(t){e.SampleAssignedQueryList=t.data.SampleAssignedQueryList,unlockUI()});var a="api/AtmTrnSampling/GetSamplesummary";if(s.getparams(a,i).then(function(t){unlockUI(),e.sample_list=t.data.sample_list}),"Myapprovedaudits"==t){var i={auditcreation_gid:v},a="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),s.getparams(a,i).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list})}else{var i={checklistmaster_gid:y,auditcreation_gid:v},a="api/AtmTrnAuditCreation/CheckpointCreation";lockUI(),s.getparams(a,i).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list,angular.forEach(e.checkpointsummary_list,function(t,e){"0"!=t.checklist_flag?(t.Checked=!0,t.checklist_flag="Y"):(t.Checked=!1,t.checklist_flag="N")})})}}function k(){var t={auditcreation_gid:v},a="api/AtmTrnSampling/GetSampleDynamicdata";s.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].sampleimport_gid,delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].sampleimport_gid,delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}var f=this;f.title="AtmTrnMyAuditRejected360ViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.sampleimport_gid=h.sampleimport_gid;var A=e.sampleimport_gid;e.checklistmaster_gid=h.checklistmaster_gid;var y=e.checklistmaster_gid;e.lspage=h.lspage;var b=e.lspage;_(),e.checksampleall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.stripAddr=function(t){return t.replace(/_/g," ")},e.dynamicsample=function(t,a){function i(t,e){var i={sampleimport_gid:o},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,i).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var n="api/SystemMaster/GetEmployeelist";s.get(n).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var i="",n="";t.cboqueryto&&(i=t.cboqueryto.employee_gid,n=t.cboqueryto.employee_name);var r={sampleimport_gid:o,description:t.txtquery_desc,auditcreation_gid:a,query_title:t.txtquery_title,query_to:i,query_toname:n},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),_()}),e.close("closed")}}var o="",n=e.SampleDynamicTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid);m.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.assignrejectedchecklist=function(){function t(t,i){t.ok=function(){e.close("closed")},t.rejectSubmit=function(){var i={auditcreation_gid:v,rejected_remarks:t.txtreject_remarks},o="api/AtmTrnAuditCreation/InitiateAuditRejected";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),a.go("app.AtmTrnMyAuditApproverSummary")):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),e.close("closed"))}),a.go("app.AtmTrnMyAuditApproverSummary")}}var e=m.open({templateUrl:"/rejectapproval.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),s.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.Checked=t})},e.assignchecklist=function(){if("0"!=e.openquerycount)l.alert("Approval can't be done, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.Checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!","warning"),unlockUI(),!1;var i={auditcreationapproval:e.checkpointsummary_list,checklistmaster_gid:y,auditcreation_gid:v};lockUI();var o="api/AtmTrnAuditCreation/PostAuditApprovalChecklistAssign";s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.AtmTrnMyAuditApproverSummary")):l.alert(t.data.message,{status:"error",pos:"top-center",timeout:3e3})})}},e.importexcel=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){a.close("closed"),1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}m.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e,a){function i(e,i){e.lblcheckpoint_description=a;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){i.close("closed")}}m.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function a(e,a){angular.module("angle");var i={checklistmasteradd_gid:t
};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/checkpointdescription.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function a(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor});var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/notetoauditor.html",controller:a,backdrop:"static",keyboard:!1,size:"lg"});a.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function a(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/showemployee.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,a,i){function o(t,e){var i={sampleimport_gid:n},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,i).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,i).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var i={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:n,auditcreation_gid:a,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="";if("Y"==i){var r=e.SampleraisedqueryTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid)}else{var r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid)}m.open({templateUrl:"/taguser.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function a(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAudit360View?hash="+g.encryptURL("auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3)),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}m.open({templateUrl:"/raisequery.html",controller:a,backdrop:"static",keyboard:!1,size:"md"});a.$inject=["$scope","$modalInstance"]},e.back=function(t){a.go("app.AtmTrnMyRejectedAuditSummary")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+b))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}m.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditRejected360ViewController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:f};lockUI(),s.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,unlockUI()});var t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservationview_list=t.data.makercheckpointobservationview_list}),_();var a={auditcreation_gid:f,sampleimport_gid:h},t="api/AtmTrnSampling/GetAssignedQuerySummary";s.getparams(t,a).then(function(t){e.SampleAssignedQueryList=t.data.SampleAssignedQueryList,unlockUI()});var t="api/AtmTrnSampling/GetSamplesummary";s.getparams(t,a).then(function(t){unlockUI(),f=t.data.auditcreation_gid,e.sample_list=t.data.sample_list})}function _(){var t={auditcreation_gid:f},a="api/AtmTrnSampling/GetSampleDynamicdata";s.getparams(a,t).then(function(t){1==t.data.status&&(e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata))})}var k=this;k.title="AtmTrnMyAuditTaskAuditeeCheckerViewController",e.auditcreation_gid=d.search().auditcreation_gid;var f=d.search().auditcreation_gid;e.checklistmaster_gid=d.search().checklistmaster_gid;e.checklistmaster_gid;e.checklistmasteradd_gid=d.search().checklistmasteradd_gid;var h=d.search().sampleimport_gid;e.sampleimport_gid=d.search().sampleimport_gid,g(),e.stripAddr=function(t){return t.replace("_"," ")},e.dynamicsample=function(t){var a=e.SampleDynamicdata[t];if(a&&a.sampleimport_gid){a.sampleimport_gid}},e.view=function(t){d.url("app/AtmTrnSamplingView?sampleimport_gid="+t)},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.btnconfirm=function(){var t={employelist:a.cboemployee_name,sample_name:a.txtsample_name,sampleimport_gid:a.sampleimport_gid,auditcreation_gid:e},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAudit360View?auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/taguser.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAudit360View?auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.dynamicsample=function(t,e,i){function o(t,a){var o={sampleimport_gid:e},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o={auditcreation_gid:i,sampleimport_gid:e},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.auditcreation_gid=e.data.auditcreation_gid}),t.ok=function(){a.close("closed")},t.submit=function(){var o={sampleimport_gid:e,description:t.txtdescription,auditcreation_gid:i},n="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAudit360View?auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3),a.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o)},e.back=function(t){i.go("app.AtmTrnAuditeeCheckerSummary")}}angular.module("angle").controller("AtmTrnMyAuditTaskAuditeeCheckerViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnMyAuditTaskAuditee/AuditeeSampleMakerView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnMyAuditTaskAuditeeMakerObservationScoreViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=e.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=h.lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified?t.tag_verifiedradio=!0:"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&sampleimport_gid=null&lspage=auditeemakeropen"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditTaskAuditeeMakerObservationScoreViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:b};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.txttotal_score=t.data.observation_score,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.auditeechecker_approvalflag=t.data.auditeechecker_approvalflag,e.openquerycount=t.data.openquerycount,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,e.raisequeryoption_disabled=!1,"auditeemakeropen"==S||"auditeemakerhold"==S||"auditeemakerclosed"==S||"auditeemakertagged"==S||"auditeemakercompleted"==S?e.raisequeryoption_disabled=!0:e.raisequeryoption_disabled=!1,unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnMyAuditTaskAuditee/AuditeeMakerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,e){t.capture_score==t.yes_score?t.yes_radio=!0:t.capture_score==t.no_score?t.no_radio=!0:t.capture_score==t.partial_score?t.partialscore_radio=!0:t.capture_score==t.na_score&&(t.nascore_radio=!0);
})});var t="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=S&&"auditeemakerhold"!=S&&"auditeemakerclosed"!=S&&"auditeemakertagged"!=S&&"auditeemakercompleted"!=S&&"auditeecheckeropen"!=S&&"auditeecheckerpending"!=S&&"auditeecheckerhold"!=S&&"auditeecheckerclosed"!=S&&"auditeecheckertagged"!=S&&"auditeecheckercompleted"!=S||(e.close_disabled=!0)}),h();var a={auditcreation_gid:b,sampleimport_gid:I}}function h(){var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}function v(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var A=this;A.title="AtmTrnMyAuditTaskAuditeeMakerViewController";var y=k.decryptURL(p.search().hash);e.auditcreation_gid=y.auditcreation_gid;var b=e.auditcreation_gid;e.checklistmaster_gid=y.checklistmaster_gid;var U=e.checklistmaster_gid;e.checklistmasteradd_gid=y.checklistmasteradd_gid;e.checklistmasteradd_gid;e.sampleimport_gid=y.sampleimport_gid;var I=e.sampleimport_gid;e.lspage=y.lspage;var S=e.lspage;f(),e.stripAddr=function(t){return t.replace("_"," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),f(),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:U},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.getapprovalclick=function(t){if("0"!=e.openquerycount)d.alert("Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{var a={auditeechecker:"Y",auditcreation_gid:t,getapproval_remark:e.getapproval_remark,observation_percentage:e.txt_percent};lockUI();var i="api/AtmTrnAuditorMaker/PostAuditeeGetApproval";l.post(i,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnCheckerPendingApproval")):(modalInstance.close("closed"),d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+k.encryptURL("auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o+"&lspage="+S))},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):(d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),v(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:b},r="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(r,n).then(function(t){e.approval_status=t.data.approval_status,unlockUI()});var n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:b,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=b,e.auditraisequery_gid=t;var n={auditcreation_gid:b,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"Default");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==S?i="Auditor Maker":"auditorapproveropen"==S?i="Auditor Approver":"auditorcheckerOpen"==S?i="Auditor Checker":"auditeemakeropen"==S?i="Auditee Maker":"auditeecheckeropen"==S?i="Auditee Checker":"auditeemakertagged"==S&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.samplecheckerobservationscoreview=function(t,e,a,i){p.url("app/AtmTrnMyAuditTaskAuditeeMakerObservationScoreView?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.Back=function(t){"auditeemakeropen"==S?p.url("app/AtmTrnMyAuditTaskAuditeeSummary"):"auditeemakerhold"==S?p.url("app/AtmTrnHoldAuditeeSummary"):"auditeemakerclosed"==S?p.url("app/AtmTrnClosedAuditeeSummary"):"auditeemakertagged"==S?p.url("app/AtmTrnTaggedAuditeeSummary"):"auditeemakercompleted"==S?p.url("app/AtmTrnCompletedAuditeeSummary"):"auditeecheckeropen"==S?p.url("app/AtmTrnMyAuditeeCheckerSummary"):"auditeecheckerpending"==S?p.url("app/AtmTrnCheckerPendingApproval"):"auditeecheckerhold"==S?p.url("app/AtmTrnCheckerHoldAuditee"):"auditeecheckerclosed"==S?p.url("app/AtmTrnCheckerClosedAuditee"):"auditeecheckertagged"==S?p.url("app/AtmTrnCheckerTaggedAuditee"):"auditeecheckercompleted"==S&&p.url("app/AtmTrnCheckerCompletedAuditee")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditTaskAuditeeMakerViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetOpenAuditee";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.taggedsample_count=t.data.taggedsample_count,e.completed_count=t.data.completedaudit_count})}var f=this;f.title="AtmTrnMyAuditTaskAuditeeSummaryController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.hold_audit=function(){d.url("app/AtmTrnHoldAuditeeSummary")},e.closed_audit=function(){d.url("app/AtmTrnClosedAuditeeSummary")},e.tagged_items=function(){d.url("app/AtmTrnTaggedAuditeeSummary")},e.completed_audit=function(){d.url("app/AtmTrnCompletedAuditeeSummary")},e.viewtask=function(t,e){d.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&lspage=auditeemakeropen"))},e.auditeecheckerapproval=function(t){d.url("app/AtmTrnAuditeeCheckerApproval?hash="+_.encryptURL("auditcreation_gid="+t))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditTaskAuditeeSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:b};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txttotal_score=t.data.observation_score,e.auditeechecker_approvalflag=t.data.auditeechecker_approvalflag,e.openquerycount=t.data.openquerycount,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,e.raisequeryoption_disabled=!1,"auditeemakeropen"==S||"auditeemakerhold"==S||"auditeemakerclosed"==S||"auditeemakertagged"==S||"auditeemakercompleted"==S?e.raisequeryoption_disabled=!0:e.raisequeryoption_disabled=!1,unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetMultipleAuditeecheckerApproval";lockUI(),l.getparams(t,a).then(function(t){e.auditee_flag=t.data.auditee_flag,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var a={auditcreation_gid:b},t="api/AtmTrnMyAuditTaskAuditee/AuditeeCheckerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,e){t.capture_score==t.yes_score?t.yes_radio=!0:t.capture_score==t.no_score?t.no_radio=!0:t.capture_score==t.partial_score?t.partialscore_radio=!0:t.capture_score==t.na_score&&(t.nascore_radio=!0)})});var t="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata,e.close_disabled=!1,"auditeemakeropen"!=S&&"auditeemakerhold"!=S&&"auditeemakerclosed"!=S&&"auditeemakertagged"!=S&&"auditeemakercompleted"!=S&&"auditeecheckeropen"!=S&&"auditeecheckerpending"!=S&&"auditeecheckerhold"!=S&&"auditeecheckerclosed"!=S&&"auditeecheckertagged"!=S&&"auditeecheckercompleted"!=S||(e.close_disabled=!0)}),h()}function h(){var t={auditcreation_gid:b},a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag,delete e.SampleDynamicTabledata[i].tagged_employee;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1})}function v(t){var a={auditcreation_gid:t},i="api/AtmTrnAuditorMaker/AuditRaisedQuerySummary";lockUI(),l.getparams(i,a).then(function(t){unlockUI(),e.auditquerydata=t.data.auditquerydata})}var A=this;A.title="AtmTrnMyAuditTaskAuditeeViewController";var y=k.decryptURL(p.search().hash);e.auditcreation_gid=y.auditcreation_gid;var b=e.auditcreation_gid;e.checklistmaster_gid=y.checklistmaster_gid;var U=e.checklistmaster_gid;e.checklistmasteradd_gid=y.checklistmasteradd_gid,e.sampleimport_gid=y.sampleimport_gid;var I=e.sampleimport_gid;e.lspage=y.lspage;var S=e.lspage;f(),e.stripAddr=function(t){return t.replace("_"," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),f(),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:U},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){
function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.getapprovalclick=function(t){var a={auditeechecker:"Y",auditcreation_gid:t,getapproval_remark:e.getapproval_remark,observation_percentage:e.txt_percent};lockUI();var i="api/AtmTrnAuditorMaker/PostAuditeeGetApproval";l.post(i,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.go("app.AtmTrnCheckerPendingApproval")):(modalInstance.close("closed"),d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),h()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+k.encryptURL("auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o+"&lspage="+S))},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail?t.tag_radio=!0:"Partial"==t.overall_detail?t.partial_radio=!0:"NA"==t.overall_detail&&(t.na_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.auditraisequery=function(t){function e(e,a){e.ok=function(){a.close("closed")};e.submit=function(){var i={auditcreation_gid:t,query_title:e.txtquery_title,query_description:e.txtquery_description},o="api/AtmTrnAuditorMaker/PostAuditRaiseQuery";lockUI(),l.post(o,i).then(function(e){unlockUI(),1==e.data.status?(d.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),v(t)):d.alert(e.data.message,{status:"info",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/auditraisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,a,o){e.hide=0;var n={auditcreation_gid:b},r="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),l.getparams(r,n).then(function(t){e.approval_status=t.data.approval_status,unlockUI()});var n={auditraisequery_gid:t},r="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(r,n).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,unlockUI()}),e.replytoquery=function(){var a={auditcreation_gid:b,remarks:e.txtqueries,auditraisequery_gid:t,replied_by:i};lockUI();var o="api/AtmTrnAuditorMaker/PostAuditQuerydetail";l.post(o,a).then(function(a){if(unlockUI(),1==a.data.status){var i={auditraisequery_gid:t},o="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(o,i).then(function(t){unlockUI(),e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else d.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=b,e.auditraisequery_gid=t;var n={auditcreation_gid:b,auditraisequery_gid:t};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"");if(0==o)return d.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.auditraisequery_gid),r={name:t[0].name,file:t[0]},c=new FormData;c.append("fileupload",r.file),c.append("file_name",r.name),c.append("document_name",e.documentname),c.append("document_title",e.txtdocument_title),c.append("auditcreation_gid",e.auditcreation_gid),c.append("auditraisequery_gid",e.auditraisequery_gid),c.append("project_flag","Default"),e.uploadfrm=c;var s="api/AtmTrnAuditorMaker/AuditResponseDocUpload";lockUI(),l.postFile(s,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),d.alert("Document Uploaded Successfully..!!","success");var a={auditraisequery_gid:n},i="api/AtmTrnAuditorMaker/GetAuditQuerydetaillist";l.getparams(i,a).then(function(t){e.auditQuerydetaillist=t.data.auditQuerydetaillist,1==t.data.status?d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),d.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){a.close("closed")}}var i="";"auditormakerOpen"==S?i="Auditor Maker":"auditorapproveropen"==S?i="Auditor Approver":"auditorcheckerOpen"==S?i="Auditor Checker":"auditeemakeropen"==S?i="Auditee Maker":"auditeecheckeropen"==S?i="Auditee Checker":"auditeemakertagged"==S&&(i="Tagged User");a.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={auditraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnAuditorMaker/PostAuditCloseQuery";lockUI(),l.post(o,i).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}a.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.samplecheckerobservationscoreview=function(t,e,a,i){p.url("app/AtmTrnAuditeeCheckerObservationView?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.fillobservation=function(){p.url("app/AtmTrnRaiseQueryHistory?hash="+k.encryptURL("auditcreation_gid="+b+"&sampleimport_gid="+I))},e.Back=function(t){"auditeemakeropen"==S?p.url("app/AtmTrnMyAuditTaskAuditeeSummary"):"auditeemakerhold"==S?p.url("app/AtmTrnHoldAuditeeSummary"):"auditeemakerclosed"==S?p.url("app/AtmTrnClosedAuditeeSummary"):"auditeemakertagged"==S?p.url("app/AtmTrnTaggedAuditeeSummary"):"auditeemakercompleted"==S?p.url("app/AtmTrnCompletedAuditeeSummary"):"auditeecheckeropen"==S?p.url("app/AtmTrnMyAuditeeCheckerSummary"):"auditeecheckerpending"==S?p.url("app/AtmTrnCheckerPendingApproval"):"auditeecheckerhold"==S?p.url("app/AtmTrnCheckerHoldAuditee"):"auditeecheckerclosed"==S?p.url("app/AtmTrnCheckerClosedAuditee"):"auditeecheckertagged"==S?p.url("app/AtmTrnCheckerTaggedAuditee"):"auditeecheckercompleted"==S&&p.url("app/AtmTrnCheckerCompletedAuditee")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditTaskAuditeeViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnMyAuditTask/EditMyAuditTask",a={auditcreation_gid:k};lockUI(),s.getparams(t,a).then(function(t){e.cboauditfrequency=t.data.auditfrequency_gid,e.cboauditfrequency=t.data.auditfrequency_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.due_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditmaker_name=t.data.auditmaker_name,e.cboauditchecker_name=t.data.auditchecker_name,unlockUI()});var t="api/AtmTrnMyAuditTask/MyAuditTaskView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.myaudittask_list=t.data.checkpointobservationview_list,e.txttotal_score=t.data.total_score});var t="api/AtmTrnSampling/GetSample";s.getparams(t,a).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnMyAuditTaskController";var k=d.search().auditcreation_gid;e.sampleimport_gid=d.search().sampleimport_gid;var f=e.sampleimport_gid;g(),e.back=function(t){i.go("app.AtmTrnMyAuditTaskSummary")},e.view=function(t,e){d.url("app/AtmTrnAuditTaskSample?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.samplequery=function(t,e){d.url("app/AtmTrnSampleQuery?auditcreation_gid="+t+"&sampleimport_gid="+e)},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.checkpointintent=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTask/GetAuditCreationIntent";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTask/GetAuditCreationDescription";s.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e){function i(e,a){var i={auditcreation_gid:t};lockUI();var o="api/AtmTrnMyAuditTask/GetAuditCreationAuditor";s.getparams(o,i).then(function(t){unlockUI(),e.txtnotetoauditor=t.data.noteto_auditor}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.raisequery=function(){function t(t,e){t.ok=function(){e.close("closed")},t.submit=function(){var a={auditcreation_gid:k,sampleimport_gid:f,remarks:t.txtqueries},i="api/AtmTrnMyAuditTaskAuditee/PostRaiseQuerysample";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:t,backdrop:"static",keyboard:!1,size:"md"});t.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditTaskController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnMyAuditTask/GetMyAuditTask";lockUI(),s.get(t).then(function(t){e.myaudittask_list=t.data.myaudittask_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnMyAuditTask/GetMyAuditTaskCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count})}var k=this;k.title="AtmTrnMyAuditTaskSummaryController",_(),e.assignedaudit=function(){var t="api/AtmTrnMyAuditTask/GetMyAuditTask";lockUI(),s.get(t).then(function(t){e.myaudittask_list=t.data.myaudittask_list,e.employee_gid=t.data.employee_gid,unlockUI()})},e.closedaudit=function(){var t="api/AtmTrnMyAuditTask/GetMyClosedAuditTask";lockUI(),s.get(t).then(function(t){e.myaudittask_list=t.data.myaudittask_list,e.employee_gid=t.data.employee_gid,unlockUI()})},e.openaudit=function(){var t="api/AtmTrnMyAuditTask/GetMyOpenAuditTask";lockUI(),s.get(t).then(function(t){e.myaudittask_list=t.data.myaudittask_list,e.employee_gid=t.data.employee_gid,unlockUI()})},e.auditsonhold=function(){var t="api/AtmTrnMyAuditTask/GetMyOnholdAuditTask";lockUI(),s.get(t).then(function(t){e.myaudittask_list=t.data.myaudittask_list,e.employee_gid=t.data.employee_gid,unlockUI()})},e.updateobservations=function(t){d.url("app/AtmTrnCheckpointObservation?auditcreation_gid="+t)},e.auditraisequery=function(t){d.url("app/AtmTrnAuditRaiseQuery?auditcreation_gid="+t)},e.viewtask=function(t){d.url("app/AtmTrnMyAuditTask?auditcreation_gid="+t)},e.approval=function(t){d.url("app/AtmTrnApproval?auditcreation_gid="+t)},e.assignedquery=function(t){d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.auditapproval=function(t){d.url("app/AtmTrnAuditApproval?auditcreation_gid="+t)},e.statusupdate=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTask/EditMyAuditTask";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid,e.txtaudit_name=t.data.audit_name,e.txtstatus_update=t.data.status_update}),e.ok=function(){a.close("closed")},e.submit=function(){var i={auditcreation_gid:t,status_update:e.status_update},o="api/AtmTrnMyAuditTask/GetMyAuditTaskStatus";lockUI(),s.post(o,i).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/statusupdate.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.getApprovalRequest=function(t){function e(e,a){var n="api/AtmMstAuditMapping/GetAuditMappingChecker";lockUI(),s.get(n).then(function(t){unlockUI(),e.auditmapping_list=t.data.auditmappingchecker_list});var n="api/AtmTrnMyAuditTask/TmpAllMembersDelete";s.get(n).then(function(t){}),e.ok=function(){o.close("closed")},e.ApprovalMembercancel=function(a){var i={tmpapprovalmember_gid:a,auditcreation_gid:t},o="api/AtmTrnMyAuditTask/TmpApprovalMembersDelete";s.post(o,i).then(function(t){e.approvalmember=t.data.approvalmember})},e.Changed=function(a){var o={approvalgid:e.cboapproval_membername.auditmapping_gid,approvalname:e.cboapproval_membername.employee_name,auditcreation_gid:t};lockUI();var n="api/AtmTrnMyAuditTask/TempApprovalMember";s.post(n,o).then(function(a){if(1==a.data.status){l.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),e.current=i.current.name,r.store("dataldCtrl",e),e.cboapproval_membername="";var o={auditcreation_gid:t},n="api/AtmTrnMyAuditTask/TmpApprovalMembersView";s.getparams(n,o).then(function(t){e.approvalmember=t.data.approvalmember})}else l.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},e.getapprovalclick=function(){var a={approve_remarks:e.approve_remarks,approve_type:e.approve_type,auditcreation_gid:t};lockUI();var i="api/AtmTrnMyAuditTask/PostApprovalGet";s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(o.close("closed"),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),_()):(alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var o=a.open({templateUrl:"/getApprovalRequest.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTask/EditMyAuditTask";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTask/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnMyAuditTaskSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t="api/AtmTrnAuditCreation/GetAuditCreationRejected";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var t="api/AtmTrnAuditCreation/GetApprovedAuditCounts";c.get(t).then(function(t){unlockUI(),e.pendingapprovalaudit_count=t.data.pendingapproval_count,e.approvedaudit_count=t.data.approved_count,e.rejectedaudit_count=t.data.rejected_count})}var _=this;_.title="AtmTrnMyRejectedAuditSummaryController",g(),e.pendingapproval_audit=function(){l.url("app/AtmTrnMyAuditApproverSummary")},e.approved_audit=function(){l.url("app/AtmTrnMyApprovedAuditSummary")},e.rejected_audit=function(){l.url("app/AtmTrnMyRejectedAuditSummary")},e.pendingaudit=function(){var t="api/AtmTrnAuditCreation/GetAuditCreation";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.closedaudit=function(){var t="api/AtmTrnAuditCreation/GetMyClosedAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.openaudit=function(){var t="api/AtmTrnAuditCreation/GetMyOpenAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.auditsonhold=function(){var t="api/AtmTrnAuditCreation/GetMyOnholdAuditTask";lockUI(),c.get(t).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()})},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),c.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";c.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}u.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createaudit=function(){a.go("app.AtmTrnCreateAudit")},e.approverview=function(t,e,a){l.url("app/AtmTrnMyAuditRejected360View?hash="+m.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a))}}angular.module("angle").controller("AtmTrnMyRejectedAuditSummaryController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","$modal","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){lockUI();var t={auditcreation_gid:A},a="api/AtmTrnAuditorMaker/RaiseQueryHistorySummary";c.getparams(a,t).then(function(t){e.raisequeryhistory=t.data.raisequeryhistory,unlockUI()})}var h=this;h.title="AtmTrnRaiseQueryHistoryController";var v=k.decryptURL(l.search().hash);e.auditcreation_gid=v.auditcreation_gid;var A=e.auditcreation_gid;e.sampleimport_gid=v.sampleimport_gid;var y=e.sampleimport_gid;e.checklistmaster_gid=v.checklistmaster_gid;e.checklistmaster_gid;e.lspage=v.lspage;var b=e.lspage;e.lsobservationfill_flag=v.lsobservationfill_flag,f(),e.tagsample=function(t){function e(e,a){var i={sampleimport_gid:t},o="api/AtmTrnAuditorMaker/AssignedTagUser";c.getparams(o,i).then(function(t){e.SampleAssignedTag=t.data.SampleAssignedTag}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/taguser.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.btnulpoad=function(t){function e(e,a){e.auditcreation_gid=t;var i={auditcreation_gid:t};e.ok=function(){a.close("closed")},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)_.Downloaddocument(t,e[a])},e.upload=function(t,i,o){var n=k.fnCheckValidDocType(t[0].name,"");if(0==n)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var r=e.auditcreation_gid,l={name:t[0].name,file:t[0]},d=new FormData;d.append("fileupload",l.file),d.append("file_name",l.name),d.append("document_name",e.documentname),d.append("document_title",e.txtdocument_title),d.append("auditcreation_gid",e.auditcreation_gid),d.append("project_flag","Default"),e.uploadfrm=d;var p="api/AtmTrnSampling/QueryDocUpload";lockUI(),c.postFile(p,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),s.alert("Document Uploaded Successfully..!!","success");var i="api/AtmTrnSampling/GetDocUploadlist",o={auditcreation_gid:r};c.getparams(i,o).then(function(t){e.lsfilename=t.data.filename,e.lsfilepath=t.data.filepath,e.DocUploadlogdtl=t.data.DocUploadlogdtl,1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()}),a.close("closed")}else unlockUI(),s.alert("File Format Not Supported!")})};var o="api/AtmTrnSampling/GetDocUploadlist";lockUI(),c.getparams(o,i).then(function(t){e.lsfilename=t.data.filename,e.lsfilepath=t.data.filepath,e.DocUploadlogdtl=t.data.DocUploadlogdtl,unlockUI()}),e.ok=function(){a.close("closed")},e.downloadsdocument=function(t,e){_.Downloaddocument(t,e)}}i.open({templateUrl:"/documentupload.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,i,o){e.hide=0;var n={auditcreation_gid:A},r="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),c.getparams(r,n).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var n={sampleraisequery_gid:t},r="api/AtmTrnMyAuditTaskAuditee/GetSampleQuerydetaillist";c.getparams(r,n).then(function(t){e.SampleQuerydetaillist=t.data.SampleQuerydetaillist,unlockUI()}),e.replytoquery=function(){var i={auditcreation_gid:A,sampleimport_gid:y,remarks:e.txtqueries,sampleraisequery_gid:t,replied_by:a};lockUI();var o="api/AtmTrnMyAuditTaskAuditee/PostSampleQuerydetail";c.post(o,i).then(function(a){if(unlockUI(),1==a.data.status){var i="api/AtmTrnMyAuditTaskAuditee/GetSampleQuerydetaillist",o={sampleraisequery_gid:t};c.getparams(i,o).then(function(t){unlockUI(),e.SampleQuerydetaillist=t.data.SampleQuerydetaillist,1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else s.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=A,e.sampleraisequery_gid=t,e.sampleimport_gid=y;var n={auditcreation_gid:A,sampleraisequery_gid:t,sampleimport_gid:y};e.uploaddocument=function(t,a,i){var o=k.fnCheckValidDocType(t[0].name,"");if(0==o)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1;var n=(e.auditcreation_gid,e.sampleraisequery_gid),r=(e.sampleimport_gid,{name:t[0].name,file:t[0]}),l=new FormData;l.append("fileupload",r.file),l.append("file_name",r.name),l.append("document_name",e.documentname),l.append("document_title",e.txtdocument_title),l.append("auditcreation_gid",e.auditcreation_gid),l.append("sampleraisequery_gid",e.sampleraisequery_gid),l.append("sampleimport_gid",e.sampleimport_gid),e.uploadfrm=l;var d="api/AtmTrnMyAuditTaskAuditee/ResponseDocUpload";lockUI(),c.postFile(d,e.uploadfrm).then(function(t){if($("#addupload").val(""),e.txtdocument_title="",1==t.data.status){unlockUI(),s.alert("Document Uploaded Successfully..!!","success");var a={sampleraisequery_gid:n},i="api/AtmTrnMyAuditTaskAuditee/GetSampleQuerydetaillist";c.getparams(i,a).then(function(t){e.SampleQuerydetaillist=t.data.SampleQuerydetaillist,1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),s.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.ok=function(){i.close("closed")}}var a="";"auditormakerOpen"==b?a="Auditor Maker":"auditorapproveropen"==b?a="Auditor Approver":"auditorcheckerOpen"==b?a="Auditor Checker":"auditeemakeropen"==b?a="Auditee Maker":"auditeecheckeropen"==b?a="Auditee Checker":"auditeemakertagged"==b&&(a="Tagged User");
i.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.Back=function(){var t=e.auditcreation_gid,a=e.sampleimport_gid;e.checklistmaster_gid;"auditeecheckerpending"==b&&l.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+"&lspage="+b))},e.back=function(){l.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+k.encryptURL("auditcreation_gid="+A+"&sampleimport_gid="+y+"&lspage=auditeecheckerpending"))}}angular.module("angle").controller("AtmTrnRaiseQueryHistoryController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","$sce","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:k},a="api/AtmTrnMyAuditTask/GetAssignedQuerySummary";s.getparams(a,t).then(function(t){e.AssignedQueryList=t.data.AssignedQueryList,unlockUI()});var a="api/AtmTrnMyAuditTask/GetRepliedQuerySummary";s.getparams(a,t).then(function(t){e.ReplyToQueryList=t.data.ReplyToQueryList,unlockUI()})}var _=this;_.title="AtmTrnReplyToQueryController",e.auditcreation_gid=d.search().auditcreation_gid;var k=e.auditcreation_gid;g(),e.Assigned=function(){var t=e.auditcreation_gid;d.url("app/AtmTrnAssignedQuery?auditcreation_gid="+t)},e.Reply=function(){i.go("app.AtmTrnReplyToQuery")},e.back=function(t){i.go("app.AtmTrnMyAuditTaskSummary")}}angular.module("angle").controller("AtmTrnReplyToQueryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","$sce"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:A,sampleimport_gid:b,observationscoresample_gid:U};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:A,sampleimport_gid:b},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?t.yes_radio=!0:"No"==t.capture_field?t.no_radio=!0:"Partial"==t.capture_field?t.partialscore_radio=!0:"NA"==t.capture_field?t.nascore_radio=!0:""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){var t={checkpointgroupadd_gid:checkpointgroupadd_gid,sampleimport_gid:b},a="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(a,t).then(function(t){unlockUI(),e.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var a=0;a<e.checklistcheckpoint_list.length;a++)e.checklistcheckpoint_list[a].checked=!0;angular.forEach(e.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified&&(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0)})})}function f(){e.observationfillenable=!0}var h=this;h.title="AtmTrnSampleAgainstApproverObservationScoreController";var v=g.decryptURL(d.search().hash);e.auditcreation_gid=v.auditcreation_gid;var A=e.auditcreation_gid;e.checklistmaster_gid=v.checklistmaster_gid;var y=e.checklistmaster_gid;e.checklistmasteradd_gid=v.checklistmasteradd_gid,e.sampleimport_gid=v.sampleimport_gid;var b=e.sampleimport_gid;e.observationscoresample_gid=v.observationscoresample_gid;var U=e.observationscoresample_gid;e.lspage=v.lspage;var I=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o,n){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else if("Y"==e.samplechecklistverified_flag){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o,e.sampleimport_gid=n;var r={auditcreation_gid:A,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid,sampleimport_gid:e.sampleimport_gid},c="api/AtmTrnAuditorMaker/PostAuditorUpdateSampleObservationTotalAmount";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o,e.sampleimport_gid=n;var r={auditcreation_gid:A,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid,sampleimport_gid:e.sampleimport_gid},c="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.overallselected=function(t){e.document_verified=t;var a={auditcreation2checklist_gid:auditcreation2checklist_gid,document_verified:e.document_verified,checklist2checkpoint:e.checklist2checkpoint,sampleimport_gid:b,checkpointgroupadd_gid:checkpointgroupadd_gid},i="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.overallonselected=function(t){e.document_verified=t;var a={auditcreation2checklist_gid:auditcreation2checklist_gid,document_verified:e.document_verified,checklist2checkpoint:e.checklist2checkpoint,sampleimport_gid:b,checkpointgroupadd_gid:checkpointgroupadd_gid},i="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:A},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:A},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:A},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&f()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:y,sampleimport_gid:b,auditcreation_gid:A},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorApproverView?hash="+g.encryptURL("auditcreation_gid="+A+"&lspage=auditorapproverPending"))):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t={sampleimport_gid:b,auditcreation_gid:A},e="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(e,t).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorApproverView?hash="+g.encryptURL("auditcreation_gid="+A+"&lspage=auditorapproverPending"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:y},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+A+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+I+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,i,o){function n(a,n){function r(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i},o="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(o,e).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})})}a.ok=function(){n.close("closed")};var c={checkpointgroupadd_gid:t,sampleimport_gid:i},d="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var d="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(d,c).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.sample2checkpoint=i;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.samplecheckpointassign=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})},a.samplecheckpointassignupdate=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})},a.overallselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallonselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallpartialselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallnaselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnAuditorApproverView?hash="+g.encryptURL("auditcreation_gid="+A+"&lspage=auditorapproverPending"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnSampleAgainstApproverObservationScoreController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_overallscore=t.data.sampleoverall_score,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnSampleAgainstApproverObservationScoreViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=d.search().lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"
});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified?t.tag_verifiedradio=!0:"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnAuditorApproverObservationView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditorapproverCompleted"))}}angular.module("angle").controller("AtmTrnSampleAgainstApproverObservationScoreViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?t.yes_radio=!0:"No"==t.capture_field?t.no_radio=!0:"Partial"==t.capture_field?t.partialscore_radio=!0:"NA"==t.capture_field?t.nascore_radio=!0:""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnSampleAgainstCheckerObservationScoreController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=h.lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else if("Y"==e.samplechecklistverified_flag){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,sampleimport_gid:y,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorUpdateSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,sampleimport_gid:y,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorCheckerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditorcheckerPending"))):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t={sampleimport_gid:y,auditcreation_gid:v},e="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(e,t).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorCheckerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditorcheckerPending"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,i,o){function n(a,n){function r(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i},o="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(o,e).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})})}a.ok=function(){n.close("closed")};var c={checkpointgroupadd_gid:t,sampleimport_gid:i},d="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var d="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(d,c).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.sample2checkpoint=i;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.overallselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallonselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallpartialselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallnaselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.samplecheckpointassign=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})},a.samplecheckpointassignupdate=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnAuditorCheckerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditorcheckerPending"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnSampleAgainstCheckerObservationScoreController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnSampleAgainstCheckerObservationScoreViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=h.lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){
unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAudit360View?hash="+g.encryptURL("auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3)),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified?t.tag_verifiedradio=!0:"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+i+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnAuditorCheckerObservationView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditorcheckerPending"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnSampleAgainstCheckerObservationScoreViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnSampleAgainstMakerObservationScoreViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=h.lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified&&(t.tag_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.back=function(t){d.url("app/AtmTrnAuditorMakerObservationView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnSampleAgainstMakerObservationScoreViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnSampleAgainstObservationScoreController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid;e.checklistmasteradd_gid;e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=h.lspage;var U=e.lspage;e.data={},_(),e.IsDisabled=!0,e.allobservationfilled=!0,e.EnableDisable=function(){e.IsDisabled=!e.sample2checkpoint},e.onselected=function(t,a,i,o,n){if("Y"==e.samplechecklistverified_flag){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o,e.checkpointgroupadd_gid=n;var r={auditcreation_gid:v,sampleimport_gid:y,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid,checkpointgroupadd_gid:e.checkpointgroupadd_gid},c="api/AtmTrnAuditorMaker/PostAuditorUpdateSampleObservationTotalAmount";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o,e.checkpointgroupadd_gid=n;var r={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid,sampleimport_gid:y,checkpointgroupadd_gid:e.checkpointgroupadd_gid},c="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(c,r).then(function(t){unlockUI(),1==t.data.status?(1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";lockUI(),s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t={sampleimport_gid:y,auditcreation_gid:v},e="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(e,t).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")});
},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,i,o){function n(a,n){function r(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i},o="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(o,e).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})})}a.ok=function(){n.close("closed")};var c={checkpointgroupadd_gid:t,sampleimport_gid:i},d="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(d,c).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified?t.tag_verifiedradio=!0:"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})});var d="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(d,c).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.sample2checkpoint=i;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.overallselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallonselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallpartialselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.overallnaselected=function(o){a.document_verified=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint,sampleimport_gid:i,checkpointgroupadd_gid:t},c="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(c,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),r()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},a.samplecheckpointassign=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})},a.samplecheckpointassignupdate=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+v+"&lspage=auditormakerOpen"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnSampleAgainstObservationScoreController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:k,sampleimport_gid:f},a="api/AtmTrnSampling/GetAssignedQuerySummary";s.getparams(a,t).then(function(t){e.SampleAssignedQueryList=t.data.SampleAssignedQueryList,unlockUI()});var a="api/AtmTrnSampling/GetSample";s.getparams(a,t).then(function(t){unlockUI(),k=t.data.auditcreation_gid,e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnSampleAssignedQueryController",e.auditcreation_gid=d.search().auditcreation_gid;var k=e.auditcreation_gid;e.sampleimport_gid=d.search().sampleimport_gid;var f=e.sampleimport_gid;g(),e.Reply=function(){var t=e.auditcreation_gid,a=e.sampleimport_gid;d.url("app/AtmTrnSampleReplyQuery?auditcreation_gid="+t+"&sampleimport_gid="+a)},e.replytoquery=function(t){function e(e,a){var i={sampleraisequery_gid:t},o="api/AtmTrnSampling/EditAssignedQuery";s.getparams(o,i).then(function(t){e.sampleraisequery_gid=t.data.sampleraisequery_gid}),e.ok=function(){a.close("closed")},e.submit=function(){var t={auditcreation_gid:k,sampleimport_gid:f,sampleraisequery_gid:e.sampleraisequery_gid,reply_query:e.txtdescription},i="api/AtmTrnSampling/PostReplyToQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnSampleAssignedQuery?auditcreation_gid="+k),a.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/replytoquery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.back=function(){var t=e.auditcreation_gid;d.url("app/AtmTrnCheckpointObservation?auditcreation_gid="+t)}}angular.module("angle").controller("AtmTrnSampleAssignedQueryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","$sce"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:A,sampleimport_gid:b,observationscoresample_gid:U};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.txt_percent=t.data.sampleobservation_percentage,"N"==t.data.observation_fill?(e.observationfillenable=!1,e.makersaveapprove=!1):"Y"==t.data.observation_fill&&"auditormakerOpen"==I&&"N"==e.auditormaker_approvalflag?(e.observationfillenable=!0,e.makersaveapprove=!0):(e.observationfillenable="Disable",e.makersaveapprove=!1),unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var t="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(t,a).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var t="api/AtmTrnAuditCreation/GetAudit360View";lockUI(),s.getparams(t,a).then(function(t){e.auditcreation_list=t.data.auditcreation_list,unlockUI()});var a={auditcreation_gid:A,sampleimport_gid:b},t="api/AtmTrnAuditorMaker/GetAuditorSampleName";lockUI(),s.getparams(t,a).then(function(t){e.sample_name=t.data.sample_name,unlockUI()});var a={auditcreation_gid:A},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list}),e.allobservationfilled=!0;var a={auditcreation_gid:A,sampleimport_gid:b},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){var t={checkpointgroupadd_gid:checkpointgroupadd_gid,sampleimport_gid:b},a="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(a,t).then(function(t){unlockUI(),e.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var a=0;a<e.checklistcheckpoint_list.length;a++)e.checklistcheckpoint_list[a].checked=!0;angular.forEach(e.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified?(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0):"Partial"==t.checklist_verified?t.partial_verifiedradio=!0:"NA"==t.checklist_verified&&(t.na_verifiedradio=!0)})})}function f(){e.observationfillenable=!0}var h=this;h.title="AtmTrnSampleQueryAgainstObservationScoreController";var v=g.decryptURL(d.search().hash);e.auditcreation_gid=v.auditcreation_gid;var A=e.auditcreation_gid;e.checklistmaster_gid=v.checklistmaster_gid;var y=e.checklistmaster_gid;e.checklistmasteradd_gid=v.checklistmasteradd_gid,e.sampleimport_gid=v.sampleimport_gid;var b=e.sampleimport_gid;e.observationscoresample_gid=v.observationscoresample_gid;var U=e.observationscoresample_gid;e.lspage=v.lspage;var I=e.lspage;e.data={},_(),e.onselected=function(t,a,i,o){e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:A,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},e.overallselected=function(t){e.document_verified=t;var a={auditcreation2checklist_gid:auditcreation2checklist_gid,document_verified:e.document_verified,checklist2checkpoint:e.checklist2checkpoint,sampleimport_gid:b,checkpointgroupadd_gid:checkpointgroupadd_gid},i="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.overallonselected=function(t){e.document_verified=t;var a={auditcreation2checklist_gid:auditcreation2checklist_gid,document_verified:e.document_verified,checklist2checkpoint:e.checklist2checkpoint,sampleimport_gid:b,checkpointgroupadd_gid:checkpointgroupadd_gid},i="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.overallpartialselected=function(t){e.document_verified=t;var a={auditcreation2checklist_gid:auditcreation2checklist_gid,document_verified:e.document_verified,checklist2checkpoint:e.checklist2checkpoint,sampleimport_gid:b,checkpointgroupadd_gid:checkpointgroupadd_gid},i="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.overallnaselected=function(t){e.document_verified=t;var a={auditcreation2checklist_gid:auditcreation2checklist_gid,document_verified:e.document_verified,checklist2checkpoint:e.checklist2checkpoint,sampleimport_gid:b,checkpointgroupadd_gid:checkpointgroupadd_gid},i="api/AtmTrnAuditorMaker/PostOverallCheckpointAgainstSample";lockUI(),s.post(i,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_(),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:A},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:A},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:A},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&f()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makersampleupdateapproval=function(){var t={sampleimport_gid:b,auditcreation_gid:A},e="api/AtmTrnAuditCreation/PostSampleAssignUpdate";lockUI(),s.post(e,t).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+A+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})},e.makerinitiateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:y,sampleimport_gid:b,auditcreation_gid:A},i="api/AtmTrnAuditCreation/PostSampleAssign";lockUI(),s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+A+"&lspage=auditormakerOpen"))):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:y},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery")},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?hash="+g.encryptURL("auditcreation_gid="+A+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+I+"&lsobservationfill_flag="+e.observationfill))},e.observationquery=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:i},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?(t.document_verifiedradio=!0,t.document_verifiedradio1=!0):"No"==t.checklist_verified&&(t.tag_verifiedradio=!0,t.tag_verifiedradio1=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.sample2checkpoint=i;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:o},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})},a.samplecheckpointassignupdate=function(){var e={checkpointgroupadd_gid:t,sampleimport_gid:i,auditcreation_gid:o},a="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";lockUI(),s.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.close("closed"),_()):(l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?hash="+g.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){d.url("app/AtmTrnAuditorMakerView?hash="+g.encryptURL("auditcreation_gid="+A+"&lspage=auditormakerOpen"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnSampleQueryAgainstObservationScoreController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_,k){function f(){e.hide=0,lockUI();var t={auditcreation_gid:A,sampleimport_gid:y},a="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),c.getparams(a,t).then(function(t){
e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()}),e.showdiv=!0;var a="api/SystemMaster/GetEmployeelist";c.get(a).then(function(t){e.cboemployee_list=t.data.employeelist});var a="api/AtmTrnSampling/GetAssignedQuerySummary";c.getparams(a,t).then(function(t){e.SampleAssignedQueryList=t.data.SampleAssignedQueryList});var t={sampleimport_gid:y},a="api/AtmTrnSampling/GetSampleName";c.getparams(a,t).then(function(t){e.sampleimport_gid=t.data.sampleimport_gid,e.txtsample_name=t.data.sample_name}),e.lspage=l.search().lspage;var i=e.lspage,a="api/AtmTrnAuditorMaker/RaisedsampleQuerySummary";c.getparams(a,t).then(function(t){unlockUI(),e.samplequerydatalist=t.data.samplequerydata,e.close_disabled=!1,"auditeemakeropen"!=i&&"auditeemakerhold"!=i&&"auditeemakerclosed"!=i&&"auditeemakertagged"!=i&&"auditeemakercompleted"!=i&&"auditeecheckeropen"!=i&&"auditeecheckerpending"!=i&&"auditeecheckerhold"!=i&&"auditeecheckerclosed"!=i&&"auditeecheckertagged"!=i&&"auditeecheckercompleted"!=i||(e.close_disabled=!0)}),"auditormakerOpen"!=i&&"Y"!=e.lsobservationfill_flag&&(e.lsobservationfill_flag="N"),"auditeemakeropen"!=i&&"auditeemakerhold"!=i&&"auditeemakerclosed"!=i&&"auditeemakertagged"!=i&&"auditeemakercompleted"!=i&&"auditeemakertagged"!=i||(e.lsobservationfill_flag="Y")}var h=this;h.title="AtmTrnSampleQueryController";var v=k.decryptURL(l.search().hash);e.auditcreation_gid=v.auditcreation_gid;var A=e.auditcreation_gid;e.sampleimport_gid=v.sampleimport_gid;var y=e.sampleimport_gid;e.checklistmaster_gid=v.checklistmaster_gid;e.checklistmaster_gid;e.lspage=v.lspage;var b=e.lspage;e.lsobservationfill_flag=v.lsobservationfill_flag,f(),e.refresh=function(){lockUI(),f()},e.btnraisequery=function(){e.showraisequery=!0,e.showdiv=!1},e.Cancel=function(){e.txtquery_title="",e.txtquery_desc="",e.cboqueryto="",e.showraisequery=!1,e.showdiv=!0},e.submit=function(){var t="",a="";e.cboqueryto&&(t=e.cboqueryto.employee_gid,a=e.cboqueryto.employee_name);var i={sampleimport_gid:y,description:e.txtquery_desc,auditcreation_gid:A,query_title:e.txtquery_title,query_to:t,query_toname:a},o="api/AtmTrnSampling/PostRaiseQuery";lockUI(),c.post(o,i).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.txtquery_title="",e.txtquery_desc="",e.cboqueryto="",f(),e.showdiv=!1):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),$modalInstance.close("closed")},e.closesample_query=function(t){function e(e,a){e.closesample_submit=function(){var i={sampleraisequery_gid:t,close_remarks:e.txtclosequeries},o="api/AtmTrnMyAuditTaskAuditee/PostcloseSamplequery";lockUI(),c.post(o,i).then(function(t){unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),f()):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.ok=function(){a.close("closed")}}i.open({templateUrl:"/closeremarks.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.btnulpoad=function(t){function e(e,a){e.auditcreation_gid=t;var i={auditcreation_gid:t};e.ok=function(){a.close("closed")},e.downloadall=function(t,e){for(var a=0;a<e.length;a++)_.Downloaddocument(t,e[a])},e.upload=function(i,o,n){for(var r=new FormData,l=0;l<i.length;l++){var d={name:i[l].name,file:i[l]};r.append("fileupload",d.file),r.append("file_name",d.name);var p=k.fnCheckValidDocType(i[l].name,"documentformatonly");if(0==p)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}r.append("document_name",e.documentname),r.append("document_title",e.txtdocument_title),r.append("auditcreation_gid",e.auditcreation_gid),r.append("project_flag","Default"),e.uploadfrm=r;var u="api/AtmTrnSampling/QueryDocUpload";lockUI(),c.postFile(u,e.uploadfrm).then(function(i){if($("#addupload").val(""),e.txtdocument_title="",1==i.data.status){unlockUI(),s.alert("Document Uploaded Successfully..!!","success");var o="api/AtmTrnSampling/GetDocUploadlist",n={auditcreation_gid:t};c.getparams(o,n).then(function(t){e.lsfilename=t.data.filename,e.lsfilepath=t.data.filepath,e.DocUploadlogdtl=t.data.DocUploadlogdtl,1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()}),a.close("closed")}else unlockUI(),s.alert("File Format Not Supported!")})};var o="api/AtmTrnSampling/GetDocUploadlist";lockUI(),c.getparams(o,i).then(function(t){e.lsfilename=t.data.filename,e.lsfilepath=t.data.filepath,e.DocUploadlogdtl=t.data.DocUploadlogdtl,unlockUI()}),e.ok=function(){a.close("closed")},e.downloadsdocument=function(t,e){_.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=k.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void _.DocumentViewer(t,e)}}i.open({templateUrl:"/documentupload.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.viewresponse_samplequery=function(t){function e(e,i,o){e.hide=0;var n={auditcreation_gid:A},r="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),c.getparams(r,n).then(function(t){e.approval_status=t.data.approval_status,"Completed"==e.approval_status&&(e.hide=1),unlockUI()});var n={sampleraisequery_gid:t},r="api/AtmTrnMyAuditTaskAuditee/GetSampleQuerydetaillist";c.getparams(r,n).then(function(t){e.SampleQuerydetaillist=t.data.SampleQuerydetaillist,unlockUI()}),e.replytoquery=function(){var i={auditcreation_gid:A,sampleimport_gid:y,remarks:e.txtqueries,sampleraisequery_gid:t,replied_by:a};lockUI();var o="api/AtmTrnMyAuditTaskAuditee/PostSampleQuerydetail";c.post(o,i).then(function(a){if(unlockUI(),1==a.data.status){var i="api/AtmTrnMyAuditTaskAuditee/GetSampleQuerydetaillist",o={sampleraisequery_gid:t};c.getparams(i,o).then(function(t){unlockUI(),e.SampleQuerydetaillist=t.data.SampleQuerydetaillist,1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else s.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3});e.txtqueries=""})},e.auditcreation_gid=A,e.sampleraisequery_gid=t,e.sampleimport_gid=y;var n={auditcreation_gid:A,sampleraisequery_gid:t,sampleimport_gid:y};e.uploaddocument=function(a,i,o){for(var n=k.fnCheckValidDocType(a[0].name,"Default"),r=new FormData,l=0;l<a.length;l++){var d={name:a[l].name,file:a[l]};r.append("fileupload",d.file),r.append("file_name",d.name);var n=k.fnCheckValidDocType(a[l].name,"documentformatonly");if(0==n)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}r.append("document_name",e.documentname),r.append("document_title",e.txtdocument_title),r.append("auditcreation_gid",e.auditcreation_gid),r.append("sampleraisequery_gid",e.sampleraisequery_gid),r.append("sampleimport_gid",e.sampleimport_gid),r.append("project_flag","Default"),e.uploadfrm=r;var p="api/AtmTrnMyAuditTaskAuditee/ResponseDocUpload";lockUI(),c.postFile(p,e.uploadfrm).then(function(a){if($("#addupload").val(""),e.txtdocument_title="",1==a.data.status){unlockUI(),s.alert("Document Uploaded Successfully..!!","success");var i={sampleraisequery_gid:t},o="api/AtmTrnMyAuditTaskAuditee/GetSampleQuerydetaillist";c.getparams(o,i).then(function(t){e.SampleQuerydetaillist=t.data.SampleQuerydetaillist,1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}else unlockUI(),s.alert("File Format Not Supported!")})},e.downloadsdocument=function(t,e){o.Downloaddocument(t,e)},e.documentviewer=function(t,e){lockUI();var a=k.fnCheckValidDocType(e,"DocumentViewerFormat");return 0==a?(s.alert("View is not supported for this format..!",{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),!1):void o.DocumentViewer(t,e)},e.ok=function(){i.close("closed")}}var a="";"auditormakerOpen"==b?a="Auditor Maker":"auditorapproveropen"==b?a="Auditor Approver":"auditorcheckerOpen"==b?a="Auditor Checker":"auditeemakeropen"==b?a="Auditee Maker":"auditeecheckeropen"==b?a="Auditee Checker":"auditeemakertagged"==b&&(a="Tagged User");i.open({templateUrl:"/response_view.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance","DownloaddocumentService"]},e.Back=function(){var t=e.auditcreation_gid,a=e.sampleimport_gid,i=e.checklistmaster_gid;"auditormakerOpen"==b?l.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditormakerHold"==b?l.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditormakerClosed"==b?l.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditormakerTagged"==b?l.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditormakerCompleted"==b?l.url("app/AtmTrnAuditorMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorcheckerOpen"==b?l.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorcheckerPending"==b?l.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorcheckerClosed"==b?l.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorcheckerTagged"==b?l.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorcheckerHold"==b?l.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorcheckerCompleted"==b?l.url("app/AtmTrnAuditorCheckerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorapproveropen"==b?l.url("app/AtmTrnAuditorApproverView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorapproverPending"==b?l.url("app/AtmTrnAuditorApproverView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorapproverHold"==b?l.url("app/AtmTrnAuditorApproverView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorapproverClosed"==b?l.url("app/AtmTrnAuditorApproverView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorapproverTagged"==b?l.url("app/AtmTrnAuditorApproverView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditorapproverCompleted"==b?l.url("app/AtmTrnAuditorApproverView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeemakeropen"==b?l.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeemakerhold"==b?l.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeemakerclosed"==b?l.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeemakertagged"==b?l.url("app/AtmTrnTaggedAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeemakercompleted"==b?l.url("app/AtmTrnMyAuditTaskAuditeeMakerView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeecheckeropensummary"==b?l.url("app/AtmTrnMyAuditeeTaskCheckerAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeecheckeropen"==b?l.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeecheckerpending"==b?l.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeecheckerhold"==b?l.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeecheckerclosed"==b?l.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeecheckertagged"==b?l.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditeecheckercompleted"==b?l.url("app/AtmTrnMyAuditTaskAuditeeView?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b)):"auditclosed"==b?l.url("app/AtmTrnAudit360View?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+i+"&sampleimport_gid="+a+"&lspage="+b)):"auditcompleted"==b?l.url("app/AtmTrnAudit360View?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+i+"&sampleimport_gid="+a+"&lspage="+b)):"initiateaudit"==b?l.url("app/AtmTrnAudit360View?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+i+"&sampleimport_gid="+a+"&lspage="+b)):"auditapproved"==b?l.url("app/AtmTrnAudit360View?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+i+"&sampleimport_gid="+a+"&lspage="+b)):"audithold"==b?l.url("app/AtmTrnAudit360View?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+i+"&sampleimport_gid="+a+"&lspage="+b)):"auditrejected"==b?l.url("app/AtmTrnAudit360View?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+i+"&sampleimport_gid="+a+"&lspage="+b)):"Mypendingapproval"==b?l.url("app/AtmTrnMyAuditApprover360View?hash="+k.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+i+"&sampleimport_gid="+a+"&lspage="+b)):"Myapprovedaudits"==b&&l.url("app/AtmTrnMyAuditApprover360View?hash="+k.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+a+NaN+i+"&lspage="+b))}}angular.module("angle").controller("AtmTrnSampleQueryController",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","$sce","$anchorScroll","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:k,sampleimport_gid:f},a="api/AtmTrnSampling/GetRepliedQuerySummary";s.getparams(a,t).then(function(t){e.SampleReplyQueryList=t.data.SampleReplyQueryList,unlockUI()})}var _=this;_.title="AtmTrnSampleReplyQueryController",e.auditcreation_gid=d.search().auditcreation_gid;var k=e.auditcreation_gid;e.sampleimport_gid=d.search().sampleimport_gid;var f=e.sampleimport_gid;g(),e.Assigned=function(){var t=e.auditcreation_gid,a=e.sampleimport_gid;d.url("app/AtmTrnSampleAssignedQuery?auditcreation_gid="+t+"&sampleimport_gid="+a)},e.back=function(){var t=e.auditcreation_gid;d.url("app/AtmTrnCheckpointObservation?auditcreation_gid="+t)}}angular.module("angle").controller("AtmTrnSampleReplyQueryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","$sce"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:k},a="api/AtmTrnAuditCreation/GetSample";s.getparams(a,t).then(function(t){unlockUI(),e.sample_list=t.data.sample_list})}var _=this;_.title="AtmTrnSamplingController";var k=d.search().auditcreation_gid;g(),e.btntaguser=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name}),a.ok=function(){i.close("closed")};var n="api/SystemMaster/GetEmployeelist";lockUI(),s.get(n).then(function(t){a.employee_list=t.data.employeelist,unlockUI()}),a.btnconfirm=function(){var t={employelist:a.cboemployee_name,sample_name:a.txtsample_name,sampleimport_gid:a.sampleimport_gid,auditcreation_gid:e},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnSampling?auditcreation_gid="+val1),i.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/taguser.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.raisequery=function(t){function e(e,a){var i={sampleimport_gid:t},o="api/AtmTrnSampling/EditSampleQuery";s.getparams(o,i).then(function(t){e.sampleimport_gid=t.data.sampleimport_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={sampleimport_gid:e.sampleimport_gid,employelist:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnSampling?auditcreation_gid="+val1),a.close("closed"),g()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.view=function(t){var a=e.auditcreation_gid;d.url("app/AtmTrnSamplingView?auditcreation_gid="+a+"&sampleimport_gid="+t)},e.back=function(t){i.go("app.AtmTrnMyAuditTaskAuditeeSummary")}}angular.module("angle").controller("AtmTrnSamplingController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m){function g(){var t={auditcreation_gid:f,sampleimport_gid:k},a="api/AtmTrnSampling/GetEmployeeName";s.getparams(a,t).then(function(t){unlockUI(),e.employee_name=t.data.employee_name});var a="api/AtmTrnSampling/GetSampleView",t={sampleimport_gid:k,auditcreation_gid:f};lockUI(),s.getparams(a,t).then(function(t){e.txtsample_name=t.data.sample_name,e.txtsamfin_code=t.data.samfin_code,e.txtsamagro_code=t.data.samagro_code,e.txtcodecreation_date=t.data.codecreation_date,e.txtfield1=t.data.field1,e.txtfield2=t.data.field2,e.txtfield3=t.data.field3,e.txtfield4=t.data.field4,e.txtfield5=t.data.field5,e.txtfield6=t.data.field6,e.txtfield7=t.data.field7,e.txtfield8=t.data.field8,e.txtfield9=t.data.field9,e.txtfield10=t.data.field10,unlockUI()})}var _=this;_.title="AtmTrnSamplingViewController";var k=d.search().sampleimport_gid;e.auditcreation_gid=d.search().auditcreation_gid;var f=d.search().auditcreation_gid;g(),e.back=function(){var t=e.auditcreation_gid;d.url("app/AtmTrnAuditorMakerSummary?auditcreation_gid="+t)},e.Back=function(){var t=e.auditcreation_gid;d.url("app/AtmTrnAuditCreationView?auditcreation_gid="+t)}}angular.module("angle").controller("AtmTrnSamplingViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g){function _(){var t="api/AtmTrnAuditCreation/SampleObservationScore",a={auditcreation_gid:v,sampleimport_gid:y,observationscoresample_gid:b};lockUI(),s.getparams(t,a).then(function(t){e.openquerycount=t.data.openquerycount,e.status_flag=t.data.status_flag,e.DBobservation_score=t.data.sampleobservation_score,e.txttotal_score=e.DBobservation_score,e.observationfill=t.data.observation_fill,e.auditormaker_approvalflag=t.data.auditormaker_approvalflag,e.samplechecklistverified_flag=t.data.samplechecklistverified_flag,e.samplecapture_field=t.data.samplecapture_field,e.txt_percent=t.data.sampleobservation_percentage,e.observationfillenable="Disable",e.makersaveapprove=!1,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorSampleViewOverallscore";lockUI(),s.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:v,sampleimport_gid:y},t="api/AtmTrnAuditorMaker/AuditorSampleView";lockUI(),s.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){"Yes"==t.capture_field?(t.yes_radio=!0,t.yes_radio1=!0):"No"==t.capture_field?(t.no_radio=!0,t.no_radio1=!0):"Partial"==t.capture_field?(t.partialscore_radio=!0,t.partialscore_radio1=!0):"NA"==t.capture_field?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_field&&(e.allobservationfilled=!1)})})}function k(){e.observationfillenable=!0}var f=this;f.title="AtmTrnTaggedAuditeeObservationScoreViewController";var h=g.decryptURL(d.search().hash);e.auditcreation_gid=h.auditcreation_gid;var v=e.auditcreation_gid;e.checklistmaster_gid=h.checklistmaster_gid;var A=e.checklistmaster_gid;e.checklistmasteradd_gid=h.checklistmasteradd_gid,e.sampleimport_gid=h.sampleimport_gid;var y=e.sampleimport_gid;e.observationscoresample_gid=h.observationscoresample_gid;var b=e.observationscoresample_gid;e.lspage=h.lspage;var U=e.lspage;e.data={},_(),e.allobservationfilled=!0,e.onselected=function(t,a,i,o){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{e.total_score=t,e.auditcreation2checklist_gid=a,e.checklistmasteradd_gid=i,e.observationscoresample_gid=o;var n={auditcreation_gid:v,auditcreation2checklist_gid:e.auditcreation2checklist_gid,checklistmasteradd_gid:e.checklistmasteradd_gid,capture_score:e.total_score,observationscoresample_gid:e.observationscoresample_gid},r="api/AtmTrnAuditorMaker/PostAuditorSampleObservationTotalAmount";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(e.txttotal_samplescore=t.data.total_amount,1==t.data.allobservationfilled?(e.allobservationfilled=!0,e.makersaveapprove=!0):e.allobservationfilled=!1,l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}},e.submitobservation=function(){if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{lockUI();var t=[];angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.auditcreation2checklist_gid;t.push(a)}});var a={auditcreation2checklist_gid:t,auditcreation_gid:v},i="api/AtmTrnAuditorMaker/PostAuditorMakerCheckpointObservation";s.post(i,a).then(function(t){if(1==t.data.status){l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3});var a={auditcreation_gid:v},i="api/AtmTrnAuditorMaker/AuditorMakerView";s.getparams(i,a).then(function(t){e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;e.allobservationfilled=!0,angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)}),unlockUI()})}else l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI();e.txttotal_score=""})}},e.fillobservation=function(){function t(t,e){t.ok=function(){e.close("closed")},t.btnproceed=function(){var t={auditcreation_gid:v},a="api/AtmTrnAuditCreation/observationfill";s.getparams(a,t).then(function(t){1==t.data.status&&k()}),e.close("closed")}}if("0"!=e.openquerycount)l.alert("Observation can't be filled, Query is not closed",{status:"warning",pos:"top-center",timeout:3e3});else{a.open({templateUrl:"/warningObservation.html",controller:t,backdrop:"static",keyboard:!1,size:"lg"});t.$inject=["$scope","$modalInstance"]}},e.makerinitiateapproval=function(){if("0"!=e.samplecapture_field)l.alert("Sample Observation score can't be filled",{status:"warning",pos:"top-center",timeout:3e3});else{var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssign";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+v+"&lspage=auditormakerOpen")):l.alert("Select Atleast One..!!","warning")})}},e.makersampleupdateapproval=function(){var t=[];if(angular.forEach(e.makercheckpointobservation_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A,sampleimport_gid:y,auditcreation_gid:v},i="api/AtmTrnAuditCreation/PostSampleAssignUpdate";s.post(i,a).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Observation score Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+v+"&lspage=auditormakerOpen")):l.alert("Select Atleast One..!!","warning")})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:A},o="api/AtmTrnAuditCreation/PostChecklistAssign";s.post(o,a).then(function(t){1==t.data.status?(l.alert("Checklist Assigned Successfully!","success"),i.go("app.AtmTrnAuditCreationSummary")):l.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e,i){function o(e,a){e.lblcheckpoint_description=i;var o={checklistmasteradd_gid:t};lockUI();var n="api/AtmMstChecklistMaster/GetChecklistMasterIntent";s.getparams(n,o).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";s.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){t.hide=0;var a={auditcreation_gid:i},o="api/AtmTrnAuditorMaker/GetSampleResponseQuery";lockUI(),s.getparams(o,a).then(function(e){t.approval_status=e.data.approval_status,"Completed"==t.approval_status&&(t.hide=1),unlockUI()});var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";s.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";s.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),s.post(o,a).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";s.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),s.post(e,t).then(function(t){unlockUI(),1==t.data.status?(location.reload(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),d.url("app/AtmTrnAudit360View?auditcreation_gid="+val1+"&checklistmaster_gid="+val2+"&sampleimport_gid="+val3),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.observationremarks=function(t,e){function i(a,i){var o={auditcreation2checklist_gid:t,auditcreation_gid:e};a.remark_submit=function(){var o={auditcreation2checklist_gid:t,auditcreation_gid:e,observation_remarks:a.txtremarks},n="api/AtmTrnAuditorMaker/AuditObservatioRemarks";lockUI(),s.post(n,o).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),_()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})};var n="api/AtmTrnAuditorMaker/AuditObservatioRemarksview";lockUI(),s.getparams(n,o).then(function(t){a.observationremarkslog_data=t.data.myauditormaker_list,unlockUI()}),a.ok=function(){i.close("closed")}}a.open({templateUrl:"/observationremarksupdate.html",controller:i,backdrop:"static",keyboard:!1,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.observationquery=function(){i.go("app.AtmTrnAuditObservationQuery");
},e.samplequery=function(t){var a=e.checklistmaster_gid,i="",o=e.SampleraisedqueryTable[t];o&&o.sampleimport_gid&&(i=o.sampleimport_gid),d.url("app/AtmTrnSampleQueryAuditor?auditcreation_gid="+v+"&checklistmaster_gid="+a+"&sampleimport_gid="+i+"&lspage="+U+"&lsobservationfill_flag="+e.observationfill)},e.observationcheckpointsample=function(t,e,i,o){function n(a,n){a.ok=function(){n.close("closed")};var r={checkpointgroupadd_gid:t,sampleimport_gid:o},c="api/AtmTrnAuditorMaker/GetSampleToCheckpoint";lockUI(),s.getparams(c,r).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.checklist_verified?t.document_verifiedradio=!0:"No"==t.checklist_verified&&(t.tag_verifiedradio=!0)})});var c="api/AtmTrnAuditorMaker/GetAuditorSampleFlag";lockUI(),s.getparams(c,r).then(function(t){a.sample_flag=t.data.sample_flag,unlockUI()}),a.ok=function(){n.close("closed")},a.onselected=function(t,o){a.document_verified=t,a.sample2checkpoint=o;var n={auditcreation2checklist_gid:e,document_verified:a.document_verified,sample2checkpoint:a.sample2checkpoint,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAgainstObservation";lockUI(),s.post(r,n).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},a.checkall=function(t){angular.forEach(a.checklistcheckpoint_list,function(e){e.checked=t})},a.samplecheckpointassign=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssign";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+i+"&lspage=auditormakerOpen")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})},a.samplecheckpointassignupdate=function(){var t=[];if(angular.forEach(a.checklistcheckpoint_list,function(e){if(1==e.checked){var a=e.checkpointgroupadd_gid;t.push(a)}}),0==t.length)return l.alert("Select Atleast One Record!"),!1;var e={checkpointgroupadd_gid:t,sampleimport_gid:o,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/PostSampleCheckpointAssignUpdate";s.post(r,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),l.alert("Sample Checkpoint Saved Successfully!","success"),d.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+i+"&lspage=auditormakerOpen")):l.alert("Select Atleast One..!!","warning"),n.close("closed")})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.dynamicsamplescore=function(t,e,a,i){d.url("app/AtmTrnSampleAgainstObservationScore?auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i)},e.back=function(t){d.url("app/AtmTrnTaggedAuditeeView?hash="+g.encryptURL("auditcreation_gid="+v+"&sampleimport_gid="+y+"&taggeduser_gid=undefined&lspage=auditeemakertagged"))},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnTaggedAuditeeObservationScoreViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,i,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskAuditeeMaker";lockUI(),s.get(t).then(function(t){e.myaudittaskauditee_list=t.data.myaudittaskauditee_list,e.employee_gid=t.data.employee_gid,unlockUI()});var t="api/AtmTrnMyAuditTaskAuditee/GetMyAuditTaskCounts";s.get(t).then(function(t){unlockUI(),e.auditsonhold_count=t.data.auditsonhold_count,e.closedaudit_count=t.data.closedaudit_count,e.openaudit_count=t.data.openaudit_count,e.taggedsample_count=t.data.taggedsample_count,e.completed_count=t.data.completedaudit_count,e.pendingapproval_count=t.data.pendingapproval_count})}var f=this;f.title="AtmTrnTaggedAuditeeSummaryController",k(),e.auditee_maker=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.auditee_checker=function(){d.url("app/AtmTrnMyAuditeeCheckerSummary")},e.open_audit=function(){d.url("app/AtmTrnMyAuditTaskAuditeeSummary")},e.hold_audit=function(){d.url("app/AtmTrnHoldAuditeeSummary")},e.closed_audit=function(){d.url("app/AtmTrnClosedAuditeeSummary")},e.tagged_items=function(){d.url("app/AtmTrnTaggedAuditeeSummary")},e.completed_audit=function(){d.url("app/AtmTrnCompletedAuditeeSummary")},e.viewtask=function(t,e,a){d.url("app/AtmTrnTaggedAuditeeView?hash="+_.encryptURL("auditcreation_gid="+t+"&sampleimport_gid="+e+"&taggeduser_gid="+a+"&lspage=auditeemakertagged"))},e.raisequery=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnMyAuditTaskAuditee/EditMyAuditTaskAuidtee";s.getparams(o,i).then(function(t){e.auditcreation_gid=t.data.auditcreation_gid}),e.ok=function(){a.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),s.get(o).then(function(t){e.employee_list=t.data.employeelist,unlockUI()}),e.submit=function(){var t={auditcreation_gid:e.auditcreation_gid,employe:e.cboemployee_name,description:e.txtdescription},i="api/AtmTrnMyAuditTaskAuditee/PostAuditeeRaiseQuery";lockUI(),s.post(i,t).then(function(t){unlockUI(),1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),k()):l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),a.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:e,backdrop:"static",keyboard:!1,size:"md"});e.$inject=["$scope","$modalInstance"]},e.approvalinformation=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),s.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var o="api/AtmTrnAuditCreation/GetAssignedInformation";s.getparams(o,i).then(function(t){e.lblaudit_maker=t.data.audit_maker,e.lblaudit_checker=t.data.audit_checker,e.lblauditapprover_name=t.data.auditapprover_name,e.lblauditperiod_fromdate=t.data.auditperiod_fromdate,e.lblauditperiod_todate=t.data.auditperiod_todate}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.importexcel=function(t){function e(e,a){var i={auditcreation_gid:t},o="api/AtmTrnSampling/GetSample";s.getparams(o,i).then(function(t){e.sample_list=t.data.sample_list}),e.ok=function(){a.close("closed")},e.downloadtemplate_importexcel=function(){var t=p.GetCommonData.TemplatePath.Path,e="ImportExcelSample.xlsx",a=t+e,i=a.split("EMS"),o=i[1].replace("\\","/"),n=window.location.protocol+"//",r=window.location.host,c=n.concat(r,o),s=document.createElement("a"),l=e.split(".");s.download=l[0],s.href=c,s.click()},e.excelupload=function(i,o,n){var r=document.getElementById("fileimport"),c=r.value;e.fileinputvalue=c;var s=/(\.xls|\.xlsx|\.csv)$/i;if(s.exec(c))if(0==c.includes("ImportExcelSample"))l.alert("File Name / Template Not Supported!","warning"),a.close("closed");else{var d={name:i[0].name,file:i[0]},p=new FormData;p.append("fileupload",d.file),p.append("file_name",d.name),p.append("auditcreation_gid",t),e.uploadfrm=p}else l.alert("File Format Not Supported!","warning"),a.close("closed")},e.uploadexcel=function(){if(""==e.fileinputvalue||void 0==e.fileinputvalue||null==e.fileinputvalue)l.alert("Kindly Select the Excel file","warning");else{var t="api/AtmTrnSampling/ImportExcelSample";lockUI(),s.postFile(t,e.uploadfrm).then(function(t){1==t.data.status?(k(),unlockUI(),l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed")):(unlockUI(),l.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),a.close("closed")),$("#fileimport").val("")})}},e.uploadexcelcancel=function(){$("#fileimport").val("")}}a.open({templateUrl:"/importexcel.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnTaggedAuditeeSummaryController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$filter","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,r,c,s,l,d,p,u,m,g,_){function k(){var t="api/AtmTrnAuditCreation/EditAuditCreation",a={auditcreation_gid:A};lockUI(),l.getparams(t,a).then(function(t){e.cboauditdepartment=t.data.auditdepartment_gid,e.cboauditdepartment=t.data.auditdepartment_name,e.cboauditname=t.data.checklistmaster_gid,e.cboauditname=t.data.audit_name,e.cboauditmaker=t.data.employee_gid,e.cboauditmaker=t.data.audit_maker,e.cboauditchecker=t.data.auditmapping_gid,e.cboauditchecker=t.data.audit_checker,e.cboauditapprover=t.data.employee_gid,e.cboauditapprover=t.data.audit_approver,e.cboauditpriority=t.data.auditpriority_gid,e.cboauditpriority=t.data.auditpriority_name,e.txtdue_date=t.data.end_date,e.txtreport_date=t.data.report_date,e.txtperiod_from=t.data.periodfrom_date,e.created_by=t.data.created_by,e.created_date=t.data.created_date,e.txtperiod_to=t.data.auditperiod_to,e.txtaudit_ref_no=t.data.audit_uniqueno,e.cboauditeemaker=t.data.auditeemaker_name,e.cboauditeechecker=t.data.auditeechecker_name,e.txtentity_name=t.data.entity_name,e.txtaudit_type=t.data.audittype_name,e.txtcheckpoint_group=t.data.checkpointgroup_name,e.txtaudit_desc=t.data.audit_description,e.auditeechecker_approvalflag=t.data.auditeechecker_approvalflag,e.txt_percent=t.data.observation_percentage,e.auditobservation_name=t.data.auditobservation_name,e.samplestatus_flag=t.data.samplestatus_flag,e.checklistverified_flag=t.data.checklistverified_flag,"auditeecheckerpending"==U&&"N"==e.auditeechecker_approvalflag?e.proceedtoapprover=!0:e.proceedtoapprover=!1,unlockUI()});var a={auditcreation_gid:A},t="api/AtmTrnAuditCreation/TrnCheckpointCreation";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.checkpointsummary_list=t.data.auditcheckpointsummary_list});var t="api/AtmTrnAuditCreation/GetAuditeeSummaryList";lockUI(),l.getparams(t,a).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()});var t="api/AtmTrnAuditorMaker/GetAuditorMakerViewOverallscore";lockUI(),l.getparams(t,a).then(function(t){e.txt_overallscore=t.data.overall_score,unlockUI()});var a={auditcreation_gid:A},t="api/AtmTrnAuditorMaker/AuditorMakerView";lockUI(),l.getparams(t,a).then(function(t){unlockUI(),e.makercheckpointobservation_list=t.data.makercheckpointobservationview_list,e.txttotal_score=t.data.total_score;for(var a=0;a<e.makercheckpointobservation_list.length;a++)e.makercheckpointobservation_list[a].checked=!0;angular.forEach(e.makercheckpointobservation_list,function(t,a){t.capture_score==t.yes_score?(t.yes_radio=!0,t.yes_radio1=!0):t.capture_score==t.no_score?(t.no_radio=!0,t.no_radio1=!0):t.capture_score==t.partial_score?(t.partialscore_radio=!0,t.partialscore_radio1=!0):t.capture_score==t.na_score?(t.nascore_radio=!0,t.nascore_radio1=!0):""==t.capture_score&&(e.allobservationfilled=!1)})}),f();var a={auditcreation_gid:A,sampleimport_gid:b}}function f(){var t={auditcreation_gid:A},a="api/AtmTrnSampling/GetSampleRaiseQueryDynamicdata";l.getparams(a,t).then(function(t){if(1==t.data.status){e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedqueryarray=e.SampleDynamicRaisedTabledata.filter(function(t){return"Y"===t.raisedquery_flag}),e.SampleraisedqueryTable=angular.copy(e.raisedqueryarray);for(i in e.SampleDynamicTabledata)delete e.SampleDynamicTabledata[i].raisedquery_flag,delete e.SampleDynamicTabledata[i].taguser_flag;for(i in e.raisedqueryarray)delete e.raisedqueryarray[i].sampleimport_gid,delete e.raisedqueryarray[i].raisedquery_flag;e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1),0==e.raisedqueryarray.length&&(e.raisedquerytable=!1)}else e.SampleDynamicTabledata="",e.raisedqueryarray="",e.showtablediv=!1,e.raisedquerytable=!1});var a="api/AtmTrnSampling/GetSampleDynamicdata";l.getparams(a,t).then(function(t){1==t.data.status?(e.SampleDynamicdata=JSON.parse(t.data.JSONdata),e.SampleDynamicTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicRaisedTabledata=angular.copy(e.SampleDynamicdata),e.SampleDynamicTabledata=e.SampleDynamicTabledata.filter(function(t){return"N"===t.raisedquery_flag}),e.SampleDynamicTable=angular.copy(e.SampleDynamicTabledata),e.raisedquerytable=!0,e.showtablediv=!0,0==e.SampleDynamicTabledata.length&&(e.showtablediv=!1)):(e.SampleDynamicTabledata="",e.showtablediv=!1,e.raisedquerytable=!1)})}var h=this;h.title="AtmTrnTaggedAuditeeViewController";var v=_.decryptURL(p.search().hash);e.auditcreation_gid=v.auditcreation_gid;var A=v.auditcreation_gid;e.checklistmaster_gid=v.checklistmaster_gid;var y=e.checklistmaster_gid;e.checklistmasteradd_gid=v.checklistmasteradd_gid,e.sampleimport_gid=v.sampleimport_gid;var b=e.sampleimport_gid;e.lspage=v.lspage;var U=e.lspage;k(),e.stripAddr=function(t){return t.replace("_"," ")},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),k(),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.checkall=function(t){angular.forEach(e.checkpointsummary_list,function(e){e.checked=t})},e.assignchecklist=function(){var t=[];if(angular.forEach(e.checkpointsummary_list,function(e){if(1==e.checked){var a=e.checklistmasteradd_gid;t.push(a);e.checklistmaster_gid}}),0==t.length)return d.alert("Select Atleast One Record!"),!1;var a={checklistmasteradd_gid:t,checklistmaster_gid:y},i="api/AtmTrnAuditCreation/PostChecklistAssign";l.post(i,a).then(function(t){1==t.data.status?(d.alert("Checklist Assigned Successfully!","success"),o.go("app.AtmTrnAuditCreationSummary")):d.alert("Select Atleast One..!!","warning")})},e.checkpointintent=function(t,e){function i(e,a){var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterIntent";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointintent=t.data.checkpoint_intent}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointintent.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.description=function(t,e){function i(e,a){angular.module("angle");var i={checklistmasteradd_gid:t};lockUI();var o="api/AtmMstChecklistMaster/GetChecklistMasterDescription";l.getparams(o,i).then(function(t){unlockUI(),e.txtcheckpointdescription=t.data.checkpoint_description}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/checkpointdescription.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.notetoauditor=function(t,e,i){function o(t,a){t.txtnotetoauditor=e,t.txtcheckpointdescription=i,t.ok=function(){a.close("closed")}}a.open({templateUrl:"/notetoauditor.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.showPopover=function(t,e){function i(e,a){var i={sampleimport_gid:t};lockUI();var o="api/AtmTrnSampling/GetEmployeeName";l.getparams(o,i).then(function(t){unlockUI(),e.employee_name=t.data.employee_name,e.sample_name=t.data.sample_name}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/showemployee.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.btntaguser=function(t,i,o){function n(t,e){var a={sampleimport_gid:r},o="api/AtmTrnSampling/AssignedTagUserSummary";l.getparams(o,a).then(function(e){t.SampleTagUserList=e.data.SampleAssignedQueryList});var o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.txtsample_name=e.data.sample_name}),t.ok=function(){e.close("closed")};var o="api/SystemMaster/GetEmployeelist";lockUI(),l.get(o).then(function(e){t.employee_list=e.data.employeelist,unlockUI()}),t.btnconfirm=function(){var a={employelist:t.cboemployee_name,sample_name:t.txtsample_name,sampleimport_gid:r,auditcreation_gid:i,description:t.txttaguser_desc},o="api/AtmTrnSampling/GetTagUser";lockUI(),l.post(o,a).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),k(),e.close("closed")}}var r="";if("Y"==o){var c=e.SampleraisedqueryTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}else{var c=e.SampleDynamicTable[t];c&&c.sampleimport_gid&&(r=c.sampleimport_gid)}a.open({templateUrl:"/taguser.html",controller:n,backdrop:"static",keyboard:!1,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.raisequery=function(t,e){function i(a,i){var o={sampleimport_gid:t},n="api/AtmTrnSampling/GetSampleName";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.txtsample_name=t.data.sample_name});var o={auditcreation_gid:e,sampleimport_gid:t},n="api/AtmTrnSampling/EditSampleQuery";l.getparams(n,o).then(function(t){a.sampleimport_gid=t.data.sampleimport_gid,a.auditcreation_gid=t.data.auditcreation_gid}),a.ok=function(){i.close("closed")},a.submit=function(){var t={sampleimport_gid:a.sampleimport_gid,sample_name:a.txtsample_name,description:a.txtdescription,auditcreation_gid:a.auditcreation_gid},e="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(e,t).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),p.url("app/AtmTrnTaggedAuditeeView?auditcreation_gid="+val+"&sampleimport_gid="+val1+"&taggeduser_gid="+val2+"&lspage=auditeemakertagged"),i.close("closed"),k()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),k(),i.close("closed")}}a.open({templateUrl:"/raisequery.html",controller:i,backdrop:"static",keyboard:!1,size:"md"});i.$inject=["$scope","$modalInstance"]},e.dynamicsample=function(t,i){function o(t,e){var a={sampleimport_gid:n},o="api/AtmTrnSampling/GetSampleName";l.getparams(o,a).then(function(e){t.sampleimport_gid=e.data.sampleimport_gid,t.txtsample_name=e.data.sample_name});var o="api/SystemMaster/GetEmployeelist";l.get(o).then(function(e){t.cboemployee_list=e.data.employeelist}),t.ok=function(){e.close("closed")},t.submit=function(){var a="",o="";t.cboqueryto&&(a=t.cboqueryto.employee_gid,o=t.cboqueryto.employee_name);var r={sampleimport_gid:n,description:t.txtquery_desc,auditcreation_gid:i,query_title:t.txtquery_title,query_to:a,query_toname:o},c="api/AtmTrnSampling/PostRaiseQuery";lockUI(),l.post(c,r).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})}),k(),e.close("closed")}}var n="",r=e.SampleDynamicTable[t];r&&r.sampleimport_gid&&(n=r.sampleimport_gid);a.open({templateUrl:"/raisequery.html",controller:o,backdrop:"static",keyboard:!1,size:"md"});o.$inject=["$scope","$modalInstance"]},e.dynamicsampledelete=function(t){var a="",i=e.SampleDynamicTable[t];i&&i.sampleimport_gid&&(a=i.sampleimport_gid);var o={sampleimport_gid:a},n="api/AtmTrnAuditCreation/GetDeleteSampleImport";lockUI(),l.getparams(n,o).then(function(t){unlockUI(),1==t.data.status?(d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),f()):d.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})},e.samplequery=function(t){var a=e.auditcreation_gid,i=e.checklistmaster_gid,o="",n=e.SampleraisedqueryTable[t];n&&n.sampleimport_gid&&(o=n.sampleimport_gid),p.url("app/AtmTrnSampleQueryAuditor?hash="+_.encryptURL("auditcreation_gid="+a+"&checklistmaster_gid="+i+"&sampleimport_gid="+o+"&lspage="+U))},e.Back=function(t){o.go("app.AtmTrnTaggedAuditeeSummary")},e.observationquery=function(t,e,i){function o(a,o){a.ok=function(){o.close("closed")};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmMstCheckpointGroup/GetChecklistToCheckpointcreate";lockUI(),l.getparams(r,n).then(function(t){unlockUI(),a.checklistcheckpoint_list=t.data.checklistcheckpoint_list;for(var e=0;e<a.checklistcheckpoint_list.length;e++)a.checklistcheckpoint_list[e].checked=!0;angular.forEach(a.checklistcheckpoint_list,function(t,e){"Yes"==t.overall_detail?t.document_radio=!0:"No"==t.overall_detail&&(t.tag_radio=!0)})}),a.checkpointobservation=function(){var e={checkpointgroupadd_gid:t,auditcreation_gid:i},a="api/AtmTrnAuditorMaker/PostCheckpointObservation";lockUI(),l.post(a,e).then(function(t){lockUI(),1==t.data.status?(unlockUI(),d.alert("Observation Checkpoint Saved Successfully!","success"),p.url("app/AtmTrnAuditorMakerView?auditcreation_gid="+i+"&lspage=auditormakerOpen")):(d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()),o.close("closed")})};var n={checkpointgroupadd_gid:t,auditcreation_gid:i},r="api/AtmTrnAuditorMaker/GetAuditorCheckpointFlag";lockUI(),l.getparams(r,n).then(function(t){a.checklistcheckpoint_flag=t.data.checklistcheckpoint_flag,unlockUI()}),a.ok=function(){o.close("closed")},a.onselected=function(t,i){a.document_verified=t,a.checklist2checkpoint=i;var o={auditcreation2checklist_gid:e,document_verified:a.document_verified,checklist2checkpoint:a.checklist2checkpoint},n="api/AtmTrnAuditorMaker/PostCheckpointAgainstObservation";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(a.txttotal_score=t.data.total_amount,d.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),k()):d.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}a.open({templateUrl:"/TagToDefferalEdit.html",controller:o,backdrop:"static",keyboard:!1,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.samplecheckerobservationscoreview=function(t,e,a,i){p.url("app/AtmTrnTaggedAuditeeObservationScoreView?hash="+_.encryptURL("auditcreation_gid="+t+"&checklistmaster_gid="+e+"&sampleimport_gid="+a+"&observationscoresample_gid="+i))},e.back=function(t){p.url("app/AtmTrnTaggedAuditeeView?auditcreation_gid="+A+"&sampleimport_gid=null&lspage=auditeemakeropen")},e.approvalinformation=function(t){function e(e,a){var i={checkpointgroupadd_gid:t},o="api/AtmMstCheckpointGroup/GetAuditeeCheckpointSummaryList";lockUI(),l.getparams(o,i).then(function(t){e.multipleauditee_list=t.data.multipleauditee_list,unlockUI()}),e.ok=function(){a.close("closed")}}a.open({templateUrl:"/Approvalinformation.html",controller:e,backdrop:"static",keyboard:!1,size:"lg"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("AtmTrnTaggedAuditeeViewController",t),t.$inject=["$rootScope","$scope","$modal","$state","AuthenticationService","SweetAlert","ScopeValueService","$http","SocketService","Notify","$location","apiManage","$route","ngTableParams","cmnfunctionService"]}();