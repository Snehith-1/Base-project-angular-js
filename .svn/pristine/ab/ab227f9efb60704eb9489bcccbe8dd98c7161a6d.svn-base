!function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){lockUI(),e.Allocated=localStorage.getItem("Allocated"),e.ZonalAllocationBack=localStorage.getItem("ZonalAllocationBack");var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},a="api/allocationManagement/getallocatedtls";l.getparams(a,t).then(function(t){e.state_name=t.data.state_name,e.district_name=t.data.district_name,e.assigned_RM=t.data.assigned_RM,e.customername=t.data.customername,e.customer_urn=t.data.customer_urn,e.ZonalRMname=t.data.ZonalRMname,e.customer_gid=t.data.customer_gid,e.zonal_name=t.data.zonal_name});var a="api/allocationManagement/getAllocationdocument";l.getparams(a,t).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length&&(e.upload_list=t.data.upload_list)});var a="api/allocationManagement/GetAllocationCustomerDtl";l.getparams(a,t).then(function(t){e.ppa_name=t.data.ppa_name,e.customerdetails=t.data,e.customerCollateral=t.data.collateraldtl,e.holdallocationlist=t.data.holdallocation,e.U2CMovedallocation=t.data.U2CMovedallocation,e.customerguarantorlist=t.data.Guarantorsdtl,e.customerPromotorlist=t.data.Promoterdtl,e.sanctiondetails=t.data.loandtl,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},o="api/allocationManagement/GetAllocateloanList";l.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var o={customer_gid:localStorage.getItem("allocation_customer_gid")},a="api/raiseLegalSR/GetDemandNoticedtl";l.getparams(a,o).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status});var a="api/visitReport/GetAllocationLogDetail";l.getparams(a,t).then(function(t){e.scheduleList=t.data.schedulelogdtl,e.calllogdtlList=t.data.calllogdtl});var a="api/customerManagement/EscrowSummary";l.getparams(a,o).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)}),unlockUI()}var f=this;f.title="allocation360controller",_(),e.allocationAllocate=function(){localStorage.setItem("PendingSummary","N"),localStorage.setItem("ZonalPendingSummary","N");var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid"),customer_gid:localStorage.getItem("allocation_customer_gid")},e="api/allocationManagement/getRMAllocationSubmit";l.post(e,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),"Y"==localStorage.getItem("ZonalAllocationBack")?a.go("app.allocationZonalRM"):a.go("app.caseAllocation")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.scheduleLoghistory=function(t){function e(e,a){var o={schedulelog_gid:t},n="api/visitReport/GetScheduleLogHistory";l.getparams(n,o).then(function(t){e.scheduleList=t.data.schedulelogdtl}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/SchedulehistoryModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.escrowInfoView=function(t){function e(e,a){var o={escrow_gid:t},n="api/customerManagement/EscrowView";l.getparams(n,o).then(function(t){e.escrowview=t.data}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.downloads=function(t,e){g.Downloaddocument(t,e)},e.cancel=function(){a.go("app.caseAllocation")},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var l=cmnfunctionService.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==l)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_type",e.txtdocument_type),n.append("project_flag","documentformatonly"),e.uploadfrm=n},e.documentUpload=function(){if(""==e.uploadfrm)return void alert("Document is not Available..!");var t="api/allocationManagement/AllocateUpload";l.postFile(t,e.uploadfrm).then(function(t){e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),e.txtdocument_type="",1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.documentuploadflag="Y"):(s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),e.documentuploadflag="N")})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/AllocateUploadcancel";l.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list,null==t.data.upload_list?e.documentuploadflag="N":e.documentuploadflag="Y"})},e.cancelupload=function(){e.uploadfrm="",e.txtdocument_type="",$("#addExternalupload").val("")},e.allocationSave=function(){localStorage.setItem("PendingSummary","Y");var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid"),customer_gid:localStorage.getItem("allocation_customer_gid"),allocationSubmit:"N"},e="api/allocationManagement/getRMAllocationSave";l.post(e,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),"Y"==localStorage.getItem("ZonalAllocationBack")?a.go("app.allocationZonalRM"):a.go("app.caseAllocation")):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})},e.allocationSubmit=function(){if("Y"!=e.documentuploadflag)return void alert("Atleast Upload One Document");localStorage.setItem("PendingSummary","N"),localStorage.setItem("ZonalPendingSummary","N");var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid"),customer_gid:localStorage.getItem("allocation_customer_gid"),allocationSubmit:"Y"},o="api/allocationManagement/getRMAllocationSave";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),"Y"==localStorage.getItem("ZonalAllocationBack")?a.go("app.allocationZonalRM"):a.go("app.caseAllocation")):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}angular.module("angle").controller("allocation360controller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){lockUI(),e.cbocustomergid=localStorage.getItem("allocation_customer_gid"),"Fresh"==localStorage.getItem("qualified_status")?e.div_visitinfo=!1:e.div_visitinfo=!0;var t="api/customer/customer";l.get(t).then(function(t){e.customer_list=t.data.customer_list});var a={customer_gid:localStorage.getItem("allocation_customer_gid")},t="api/allocationManagement/getcreateallocatedtls";l.getparams(t,a).then(function(t){e.customername=t.data.customername,e.zonal_gid=t.data.zonal_gid,e.zonal_name=t.data.zonal_name,e.state_gid=t.data.state_gid,e.state_name=t.data.state_name,e.district_gid=t.data.district_gid,e.district_name=t.data.district_name,e.ZonalRM_gid=t.data.ZonalRM_gid,e.ZonalRMname=t.data.ZonalRMname,e.assignedRM_gid=t.data.assignedRM_gid,e.allocateRMname=t.data.assigned_RM,e.customerlastvisitdtl=t.data.customerlastvisit});var t="api/customer/Getcustomerdetails";l.getparams(t,a).then(function(t){e.customerdetails=t.data});var t="api/customerManagement/Getsanctionloandetails";l.getparams(t,a).then(function(t){e.sanctiondetails=t.data.sanctionloanList,e.sanctionDocument=t.data.upload_list;null==t.data.upload_list?e.previstdocumentflag="N":e.previstdocumentflag="Y",angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid},o="api/customerManagement/GetloanListDetails";l.getparams(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var t="api/raiseLegalSR/GetDemandNoticedtl";l.getparams(t,a).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status});var t="api/customerManagement/getcustomerPromoter";l.getparams(t,a).then(function(t){e.ppa_name=t.data.PPAname,e.customerPromotorlist=t.data.customerPromoter});var t="api/customerManagement/getcustomerGuarantors";l.getparams(t,a).then(function(t){e.customerguarantorlist=t.data.customerGuarantors});var t="api/customerManagement/getCollateraldetail";l.getparams(t,a).then(function(t){e.customerCollateral=t.data.customerCollateral});var t="api/customerManagement/EscrowSummary";l.getparams(t,a).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)}),unlockUI()}var f=this;f.title="allocationCreatecontroller",_(),e.downloads=function(t,e){g.Downloaddocument(t,e)},e.escrowInfoView=function(t){function e(e,a){var o={escrow_gid:t},n="api/customerManagement/EscrowView";l.getparams(n,o).then(function(t){e.escrowview=t.data}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.onchangestate=function(t){lockUI();var a={state_gid:t},o="api/rmMapping/getdistrictdtls";l.getparams(o,a).then(function(t){e.districtdtl=t.data.statedtl}),unlockUI()},e.onchangedistrict=function(t){lockUI();var a={district_gid:t},o="api/allocationManagement/getallocateRM";l.getparams(o,a).then(function(t){console.log(t.data.assigned_RM),""==t.data.assigned_RM?(e.allocateRMname="",e.assignedRM_gid="",e.ZonalRM_gid="",e.ZonalRMname="",alert("RM is Not Mapping for the Selected District")):(e.allocateRMname=t.data.assigned_RM,e.assignedRM_gid=t.data.assignedRM_gid,e.ZonalRM_gid=t.data.ZonalRM_gid,e.ZonalRMname=t.data.ZonalRMname)}),unlockUI()},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var l=cmnfunctionService.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==l)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_type",e.txtdocument_type),n.append("project_flag","documentformatonly"),e.uploadfrm=n},e.documentUpload=function(){if(""==e.uploadfrm)return void alert("Document is not Available..!");var t="api/allocationManagement/AllocateUpload";l.postFile(t,e.uploadfrm).then(function(t){e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),e.txtdocument_type="",1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/AllocateUploadcancel";l.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list})},e.cancelupload=function(){e.uploadfrm="",e.txtdocument_type="",$("#addExternalupload").val("")},e.AllocationSubmit=function(){if("Y"==e.previstdocumentflag){var t={customer_gid:localStorage.getItem("allocation_customer_gid"),qualified_status:localStorage.getItem("qualified_status"),customername:e.customername,zonal_gid:e.zonal_gid,state_gid:e.state_gid,state_name:e.state_name,district_gid:e.district_gid,district_name:e.district_name,assignedRM_gid:e.assignedRM_gid,assigned_RM:e.allocateRMname,ZonalRM_gid:e.ZonalRM_gid,ZonalRMname:e.ZonalRMname,Manual_Allocation:"N"};lockUI();var o="api/allocationManagement/PostCreateAllocation";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.caseAllocation")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}else s.alert("Atleast Upload One Document to Allocate..!",{status:"danger",pos:"top-center",timeout:3e3})},e.cancel=function(){a.go("app.caseAllocation")}}angular.module("angle").controller("allocationCreatecontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){var t="api/allocationManagement/getCustomerAllocation";l.get(t).then(function(t){e.customerdtl=t.data.customerdtl}),e.complete=function(t){if(t.length>=3){e.message="";var a="api/customer/ExploreCustomer",o={customername:t};l.getparams(a,o).then(function(t){1==t.data.status?(e.message="",e.customer_list=t.data.Customers):e.message="No Records"})}else e.customer_list=null,e.message="Type atleast three character"},e.fillTextbox=function(t,a){console.log("string",a),e.customer=a,e.customer_gid=t,e.customer_list=null;var o={customer_gid:t},n="api/allocationManagement/GetRiskCustomerList";l.getparams(n,o).then(function(t){if(0==t.data.status)e.customer="",alert(t.data.message);else{var a="api/loan/customer_getheads";l.getparams(a,o).then(function(t){e.mdlheadsofcustomer=t.data,e.zonalHead=t.data.zonalGid,e.businessHead=t.data.businessHeadGid,e.clustermanager=t.data.clustermanagerGid,e.relationshipMgmt=t.data.relationshipMgmtGid,e.creditmgmt_name=t.data.creditmanager_gid,e.vertical_code=t.data.vertical_code,e.vertical_code=!0,e.sanctiondtl=t.data.sanctiondtl}),e.onchangecustomer=!0;var a="api/allocationManagement/getcreateallocatedtls";l.getparams(a,o).then(function(t){e.zonal_gid=t.data.zonal_gid,e.zonal_name=t.data.zonal_name,e.state_gid=t.data.state_gid,e.state_name=t.data.state_name,e.district_gid=t.data.district_gid,e.district_name=t.data.district_name,e.ZonalRM_gid=t.data.ZonalRM_gid,e.ZonalRMname=t.data.ZonalRMname,e.assignedRM_gid=t.data.assignedRM_gid,e.allocateRMname=t.data.assigned_RM,e.qualified_status=t.data.qualified_status,console.log(e.qualified_status)});var a="api/customer/Getcustomerdetails";l.getparams(a,o).then(function(t){e.customerdetails=t.data});var a="api/customerManagement/Getsanctionloandetails";l.getparams(a,o).then(function(t){e.sanctiondetails=t.data.sanctionloanList,e.sanctionDocument=t.data.upload_list;null==t.data.upload_list?e.previstdocumentflag="N":e.previstdocumentflag="Y",angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid},o="api/customerManagement/GetloanListDetails";l.getparams(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var a="api/raiseLegalSR/GetDemandNoticedtl";l.getparams(a,o).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status});var a="api/customerManagement/getcustomerPromoter";l.getparams(a,o).then(function(t){e.ppa_name=t.data.PPAname,e.customerPromotorlist=t.data.customerPromoter});var a="api/customerManagement/getcustomerGuarantors";l.getparams(a,o).then(function(t){e.customerguarantorlist=t.data.customerGuarantors});var a="api/customerManagement/EscrowSummary";l.getparams(a,o).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)});var a="api/customerManagement/getCollateraldetail";l.getparams(a,o).then(function(t){e.customerCollateral=t.data.customerCollateral})}})}}var g=this;g.title="allocationCreateDirect",p(),e.loandetails=function(t,e){var a={sanction_gid:t},o="api/customerManagement/GetloanListDetails";l.getparams(o,a).then(function(t){console.log(t.data.loanList)})},e.escrowInfoView=function(t){function e(e,a){var o={escrow_gid:t},n="api/customerManagement/EscrowView";l.getparams(n,o).then(function(t){e.escrowview=t.data}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.downloads=function(t,e){m.Downloaddocument(t,e)},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var l=cmnfunctionService.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==l)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_type",e.txtdocument_type),n.append("project_flag","documentformatonly"),e.uploadfrm=n},e.documentUpload=function(){if(""==e.uploadfrm)return void alert("Document is not Available..!");var t="api/allocationManagement/AllocateUpload";l.postFile(t,e.uploadfrm).then(function(t){console.log(t),e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),e.txtdocument_type="",1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/AllocateUploadcancel";l.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list})},e.cancelupload=function(){e.uploadfrm="",e.txtdocument_type="",$("#addExternalupload").val("")},e.cancel=function(){a.go("app.caseAllocation")},e.AllocationSubmit=function(){if("Y"==e.previstdocumentflag){var t={customer_gid:e.customer_gid,qualified_status:e.qualified_status,zonal_gid:e.zonal_gid,state_gid:e.state_gid,state_name:e.state_name,district_gid:e.district_gid,district_name:e.district_name,assignedRM_gid:e.assignedRM_gid,assigned_RM:e.allocateRMname,ZonalRM_gid:e.ZonalRM_gid,ZonalRMname:e.ZonalRMname,customername:e.customer,Manual_Allocation:"Y"};lockUI();var o="api/allocationManagement/PostCreateAllocation";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.caseAllocation")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}else s.alert("Atleast Upload One Document to Allocate..!",{status:"danger",pos:"top-center",timeout:3e3})}}angular.module("angle").controller("allocationCreateDirect",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g,_){function f(){lockUI(),e.MyZonalAllocationHistory=localStorage.getItem("MyZonalAllocationHistory");var t={customer_gid:localStorage.getItem("allocation_customer_gid")},o="api/allocationManagement/getAllocationHistory";l.getparams(o,t).then(function(t){return null==t.data.overallhistoryallocationdtl?("Y"==localStorage.getItem("MyZonalAllocationHistory")?a.go("app.allocationZonalRM"):a.go("app.caseAllocation"),void alert("No History for this selected Customer")):(e.allocationHistoryList=t.data.overallhistoryallocationdtl,e.customername=t.data.overallhistoryallocationdtl[0].customername,e.customer_urn=t.data.overallhistoryallocationdtl[0].customer_urn,void 0)}),unlockUI()}var v=this;v.title="allocationHistorycontroller",f(),e.ViewCancelReason=function(t,e,a,o){function n(n,i){n.customername=e,n.customer_urn=a;var r={allocationdtl_gid:t};if("Y"==o){var s="api/VisitReportCancel/GetExternalVisitCancelLog";l.getparams(s,r).then(function(t){n.visistreportcancel=t.data.visistreportcancel})}else{var s="api/VisitReportCancel/GetVisitCancelLog";l.getparams(s,r).then(function(t){n.visistreportcancel=t.data.visistreportcancel})}n.ok=function(){i.close("closed"),f()}}i.open({templateUrl:"/reportCancelModal.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.externalAssigned=function(t){function e(t,e){lockUI();var o="api/allocationManagement/getExternalDetails";l.getparams(o,a).then(function(e){t.customerdtl=e.data.customerdtl,t.externalname=e.data.externalname,t.AllocateExtRemarks=e.data.requested_remarks,t.assigned_by=e.data.assigned_by,t.assigned_date=e.data.assigned_date,t.target_date=e.data.target_date});var o="api/allocationManagement/getExternaldocument";l.getparams(o,a).then(function(e){t.upload_list=e.data.upload_list}),unlockUI(),t.ok=function(){e.close("closed")},t.close=function(){e.close("closed")},t.downloads=function(t,e){_.Downloaddocument(t,e)}}var a={allocationdtl_gid:t};i.open({templateUrl:"/AssignedExternal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.historyback=function(){"Y"==localStorage.getItem("MyZonalAllocationHistory")?a.go("app.allocationZonalRM"):a.go("app.caseAllocation")},e.observationviewreport=function(t,e){""!==e?(localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("observation_reportgid",e),c.url("app/ZRMObservationReportView?allocationdtl_gid="+t+"&?&observation_reportgid="+e)):s.alert("Observation Report  Not Found..!",{status:"warning",pos:"top-center",timeout:3e3})},e.generetePDF=function(t){lockUI();var e={allocationdtl_gid:t},a="api/zonalAllocation/visitReportpdfcontent";l.getparams(a,e).then(function(t){if(1==t.data.status){var e=t.data.file_path,a=t.data.file_name;_.Downloaddocument(e,a),unlockUI()}else unlockUI(),s.alert("Error Occurred While Export PDF !","warning")})},e.viewallocation=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),a.go("app.allocationHistoryView")},e.genereteATRPDF=function(t){if(""!==t){var e={observation_reportgid:t},a="api/ObservationReport/ATRReportpdfcontent";lockUI(),l.getparams(a,e).then(function(t){if(1==t.data.status){var e=t.data.file_path,a=t.data.file_name;_.Downloaddocument(e,a)}else unlockUI(),s.alert("Error Occurred While Export PDF !","warning");unlockUI()})}else s.alert("ATR PDF  Not Found..!",{status:"warning",pos:"top-center",timeout:3e3})}}angular.module("angle").controller("allocationHistorycontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$modal","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI();var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},a="api/allocationManagement/getallocatedtls";l.getparams(a,t).then(function(t){e.zonal_name=t.data.zonal_name,e.state_name=t.data.state_name,e.district_name=t.data.district_name,e.assigned_RM=t.data.assigned_RM,e.customername=t.data.customername,e.customer_urn=t.data.customer_urn,e.ZonalRMname=t.data.ZonalRMname,e.clientName=t.data.customername});var a="api/visitReport/GetAllocationLogDetail";l.getparams(a,t).then(function(t){e.scheduleList=t.data.schedulelogdtl,e.calllogdtlList=t.data.calllogdtl});var a="api/allocationManagement/GetAllocationCustomerDtl";l.getparams(a,t).then(function(t){e.customerdetails=t.data,e.sanctiondetails=t.data.loandtl,e.customerCollateral=t.data.collateraldtl,e.holdallocationlist=t.data.holdallocation,e.U2CMovedallocation=t.data.U2CMovedallocation,e.customerguarantorlist=t.data.Guarantorsdtl,e.customerPromotorlist=t.data.Promoterdtl,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},o="api/allocationManagement/GetAllocateloanList";l.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var a="api/customerManagement/HistoryEscrowSummary";l.getparams(a,t).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)});var a="api/allocationManagement/getAllocationdocument";l.getparams(a,t).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(e.upload_list=t.data.upload_list,e.documentUpload=!0):e.documentNotUpload=!0});var a="api/visitReport/getvisitreportdtl";l.getparams(a,t).then(function(t){if(e.visitreport_generateGid=t.data.visitreport_generateGid,e.customer_gid=t.data.customer_gid,e.txtbusiness_vintage=t.data.business_vintage,e.cbotypeof_loan=t.data.typeof_loanvertical,e.txtbusiness_sector=t.data.business_sector,e.txtregister_address=t.data.registeredoffice_address,e.cboriskcode=t.data.risk_code,e.txtactual_address=t.data.present_address,e.txtcontact_dtl1=t.data.contact_details1,e.txtcontact_dtl2=t.data.contact_details2,e.cborisk_reviewtype=t.data.typeof_riskreview,e.txtlattitude=t.data.visit_latitude,e.txtlongitude=t.data.visit_longitude,e.txtbusiness_client=t.data.clientbusiness_vintage,e.txtprimary_chain=t.data.primarysecondary_valuechain,e.cbogenetic_code=t.data.geneticcode_complied,e.cboRMD_gid=t.data.RMD_visitedGid,e.RMD_visitedname=t.data.RMD_visitedname,e.txtPPA_name=t.data.PPA_name,e.cbovisit_done=t.data.visit_done,e.txtpurposeof_loan=t.data.purpose_ofloan,e.txtrequestedloan_byclient=t.data.requestedamount_byclient,e.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,e.txtdisbursement_amount=t.data.disbursement_amount,e.txttotalloan_oustanding=t.data.totalloan_outstanding,e.cborepayment_track=t.data.repayment_track,e.cbobasic_records=t.data.basicrecords_maintain,e.txtturnover_lastfy=t.data.turnover_lastFY,e.txtpresent_fysales=t.data.presentFY_sales,e.txtdeferral_pendency=t.data.deferral_pendency,e.txtadditional_funding=t.data.adequacy_additionalfunding,e.txtcbototal_groups=t.data.total_noofGroups,e.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,e.txtRMDvisit_groupcount=t.data.RMD_visitgroups,e.txtassetverification_comment=t.data.assetverification_createdoutofloan,e.txtsecurity_details=t.data.assetverification_securitydtls,e.txtassetverification_mortagged=t.data.assetverification_mortgaged,e.txtROCcreation=t.data.assetverification_ROCcreation,e.txtbasicrecord_remarks=t.data.basicrecords_remarks,e.txtpurpose_funding=t.data.purposeof_funding,e.txt_utilisationdtls=t.data.utilisation_details,e.txtadequacyloan_samunnati=t.data.adequacy_loanamount,e.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,e.txtportfolio_noofmember=t.data.portfolio_noofmembers,e.txtportfolio_activemembers=t.data.portfolio_activemembers,e.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,e.txtportfolio_outstandingdate=t.data.outstanding_ondate,e.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,e.txtportfolio_overdueAmount=t.data.overdue_amount,e.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtrepayment_trackremarks=t.data.repayment_trackremarks,e.txtoverdue=t.data.overdue,e.txtborrower_commitment=t.data.borrower_commitment,e.txtpending_documentation=t.data.pending_documentation,e.txtbriefdtls_client=t.data.briefdtls_client,e.txtenduse_loan=t.data.enduse_loan,e.txtoverall_remarks=t.data.overall_remarks,e.txtPDD_compliance=t.data.PDD_compliance,e.txtbriefrpt_financials=t.data.briefrpt_financials,e.txtbriefrpt_process=t.data.briefrpt_process,e.txtbriefrpt_customer=t.data.briefrpt_customer,e.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,e.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,e.txtbriefrpt_learnings=t.data.briefrpt_learnings,e.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,e.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(e.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(e.constitution=t.data.constitution),null!=t.data.credit_managername&&(e.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var a=t.data.visit_date.split(/\D/g);e.visitdate=[a[2],a[1],a[0]].join("-")}if(null!=t.data.dealing_withsince){var a=t.data.dealing_withsince.split(/\D/g);e.txtincorporated_date=[a[2],a[1],a[0]].join("-")}if(null!=t.data.disbursement_date){var a=t.data.disbursement_date.split(/\D/g);e.txtdisbursement_date=[a[2],a[1],a[0]].join("-")}});var a="api/visitReport/getvisitReportDocument";l.getparams(a,t).then(function(t){e.visitreportdocument=t.data.visitreportdocument});var a="api/visitReport/getvisitReportPhoto";l.getparams(a,t).then(function(t){e.visitreportphoto=t.data.visitreportphoto,unlockUI()})}var _=this;_.title="allocationHistoryView",g(),e.escrowInfoView=function(t){function e(e,a){var o={escrow_gid:t},n="api/customerManagement/HistoryEscrowView";l.getparams(n,o).then(function(t){e.escrowview=t.data}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.scheduleLoghistory=function(t){function e(e,a){var o={schedulelog_gid:t},n="api/visitReport/GetScheduleLogHistory";l.getparams(n,o).then(function(t){e.scheduleList=t.data.schedulelogdtl}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/SchedulehistoryModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.downloads=function(t,e){p.Downloaddocument(t,e)}}angular.module("angle").controller("allocationHistoryView",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){var t="api/allocationManagement/getallocationSummary";l.get(t).then(function(t){e.allocationList=t.data.mappingdtl})}var _=this;_.title="allocationManagementcontroller",g(),e.createAllocation=function(){a.go("app.allocationCreate")},e.viewallocation=function(t,e){console.log(t,e),localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),a.go("app.allocationView")}}angular.module("angle").controller("allocationManagementcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){_=localStorage.getItem("page");var t="api/vertical/vertical";l.get(t).then(function(t){e.vertical_list=t.data.vertical_list});var t="api/zonalMapping/getzonalMappingdtl";l.get(t).then(function(t){e.zonalMappingList=t.data.zonalMapping});var t="api/employee/employee";l.get(t).then(function(t){e.employee_list=t.data.employee_list}),lockUI(),e.totalDisplayed=100;var t="api/allocationManagement/GetAllocationReport";l.get(t).then(function(t){e.allocationdtl_list=t.data.allocationdtl,unlockUI(),null==e.allocationdtl_list?(e.total=0,e.totalDisplayed=0):(e.total=e.allocationdtl_list.length,e.allocationdtl_list.length<100&&(e.totalDisplayed=e.allocationdtl_list.length))})}var g=this;g.title="allocationReport";var _;p(),e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.allocationdtl_list){if(!(t<e.allocationdtl_list.length))return unlockUI(),void s.alert(" Total Summary "+e.allocationdtl_list.length+" Records Only","warning");e.totalDisplayed+=a,e.allocationdtl_list.length<e.totalDisplayed&&(e.totalDisplayed=e.allocationdtl_list.length,s.alert(" Total Summary "+e.allocationdtl_list.length+" Records Only","warning")),unlockUI()}unlockUI()},e.complete=function(t){if(t.length>=3){e.message="";var a="api/customer/ExploreCustomer",o={customername:t};l.getparams(a,o).then(function(t){1==t.data.status?(e.message="",e.customer_list=t.data.Customers):e.message="No Records"})}else e.customer_list=null,e.message="Type atleast three character"},e.fillTextbox=function(t,a){e.customer=a,e.customer_gid=t,e.customer_list=null},e.search=function(){var t={customer_gid:e.customer_gid,zonalmapping_gid:e.zonalmapping_gid,zonalrisk_manager:e.zonalrisk_manager,risk_manager:e.risk_manager},a="api/allocationManagement/GetAllocationReportSummaryreport";lockUI(),l.post(a,t).then(function(t){unlockUI(),e.allocationdtl_list=t.data.allocationdtl})},e.refresh=function(){e.customer_gid="",e.customer="",e.zonalmapping_gid="",e.zonalrisk_manager="",e.risk_manager="",p()},e["export"]=function(){lockUI();var t="api/allocationManagement/GetAllocationReportExcel";l.get(t).then(function(t){1==t.data.status?(unlockUI(),m.Downloaddocument(t.data.excel_path,t.data.excel_name)):(unlockUI(),s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}))})},e.viewcustomerdtl=function(t,e){localStorage.setItem("allocationdtl_gid",t),
localStorage.setItem("tier1format_gid",e);var a=location.protocol+"//"+location.hostname+"/v1/#/app/tierCustomer360";window.open(a,"_blank")}}angular.module("angle").controller("allocationReport",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI(),e.totalDisplayed=100;var t="api/allocationTransfer/gettransferSummary";l.get(t).then(function(t){e.allocationtransferlist=t.data.allocationtransferdtl,e.count_OverallTransfer=t.data.count_OverallTransfer,e.count_pendingApproval=t.data.count_mypendingApproval,e.count_Approved=t.data.count_myApproved,e.count_rejected=t.data.count_myrejected,null==e.allocationtransferlist?(e.total=0,e.totalDisplayed=0):(e.total=e.allocationtransferlist.length,e.allocationtransferlist.length<100&&(e.totalDisplayed=e.allocationtransferlist.length)),unlockUI()})}var _=this;_.title="allocationTransfercontroller",g(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.initiateTransfer=function(){a.go("app.allocationTransferInitiate")},e.TransferAllocationView=function(t,e,o){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("allocation_transfergid",o),localStorage.setItem("MyApprovalPage","N"),a.go("app.transferApproval360")}}angular.module("angle").controller("allocationTransfercontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI(),e.totalDisplayed=100;var t="api/allocationTransfer/getallocateddetails";l.get(t).then(function(t){e.allocationlist=t.data.mappingdtl,null==e.allocationlist?(e.total=0,e.totalDisplayed=0):(e.total=e.allocationlist.length,e.allocationlist.length<100&&(e.totalDisplayed=e.allocationlist.length)),unlockUI()})}var _=this;_.title="allocationTransferInitiate",g(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.AllocationtransferRM=function(t,e){function o(o,n){lockUI();var r="api/newServiceTicket/employee";l.get(r).then(function(t){o.employee_list=t.data.employee_list});var r="api/allocationManagement/gettransferDetails";l.getparams(r,i).then(function(t){o.transferFrom=t.data.transferred_from,o.assignedRM_name=t.data.assignedRM_name,o.customerdtl=t.data.customerdtl,o.location=t.data.location,o.state_gid=t.data.state_gid,o.zonalRM_name=t.data.zonalRM_name,o.zonalRM_gid=t.data.zonalRM_gid,o.employee_assignedRM=t.data.assignedRM,o.zonal_gid=t.data.zonal_gid}),unlockUI(),o.ok=function(){n.close("closed")},o.WithinZone=function(t){var e={zonalmapping_gid:t},a="api/rmMapping/GetZonalStateDtls";l.getparams(a,e).then(function(t){o.statedtllist=t.data.statedtl}),o.zonalmapping_gid="",o.zonalrisk_managername="",o.crosszone_employeeGid="",o.withincrossstate_gid="",o.withincrossdistrict_gid="",o.withincrossstate_name="",o.withincrossdistrict_name="",o.CrossZone_employeename="",o.withinZonediv=!0,o.CrossZonediv=!1},o.withinStatechange=function(t){lockUI();var e={state_gid:t},a="api/allocationTransfer/getallocatedistritdtl";l.getparams(a,e).then(function(t){o.distrtictwithindtl=t.data.statedtl}),unlockUI()},o.crossStatechange=function(t){lockUI();var e={state_gid:t},a="api/allocationTransfer/getallocatedistritdtl";l.getparams(a,e).then(function(t){o.distrtictcrossdtl=t.data.statedtl,console.log(t)}),unlockUI()},o.withinDistrictchange=function(t){lockUI();var e={district_gid:t},a="api/allocationTransfer/getdistrictallocateRM";l.getparams(a,e).then(function(t){o.withinZone_employeeGid=t.data.assigned_RMGid,o.withinZone_employeename=t.data.assigned_RMname}),unlockUI()},o.CrossDistrictchange=function(t){lockUI();var e={district_gid:t},a="api/allocationTransfer/getdistrictallocateRM";l.getparams(a,e).then(function(t){o.crosszone_employeeGid=t.data.assigned_RMGid,o.CrossZone_employeename=t.data.assigned_RMname}),unlockUI()},o.CrossZone=function(t){lockUI();var e="api/zonalMapping/getzonaldtl";l.get(e).then(function(t){o.zonalMappinglist=t.data.zonalMapping}),o.withinZonediv=!1,o.CrossZonediv=!0,o.state_gid="",o.withinZone_employeeGid="",o.withinZone_employeename="",o.withincrossstate_gid="",o.withincrossdistrict_gid="",o.withincrossstate_name="",o.withincrossdistrict_name="",unlockUI()},o.zonalRMname=function(t){lockUI();var e={zonalmapping_gid:t},a="api/zonalMapping/getviewzonalmappingdtl";l.getparams(a,e).then(function(t){o.zonalrisk_managername=t.data.zonalrisk_managername,o.zonalrisk_managerGid=t.data.zonalrisk_managerGid,o.assignedcrossRMlist=t.data.assignedRMlist});var a="api/rmMapping/GetZonalStateDtls";l.getparams(a,e).then(function(t){o.statedtllist=t.data.statedtl}),unlockUI()},o.withzoneRMchange=function(t,e){lockUI();var a={assigned_RMGid:e},n="api/zonalMapping/getRMstatedistrict";l.getparams(n,a).then(function(t){return null==t.data.state_gid?void alert("State and district are not Mapping for the Selected RM"):(o.withincrossstate_gid=t.data.state_gid,o.withincrossdistrict_gid=t.data.district_gid,o.withincrossstate_name=t.data.state_name,o.withincrossdistrict_name=t.data.district_name,void 0)}),unlockUI()},o.submitAllocationtransfer=function(){if("WithinZone"==o.cbotransferstatus){var i=$("#withindistrict_name :selected").text(),r=o.withinZone_employeeGid,c=o.withinZone_employeename,d=o.zonal_gid;if(void 0==o.state_gid)return void alert("Select state");if(void 0==o.withinZone_employeeGid)return void alert("Select Transfer RM")}else{var r=o.crosszone_employeeGid,c=o.CrossZone_employeename,d=o.zonalmapping_gid,i=$("#crossdistrict_name :selected").text();if(void 0==o.zonalmapping_gid)return void alert("Select Zonal");if(void 0==o.crosszone_employeeGid)return void alert("Select Transfer RM")}lockUI();var u=$("#withincrossstate_name :selected").text(),m={allocationdtl_gid:t,customer_gid:e,transfer_from:o.transferFrom,transfer_to:r,transferto_name:c,transferFrom_zonalgid:o.zonal_gid,transferTo_zonalgid:d,transferto_stategid:o.withincrossstate_gid,transferto_statename:u,transferto_districtgid:o.withincrossdistrict_gid,transferto_districtname:i,zonal_approvalfrom:o.zonalRM_gid,zonal_approvalfromname:o.zonalRM_name,zonal_approvalto:o.zonalrisk_managerGid,zonal_approvaltoname:o.zonalrisk_managername,transfer_remarks:o.txttransferremarks,transfer_zonal:o.cbotransferstatus},p="api/allocationTransfer/posttransferAllcoation";l.post(p,m).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),a.go("app.allocationTransfer")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var i={allocationdtl_gid:t};n.open({templateUrl:"/AllocationRMTransfer.html",controller:o,size:"lg"});o.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("allocationTransferInitiate",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){lockUI();var t={allocationdtl_gid:h},a="api/allocationManagement/getallocatedtls";l.getparams(a,t).then(function(t){e.state_name=t.data.state_name,e.district_name=t.data.district_name,e.assigned_RM=t.data.assigned_RM,e.customername=t.data.customername,e.customer_urn=t.data.customer_urn,e.ZonalRMname=t.data.ZonalRMname,e.zonal_name=t.data.zonal_name});var a="api/visitReport/GetAllocationLogDetail";l.getparams(a,t).then(function(t){e.scheduleList=t.data.schedulelogdtl,e.calllogdtlList=t.data.calllogdtl});var o={customer_gid:y},a="api/raiseLegalSR/GetDemandNoticedtl";if(l.getparams(a,o).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status}),"Y"==v){var a="api/customerManagement/HistoryEscrowSummary";l.getparams(a,t).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary,e.historyescrow="Y")});var a="api/allocationManagement/getAllocationdocument";l.getparams(a,t).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(e.upload_list=t.data.upload_list,e.documentUpload=!0):e.documentNotUpload=!0})}else{var a="api/customerManagement/EscrowSummary";l.getparams(a,o).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)});var n={allocationdtl_gid:h,customer_gid:y},a="api/customerManagement/GetTrnSanctionDocumentUpload";l.getparams(a,n).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(e.upload_list=t.data.upload_list,e.documentUpload=!0):e.documentNotUpload=!0})}var a="api/allocationManagement/GetAllocationCustomerDtl";l.getparams(a,t).then(function(t){e.customerdetails=t.data,e.sanctiondetails=t.data.loandtl,e.customerCollateral=t.data.collateraldtl,e.holdallocationlist=t.data.holdallocation,e.U2CMovedallocation=t.data.U2CMovedallocation,e.customerguarantorlist=t.data.Guarantorsdtl,e.customerPromotorlist=t.data.Promoterdtl,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:h},o="api/allocationManagement/GetAllocateloanList";l.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})}),"Y"==b?e.MyAllocationView=!0:e.AllocationSummary=!0,unlockUI()}var f=this;f.title="allocationViewcontroller";var v=c.search().completed_flag,h=c.search().allocationdtl_gid,y=c.search().allocation_customer_gid,b=c.search().MyAllocation;_(),e.downloads=function(t,e){p.Downloaddocument(t,e)},e.escrowInfoView=function(t,e){function a(a,o){var n={escrow_gid:t};if("Y"==e){console.log("historyescrow ==");var i="api/customerManagement/HistoryEscrowView";l.getparams(i,n).then(function(t){a.escrowview=t.data})}else{var i="api/customerManagement/EscrowView";l.getparams(i,n).then(function(t){a.escrowview=t.data})}a.ok=function(){o.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},e.scheduleLoghistory=function(t){function e(e,a){var o={schedulelog_gid:t},n="api/visitReport/GetScheduleLogHistory";l.getparams(n,o).then(function(t){e.scheduleList=t.data.schedulelogdtl}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/SchedulehistoryModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var l=g.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==l)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_type",e.txtdocument_type),n.append("project_flag","documentformatonly"),e.uploadfrm=n},e.documentRMUpload=function(){if(void 0==e.uploadfrm)return void alert("Document is not Available..!");var t="api/allocationManagement/AllocateUpload";l.postFile(t,e.uploadfrm).then(function(t){e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),e.txtdocument_type="",1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.documentuploadflag="Y"):(s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),e.documentuploadflag="N")})},e.SubmitPrevisitRMdocument=function(){if("Y"==e.documentuploadflag){var t={allocationdtl_gid:h},o="api/visitReport/GetPreVisitRMUpload";l.getparams(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.go("app.rmVisitReport")):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}else s.alert("Atleast Upload One Document..!",{status:"info",pos:"top-center",timeout:3e3})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/AllocateUploadcancel";l.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list,null==t.data.upload_list?e.documentuploadflag="N":e.documentuploadflag="Y"})},e.cancelupload=function(){e.uploadfrm="",e.txtdocument_type="",$("#addExternalupload").val("")}}angular.module("angle").controller("allocationViewcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){lockUI(),e.cbocustomergid=localStorage.getItem("allocation_customer_gid");var t="api/customer/customer";l.get(t).then(function(t){e.customer_list=t.data.customer_list});var a={customer_gid:localStorage.getItem("allocation_customer_gid")},t="api/allocationManagement/getcreateallocatedtls";l.getparams(t,a).then(function(t){e.customername=t.data.customername,e.zonal_gid=t.data.zonal_gid,e.zonal_name=t.data.zonal_name,e.state_gid=t.data.state_gid,e.state_name=t.data.state_name,e.district_gid=t.data.district_gid,e.district_name=t.data.district_name,e.ZonalRM_gid=t.data.ZonalRM_gid,e.ZonalRMname=t.data.ZonalRMname,e.assignedRM_gid=t.data.assignedRM_gid,e.allocateRMname=t.data.assigned_RM,e.customerlastvisitdtl=t.data.customerlastvisit});var t="api/customer/Getcustomerdetails";l.getparams(t,a).then(function(t){e.customerdetails=t.data});var t="api/customerManagement/Getsanctionloandetails";l.getparams(t,a).then(function(t){e.sanctiondetails=t.data.sanctionloanList,e.sanctionDocument=t.data.upload_list;null==t.data.upload_list?e.previstdocumentflag="N":e.previstdocumentflag="Y",angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid},o="api/customerManagement/GetloanListDetails";l.getparams(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var t="api/raiseLegalSR/GetDemandNoticedtl";l.getparams(t,a).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status});var t="api/customerManagement/getcustomerPromoter";l.getparams(t,a).then(function(t){e.customerPromotorlist=t.data.customerPromoter});var t="api/customerManagement/getcustomerGuarantors";l.getparams(t,a).then(function(t){e.customerguarantorlist=t.data.customerGuarantors});var t="api/customerManagement/getCollateraldetail";l.getparams(t,a).then(function(t){e.customerCollateral=t.data.customerCollateral});var t="api/customerManagement/EscrowSummary";l.getparams(t,a).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)}),unlockUI()}var f=this;f.title="allocationZonalCreate",_(),e.escrowInfoView=function(t){function e(e,a){var o={escrow_gid:t},n="api/customerManagement/EscrowView";l.getparams(n,o).then(function(t){e.escrowview=t.data}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.onchangestate=function(t){lockUI();var a={state_gid:t},o="api/rmMapping/getdistrictdtls";l.getparams(o,a).then(function(t){e.districtdtl=t.data.statedtl}),unlockUI()},e.downloads=function(t,e){g.Downloaddocument(t,e)},e.onchangedistrict=function(t){lockUI();var a={district_gid:t},o="api/allocationManagement/getallocateRM";l.getparams(o,a).then(function(t){console.log(t.data.assigned_RM),""==t.data.assigned_RM?(e.allocateRMname="",e.assignedRM_gid="",e.ZonalRM_gid="",e.ZonalRMname="",alert("RM is Not Mapping for the Selected District")):(e.allocateRMname=t.data.assigned_RM,e.assignedRM_gid=t.data.assignedRM_gid,e.ZonalRM_gid=t.data.ZonalRM_gid,e.ZonalRMname=t.data.ZonalRMname)}),unlockUI()},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var l=cmnfunctionService.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==l)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_type",e.txtdocument_type),n.append("project_flag","documentformatonly"),e.uploadfrm=n},e.documentUpload=function(){if(""==e.uploadfrm)return void alert("Document is not Available..!");var t="api/allocationManagement/AllocateUpload";l.postFile(t,e.uploadfrm).then(function(t){console.log(t),e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),e.txtdocument_type="",1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/AllocateUploadcancel";l.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list})},e.cancelupload=function(){e.uploadfrm="",e.txtdocument_type="",$("#addExternalupload").val("")},e.AllocationSubmit=function(){if("Y"==e.previstdocumentflag){lockUI();var t={customer_gid:localStorage.getItem("allocation_customer_gid"),qualified_status:localStorage.getItem("qualified_status"),zonal_gid:e.zonal_gid,state_gid:e.state_gid,state_name:e.state_name,district_gid:e.district_gid,district_name:e.district_name,assignedRM_gid:e.assignedRM_gid,assigned_RM:e.allocateRMname,ZonalRM_gid:e.ZonalRM_gid,ZonalRMname:e.ZonalRMname},o="api/allocationManagement/PostCreateAllocation";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.allocationZonalRM")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}else s.alert("Atleast Upload One Document to Allocate..!",{status:"danger",pos:"top-center",timeout:3e3})},e.cancel=function(){a.go("app.allocationZonalRM")}}angular.module("angle").controller("allocationZonalCreate",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){var t="api/zonalAllocation/getZonalCustomerAllocation";l.get(t).then(function(t){e.customerdtl=t.data.customerdtl}),e.complete=function(t){if(t.length>=3){e.message="";var a="api/customer/ExploreCustomer",o={customername:t};l.getparams(a,o).then(function(t){1==t.data.status?(e.message="",e.customer_list=t.data.Customers):e.message="No Records"})}else e.customer_list=null,e.message="Type atleast three character"},e.fillTextbox=function(t,a){console.log("string",a),e.customer=a,e.customer_gid=t,e.customer_list=null;var o={customer_gid:t},n="api/loan/customer_getheads";l.getparams(n,o).then(function(t){e.mdlheadsofcustomer=t.data,e.zonalHead=t.data.zonalGid,e.businessHead=t.data.businessHeadGid,e.clustermanager=t.data.clustermanagerGid,e.relationshipMgmt=t.data.relationshipMgmtGid,e.creditmgmt_name=t.data.creditmanager_gid,e.vertical_code=t.data.vertical_code,e.vertical_code=!0,e.sanctiondtl=t.data.sanctiondtl}),e.onchangecustomer=!0;var n="api/allocationManagement/getcreateallocatedtls";l.getparams(n,o).then(function(t){e.zonal_gid=t.data.zonal_gid,e.zonal_name=t.data.zonal_name,e.state_gid=t.data.state_gid,e.state_name=t.data.state_name,e.district_gid=t.data.district_gid,e.district_name=t.data.district_name,e.ZonalRM_gid=t.data.ZonalRM_gid,e.ZonalRMname=t.data.ZonalRMname,e.assignedRM_gid=t.data.assignedRM_gid,e.allocateRMname=t.data.assigned_RM,e.qualified_status=t.data.qualified_status,console.log(e.qualified_status)});var n="api/customer/Getcustomerdetails";l.getparams(n,o).then(function(t){e.customerdetails=t.data});var n="api/customerManagement/Getsanctionloandetails";l.getparams(n,o).then(function(t){e.sanctiondetails=t.data.sanctionloanList,e.sanctionDocument=t.data.upload_list;null==t.data.upload_list?e.previstdocumentflag="N":e.previstdocumentflag="Y",angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid},o="api/customerManagement/GetloanListDetails";l.getparams(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var n="api/raiseLegalSR/GetDemandNoticedtl";l.getparams(n,o).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status});var n="api/customerManagement/getcustomerPromoter";l.getparams(n,o).then(function(t){e.ppa_name=t.data.PPAname,e.customerPromotorlist=t.data.customerPromoter});var n="api/customerManagement/getcustomerGuarantors";l.getparams(n,o).then(function(t){e.customerguarantorlist=t.data.customerGuarantors});var n="api/customerManagement/EscrowSummary";l.getparams(n,o).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)});var n="api/customerManagement/getCollateraldetail";l.getparams(n,o).then(function(t){e.customerCollateral=t.data.customerCollateral})}}var g=this;g.title="allocationZonalCreateDirect",p(),e.loandetails=function(t,e){var a={sanction_gid:t},o="api/customerManagement/GetloanListDetails";l.getparams(o,a).then(function(t){console.log(t.data.loanList)})},e.escrowInfoView=function(t){function e(e,a){var o={escrow_gid:t},n="api/customerManagement/EscrowView";l.getparams(n,o).then(function(t){e.escrowview=t.data}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.downloads=function(t,e){m.Downloaddocument(t,e)},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var l=cmnfunctionService.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==l)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_type",e.txtdocument_type),n.append("project_flag","documentformatonly"),e.uploadfrm=n},e.documentUpload=function(){if(""==e.uploadfrm)return void alert("Document is not Available..!");var t="api/allocationManagement/AllocateUpload";l.postFile(t,e.uploadfrm).then(function(t){console.log(t),e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),e.txtdocument_type="",1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/AllocateUploadcancel";l.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list})},e.cancelupload=function(){e.uploadfrm="",e.txtdocument_type="",$("#addExternalupload").val("")},e.cancel=function(){a.go("app.allocationZonalRM")},e.AllocationSubmit=function(){if("Y"==e.previstdocumentflag){var t={customer_gid:e.customer_gid,qualified_status:e.qualified_status,zonal_gid:e.zonal_gid,state_gid:e.state_gid,state_name:e.state_name,district_gid:e.district_gid,district_name:e.district_name,assignedRM_gid:e.assignedRM_gid,assigned_RM:e.allocateRMname,ZonalRM_gid:e.ZonalRM_gid,ZonalRMname:e.ZonalRMname},o="api/allocationManagement/PostCreateAllocation";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.allocationZonalRM")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}else s.alert("Atleast Upload One Document to Allocate..!",{status:"danger",pos:"top-center",timeout:3e3})}}angular.module("angle").controller("allocationZonalCreateDirect",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){e.cboQualifiedStatus="Fresh",lockUI(),localStorage.setItem("RSK_RM","N"),localStorage.setItem("CC","N"),localStorage.setItem("AgrCC","N"),localStorage.setItem("AgrSuprCC","N");var t="api/zonalAllocation/GetZonalAllocationLogDetail";l.get(t).then(function(t){e.todayactivity=t.data.todayactivity,e.zonalpendingcount=t.data.zonalallocationcount,e.zonal_name=t.data.zonal_name,e.monthlyactivity=t.data.monthlyactivity,e.count_currentallo=t.data.count_current,e.count_upcoming=t.data.count_upcoming,e.count_completedallo=t.data.count_completed,e.count_external=t.data.count_external,e.count_breached=t.data.count_breached,e.count_reportcancel=t.data.count_reportchanges,e.count_qualified=t.data.count_qualified,e.ADM_updatedby=t.data.ADM_updatedby,e.ADM_updateddate=t.data.ADM_updateddate,unlockUI()})}var _=this;_.title="allocationZonalRMcontroller",g(),e.Fresh=function(){lockUI(),e.totalQualifiedDisplayed=100;var t="api/zonalAllocation/GetZoanlFreshAllocation";l.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.ReVisit=function(){lockUI(),e.totalQualifiedDisplayed=100;var t="api/zonalAllocation/GetZonalReVisitAllocation";l.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.allcase=function(){lockUI(),e.totalQualifiedDisplayed=100;var t="api/zonalAllocation/GetZonalQualifiedAllocation";l.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.qualified=function(){lockUI(),e.totalQualifiedDisplayed=100;var t="api/zonalAllocation/GetZoanlFreshAllocation";l.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.loadQualifiedMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.qualifiedallocationList){if(!(e.totalQualifiedDisplayed<e.qualifiedallocationList.length))return unlockUI(),void s.alert(" Total Summary "+e.qualifiedallocationList.length+" Records Only","warning");e.totalQualifiedDisplayed+=a,unlockUI()}},e.current=function(){lockUI(),e.totalCurrentDisplayed=100;var t="api/zonalAllocation/GetZonalCurrentAllocation";l.get(t).then(function(t){e.count_currentallo=t.data.count_currentallo,e.currentallocationList=t.data.allocationdtl,null==e.currentallocationList?(e.totalCurrent=0,e.totalCurrentDisplayed=0):(e.totalCurrent=e.currentallocationList.length,e.currentallocationList.length<100&&(e.totalCurrentDisplayed=e.currentallocationList.length)),unlockUI()})},e.loadCurrentMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalCurrentDisplayed<e.currentallocationList.length?(e.totalCurrentDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.currentallocationList.length+" Records Only","warning"))},e.upcoming=function(){lockUI(),e.totalUpcomingDisplayed=100;var t="api/zonalAllocation/GetZonalUpcomingAllocation";l.get(t).then(function(t){e.count_upcoming=t.data.count_upcoming,e.upcomingallocationList=t.data.allocationdtl,null==e.upcomingallocationList?(e.totalUpcoming=0,e.totalUpcomingDisplayed=0):(e.totalUpcoming=e.upcomingallocationList.length,e.upcomingallocationList.length<100&&(e.totalUpcomingDisplayed=e.upcomingallocationList.length)),unlockUI()})},e.movetocurrentallocation=function(t,e,o){function r(n,r){n.ok=function(){r.close("closed")},n.customer_urn=e,n.customername=o,n.confirmmoveAllocation=function(){var e={allocationdtl_gid:t,allocationmove_reason:n.txtmove_reason},o="api/allocationManagement/GetMovetoCurrentAllocation";l.getparams(o,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),r.close("closed"),n.current=a.current.name,i.store("dataldCtrl",n),a.go("app.pageredirect")):(s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),r.close("closed"))})}}n.open({templateUrl:"/movetocurrentallocationpopup.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},e.loadUpcomingMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalUpcomingDisplayed<e.upcomingallocationList.length?(e.totalUpcomingDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.upcomingallocationList.length+" Records Only","warning"))},e.breached=function(){lockUI(),e.totalBreachedDisplayed=100;var t="api/zonalAllocation/GetZonalBreachedAllocation";l.get(t).then(function(t){e.count_breached=t.data.count_breached,e.breachedallocationList=t.data.breacheddtl,null==e.breachedallocationList?(e.totalBreached=0,e.totalBreachedDisplayed=0):(e.totalBreached=e.breachedallocationList.length,e.breachedallocationList.length<100&&(e.totalBreachedDisplayed=e.breachedallocationList.length)),unlockUI()})},e.loadBreachedMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.breachedallocationList){if(!(e.totalBreachedDisplayed<e.breachedallocationList.length))return unlockUI(),void s.alert(" Total Summary "+e.breachedallocationList.length+" Records Only","warning");e.totalBreachedDisplayed+=a,unlockUI()}unlockUI()},e.completed=function(){lockUI(),e.totalCompletedDisplayed=100;var t="api/zonalAllocation/GetZonalcompletedAlloSummary";l.get(t).then(function(t){e.count_completedallo=t.data.count_completedallo,e.completedallocationList=t.data.allocationdtl,null==e.completedallocationList?(e.totalCompleted=0,e.totalCompletedDisplayed=0):(e.totalCompleted=e.completedallocationList.length,e.completedallocationList.length<100&&(e.totalCompletedDisplayed=e.completedallocationList.length)),unlockUI()})},e.loadCompletedMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalCompletedDisplayed<e.completedallocationList.length?(e.totalCompletedDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.completedallocationList.length+" Records Only","warning"))},e.external=function(){lockUI(),e.totalExternalDisplayed=100;var t="api/zonalAllocation/GetZonalExternalAllocation";l.get(t).then(function(t){e.count_external=t.data.count_external,e.externalallocationList=t.data.allocationdtl,console.log(e.externalallocationList),null==e.externalallocationList?(e.totalExternal=0,
e.totalExternalDisplayed=0):(e.totalExternal=e.externalallocationList.length,e.externalallocationList.length<100&&(e.totalExternalDisplayed=e.externalallocationList.length)),unlockUI()})},e.loadExternalMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.externalallocationList){if(!(e.totalExternalDisplayed<e.externalallocationList.length))return unlockUI(),void s.alert(" Total Summary "+e.externalallocationList.length+" Records Only","warning");e.totalExternalDisplayed+=a,unlockUI()}unlockUI()},e.reportcancel=function(){lockUI(),e.totalReportDisplayed=100;var t="api/zonalAllocation/GetVisitCancelChanges";l.get(t).then(function(t){e.count_reportcancel=t.data.count_reportcancel,e.reportcancelList=t.data.allocationdtl,null==e.reportcancelList?(e.totalReport=0,e.totalReportDisplayed=0):(e.totalReport=e.reportcancelList.length,e.reportcancelList.length<100&&(e.totalReportDisplayed=e.reportcancelList.length)),unlockUI()})},e.loadReportMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.reportcancelList){if(!(e.totalReportDisplayed<e.reportcancelList.length))return unlockUI(),void s.alert(" Total Summary "+e.reportcancelList.length+" Records Only","warning");e.totalReportDisplayed+=a,unlockUI()}unlockUI()},e.all=function(){e.cboQualifiedStatus=void 0},e.holdAllocation=function(t,e,o){function r(n,r){n.ok=function(){r.close("closed")},n.customer_urn=e,n.customername=o,n.confirmHoldAllocation=function(){var e={allocationdtl_gid:t,allocationhold_reason:n.txthold_reason},o="api/allocationManagement/GetHoldAllocation";l.getparams(o,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),r.close("closed"),n.current=a.current.name,i.store("dataldCtrl",n),a.go("app.pageredirect")):(s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),r.close("closed"))})}}n.open({templateUrl:"/holdAllocationpopup.html",controller:r,size:"md"});r.$inject=["$scope","$modalInstance"]},e.exclusioncustomer=function(t,e,o){function r(n,r){n.ok=function(){r.close("closed")},n.customer_urn=t,n.customername=e,n.customer_status=o;var c={customer_urn:t},d="api/zonalAllocation/GetExclusionCustomerHistory";l.getparams(d,c).then(function(t){n.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?n.Nohistoryexclusion=!0:n.historyexclusion=!0}),n.confirmExclusioncustomer=function(){var e={customer_urn:t,exclusion_reason:n.txtexclusion_reason},o="api/zonalAllocation/GetExclusionCustomer";l.getparams(o,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),r.close("closed"),n.current=a.current.name,i.store("dataldCtrl",n),a.go("app.pageredirect")):(s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),r.close("closed"))})}}n.open({templateUrl:"/exclusionpopup.html",controller:r,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.createDirectAllocation=function(){var t="api/allocationManagement/tmpAllocatedocumentclear";l.get(t).then(function(t){}),a.go("app.allocationZonalCreateDirect")},e.historyallocation=function(t){localStorage.setItem("MyZonalAllocationHistory","Y"),localStorage.setItem("allocation_customer_gid",t),a.go("app.allocationHistorydetails")},e.viewZonalallocation=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),a.go("app.zonalAllocation360")},e.viewallocation=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("ZonalAllocationBack","Y"),localStorage.setItem("MyAllocation","N"),localStorage.setItem("Allocated","N"),a.go("app.zonalAllocation360")},e.viewallocateddetails=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("ZonalAllocationBack","Y"),localStorage.setItem("MyAllocation","N"),localStorage.setItem("Allocated","Y"),a.go("app.zonalAllocation360")},e.exteralAllocate=function(t){function e(e,n){lockUI();var r="api/allocationManagement/tmpExternaldocumentclear";l.get(r).then(function(t){});var r="api/allocationManagement/getExternalNamelist";l.get(r).then(function(t){e.externaldtl=t.data.externaldtl});var r="api/allocationManagement/gettransferDetails";l.getparams(r,o).then(function(t){e.customerdtl=t.data.customerdtl}),unlockUI(),e.ok=function(){n.close("closed")},e.close=function(){n.close("closed")},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=p.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("project_flag","documentformatonly"),e.uploadfrm=n;var d="api/allocationManagement/ExternalUpload";l.postFile(d,e.uploadfrm).then(function(t){console.log(t),e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/ExternalUploadcancel";l.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list})},e.submitAllocateExternal=function(){lockUI();var o=new Date;o.setFullYear(e.targetdate.getFullYear()),o.setMonth(e.targetdate.getMonth()),o.setDate(e.targetdate.getDate());var r={allocationdtl_gid:t,external_usergid:e.external_usergid,external_allocateRemarks:e.AllocationExtRemarks,target_date:o},c="api/allocationManagement/postAllocationExternal";l.post(c,r).then(function(t){1==t.data.status?(e.AllocationExtRemarks="",s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),e.current=a.current.name,i.store("dataldCtrl",e),a.go("app.pageredirect")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var o={allocationdtl_gid:t};n.open({templateUrl:"/AllocateExternal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.externalAssigned=function(t){function e(t,e){lockUI();var o="api/allocationManagement/getExternalDetails";l.getparams(o,a).then(function(e){t.customerdtl=e.data.customerdtl,t.externalname=e.data.externalname,t.AllocateExtRemarks=e.data.requested_remarks,t.assigned_by=e.data.assigned_by,t.assigned_date=e.data.assigned_date,t.target_date=e.data.target_date});var o="api/allocationManagement/getExternaldocument";l.getparams(o,a).then(function(e){t.upload_list=e.data.upload_list}),unlockUI(),t.ok=function(){e.close("closed")},t.close=function(){e.close("closed")},t.downloads=function(t,e){m.Downloaddocument(t,e)}}var a={allocationdtl_gid:t};n.open({templateUrl:"/AssignedExternal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createAllocation=function(t,e){var o={customer_urn:t};lockUI();var i="api/allocationManagement/GetCustomerGid";l.getparams(i,o).then(function(t){function o(t,e){t.ok=function(){e.close("closed")}}if(1==t.data.status)localStorage.setItem("allocation_customer_gid",t.data.customer_gid),localStorage.setItem("qualified_status",e),a.go("app.allocationZonalCreate"),unlockUI();else{unlockUI();n.open({templateUrl:"/warningpopup.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]}})},e.generetePDF=function(t){lockUI();var e={allocationdtl_gid:t},a="api/zonalAllocation/visitReportpdfcontent";l.getparams(a,e).then(function(t){if(1==t.data.status){var e=(t.data.relpath1,t.data.file_name);m.Downloaddocument(relpath1,e)}else unlockUI(),s.alert("Error Occurred While Export PDF !","warning");unlockUI()})}}angular.module("angle").controller("allocationZonalRMcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g,_,f,v){function h(){lockUI();var t="api/allocationManagement/GetOverallZonalPendingCount";s.get(t).then(function(t){e.count_qualified=t.data.count_qualified,e.count_currentallo=t.data.count_current,e.count_upcoming=t.data.count_upcoming,e.count_completedallo=t.data.count_completed,e.count_external=t.data.count_external,e.count_breached=t.data.count_breached,e.ADM_updatedby=t.data.ADM_updatedby,e.ADM_updateddate=t.data.ADM_updateddate,e.count_reportcancel=t.data.count_reportchanges,e.count_unmatchedqualified="500";var a=parseInt(t.data.count_qualified),o=parseInt(e.count_unmatchedqualified);e.count_overall=a+o,e.overallzonalcountdtl=t.data.overallzonalcount,angular.forEach(e.overallzonalcountdtl,function(t,e){var a={zonalmapping_gid:t.zonalmapping_gid},o="api/allocationManagement/GetAllocationPendingCount";s.getparams(o,a).then(function(e){t.zonalwisecountdtl=e.data.zonalwisecount,t.expand=!1})}),unlockUI()})}var y=this;y.title="caseAllocation",h(),e.showPopover=function(t){var a={assigned_RM:t},o="api/RskDashboard/GetRMAllocateCountdtl";s.getparams(o,a).then(function(t){1==t.data.status?e.customerstatusdtl=t.data.customerstatusdtl:(e.customerstatusdtl="No Record",console.log("NO",e.customerstatusdtl),$("[data-toggle=popover]").popover({html:!1,content:function(){return $("#popover-content").html()}}))})},e.Fresh=function(){lockUI(),e.totalQualifiedDisplayed=100,e.cboQualifiedStatus="Fresh";var t="api/allocationManagement/GetQualifiedFreshAllocation";s.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.Revisit=function(){lockUI(),e.totalQualifiedDisplayed=100;var t="api/allocationManagement/GetQualifiedReVisitAllocation";s.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.all=function(){lockUI(),e.totalQualifiedDisplayed=100;var t="api/allocationManagement/GetQualifiedAllocationSummary";s.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.loadQualifiedMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.qualifiedallocationList){if(!(e.totalQualifiedDisplayed<e.qualifiedallocationList.length))return unlockUI(),void c.alert(" Total Summary "+e.qualifiedallocationList.length+" Records Only","warning");e.totalQualifiedDisplayed+=a,unlockUI()}},e.allunmatch=function(){lockUI(),e.cbounmatchStatus=void 0,unlockUI()},e.unmatchedqualified=function(){lockUI(),e.totalUnmatchedDisplayed=100;var t="api/allocationManagement/GetQualifiedUnmatched";s.get(t).then(function(t){e.count_unmatchedqualified=t.data.count_unmatchedqualified,e.unmatchedallocationList=t.data.qualifiedallocation,null==e.unmatchedallocationList?(e.totalUnmatched=0,e.totalUnmatchedDisplayed=0):(e.totalUnmatched=e.unmatchedallocationList.length,e.unmatchedallocationList.length<100&&(e.totalUnmatchedDisplayed=e.unmatchedallocationList.length)),unlockUI()})},e.movetocurrentallocation=function(t,e,a){function n(n,i){n.ok=function(){i.close("closed")},n.customer_urn=e,n.customername=a,n.confirmmoveAllocation=function(){var e={allocationdtl_gid:t,allocationmove_reason:n.txtmove_reason},a="api/allocationManagement/GetMovetoCurrentAllocation";s.getparams(a,e).then(function(t){1==t.data.status?(c.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),n.current=o.current.name,r.store("dataldCtrl",n),o.go("app.pageredirect")):(c.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),i.close("closed"))})}}i.open({templateUrl:"/movetocurrentallocationpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},e.loadUnmatchedMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalUnmatchedDisplayed<e.unmatchedallocationList.length?(e.totalUnmatchedDisplayed+=a,void unlockUI()):(unlockUI(),void c.alert(" Total Summary "+e.unmatchedallocationList.length+" Records Only","warning"))},e.qualified=function(){lockUI(),e.totalQualifiedDisplayed=100;var t="api/allocationManagement/GetQualifiedFreshAllocation";s.get(t).then(function(t){e.qualifiedallocationList=t.data.qualifiedallocation,null==e.qualifiedallocationList?(e.totalQualified=0,e.totalQualifiedDisplayed=0):(e.totalQualified=e.qualifiedallocationList.length,e.qualifiedallocationList.length<100&&(e.totalQualifiedDisplayed=e.qualifiedallocationList.length)),unlockUI()})},e.current=function(){lockUI(),e.totalCurrentDisplayed=100;var t="api/allocationManagement/GetCurrentAllocateSummary";s.get(t).then(function(t){e.count_currentallo=t.data.count_currentallo,e.currentallocationList=t.data.allocationdtl,null==e.currentallocationList?(e.totalCurrent=0,e.totalCurrentDisplayed=0):(e.totalCurrent=e.currentallocationList.length,e.currentallocationList.length<100&&(e.totalCurrentDisplayed=e.currentallocationList.length)),unlockUI()})},e.loadCurrentMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalCurrentDisplayed<e.currentallocationList.length?(e.totalCurrentDisplayed+=a,void unlockUI()):(unlockUI(),void c.alert(" Total Summary "+e.currentallocationList.length+" Records Only","warning"))},e.upcoming=function(){lockUI(),e.totalUpcomingDisplayed=100;var t="api/allocationManagement/GetUpcomingAllocation";s.get(t).then(function(t){e.count_upcoming=t.data.count_upcoming,e.upcomingallocationList=t.data.allocationdtl,null==e.upcomingallocationList?(e.totalUpcoming=0,e.totalUpcomingDisplayed=0):(e.totalUpcoming=e.upcomingallocationList.length,e.upcomingallocationList.length<100&&(e.totalUpcomingDisplayed=e.upcomingallocationList.length)),unlockUI()})},e.loadUpcomingMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalUpcomingDisplayed<e.upcomingallocationList.length?(e.totalUpcomingDisplayed+=a,void unlockUI()):(unlockUI(),void c.alert(" Total Summary "+e.upcomingallocationList.length+" Records Only","warning"))},e.breached=function(){lockUI(),e.totalBreachedDisplayed=100;var t="api/allocationManagement/GetBreachedAllocationSummary";s.get(t).then(function(t){e.count_breached=t.data.count_breached,e.breachedallocationList=t.data.breacheddtl,null==e.breachedallocationList?(e.totalBreached=0,e.totalBreachedDisplayed=0):(e.totalBreached=e.breachedallocationList.length,e.breachedallocationList.length<100&&(e.totalBreachedDisplayed=e.breachedallocationList.length)),unlockUI()})},e.loadBreachedMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.breachedallocationList){if(!(e.totalBreachedDisplayed<e.breachedallocationList.length))return unlockUI(),void c.alert(" Total Summary "+e.breachedallocationList.length+" Records Only","warning");e.totalBreachedDisplayed+=a,unlockUI()}unlockUI()},e.completed=function(){lockUI(),e.totalCompletedDisplayed=100;var t="api/allocationManagement/getcompletedAllocationSummary";s.get(t).then(function(t){e.count_completedallo=t.data.count_completedallo,e.completedallocationList=t.data.allocationdtl,null==e.completedallocationList?(e.totalCompleted=0,e.totalCompletedDisplayed=0):(e.totalCompleted=e.completedallocationList.length,e.completedallocationList.length<100&&(e.totalCompletedDisplayed=e.completedallocationList.length)),unlockUI()})},e.loadCompletedMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalCompletedDisplayed<e.completedallocationList.length?(e.totalCompletedDisplayed+=a,void unlockUI()):(unlockUI(),void c.alert(" Total Summary "+e.completedallocationList.length+" Records Only","warning"))},e.external=function(){lockUI(),e.totalExternalDisplayed=100;var t="api/allocationManagement/getExternalAllocationSummary";s.get(t).then(function(t){e.count_external=t.data.count_external,e.externalallocationList=t.data.allocationdtl,null==e.externalallocationList?(e.totalExternal=0,e.totalExternalDisplayed=0):(e.totalExternal=e.externalallocationList.length,e.externalallocationList.length<100&&(e.totalExternalDisplayed=e.externalallocationList.length)),unlockUI()})},e.loadExternalMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalExternalDisplayed<e.externalallocationList.length?(e.totalExternalDisplayed+=a,void unlockUI()):(unlockUI(),void c.alert(" Total Summary "+e.externalallocationList.length+" Records Only","warning"))},e.reportcancel=function(){lockUI(),e.totalReportDisplayed=100;var t="api/allocationManagement/GetCaseAllocaCancelChanges";s.get(t).then(function(t){e.count_reportcancel=t.data.count_reportcancel,e.reportcancelList=t.data.allocationdtl,null==e.reportcancelList?(e.totalReport=0,e.totalReportDisplayed=0):(e.totalReport=e.reportcancelList.length,e.reportcancelList.length<100&&(e.totalReportDisplayed=e.reportcancelList.length)),unlockUI()})},e.loadReportMore=function(t){if(void 0==t)return void c.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalReportDisplayed<e.reportcancelList.length?(e.totalReportDisplayed+=a,void unlockUI()):(unlockUI(),void c.alert(" Total Summary "+e.reportcancelList.length+" Records Only","warning"))},e.exclusioncustomer=function(t,e,a){function n(n,i){n.ok=function(){i.close("closed")},n.customer_urn=t,n.customername=e,n.customer_status=a;var l={customer_urn:t},d="api/zonalAllocation/GetExclusionCustomerHistory";s.getparams(d,l).then(function(t){n.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?n.Nohistoryexclusion=!0:n.historyexclusion=!0}),n.confirmExclusioncustomer=function(){var e={customer_urn:t,exclusion_reason:n.txtexclusion_reason},a="api/zonalAllocation/GetExclusionCustomer";s.getparams(a,e).then(function(t){1==t.data.status?(c.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),n.current=o.current.name,r.store("dataldCtrl",n),o.go("app.pageredirect")):(c.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),i.close("closed"))})}}i.open({templateUrl:"/exclusionpopup.html",controller:n,size:"lg"});n.$inject=["$scope","$modalInstance"]},e.lasvisitdate=function(t,e,a){function o(o,n){o.customername=e,o.customer_urn=a,o.ok=function(){n.close("closed")},o.close=function(){n.close("closed")},o.submitlastvisit=function(){lockUI();var e=new Date;e.setFullYear(o.visitdate.getFullYear()),e.setMonth(o.visitdate.getMonth()),e.setDate(o.visitdate.getDate());var a={customer_gid:t,lastvisit_date:e},i="api/allocationManagement/postlastVisitDate";s.post(i,a).then(function(t){1==t.data.status?(o.visitdate="",c.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),h()):(c.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}i.open({templateUrl:"/lastVisitDate.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.transferRM=function(t){function e(e,o){lockUI();var n="api/newServiceTicket/employee";s.get(n).then(function(t){e.employee_list=t.data.employee_list});var n="api/allocationManagement/gettransferDetails";s.getparams(n,a).then(function(t){e.transferFrom=t.data.transferred_from,e.customerdtl=t.data.customerdtl}),unlockUI(),e.ok=function(){o.close("closed")},e.submittransfer=function(){lockUI();var a={allocation_Gid:t,transferred_to:e.employee_id},n="api/allocationManagement/postAllocationTransfer";s.post(n,a).then(function(t){1==t.data.status?(c.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.close("closed"),h()):(c.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={allocationdtl_gid:t};i.open({templateUrl:"/RMTransfer.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.exteralAllocate=function(t){function e(e,n){lockUI();var i="api/allocationManagement/tmpExternaldocumentclear";s.get(i).then(function(t){});var i="api/allocationManagement/getExternalNamelist";s.get(i).then(function(t){e.externaldtl=t.data.externaldtl});var i="api/allocationManagement/gettransferDetails";s.getparams(i,a).then(function(t){e.customerdtl=t.data.customerdtl}),unlockUI(),e.ok=function(){n.close("closed")},e.close=function(){n.close("closed")},e.uploadallocation=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var l=v.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==l)return c.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("project_flag","documentformatonly"),e.uploadfrm=n;var d="api/allocationManagement/ExternalUpload";s.postFile(d,e.uploadfrm).then(function(t){console.log(t),e.uploadallocation_list=t.data.upload_list,$("#addExternalupload").val(""),1==t.data.status?c.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):c.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/allocationManagement/ExternalUploadcancel";s.getparams(o,a).then(function(t){e.uploadallocation_list=t.data.upload_list})},e.submitAllocateExternal=function(){lockUI();var a=new Date;a.setFullYear(e.targetdate.getFullYear()),a.setMonth(e.targetdate.getMonth()),a.setDate(e.targetdate.getDate());var i={allocationdtl_gid:t,external_usergid:e.external_usergid,external_allocateRemarks:e.AllocationExtRemarks,target_date:a},l="api/allocationManagement/postAllocationExternal";s.post(l,i).then(function(t){1==t.data.status?(e.AllocationExtRemarks="",c.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),e.current=o.current.name,r.store("dataldCtrl",e),o.go("app.pageredirect")):(c.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={allocationdtl_gid:t};i.open({templateUrl:"/AllocateExternal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.externalAssigned=function(t){function e(t,e){lockUI();var o="api/allocationManagement/getExternalDetails";s.getparams(o,a).then(function(e){t.customerdtl=e.data.customerdtl,t.externalname=e.data.externalname,t.AllocateExtRemarks=e.data.requested_remarks,t.assigned_by=e.data.assigned_by,t.assigned_date=e.data.assigned_date,t.target_date=e.data.target_date});var o="api/allocationManagement/getExternaldocument";s.getparams(o,a).then(function(e){t.upload_list=e.data.upload_list}),unlockUI(),t.ok=function(){e.close("closed")},t.close=function(){e.close("closed")},t.downloads=function(t,e){f.Downloaddocument(t,e)}}var a={allocationdtl_gid:t};i.open({templateUrl:"/AssignedExternal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.createAllocation=function(t,e){console.log(e);var a={customer_urn:t};lockUI();var n="api/allocationManagement/GetCustomerGid";s.getparams(n,a).then(function(t){function a(t,e){t.ok=function(){e.close("closed")}}if(1==t.data.status)localStorage.setItem("allocation_customer_gid",t.data.customer_gid),localStorage.setItem("qualified_status",e),o.go("app.allocationCreate"),unlockUI();else{unlockUI();i.open({templateUrl:"/warningpopup.html",controller:a,size:"md"});a.$inject=["$scope","$modalInstance"]}})},e.holdAllocation=function(t,e,a){function n(n,i){n.ok=function(){i.close("closed")},n.customer_urn=e,n.customername=a,n.confirmHoldAllocation=function(){var e={allocationdtl_gid:t,allocationhold_reason:n.txthold_reason},a="api/allocationManagement/GetHoldAllocation";s.getparams(a,e).then(function(t){1==t.data.status?(c.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),i.close("closed"),n.current=o.current.name,r.store("dataldCtrl",n),o.go("app.pageredirect")):(c.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),i.close("closed"))})}}i.open({templateUrl:"/holdAllocationpopup.html",controller:n,size:"md"});n.$inject=["$scope","$modalInstance"]},e.createDirectAllocation=function(){var t="api/allocationManagement/tmpAllocatedocumentclear";s.get(t).then(function(t){}),o.go("app.allocationCreateDirect")},e.viewallocation=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("MyAllocation","N"),localStorage.setItem("ZonalAllocationBack","N"),localStorage.setItem("Allocated","N"),o.go("app.allocation360")},e.viewallocateddetails=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("MyAllocation","N"),localStorage.setItem("Allocated","Y"),localStorage.setItem("ZonalAllocationBack","N"),o.go("app.allocation360")},e.historyallocation=function(t){localStorage.setItem("MyZonalAllocationHistory","N"),localStorage.setItem("allocation_customer_gid",t),o.go("app.allocationHistorydetails")}}angular.module("angle").controller("caseAllocation",t),t.$inject=["$rootScope","$scope","$sce","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){v=localStorage.getItem("customer_gid"),e.customer_name=localStorage.getItem("customer_name"),e.urn=localStorage.getItem("urn"),e.customer_code=localStorage.getItem("customer_code"),f.calenderDisbursement=function(t){t.preventDefault(),t.stopPropagation(),f.opendisbursement=!0},f.calenderTransaction=function(t){t.preventDefault(),t.stopPropagation(),f.openTransaction=!0},f.dateOptions={formatYear:"yy",startingDay:1},f.formats=["dd-MM-yyyy"],f.format=f.formats[0];var t={customer_gid:v},a="api/loan/customer_getheads";l.getparams(a,t).then(function(t){e.sanctiondtl=t.data.sanctiondtl,console.log(t.data.sanctiondtl)})}var f=this;f.title="customer2EscrowCreate";var v;_(),e.escrowSubmit=function(){var t={sanction_gid:e.cbosanction.sanction_Gid,customer_gid:v,disbursement_date:e.txtdisbursementDate,transaction_date:e.transactionDate,transactionref_no:e.transactionRefNo,escrow_account_no:e.escrow_accountno,dealer_name:e.dealername,master_account_no:e.master_accountno,amount:e.amount,beneficiary_customer_account_name:e.beneficiarycustomer_accountname,sender_customer_account_name:e.sendercustomer_accountname,sender_customer_account_no:e.sendercustomer_accountno,remittance_info:e.remittance,sender_branch_IFSC:e.sendbranch_ifsc,reference:e.reference,credit_time:e.creditTime,remarks:e.remarks},o="api/customerManagement/escrowCreate";lockUI(),l.post(o,t).then(function(t){1==t.data.status?(unlockUI(),s.alert(t.data.message,"success"),a.go("app.Customer2EscrowSummary")):(unlockUI(),s.alert(t.data.message)),_()})},e.amountschange=function(){var t,a=document.getElementById("txtInput").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-IN");e.amount=i},e.sanctionrefnochange=function(t){var a={sanction_gid:e.cbosanction.sanction_Gid},o="api/loan/GetSanctionDate";l.getparams(o,a).then(function(t){e.sanctionDate=t.data.sanctiondate,e.Sanction_Date=t.data.Sanction_Date,e.facilitytype=t.data.facility_type,e.facilitytype_gid=t.data.facilitytype_gid})},e.back=function(){a.go("app.Customer2EscrowSummary")}}angular.module("angle").controller("customer2EscrowCreate",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g,_){function f(){e.IsCreate=!1,e.IsView=!1,h=localStorage.getItem("customer_gid");var t={customer_gid:localStorage.getItem("customer_gid")},a="api/customerManagement/EscrowSummary";l.getparams(a,t).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)});var a="api/customer/Getcustomerdetails";lockUI(),l.getparams(a,t).then(function(t){1==t.data.status&&(e.customerdetails=t.data,e.urn=t.data.customer_urnedit,e.customername=t.data.customerNameedit,e.customercode=t.data.customerCodeedit)}),unlockUI(),v.calenderDisbursement=function(t){t.preventDefault(),t.stopPropagation(),v.opendisbursement=!0},v.calenderTransaction=function(t){t.preventDefault(),t.stopPropagation(),v.openTransaction=!0},v.dateOptions={formatYear:"yy",startingDay:1},v.formats=["dd-MM-yyyy"],v.format=v.formats[0];var t={customer_gid:h},a="api/loan/customer_getheads";l.getparams(a,t).then(function(t){e.sanctiondtl=t.data.sanctiondtl})}var v=this;v.title="customer2EscrowSummary";var h;f(),e.sanctionrefnochange=function(t){if(void 0==e.cbosanction.sanction_Gid);else{var a={sanction_gid:e.cbosanction.sanction_Gid},o="api/loan/GetSanctionDate";l.getparams(o,a).then(function(t){e.sanctionDate=t.data.sanctiondate,e.Sanction_Date=t.data.Sanction_Date,e.facilitytype=t.data.facility_type,e.facilitytype_gid=t.data.facilitytype_gid})}},e.escrowCreate=function(){e.IsCreate=!0},e.amountschange=function(){var t,a=document.getElementById("txtInput").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-IN");e.amount=i},e.escrowSubmit=function(){var t={sanction_gid:e.cbosanction.sanction_Gid,customer_gid:h,disbursement_date:e.txtdisbursementDate,transaction_date:e.transactionDate,transactionref_no:e.transactionRefNo,escrow_account_no:e.escrow_accountno,dealer_name:e.dealername,master_account_no:e.master_accountno,amount:e.amount,beneficiary_customer_account_name:e.beneficiarycustomer_accountname,sender_customer_account_name:e.sendercustomer_accountname,sender_customer_account_no:e.sendercustomer_accountno,remittance_info:e.remittance,sender_branch_IFSC:e.sendbranch_ifsc,reference:e.reference,credit_time:e.creditTime,remarks:e.remarks},a="api/customerManagement/escrowCreate";lockUI(),l.post(a,t).then(function(t){1==t.data.status?(unlockUI(),e.remarks=null,e.cbosanction="---Select---",e.Sanction_Date=null,e.facilitytype=null,e.txtdisbursementDate=null,e.transactionRefNo=null,e.transactionDate=null,e.dealername="",e.escrow_accountno="",e.master_accountno="",e.sendercustomer_accountname="",e.sendercustomer_accountno="",e.sendbranch_ifsc="",e.beneficiarycustomer_accountname="",e.reference=null,e.remittance="",e.amount="",e.creditTime="",s.alert(t.data.message,"success"),f()):(unlockUI(),s.alert(t.data.message)),f()})},e.close=function(){e.IsCreate=!1,this.remarks=null,this.cbosanction="---Select---",this.Sanction_Date=null,this.facilitytype=null,this.txtdisbursementDate=null,this.transactionRefNo=null,this.transactionDate=null,this.dealername="",this.escrow_accountno="",this.master_accountno="",this.sendercustomer_accountname="",this.sendercustomer_accountno="",
this.sendbranch_ifsc="",this.beneficiarycustomer_accountname="",this.reference=null,this.remittance="",this.amount="",this.creditTime=""},e.escrowView=function(t){e.IsView=!0;var a={escrow_gid:t},o="api/customerManagement/EscrowView";l.getparams(o,a).then(function(t){1==t.data.status&&(e.escrowview=t.data)})},e.ViewClose=function(){e.IsView=!1},e.escrowDelete=function(t){var e={escrow_gid:t};_.swal({title:"Are you sure?",text:"Do You Want To Delete the Escrow ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var a="api/customerManagement/EscrowDelete";l.getparams(a,e).then(function(t){1==t.data.status?(_.swal("Deleted Successfully!"),unlockUI(),f()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}})}}angular.module("angle").controller("customer2EscrowSummary",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","SweetAlert"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){g=localStorage.getItem("escrow_gid",g),console.log(g);var t={escrow_gid:g},a="api/customerManagement/EscrowView";l.getparams(a,t).then(function(t){1==t.data.status&&(e.escrowview=t.data)})}e.title="customer2EscrowView";var g;p(),e.back=function(){a.go("app.Customer2EscrowSummary")}}angular.module("angle").controller("customer2EscrowView",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){e.MyCustomer=localStorage.getItem("MyCustomer");var t={customer_gid:localStorage.getItem("customer_gid")},a="api/customer/Getcustomerdetails";l.getparams(a,t).then(function(t){e.customerdetails=t.data});var a="api/customerManagement/getcustomerPromoter";l.getparams(a,t).then(function(t){e.customerPromotorlist=t.data.customerPromoter});var a="api/customerManagement/getcustomerGuarantors";l.getparams(a,t).then(function(t){e.customerguarantorlist=t.data.customerGuarantors});var a="api/customerManagement/getCollateraldetail";l.getparams(a,t).then(function(t){e.customerCollateral=t.data.customerCollateral})}var f=this;f.title="customerManagement360controller",_(),e.addgurantor=function(){function t(t,e){t.ok=function(){e.close("closed")},t.customerGuarantorsSubmit=function(){var a={guarantors_name:t.txtGuarantorsName,guarantor_age:t.txtAge,networth:t.txtNetWorth,basisofNW:t.txtBasisofNW,customer_gid:localStorage.getItem("customer_gid")},o="api/customerManagement/postcustomerGuarantors";l.post(o,a).then(function(t){console.log(t),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.close("closed"),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}o.open({templateUrl:"/GuarantorsAddModalContent.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},e.addpromotor=function(){function t(t,e){t.ok=function(){e.close("closed")},t.customerPromoterSubmit=function(){var a={promoter_name:t.txtPromoterName,designation:t.txtDesignation,promoter_age:t.txtAge,mobile:t.txtmobile,customer_gid:localStorage.getItem("customer_gid")},o="api/customerManagement/postcustomerPromoter";l.post(o,a).then(function(t){1==t.data.status?(e.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}o.open({templateUrl:"/promotorAddModalContent.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},e.deleteguarantor=function(t){var e={customer2guarantor_gid:t};g.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/customerManagement/postGuarantorsdetail";l.getparams(a,e).then(function(t){1==t.data.status?_():s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})}),g.swal("Deleted Successfully!")}})},e.deletepromotor=function(t){var e={customer2promotor_gid:t};g.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/customerManagement/postPromoterdetail";l.getparams(a,e).then(function(t){1==t.data.status?_():s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})}),g.swal("Deleted Successfully!")}})},e.editpromotor=function(t){function e(e,a){var o={customer2promotor_gid:t},n="api/customerManagement/getPromoterdetail";l.getparams(n,o).then(function(t){e.txtPromoterNameedit=t.data.promoter_name,e.txtDesignationedit=t.data.designation,e.txtAgeedit=t.data.promoter_age,e.txtmobileedit=t.data.mobile}),e.ok=function(){a.close("closed")},e.updatepromotor=function(){var o={customer2promotor_gid:t,promoter_name:e.txtPromoterNameedit,designation:e.txtDesignationedit,promoter_age:e.txtAgeedit,mobile:e.txtmobileedit};console.log(o);var n="api/customerManagement/postcustomerPromoterEdit";l.post(n,o).then(function(t){1==t.data.status?(a.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}o.open({templateUrl:"/promotorModalContent.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.editguarantor=function(t){function e(e,a){var o={customer2guarantor_gid:t},n="api/customerManagement/getGuarantorsdetail";l.getparams(n,o).then(function(t){e.txtGuarantorsNameedit=t.data.guarantors_name,e.txtAgeedit=t.data.guarantor_age,e.txtNetWorthedit=t.data.networth,e.txtBasisofNWedit=t.data.basisofNW,console.log(t)}),e.ok=function(){a.close("closed")},e.updateguarantor=function(){var o={customer2guarantor_gid:t,guarantors_name:e.txtGuarantorsNameedit,guarantor_age:e.txtAgeedit,networth:e.txtNetWorthedit,basisofNW:e.txtBasisofNWedit};console.log(o);var n="api/customerManagement/postcustomerGuarantorsEdit";l.post(n,o).then(function(t){1==t.data.status?(a.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),_()):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}}o.open({templateUrl:"/gurantorModalContent.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.back=function(){a.go("app.customerManagement")}}angular.module("angle").controller("customerManagement360controller",t),t.$inject=["$rootScope","$scope","$state","$modal","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","SweetAlert"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){e.totalDisplayed=100;var t="api/customerManagement/GetCustomerRMDetail";lockUI(),l.get(t).then(function(t){e.customer_data=t.data.customer_list,null==e.customer_data?(e.total=0,e.totalDisplayed=0):(e.total=e.customer_data.length,e.customer_data.length<100&&(e.totalDisplayed=e.customer_data.length)),unlockUI()})}var f=this;f.title="customerSummaryManagementcontroller",_(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.assignRM=function(t){function e(e,o){lockUI();var n="api/newServiceTicket/employee";l.get(n).then(function(t){e.employee_list=t.data.employee_list});var n="api/customerManagement/getAssignRMdetail";l.getparams(n,a).then(function(t){e.districtdtl=t.data.districtdtl,e.state_name=t.data.state_name,e.cboassignedRM_gid=t.data.assigned_RM,e.ZonalRM_gid=t.data.zonal_riskmanager,e.cbodistrict_gid=t.data.district_gid,e.zonal_name=t.data.zonal_name,e.zonal_gid=t.data.zonal_gid,e.customer_name=t.data.customer_name,e.addressline1=t.data.addressline1,e.addressline2=t.data.addressline2,e.cboPPA_gid=t.data.ppa_gid}),unlockUI(),e.onchangedistrict=function(t){console.log(t),lockUI();var a={district_gid:t},o="api/allocationManagement/getallocateRM";l.getparams(o,a).then(function(t){""==t.data.assigned_RM?(e.cboassignedRM_gid="",e.ZonalRM_gid="",alert("RM is Not Mapping for the Selected District")):(e.cboassignedRM_gid=t.data.assignedRM_gid,e.ZonalRM_gid=t.data.ZonalRM_gid)}),unlockUI()},e.ok=function(){o.close("closed")},e.submitmapping=function(){lockUI();var a=$("#ppa_name :selected").text(),n=$("#cbodistrictname :selected").text(),i={customer_gid:t,district_gid:e.cbodistrict_gid,district_name:n,assignedRM_gid:e.cboassignedRM_gid,ZonalRM_gid:e.ZonalRM_gid,zonal_gid:e.zonal_gid,PPA_gid:e.cboPPA_gid,PPA_name:a},r="api/rmMapping/postcustomerMappingdetails";l.post(r,i).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.close("closed"),_()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={customer_gid:t};n.open({templateUrl:"/assign_RMModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.EscrowCreate=function(t){e.customer_gid=localStorage.setItem("customer_gid",t),a.go("app.Customer2EscrowSummary")},e.customer360click=function(t){e.customer_gid=localStorage.setItem("customer_gid",t),localStorage.setItem("MyCustomer","N"),a.go("app.customerManagement360")}}angular.module("angle").controller("customerSummaryManagementcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){var t={customer_gid:val};e.remitterbuyersummary=function(){var a="api/DASTracker/getremitterbuyers";l.getparams(a,t).then(function(t){e.remitterbuyerslist=t.data.remitterbuyers})}}var _=this;_.title="dasRemitterBuyerscontroller",g(),e.selfbuyer=function(){e.showselfbuyer=!0,e.showacknowledgedbuyer=!1,e.showunacknowledgedbuyer=!1,e.selfcustomername=customername},e.acknowledgedbuyer=function(){e.showselfbuyer=!1,e.showacknowledgedbuyer=!0,e.showunacknowledgedbuyer=!1;var t="api/DASTracker/getacknowledgedbuyers";l.getparams(t,params).then(function(t){e.acknowledgedbuyers=t.data.acknowledgedbuyers})},e.unacknowledgedbuyer=function(){e.showselfbuyer=!1,e.showunacknowledgedbuyer=!0,e.showacknowledgedbuyer=!1},e.addremitterbuyer=function(){if("Self"==e.cboremitterbuyer)var t={customer_gid:val,remitter_status:e.cboremitterbuyer,remitter_self:val};else if("Acknowledged buyer"==e.cboremitterbuyer){if(console.log(e.acknowledgedbuyers_gid),void 0==e.acknowledgedbuyers_gid)return void alert("Select Acknowledged Buyer");var t={customer_gid:val,remitter_status:e.cboremitterbuyer,remitter_ackbuyersgid:e.acknowledgedbuyers_gid,remitter_ackbuyers:$("#ackbuyersname :selected").text()}}else{if(""==e.txtunacknowbuyers)return void alert("Enter Unacknowledged Buyer");var t={customer_gid:val,remitter_status:e.cboremitterbuyer,remitter_unackbuyers:e.txtunacknowbuyers}}var a="api/DASTracker/addremitterbuyers";lockUI(),l.post(a,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),$("#ackbuyersname").val(0),e.acknowledgedbuyers_gid="",e.txtunacknowbuyers="",console.log(e.acknowledgedbuyers_gid=""),e.remitterbuyersummary(),unlockUI()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.deleteAcknowledgedbuyer=function(t){lockUI();var a={remitterbuyers_gid:t};console.log(a);var o="api/DASTracker/deleteremitterbuyers";l.getparams(o,a).then(function(t){1==t.data.status?(e.remitterbuyersummary(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}angular.module("angle").controller("dasRemitterBuyerscontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){var t="api/customer/customerdetail";lockUI(),r.get(t).then(function(t){e.customer_data=t.data.customer_list,unlockUI()})}var f=this;f.title="dasTrackercontroller",_(),e.ackbuyers=function(t){function e(e,o){e.ok=function(){o.close("closed")},e.acknowledgedbuyerssummary=function(){var t="api/DASTracker/getacknowledgedbuyers";r.getparams(t,a).then(function(t){console.log(t),e.acknowledgedbuyers=t.data.acknowledgedbuyers})},e.acknowledgedbuyerssummary(),e.addacknowledgedbuyers=function(){var a={customer_gid:t,acknowledged_buyers:e.txtackbuyers};console.log(a);var o="api/DASTracker/addacknowledgedbuyers";lockUI(),r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.txtackbuyers="",e.acknowledgedbuyerssummary(),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.deleteAcknowledgedbuyer=function(t){lockUI();var a={acknowledgedbuyers_gid:t};console.log(a);var o="api/DASTracker/deleteacknowledgedbuyers";r.getparams(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.acknowledgedbuyerssummary(),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.editAcknowledgedbuyer=function(t){lockUI();var a={acknowledgedbuyers_gid:t,acknowledged_buyers:e.txteditackbuyers},o="api/DASTracker/updateacknowledgedbuyers";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.acknowledgedbuyerssummary(),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={customer_gid:t};g.open({templateUrl:"/AcknowledgedBuyerContent.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.remitterbuyers=function(t,e){a.go("app.dasRemitterBuyers")}}angular.module("angle").controller("dasTrackercontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","$modal"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI(),e.totalDisplayed=100;var t="api/documentation/getdocumentationdtlList";l.get(t).then(function(t){e.documentation_list=t.data.documentationdtl,null==e.documentation_list?(e.total=0,e.totalDisplayed=0):(e.total=e.documentation_list.length,e.documentation_list.length<100&&(e.totalDisplayed=e.documentation_list.length)),unlockUI()})}var _=this;_.title="documentationcontroller",g(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.documentation_list){if(!(e.totalDisplayed<e.documentation_list.length))return unlockUI(),void s.alert(" Total Summary "+e.documentation_list.length+" Records Only","warning");e.totalDisplayed+=a,unlockUI()}unlockUI()},e.addDocument=function(t){function e(t,e){t.ok=function(){e.close("closed")},t.documentformSubmit=function(){var a={documentation_name:t.txtdocumentationname,documentation_type:t.txtdocumentationtype};lockUI();var o="api/documentation/postdocumentationdtls";l.post(o,a).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),e.close("closed"),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/addDocumentModalContent.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.editdocument=function(t){function e(e,a){var o={customer2document_gid:t},n="api/documentation/getdocumentationdtl";l.getparams(n,o).then(function(t){e.txteditdocumentrefno=t.data.documentation_refno,e.txteditdocumentationname=t.data.documentation_name,e.txteditdocumentationtype=t.data.documentation_type}),e.ok=function(){a.close("closed")},e.documentformUpdate=function(){lockUI();var o={documentation_name:e.txteditdocumentationname,documentation_type:e.txteditdocumentationtype,customer2document_gid:t},n="api/documentation/postdocumentationupdate";l.post(n,o).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),a.close("closed"),unlockUI(),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/EditDocumentModalContent.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.deleteDocumentation=function(t){var e={customer2document_gid:t};u.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){lockUI();var a="api/documentation/documentationdelete";l.getparams(a,e).then(function(t){1==t.data.status?(g(),u.swal("Deleted Successfully!"),unlockUI()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}})}}angular.module("angle").controller("documentationcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g,_){function f(){e.photouploaded=!1,e.upload=!0,e.IsVisible=!1,e.rskdocumentlist=!1,e.customer2sanction_gid=localStorage.getItem("customer2sanction_gid");var t={customer2sanction_gid:e.customer2sanction_gid},a="api/sanction/GetIdasSanctionDocumentList";l.getparams(a,t).then(function(t){1==t.data.status&&(e.IsVisible=!0,e.idassanctiondocumentlist=t.data.idassanctiondocument)});var a="api/sanction/GetRskSanctionDocumentList";l.getparams(a,t).then(function(t){e.rsksanctiondocumentlist=t.data.rsksanctiondocument});var a="api/documentation/getrskdocumentationdtlList";l.getparams(a,t).then(function(t){e.documentationlist=t.data.documentationdtl});var a="api/sanction/GetSanctionDtls",t={sanction_gid:e.customer2sanction_gid};l.getparams(a,t).then(function(t){e.sanctionrefno=t.data.sanction_refno,e.SanctionDate=t.data.sanction_date,e.SanctionAmount=t.data.sanction_amount,e.FacilityType=t.data.facility_type,e.customerName=t.data.customername,e.Customerurn=t.data.customer_urn,e.collateral_security=t.data.collateral_security,e.zonalHeadName=t.data.zonal_name,e.businessHeadName=t.data.businesshead_name,e.clusterManager=t.data.cluster_manager_name,e.creditManager=t.data.creditmanager_name,e.relationshipmgmt=t.data.relationshipmgmt_name,e.customercode=t.data.customercode,e.verticalCode=t.data.vertical_code,e.contactperson=t.data.contactperson,e.mobileno=t.data.mobileno,e.addressline1=t.data.addressline1,e.addressline2=t.data.addressline2,e.customer_gid=t.data.customer_gid,e.riskmanager=t.data.riskmanager})}var v=this;v.title="documentCheckListController",f(),e.back=function(){a.go("app.sanctionManagement")},e.uploadidasdocument_sub=function(t,a,o,n){for(var i=new FormData,r=0;r<t.length;r++){var c={name:t[r].name,file:t[r]};i.append("fileupload",c.file),i.append("file_name",c.name);var d=_.fnCheckValidDocType(t[r].name,"documentformatonly");if(0==d)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}i.append("document_gid",n),i.append("project_flag","documentformatonly"),e.uploadfrm=i;var u="api/sanction/postUploadidasSanctionDocument";lockUI(),l.postFile(u,e.uploadfrm).then(function(t){$("#addupload").val(""),1==t.data.status?(unlockUI(),e.document_type="",f(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}))})},e.uploadidasdocument=function(t,a,o,n){for(var i=new FormData,r=0;r<t.length;r++){var c={name:t[r].name,file:t[r]};i.append("fileupload",c.file),i.append("file_name",c.name);var d=_.fnCheckValidDocType(t[r].name,"documentformatonly");if(0==d)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}i.append("sanctiondocument_gid",localStorage.getItem("sanctiondocument_gid")),i.append("project_flag","documentformatonly"),e.uploadfrm=i;var u="api/sanction/postUploadSanctionDocument";lockUI(),l.postFile(u,e.uploadfrm).then(function(t){$("#addupload").val(""),1==t.data.status?(unlockUI(),e.file_name=t.data.file_name,e.photouploaded=!0,e.upload=!1,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}))})},e.uploaddocument=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=_.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("customer2sanction_gid",localStorage.getItem("customer2sanction_gid")),n.append("project_flag","documentformatonly"),e.uploadfrm=n;var d="api/sanction/postUploadSanctionDocument";lockUI(),l.postFile(d,e.uploadfrm).then(function(t){$("#addupload").val(""),1==t.data.status?(unlockUI(),e.Sanctiondocupload_list=t.data.Sanctiondoc_upload,e.photouploaded=!0,e.upload=!1,s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}))})},e.documentadd=function(){if(""==e.txtremarks||void 0==e.txtremarks)return void s.alert("Enter Remarks..!",{status:"warning",pos:"top-center",timeout:3e3});if(!(e.Sanctiondocupload_list.length>0))return void s.alert("Kindly Upload Document..!",{status:"warning",pos:"top-center",timeout:3e3});lockUI(),e.customer2sanction_gid=localStorage.getItem("customer2sanction_gid");var t={customer2document_gid:e.cbodocumentationname.customer2document_gid,customer2sanction_gid:e.customer2sanction_gid,customer_gid:e.customer_gid,document_remarks:e.txtremarks},a="api/sanction/postsanctiondocument";l.post(a,t).then(function(t){1==t.data.status?(e.txtremarks="",$("#addrskupload").val(""),e.test_document="",e.file_name=void 0,e.cbodocumentationname="",s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),f()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.docdelete=function(t){var e={document_gid:t};lockUI();var a="api/sanction/UploadDocDelete";l.getparams(a,e).then(function(t){1==t.data.status?(f(),unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3})):(unlockUI(),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}))}),unlockUI()},e.downloads=function(t,e){g.Downloaddocument(t,e)}}angular.module("angle").controller("documentCheckListController",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){lockUI(),e.totalDisplayed=100;var t="api/ExclusionList/GetExclusionSummary";l.get(t).then(function(t){e.exclusioncustomerList=t.data.exclusioncustomer,null==e.exclusioncustomerList?(e.total=0,e.totalDisplayed=0):(e.total=e.exclusioncustomerList.length,e.exclusioncustomerList.length<100&&(e.totalDisplayed=e.exclusioncustomerList.length)),unlockUI()})}var g=this;g.title="exclusionCustomerList",p(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.exclusioncustomerList){if(!(e.totalDisplayed<e.exclusioncustomerList.length))return unlockUI(),void s.alert(" Total Summary "+e.exclusioncustomerList.length+" Records Only","warning");e.totalDisplayed+=a,unlockUI()}unlockUI()},e["export"]=function(){lockUI();var t="api/ExclusionList/GetExclusionExport";l.get(t).then(function(t){1==t.data.status?(unlockUI(),m.Downloaddocument(t.data.excel_path,t.data.excel_name)):(unlockUI(),s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}))})},e.exclusionHistory=function(t,e,a){function o(o,n){o.ok=function(){n.close("closed")},o.customer_urn=t,o.customername=e,o.customer_status=a;var i={customer_urn:t},r="api/zonalAllocation/GetExclusionCustomerHistory";l.getparams(r,i).then(function(t){o.exclusioncustomerHistory=t.data.exclusionhistory})}n.open({templateUrl:"/exclusionHistoryPopup.html",controller:o,size:"lg"});o.$inject=["$scope","$modalInstance"]},e.activateexclusion=function(t,e,a){function o(o,n){o.ok=function(){n.close("closed")},o.customer_urn=t,o.customername=e,o.customer_status=a,o.confirmActivation=function(){lockUI();var e={customer_urn:t,exclusion_reason:o.txtactivated_reason},a="api/zonalAllocation/GetActivationCustomer";l.getparams(a,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),p()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/activateconfirmation.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("exclusionCustomerList",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){lockUI(),e.totalDisplayed=100;var t="api/zonalAllocation/GetExclusionZonalSummary";l.get(t).then(function(t){e.exclusioncustomerList=t.data.exclusioncustomer,null==e.exclusioncustomerList?(e.total=0,e.totalDisplayed=0):(e.total=e.exclusioncustomerList.length,e.exclusioncustomerList.length<100&&(e.totalDisplayed=e.exclusioncustomerList.length)),unlockUI()})}var g=this;g.title="exclusionZonalCustomerList",p(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e["export"]=function(){lockUI();var t="api/ExclusionList/GetExclusionZonalExport";l.get(t).then(function(t){1==t.data.status?(unlockUI(),m.Downloaddocument(t.data.excel_path,t.data.excel_name)):(unlockUI(),s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}))})},e.exclusionHistory=function(t,e,a){function o(o,n){o.ok=function(){n.close("closed")},o.customer_urn=t,o.customername=e,o.customer_status=a;var i={customer_urn:t},r="api/zonalAllocation/GetExclusionCustomerHistory";l.getparams(r,i).then(function(t){o.exclusioncustomerHistory=t.data.exclusionhistory})}n.open({templateUrl:"/exclusionHistoryPopup.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.activateexclusion=function(t,e,a){function o(o,n){o.ok=function(){n.close("closed")},o.customer_urn=t,o.customername=e,o.customer_status=a,o.confirmActivation=function(){lockUI();var e={customer_urn:t,exclusion_reason:o.txtactivated_reason},a="api/zonalAllocation/GetActivationCustomer";l.getparams(a,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),p()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/activateconfirmation.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("exclusionZonalCustomerList",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){e.photouploaded=!1,e.upload=!0;var t="api/externalVendor/tmpexternalphotoclear";l.get(t).then(function(t){});var t="api/rmMapping/getstatedtls";l.get(t).then(function(t){e.statedtl=t.data.statedtl})}var f=this;f.title="externalRegisterAddcontroller",_(),e.onchangestate=function(t){lockUI();var a={state_gid:t},o="api/rmMapping/getdistrictdtls";l.getparams(o,a).then(function(t){e.districtdtl=t.data.statedtl}),unlockUI()},e.upload=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=g.fnCheckValidDocType(t[i].name,"photoformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("customer_gid",localStorage.getItem("customer_gid")),n.append("project_flag","documentformatonly"),e.uploadfrm=n;var d="api/externalVendor/ExternalphotoUpload";l.postFile(d,e.uploadfrm).then(function(t){e.filename_list=t.data.Rskexternalvendordoc,e.photouploaded=!0,e.upload=!1}),$("#addupload").val("")},e.registrationsubmit=function(){lockUI();var t={external_vendorcode:e.txtexternal_vendorCode,external_vendorname:e.txtexternal_vendorName,contact_person:e.txtcontact_person,contact_emailid:e.txtemail_ID,contact_number:e.txtcontact_Number,address_line1:e.txtaddress_line1,address_line2:e.txtaddress_line2,state_gid:e.cbostategid,district_gid:e.cbodistrictgid,country_name:e.txtcountry,postal_code:e.txtpostalCode},o="api/externalVendor/postexternalRegistration";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.externalRegister")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.cancel=function(){a.go("app.externalRegister")}}angular.module("angle").controller("externalRegisterAddcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){e.totalDisplayed=100,lockUI();var t="api/externalVendor/getexternalRegistersummary";l.get(t).then(function(t){e.externalVendorList=t.data.externalvendordtl,null==e.externalVendorList?(e.total=0,e.totalDisplayed=0):(e.total=e.externalVendorList.length,e.externalVendorList.length<100&&(e.totalDisplayed=e.externalVendorList.length)),unlockUI()})}var _=this;_.title="externalRegistercontroller",g(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){
if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.externalRegister=function(){a.go("app.externalRegisterAdd")},e.viewExternalRegister=function(t){localStorage.setItem("externalregister_gid",t),a.go("app.externalRegisterView")},e.editExternalRegister=function(t){localStorage.setItem("externalregister_gid",t),a.go("app.externalRegisterEdit")},e.logincreation=function(t){function e(e,o){e.ok=function(){o.close("closed")},e.close=function(){o.close("closed")};var n="api/externalVendor/getexternallogindtl";l.getparams(n,a).then(function(t){e.external_Vendorname=t.data.external_Vendorname,e.external_vendorCode=t.data.external_vendorCode}),e.sendaccouncreate=function(){var a={external_vendorCode:e.external_vendorCode,external_vendorPassword:e.external_vendorpassword,externalregister_gid:t},n="api/externalVendor/postExternalLogin";lockUI(),l.post(n,a).then(function(t){console.log(t.data.status),1==t.data.status?(o.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),g()):(s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={externalregister_gid:t};n.open({templateUrl:"/lawyerLoginContent.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewlogin=function(t){function e(e,o){e.ok=function(){o.close("closed")},e.close=function(){o.close("closed")};var n="api/externalVendor/getexternallogindtl";l.getparams(n,a).then(function(t){e.external_Vendorname=t.data.external_Vendorname,e.external_vendorCode=t.data.external_vendorCode,e.external_vendorPassword=t.data.external_vendorPassword,e.loginuserstatus=t.data.external_activeStatus}),e.sendaccounstatus=function(){var a={external_activeStatus:e.loginuserstatus,externalregister_gid:t},n="api/externalVendor/postExternalLoginStatus";l.post(n,a).then(function(t){1==t.data.status?(o.close("closed"),s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),g()):(o.close("closed"),s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={externalregister_gid:t};n.open({templateUrl:"/ViewlawyerLoginContent.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("externalRegistercontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI();var t={externalregister_gid:localStorage.getItem("externalregister_gid")},a="api/externalVendor/getexternalRegisterdtl";l.getparams(a,t).then(function(t){if(e.txtexternal_vendorcode=t.data.external_vendorcode,e.txtexternal_vendorName=t.data.external_vendorname,e.txtcontact_person=t.data.contact_person,e.txtemail_ID=t.data.contact_emailid,e.txtcontact_Number=t.data.contact_number,e.txtaddress_line1=t.data.address_line1,e.txtaddress_line2=t.data.address_line2,e.state_name=t.data.state_name,e.cbostategid=t.data.state_gid,e.cbodistrict_gid=t.data.district_gid,e.district_name=t.data.district_name,e.txtcountry=t.data.country_name,e.txtpostalCode=t.data.postal_code,"N"!=t.data.photo_path){var a=location.href.split("/"),o=a[0],n=a[2],i=o+"//"+n,r=t.data.photo_path,r=r.split("StoryboardAPI"),s=r[1].replace("\\","/");e.photo_path=i.concat(s)}else e.photo_path=t.data.photo_path;var c={state_gid:t.data.state_gid},i="api/rmMapping/getdistrictdtls";l.getparams(i,c).then(function(t){e.districtdtl=t.data.statedtl})});var a="api/rmMapping/getstatedtls";l.get(a).then(function(t){e.statedtl=t.data.statedtl}),unlockUI()}var _=this;_.title="externalregisterViewEdit",g(),e.onchangestate=function(t){lockUI();var a={state_gid:t},o="api/rmMapping/getdistrictdtls";l.getparams(o,a).then(function(t){e.districtdtl=t.data.statedtl}),unlockUI()},e.registrationUpdate=function(){var t={external_vendorcode:e.txtexternal_vendorcode,external_vendorname:e.txtexternal_vendorName,contact_person:e.txtcontact_person,contact_emailid:e.txtemail_ID,contact_number:e.txtcontact_Number,address_line1:e.txtaddress_line1,address_line2:e.txtaddress_line2,state_gid:e.cbostategid,district_gid:e.cbodistrict_gid,country_name:e.txtcountry,postal_code:e.txtpostalCode,externalregister_gid:localStorage.getItem("externalregister_gid")},o="api/externalVendor/updateexternalRegistration";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.externalRegister")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.cancel=function(){a.go("app.externalRegister")}}angular.module("angle").controller("externalregisterViewEdit",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){var t="api/MyCustomer/GetZonalCustomerRMDetail";lockUI(),l.get(t).then(function(t){e.customer_data=t.data.customer_list,unlockUI()})}var p=this;p.title="myZonalCustomercontroller",m(),e.assignRM=function(t){function e(e,o){lockUI();var n="api/newServiceTicket/employee";l.get(n).then(function(t){e.employee_list=t.data.employee_list});var n="api/customerManagement/getAssignRMdetail";l.getparams(n,a).then(function(t){e.districtdtl=t.data.districtdtl,e.state_name=t.data.state_name,e.cboassignedRM_gid=t.data.assigned_RM,e.ZonalRM_gid=t.data.zonal_riskmanager,e.cbodistrict_gid=t.data.district_gid,e.zonal_name=t.data.zonal_name,e.zonal_gid=t.data.zonal_gid,e.customer_name=t.data.customer_name,e.addressline1=t.data.addressline1,e.addressline2=t.data.addressline2,e.cboPPA_gid=t.data.ppa_gid}),unlockUI(),e.onchangedistrict=function(t){console.log(t),lockUI();var a={district_gid:t},o="api/allocationManagement/getallocateRM";l.getparams(o,a).then(function(t){""==t.data.assigned_RM?(e.cboassignedRM_gid="",e.ZonalRM_gid="",alert("RM is Not Mapping for the Selected District")):(e.cboassignedRM_gid=t.data.assignedRM_gid,e.ZonalRM_gid=t.data.ZonalRM_gid)}),unlockUI()},e.ok=function(){o.close("closed")},e.submitmapping=function(){lockUI();var a=$("#ppa_name :selected").text(),n=$("#cbodistrictname :selected").text(),i={customer_gid:t,district_gid:e.cbodistrict_gid,district_name:n,assignedRM_gid:e.cboassignedRM_gid,ZonalRM_gid:e.ZonalRM_gid,zonal_gid:e.zonal_gid,PPA_gid:e.cboPPA_gid,PPA_name:a},r="api/rmMapping/postcustomerMappingdetails";l.post(r,i).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.close("closed"),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={customer_gid:t};n.open({templateUrl:"/assign_RMModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.customer360click=function(t){e.customer_gid=localStorage.setItem("customer_gid",t),localStorage.setItem("MyCustomer","Y"),a.go("app.customerManagement360")}}angular.module("angle").controller("myZonalCustomercontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){var t={observation_reportgid:localStorage.getItem("observation_reportgid")},a="api/ObservationReport/GetViewObservationdtl";l.getparams(a,t).then(function(t){e.customer_name=t.data.customer_name,e.customer_urn=t.data.customer_urn,e.dateof_RMDvisit=t.data.dateof_RMDvisit,e.report_pertainingto=t.data.report_pertainingto,e.vertical=t.data.vertical,e.disbursement_amount=t.data.disbursement_amount,e.approving_authority=t.data.approving_authority,e.loansanction_date=t.data.loansanction_date,e.relationship_manager_name=t.data.relationship_manager_name,e.PPA_name=t.data.PPA_name,e.RMDvisit_officialname=t.data.RMDvisit_officialname,e.loandisbursement_date=t.data.loandisbursement_date,e.people_accompaniedRMD=t.data.people_accompaniedRMD,e.sanction_amount=t.data.sanction_amount,e.outstanding_amount=t.data.outstanding_amount,e.current_DPD=t.data.current_DPD,e.contact_details1=t.data.contact_details1,e.contact_details2=t.data.contact_details2,e.observation_flag=t.data.observation_flag,e.cboriskcode=t.data.risk_code});var a="api/ObservationReport/GetViewObservationCriticalDtl";l.getparams(a,t).then(function(t){e.criticalobservation=t.data.criticalobservation})}var p=this;p.title="observationReportApproval",m(),e.ObservationRemarks=function(t,e,a,o,i){function r(n,r){n.txtcriteria=e,n.txtRMD_observations=a,n.txtactionable_recommend=o,n.txtrelationshipmangerremarks=i,n.ok=function(){r.close("closed")},n.observationremarkssubmit=function(){var e={critical_observationgid:t,relationshipmanager_remarks:n.txtrelationshipmangerremarks},a="api/ObservationReport/PostObservationCriticalRemarks";l.post(a,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),r.close("closed"),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/criticalobservationModal.html",controller:r,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.ObservationReportSubmit=function(){var t={observation_reportgid:localStorage.getItem("observation_reportgid")};lockUI();var e="api/ObservationReport/PostObservationRemarksSubmit";l.post(e,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.observationReportSummary")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}angular.module("angle").controller("observationReportApproval",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){lockUI(),e.totalDisplayed=100;var t="api/ObservationReport/GetObservationReportSummary";l.get(t).then(function(t){e.observationreport=t.data.observationreport,e.count_pending=t.data.count_pending,e.count_approved=t.data.count_approved,null==e.observationreport?(e.total=0,e.totalDisplayed=0):(e.total=e.observationreport.length,e.observationreport.length<100&&(e.totalDisplayed=e.observationreport.length)),unlockUI()})}var p=this;p.title="observationReportSummary",m(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.observationreport){if(!(e.totalDisplayed<e.observationreport.length))return unlockUI(),void s.alert(" Total Summary "+e.observationreport.length+" Records Only","warning");e.totalDisplayed+=a,unlockUI()}unlockUI()},e.viewobservationReport=function(t){localStorage.setItem("observation_reportgid",t),a.go("app.observationReportApproval")}}angular.module("angle").controller("observationReportSummary",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e){function a(){t.go(e.get("dataldCtrl").current)}var o=this;o.title="reloadController",a()}angular.module("angle").controller("reloadController",t),t.$inject=["$state","ScopeValueService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){var t="api/allocationManagement/getRMallocateddetails";r.get(t).then(function(t){e.allocatedList=t.data.mappingdtl,console.log(t)})}var _=this;_.title="rmAllocationcontroller",g(),e.viewallocation=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("MyAllocation","Y"),a.go("app.allocationView")},e.genereteallocation=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),a.go("app.visitReportGenerate")}}angular.module("angle").controller("rmAllocationcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI();var t="api/newServiceTicket/employee";r.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/rmMapping/getstatedtls";r.get(t).then(function(t){e.statedtl=t.data.statedtl});var a={assignedRM_gid:localStorage.getItem("assignedRM_gid")},t="api/allocationManagement/getassignedAllocation";r.getparams(t,a).then(function(t){e.RMallocation=t.data.mappingdtl}),unlockUI()}var _=this;_.title="rmAllocationTransfer",g(),e.onchangestate=function(t){lockUI();var a={state_gid:t.state_gid},o="api/rmMapping/getdistrictdtls";r.getparams(o,a).then(function(t){e.districtdtl=t.data.statedtl}),unlockUI()},e.onchangedistrict=function(t){lockUI();var a={district_gid:t.district_gid};console.log(a);var o="api/allocationManagement/getallocateRM";r.getparams(o,a).then(function(t){console.log(t.data.assigned_RM),""==t.data.assigned_RM?alert("RM is Not Mapping for the Selected District"):(e.allocateRMname=t.data.assigned_RM,e.assignedRM_gid=t.data.assignedRM_gid)}),unlockUI()},e.checkall=function(t){angular.forEach(e.RMallocation,function(e){e.checked=t})},e.AllocationTransfer=function(){var t=[];if(angular.forEach(e.RMallocation,function(e){if(1==e.checked){var a=e.allocationdtl_gid;t.push(a)}}),Array.isArray(t)&&0==t.length)alert("Select Atleast one Customer");else{var o={allocationdtl_gid:t,transferred_to:e.cboemployeename.employee_id},n="api/allocationManagement/postAllocationTransfer";r.post(n,o).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.rmTransfer"),g()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}}angular.module("angle").controller("rmAllocationTransfer",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI(),e.totalDisplayed=100;var t="api/rmMapping/getmappingsummary";l.get(t).then(function(t){e.mappingdtlList=t.data.mappingdtl,null==e.mappingdtlList?(e.total=0,e.totalDisplayed=0):(e.total=e.mappingdtlList.length,e.mappingdtlList.length<100&&(e.totalDisplayed=e.mappingdtlList.length)),unlockUI()})}var _=this;_.title="rmMappingcontroller",g(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.addpincodeMapping=function(t){function e(t,e){lockUI();var a="api/rmMapping/getstatedtls";l.get(a).then(function(e){t.statedtl=e.data.statedtl});var a="api/newServiceTicket/employee";l.get(a).then(function(e){t.employee_list=e.data.employee_list}),unlockUI(),t.onselectedchange=function(e){var a={state_gid:e},o="api/rmMapping/getdistrictdtls";l.getparams(o,a).then(function(e){t.districtdtl=e.data.statedtl})},t.ok=function(){e.close("closed")},t.submitmapping=function(){var a=$("#cbostatename :selected").text(),o=$("#cbodistrictname :selected").text(),n={state_gid:t.cbostate_gid,district_gid:t.cbodistrict_gid,state_name:a,district_name:o,assigned_RM:t.cboemployeegid};lockUI();var i="api/rmMapping/postmappingdetails";l.post(i,n).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),e.close("closed"),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/addMaping.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.editmappingdtl=function(t){function e(e,o){lockUI();var n="api/newServiceTicket/employee";l.get(n).then(function(t){e.employee_list=t.data.employee_list});var n="api/rmMapping/getmappingdtl";l.getparams(n,a).then(function(t){e.district_name=t.data.district_name,e.state_name=t.data.state_name,e.employee_id=t.data.assigned_RM,e.ZonalRMname=t.data.ZonalRMname}),unlockUI(),e.ok=function(){o.close("closed")},e.updatemapping=function(){lockUI();var a={RMmapping_gid:t,assigned_RM:e.employee_id},n="api/rmMapping/updatemappingdetails";l.post(n,a).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.close("closed"),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={RMmapping_gid:t};n.open({templateUrl:"/EditMaping.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.deletemappingdtl=function(t){var e={RMmapping_gid:t};u.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/rmMapping/deletemappingdtl";l.getparams(a,e).then(function(t){1==t.data.status?(g(),u.swal("Deleted Successfully!")):s.alert(t.data.message,{status:"warning",pos:"top-center",timeout:3e3})})}})}}angular.module("angle").controller("rmMappingcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){p.formats=["dd-MM-yyyy"],p.format=p.formats[0],p.calender1=function(t){t.preventDefault(),t.stopPropagation(),p.open1=!0},""!=_&&"undefined"!=_?e.subbutton="N":e.subbutton="Y",lockUI();var t={allocationdtl_gid:g},a="api/ObservationReport/GetViewObservationReportDtl";if(l.getparams(a,t).then(function(t){e.customer_name=t.data.customer_name,e.customer_urn=t.data.customer_urn,e.vertical_code=t.data.vertical_code,e.RMD_visitname=t.data.RMD_visitname,e.RMD_visitGid=t.data.RMD_visitGid,e.relationship_manager_gid=t.data.relationship_manager_gid,e.relationship_manager_name=t.data.relationship_manager_name,e.visit_date=t.data.visit_date,e.sanction_amount=t.data.sanction_amount,e.disbursement_amount=t.data.disbursement_amount,e.txtoutstanding_amount=t.data.totalloan_outstanding,e.cboriskcode=t.data.risk_code,""!=t.data.PPA_name&&(e.txtPPA_name=t.data.PPA_name),e.disbursement_date=t.data.disbursement_date,e.txtcontact_details1=t.data.contact_details1,e.txtcontact_details2=t.data.contact_details2}),""!=_&&"undefined"!=_){var t={observation_reportgid:_},a="api/ObservationReport/GetViewObservationdtl";l.getparams(a,t).then(function(t){e.dateof_RMDvisit=t.data.dateof_RMDvisit,e.txtreportpertaining=t.data.report_pertainingto,e.vertical=t.data.vertical,e.cboapproval_authority=t.data.approving_authority,e.txtsanction_date=t.data.loansanction_date,e.txtPPA_name=t.data.PPA_name,e.RMD_visitname=t.data.RMDvisit_officialname,e.loandisbursement_date=t.data.loandisbursement_date,e.txtpeopleaccompanied_RMD=t.data.people_accompaniedRMD,e.outstanding_amount=t.data.outstanding_amount,e.txtcurrent_DPD=t.data.current_DPD,e.txtcontact_details1=t.data.contact_details1,e.txtcontact_details2=t.data.contact_details2,e.observation_flag=t.data.observation_flag});var a="api/ObservationReport/GetViewObservationCriticalDtl";l.getparams(a,t).then(function(t){e.criticalobservation=t.data.criticalobservation,e.trn_status="Y"}),unlockUI()}else{var t={allocationdtl_gid:g},a="api/ObservationReport/GetTmpCriticaldtl";l.getparams(a,t).then(function(t){e.criticalobservation=t.data.criticalobservation,e.trn_status="N",unlockUI()})}}var p=this;p.title="rmObservationReport";var g=c.search().allocationdtl_gid,_=c.search().observation_reportgid;m(),e.observations=function(t,e){function a(a,o){a.customer_name=t,a.customer_urn=e,a.ok=function(){o.close("closed")},a.criticalobservationsubmit=function(){var t={allocationdtl_gid:g,observation_reportgid:_,criteria:a.txtcriteria,RMD_observations:a.txtRMD_observations,actionable_recommended:a.txtactionable_recommend};lockUI();var e="api/ObservationReport/PostObservationCritical";l.post(e,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.close("closed"),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/criticalobservationModal.html",controller:a,size:"lg"});a.$inject=["$scope","$modalInstance"]},e.trndeleteCriticalObservation=function(t){var e={critical_observationgid:t},a="api/ObservationReport/GetDeleteTrnCriticalObser";l.getparams(a,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.deleteCriticalObservation=function(t){var e={tmpcritical_observationgid:t},a="api/ObservationReport/GetDeleteCriticalObser";l.getparams(a,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.outstandingamountchange=function(){var t,a=document.getElementById("outstanding_amount").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");"NaN"==i?(s.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtoutstanding_amount=""):e.txtoutstanding_amount=i},e.observationreportSubmit=function(){var t=e.visit_date,o=t.split("-").reverse().join("-"),n=e.disbursement_date,i=n.split("-").reverse().join("-"),r={observation_reportgid:_,customer_name:e.customer_name,customer_urn:e.customer_urn,risk_code:e.cboriskcode,dateof_RMDvisit:o,allocationdtl_gid:g,report_pertainingto:e.txtreportpertaining,vertical:e.vertical_code,disbursement_amount:e.disbursement_amount,approving_authority:e.cboapproval_authority,loansanction_date:e.txtsanction_date,relationship_manager_gid:e.relationship_manager_gid,relationship_manager_name:e.relationship_manager_name,PPA_name:e.txtPPA_name,RMDvisit_officialname:e.RMD_visitname,loandisbursement_date:i,people_accompaniedRMD:e.txtpeopleaccompanied_RMD,sanction_amount:e.sanction_amount,outstanding_amount:e.txtoutstanding_amount,current_DPD:e.txtcurrent_DPD,contact_details1:e.txtcontact_details1,contact_details2:e.txtcontact_details2};lockUI();var c="api/ObservationReport/PostObservationReport";l.post(c,r).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.rmVisitReport")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}angular.module("angle").controller("rmObservationReport",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){_.formats=["dd-MM-yyyy"],_.format=_.formats[0],_.calender1=function(t){t.preventDefault(),t.stopPropagation(),_.open1=!0};var t={observation_reportgid:v},a="api/ObservationReport/GetViewObservationdtl";l.getparams(a,t).then(function(t){e.customer_name=t.data.customer_name,e.customer_urn=t.data.customer_urn,e.dateof_RMDvisit=t.data.dateof_RMDvisit,e.report_pertainingto=t.data.report_pertainingto,e.vertical=t.data.vertical,e.disbursement_amount=t.data.disbursement_amount,e.approving_authority=t.data.approving_authority,e.loansanction_date=t.data.loansanction_date,e.relationship_manager_name=t.data.relationship_manager_name,e.PPA_name=t.data.PPA_name,e.RMDvisit_officialname=t.data.RMDvisit_officialname,e.loandisbursement_date=t.data.loandisbursement_date,e.people_accompaniedRMD=t.data.people_accompaniedRMD,e.sanction_amount=t.data.sanction_amount,e.outstanding_amount=t.data.outstanding_amount,e.current_DPD=t.data.current_DPD,e.contact_details1=t.data.contact_details1,e.contact_details2=t.data.contact_details2,e.observation_flag=t.data.observation_flag,e.txtATR_date=t.data.atr_completiondate,e.riskcode=t.data.risk_code,e.cboriskcode=t.data.risk_code,e.observationriskcode=t.data.risk_code});var a="api/ObservationReport/tmpTier1documentclear";l.get(a).then(function(t){});var a="api/ObservationReport/GetViewObservationCriticalDtl";l.getparams(a,t).then(function(t){e.criticalobservation=t.data.criticalobservation});var a="api/ObservationReport/GetTier1FormatDtl";l.getparams(a,t).then(function(t){e.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(e.cboriskcode=t.data.tier1_code),e.txtrationale_justification=t.data.tier1_justification,e.txtprocess_gap=t.data.tier1_processgap,e.txtcode_changereason=t.data.tier1code_changereason,e.tier1code_changeflag=t.data.tier1code_changeflag,e.txtimprovement_recommendation=t.data.tier1_processrecommendation,e.txtmanagement_comments=t.data.tier1_managementcomments,e.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,e.tier1format_gid=t.data.tier1format_gid,e.tier1_approvalstatus=t.data.tier1_approvalstatus,e.tier1approvallog=t.data.tier1approvallog,e.uploaddocument_list=t.data.tier1doc,e.tier1rejectlog=t.data.tier1rejectlog,"Y"==e.tier1code_changeflag?e.disablecodechangereasonshow=!0:e.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?e.nohistoryapproval=!0:e.historyapproval=!0,null==t.data.tier1rejectlog?e.rejecthistory=!1:e.rejecthistory=!0,null!=e.tier1format_gid&&"Approved"==e.tier1_approvalstatus?(e.observation_flag="T",e.doc=!0):null!=e.tier1format_gid&&"Rejected"==e.tier1_approvalstatus?(e.observation_flag="Y",e.btnupdated=!0,e.doc=!1):null!=e.tier1format_gid&&"Pending"==e.tier1_approvalstatus&&(e.observation_flag="T",e.doc=!0),"Y"==e.observation_flag&&"Rejected"==e.tier1_approvalstatus?e.btnupdate=!0:"Y"==e.observation_flag&&(e.btnsubmit=!0)})}var _=this;_.title="rmObservationReportView";var f=c.search().allocationdtl_gid,v=c.search().observation_reportgid;g(),e.downloads=function(t,e){m.Downloaddocument(t,e)},e.riskcodechange=function(t){e.riskcode==t?e.codechangereasonshow=!1:e.codechangereasonshow=!0},e.tier1formatsubmit=function(){var t=e.txtcode_changereason;if(e.riskcode==e.cboriskcode){var o=e.txtATR_date,n=o.split("-").reverse().join("-"),i={observation_reportgid:v,allocationdtl_gid:f,customer_name:e.customer_name,customer_urn:e.customer_urn,tier1_observations:e.txtobservations,tier1_code:e.cboriskcode,tier1code_changereason:t,tier1code_changeflag:"N",tier1_justification:e.txtrationale_justification,tier1_processgap:e.txtprocess_gap,tier1_processrecommendation:e.txtimprovement_recommendation,tier1_managementcomments:e.txtmanagement_comments,tier1_reverts_actionplan:e.txtcheifheadreverts_actionplan,tier1_atrdate:n};lockUI();var r="api/ObservationReport/PostTier1Format";l.post(r,i).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.rmVisitReport")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}else if(console.log(e.riskcode==e.cboriskcode),""==t||void 0==t)s.alert("Kindly Enter Risk Code - Change Reason",{status:"warning",pos:"top-center",timeout:3e3});else{var o=e.txtATR_date,n=o.split("-").reverse().join("-"),i={observation_reportgid:v,allocationdtl_gid:f,customer_name:e.customer_name,customer_urn:e.customer_urn,tier1_observations:e.txtobservations,tier1_code:e.cboriskcode,tier1code_changereason:t,tier1code_changeflag:"Y",tier1_justification:e.txtrationale_justification,tier1_processgap:e.txtprocess_gap,tier1_processrecommendation:e.txtimprovement_recommendation,tier1_managementcomments:e.txtmanagement_comments,tier1_reverts_actionplan:e.txtcheifheadreverts_actionplan,tier1_atrdate:n};lockUI();var r="api/ObservationReport/PostTier1Format";l.post(r,i).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.rmVisitReport")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.tier1formatUpdate=function(){var t=e.txtATR_date,o=t.split("-").reverse().join("-"),n={tier1format_gid:e.tier1format_gid,tier1_observations:e.txtobservations,tier1_code:e.cboriskcode,tier1code_changereason:e.txtcode_changereason,tier1_justification:e.txtrationale_justification,tier1_processgap:e.txtprocess_gap,tier1_processrecommendation:e.txtimprovement_recommendation,tier1_managementcomments:e.txtmanagement_comments,tier1_reverts_actionplan:e.txtcheifheadreverts_actionplan,tier1_atrdate:o,tier1_rejectedremarks:e.txttier1_rejectremarks};lockUI();var i="api/ObservationReport/PostUpdateTier1Format";l.post(i,n).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.rmVisitReport")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.uploaddocument=function(t,a,o){if(void 0==e.txtdocument_title||""==e.txtdocument_title)return alert("Enter the Document Title to Upload Document"),$("#addExternalupload").val(""),!1;for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=p.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_title",e.txtdocument_title),n.append("project_flag","documentformatonly"),e.uploadfrm=n,lockUI();var d="api/TierMeeting/PostTier1Upload";l.postFile(d,e.uploadfrm).then(function(t){e.uploaddocument_list=t.data.tier1document,$("#addExternalupload").val(""),e.txtdocument_title="",unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.uploadflag="Y"):(s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),e.uploadflag="N")})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/TierMeeting/GetTier1UploadCancel";l.getparams(o,a).then(function(t){e.uploaddocument_list=t.data.upload_list})}}angular.module("angle").controller("rmObservationReportView",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){var t={allocationdtl_gid:v},a="api/visitReport/GetAllocationLogDetail";l.getparams(a,t).then(function(t){e.customer_name=t.data.customer_name,e.customer_gid=t.data.customer_gid,e.customer_urn=t.data.customer_urn,e.allocated_date=t.data.allocated_date,e.scheduleList=t.data.schedulelogdtl,e.calllogdtlList=t.data.calllogdtl})}var f=this;f.title="rmScheduleLogDetails";var v=c.search().allocationdtl_gid;_(),e.callLogDetails=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.callLogsubmit=function(){var o={allocationdtl_gid:v,customer_gid:t,dialed_number:e.txtdialed_number,call_response:e.txtcall_response,call_remarks:e.txtcall_remarks
},n="api/visitReport/PostCallLog";l.post(n,o).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.close("closed"),_()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}i.open({templateUrl:"/callLogDetailsModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.callLogDetailsedit=function(t){function e(e,a){var o={calllog_gid:t},n="api/visitReport/GetCallLogDetails";l.getparams(n,o).then(function(t){e.txtdialed_number=t.data.dialed_number,e.txtcall_response=t.data.call_response,e.txtcall_remarks=t.data.call_remarks}),e.ok=function(){a.close("closed")},e.editcallLogsubmit=function(){var o={calllog_gid:t,dialed_number:e.txtdialed_number,call_response:e.txtcall_response,call_remarks:e.txtcall_remarks},n="api/visitReport/patchCallLogUpdate";lockUI(),l.post(n,o).then(function(t){unlockUI(),1==t.data.status?(a.close("closed"),s.alert(t.data.message,"success")):(a.close("closed"),s.alert(t.data.message,"Warning")),_()})}}i.open({templateUrl:"/callLogEditDetails.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.scheduleLogDetails=function(t){function e(e,a){f.mytime=new Date,f.hstep=1,f.mstep=15,f.ismeridian=!1,f.calender1=function(t){t.preventDefault(),t.stopPropagation(),f.open1=!0},e.ok=function(){a.close("closed")},e.scheduleappointment=function(){var o,n;if(void 0==e.txtappointment_time){var i=new Date;o=i.getHours()+":"+i.getMinutes()}else n=e.txtappointment_time,o=n.getHours()+":"+n.getMinutes();var r=new Date;r.setFullYear(e.txtappointmentdate.getFullYear()),r.setMonth(e.txtappointmentdate.getMonth()),r.setDate(e.txtappointmentdate.getDate());var c={allocationdtl_gid:v,customer_gid:t,appointment_date:r,appointment_time:o,appointment_status:e.txtappointmentstatus,appointment_remarks:e.txtremarks},d="api/visitReport/PostScheduleLog";l.post(d,c).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.close("closed"),_()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}i.open({templateUrl:"/schedule.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.scheduleLogDetailsEdit=function(t){function e(e,o){f.mytime=new Date,f.hstep=1,f.mstep=15,f.ismeridian=!1,f.calender1=function(t){t.preventDefault(),t.stopPropagation(),f.open1=!0};var i={schedulelog_gid:t},r="api/visitReport/GetScheduleLogDetails";l.getparams(r,i).then(function(t){e.txtappointmentdate=new Date(t.data.appointment_Date),e.txtappointment_time=new Date(t.data.appointment_Time),e.txtappointmentstatus=t.data.appointment_status,e.txtremarks=t.data.appointment_remarks});var r="api/visitReport/GetScheduleLogHistory";l.getparams(r,i).then(function(t){e.scheduleList=t.data.schedulelogdtl}),e.ok=function(){o.close("closed")},e.scheduleappointmentedit=function(){var o={schedulelog_gid:t,appointment_date:e.txtappointmentdate,appointment_time:e.txtappointment_time,appointment_status:e.txtappointmentstatus,appointment_remarks:e.txtremarks},i="api/visitReport/patchScheduleLogUpdate";lockUI(),l.post(i,o).then(function(t){if(1==t.data.status){s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI();var i="api/visitReport/GetScheduleLogHistory";l.getparams(i,o).then(function(t){e.scheduleList=t.data.schedulelogdtl}),e.current=a.current.name,n.store("dataldCtrl",e),c.url("app/rmScheduleLogDetails?allocationdtl_gid="+v)}else s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}}i.open({templateUrl:"/Editschedule.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.scheduleLoghistory=function(t){function e(e,a){var o={schedulelog_gid:t},n="api/visitReport/GetScheduleLogHistory";l.getparams(n,o).then(function(t){e.scheduleList=t.data.schedulelogdtl}),e.ok=function(){a.close("closed")}}i.open({templateUrl:"/SchedulehistoryModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.ScheduleStatus=function(t,e){function o(o,i){o.ok=function(){i.close("closed")},o.cboschedule_status=e,o.ScheduleStatusUpdate=function(){lockUI();var e={schedule_status:o.cboschedule_status,schedulelog_gid:t},r="api/visitReport/PostScheduleStatus";l.post(r,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),i.close("closed"),o.current=a.current.name,n.store("dataldCtrl",o),c.url("app/rmScheduleLogDetails?allocationdtl_gid="+v),_()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}i.open({templateUrl:"/ScheduleStatusModal.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("rmScheduleLogDetails",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$modal","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){var t="api/allocationManagement/getRMallocationList";r.get(t).then(function(t){e.RMallocation=t.data.mappingdtl})}var _=this;_.title="rmTransfercontroller",g(),e.transferRMdtl=function(t){localStorage.setItem("assignedRM_gid",t),a.go("app.rmAllocationTransfer")}}angular.module("angle").controller("rmTransfercontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){lockUI(),localStorage.setItem("RSK_RM","Y"),localStorage.setItem("CC","N"),localStorage.setItem("AgrCC","N"),localStorage.setItem("AgrSuprCC","N");var t="api/visitReport/GetRMTodayActivity";l.get(t).then(function(t){e.todayactivity=t.data.todayactivity,e.monthlyactivity=t.data.monthlyactivity,e.count_current=t.data.count_current,e.count_upcoming=t.data.count_upcoming,e.count_completed=t.data.count_completed,e.count_exclusion=t.data.count_external,e.overallRMdistrictdtl=t.data.mydistrictdtl,unlockUI()})}var g=this;g.title="rmVisitReportcontroller",p(),e.myschedule=function(){lockUI(),e.MySchedule=!0,localStorage.setItem("RSK_RM","Y");var t="api/visitReport/GetRMTodayActivity";l.get(t).then(function(t){e.todayactivity=t.data.todayactivity,e.monthlyactivity=t.data.monthlyactivity,e.count_current=t.data.count_current,e.count_upcoming=t.data.count_upcoming,e.count_completed=t.data.count_completed,unlockUI()})},e.current=function(){e.Current=!0,lockUI(),e.totalCurrentDisplayed=100;var t="api/allocationManagement/GetRMcurrentallocateddtl";l.get(t).then(function(t){e.count_current=t.data.count_current,e.allocatedList=t.data.rmallocation,null==e.allocatedList?(e.totalCurrent=0,e.totalCurrentDisplayed=0):(e.totalCurrent=e.allocatedList.length,e.allocatedList.length<100&&(e.totalCurrentDisplayed=e.allocatedList.length)),unlockUI()})},e.upcoming=function(){e.Upcoming=!0,lockUI(),e.totalUpcomingDisplayed=100;var t="api/allocationManagement/GetRMupcomingallocateddtl";l.get(t).then(function(t){e.count_upcoming=t.data.count_upcoming,e.upcomingallocationList=t.data.rmallocation,null==e.upcomingallocationList?(e.totalUpcoming=0,e.totalUpcomingDisplayed=0):(e.totalUpcoming=e.upcomingallocationList.length,e.upcomingallocationList.length<100&&(e.totalUpcomingDisplayed=e.upcomingallocationList.length)),unlockUI()})},e.exclusion=function(){e.Upcoming=!0,lockUI(),e.totalExclusionDisplayed=100;var t="api/allocationManagement/GetRMExclusiondetails";l.get(t).then(function(t){e.count_exclusion=t.data.count_exclusion,e.exclusionAllocationlist=t.data.exclusionAllocation,null==e.exclusionAllocationlist?(e.totalExclusion=0,e.totalExclusionDisplayed=0):(e.totalExclusion=e.exclusionAllocationlist.length,e.exclusionAllocationlist.length<100&&(e.totalExclusionDisplayed=e.exclusionAllocationlist.length)),unlockUI()})},e.completed=function(){e.Completed=!0,lockUI();var t="api/allocationManagement/getRMCompleteddetails";l.get(t).then(function(t){e.count_completed=t.data.count_completed,e.completedallocationList=t.data.rmallocation,null==e.completedallocationList?(e.totalCompleted=0,e.totalCompletedDisplayed=0):(e.totalCompleted=e.completedallocationList.length,e.completedallocationList.length<100&&(e.totalCompletedDisplayed=e.completedallocationList.length)),unlockUI()})},e.loadCurrentMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalCurrentDisplayed<e.allocatedList.length?(e.totalCurrentDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.allocatedList.length+" Records Only","warning"))},e.loadUpcomingMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalUpcomingDisplayed<e.upcomingallocationList.length?(e.totalUpcomingDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.upcomingallocationList.length+" Records Only","warning"))},e.loadExclusionMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalUpcomingDisplayed<e.exclusionAllocationlist.length?(e.totalUpcomingDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.exclusionAllocationlist.length+" Records Only","warning"))},e.loadCompletedMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalUpcomingDisplayed<e.completedallocationList.length?(e.totalUpcomingDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.completedallocationList.length+" Records Only","warning"))},e.schedulecurrentlog=function(t,e,a){c.url("app/rmScheduleLogDetails?allocationdtl_gid="+t)},e.scheduleupcominglog=function(t){c.url("app/rmScheduleLogDetails?allocationdtl_gid="+t)},e.schedulecompletelog=function(t){c.url("app/rmScheduleLogView?allocationdtl_gid="+t)},e.observationreport=function(t,e){c.url("app/rmObservationReport?allocationdtl_gid="+t+"&?&observation_reportgid="+e)},e.exclusioncustomer=function(t,e,o,r){function c(n,c){n.ok=function(){c.close("closed")},n.customer_urn=e,n.customername=o,n.customer_status=r;var d={customer_urn:e},u="api/zonalAllocation/GetExclusionCustomerHistory";l.getparams(u,d).then(function(t){n.exclusioncustomerHistory=t.data.exclusionhistory,null==t.data.exclusionhistory?n.Nohistoryexclusion=!0:n.historyexclusion=!0}),n.confirmExclusioncustomer=function(){var o={customer_urn:e,allocationdtl_gid:t,exclusion_reason:n.txtexclusion_reason},r="api/ExclusionList/GetExclusionAllocation";l.getparams(r,o).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.close("closed"),n.current=a.current.name,i.store("dataldCtrl",n),a.go("app.pageredirect")):(s.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),c.close("closed"))})}}n.open({templateUrl:"/exclusionpopup.html",controller:c,size:"lg"});c.$inject=["$scope","$modalInstance"]},e.observationviewreport=function(t,e){c.url("app/rmObservationReportView?allocationdtl_gid="+t+"&?&observation_reportgid="+e)},e.reportCanceldtl=function(t,e,a){function o(o,n){o.ok=function(){n.close("closed")},o.customername=a,o.proceedReportCancel=function(){lockUI();var a={cancel_reason:o.txtcancel_reason,allocationdtl_gid:t,customer_gid:e},i="api/VisitReportCancel/PostCancelReport";l.post(i,a).then(function(a){1==a.data.status?(s.alert(a.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.close("closed"),c.url("app/visitReportCancel?allocationdtl_gid="+t+"&allocation_customer_gid="+e)):(s.alert(a.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/reportCancelModal.html",controller:o,size:"md"});o.$inject=["$scope","$modalInstance"]},e.visitStatus=function(t,e,o,r){function c(n,c){n.ok=function(){c.close("closed")},n.customername=e,n.customer_urn=o,n.txtVisitStatus=r,n.VisitStatusUpdate=function(){lockUI();var e={visit_status:n.txtVisitStatus,allocationdtl_gid:t},o="api/VisitReportCancel/PostVisitStatus";l.post(o,e).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),c.close("closed"),n.current=a.current.name,i.store("dataldCtrl",n),a.go("app.pageredirect")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/visitStatusModal.html",controller:c,size:"md"});c.$inject=["$scope","$modalInstance"]},e.viewallocationDtl=function(t,e,a){if("Allocated"==a)var o="N";else var o="Y";var n="api/allocationManagement/tmpAllocatedocumentclear";l.get(n).then(function(t){});var n="app/allocationView?allocationdtl_gid="+t+"&?&allocation_customer_gid="+e+"&?&MyAllocation=Y&?&completed_flag="+o;c.url(n),console.log("url",n)},e.genereteallocation=function(t,e){lockUI();var a={allocationdtl_gid:t},o="api/visitReport/GetScheduleInfo";l.getparams(o,a).then(function(a){"Y"==a.data.info_flag?c.url("app/visitReportGenerate?allocationdtl_gid="+t+"&allocation_customer_gid="+e):s.alert(a.data.message,{status:"warning",pos:"top-center",timeout:3e3}),unlockUI()})},e.Viewgenereteddtl=function(t){c.url("app/visitReportdetailView?allocationdtl_gid="+t)},e.generetePDF=function(t){lockUI();var e={allocationdtl_gid:t},a="api/zonalAllocation/visitReportpdfcontent";l.getparams(a,e).then(function(t){if(1==t.data.status){var e=t.data.file_path,a=t.data.file_name;m.Downloaddocument(e,a)}else unlockUI(),s.alert("Error Occurred While Export PDF !","warning");unlockUI()})},e.genereteATRPDF=function(t){var e={observation_reportgid:t},a="api/ObservationReport/ATRReportpdfcontent";lockUI(),l.getparams(a,e).then(function(t){if(1==t.data.status){var e=t.data.file_name,a=t.data.file_path;m.Downloaddocument(a,e)}else unlockUI(),s.alert("Error Occurred While Export PDF !","warning")})}}angular.module("angle").controller("rmVisitReportcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g,_,f){function v(){h.barOptions={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,animationSteps:100,animationEasing:"easeInOutSine"};var t="api/RskDashboard/GetAllocationDtl";c.get(t).then(function(t){var e=t.data.allocationvisitgraphdtl;console.log(t),null==e?h.barData={labels:[],datasets:[{fillColor:n.byName("success"),strokeColor:n.byName("success"),highlightFill:n.byName("info"),highlightStroke:n.byName("info"),data:[]},{fillColor:n.byName("warning"),strokeColor:n.byName("warning"),highlightFill:n.byName("primary"),highlightStroke:n.byName("primary"),data:[]}]}:h.barData={labels:[e[4].monthname,e[3].monthname,e[2].monthname,e[1].monthname,e[0].monthname],datasets:[{fillColor:n.byName("success"),strokeColor:n.byName("success"),highlightFill:n.byName("info"),highlightStroke:n.byName("info"),data:[e[4].countAllocated,e[3].countAllocated,e[2].countAllocated,e[1].countAllocated,e[0].countAllocated]},{fillColor:n.byName("warning"),strokeColor:n.byName("warning"),highlightFill:n.byName("primary"),highlightStroke:n.byName("primary"),data:[e[4].countCompleted,e[3].countCompleted,e[2].countCompleted,e[1].countCompleted,e[0].countCompleted]}]}});var t="api/RskDashboard/GetRskPrivilege",a=localStorage.getItem("user_gid");c.get(t+"?user_gid="+a).then(function(t){var a=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKSANMAN"),o=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKSANCUS"),n=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKSANMYC"),i=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCMAN"),r=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCZAC"),l=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCRMA"),s=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCTAP"),c=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCACT"),d=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCORA"),u=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCTRT"),m=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCTIA"),p=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCTI3"),g=t.data.rskprivilege_list.map(function(t){return t.rskprivilege}).indexOf("RSKALCART");a!=-1?e.sanction_show="Y":e.sanction_show="N",o!=-1?e.customerManagement_show="Y":e.customerManagement_show="N",n!=-1?e.zonalCustomer_show="Y":e.zonalCustomer_show="N",i!=-1?e.caseAllocation_show="Y":e.caseAllocation_show="N",r!=-1?e.zonalAllocation_show="Y":e.zonalAllocation_show="N",l!=-1?e.visitManagement_show="Y":e.visitManagement_show="N",s!=-1?e.transferApproval_show="Y":e.transferApproval_show="N",c!=-1?e.allocationTransfer_show="Y":e.allocationTransfer_show="N",d!=-1?e.observationApproval_show="Y":e.observationApproval_show="N",u!=-1?e.tierreport_show="Y":e.tierreport_show="N",m!=-1?e.tier2approval_show="Y":e.tier2approval_show="N",p!=-1?e.tier3preparation_show="Y":e.tier3preparation_show="N",g!=-1?e.allocationreport_show="Y":e.allocationreport_show="N"})}var h=this;h.title="rskDashboardcontroller",v()}angular.module("angle").controller("rskDashboardcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","Colors","ChartData","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","$timeout","SweetAlert","$cookies"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){_.calender1=function(t){t.preventDefault(),t.stopPropagation(),_.open1=!0},_.calender2=function(t){t.preventDefault(),t.stopPropagation(),_.open2=!0},_.calender3=function(t){t.preventDefault(),t.stopPropagation(),_.open3=!0},_.calender4=function(t){t.preventDefault(),t.stopPropagation(),_.open4=!0},_.dateOptions={formatYear:"yy",startingDay:1},_.formats=["dd-MM-yyyy"],_.format=_.formats[0];var t="api/customer/customer";l.get(t).then(function(t){e.customer_list=t.data.customer_list});var t="api/newServiceTicket/employee";l.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/documentation/getdocumentationdtlList";l.get(t).then(function(t){e.documentationdtl=t.data.documentationdtl})}var _=this;_.title="sanctionAddcontroller",g(),e.amountschange=function(){var t,a=document.getElementById("txtInput").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txtSanctionAmount=i},e.sanctionlimitchange=function(){var t,a=document.getElementById("txt_SanctionLimit").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txtSanctionLimit=i},e.revisedlimitchange=function(){var t,a=document.getElementById("txt_RevisedLimit").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txtRevisiedLimit=i},e.existinglimitchange=function(){var t,a=document.getElementById("txt_ExistingLimit").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txtexistingLimit=i},e.sanctionformSubmit=function(){var t,o=e.txtSanctionAmount,n=o.split(",");for(t=0;t<n.length;t++){var i=o.replace(",","");o=i}lockUI();var r={customer_gid:e.cbocustomergid.customer_gid,sanction_refno:e.txtsanctionRefNo,sanction_date:e.txtSanctionDate,sanction_amount:o,sanction_limit:e.txtSanctionLimit,sanction_validity:e.txtValidity,expiry_date:e.txtExpiryDate,review_date:e.txtReviewDate,approval_authority:e.cboapproval_authority,natureof_proposal:e.cbonature_proposal,constitution:e.cboconstitution,authorized_signatory:e.cboauthorizedsignatory.employee_gid,tenure_months:e.txt_tenuremonths,revisied_limit:e.txtRevisiedLimit,existing_limit:e.txtexistingLimit,escrow_account:e.cboEscrowAccount,specific_conditions:e.txtspecificcondition,facility_type:e.cbofacilitytype,documentationname:e.cbodocumentationname},c="api/sanction/postsanctiondetails";l.post(c,r).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.sanctionManagement"),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.cancel=function(){a.go("app.sanctionManagement")}}angular.module("angle").controller("sanctionAddcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){e.documentationEdit=[],_.calender1=function(t){t.preventDefault(),t.stopPropagation(),_.open1=!0},_.calender2=function(t){t.preventDefault(),t.stopPropagation(),_.open2=!0},_.calender3=function(t){t.preventDefault(),t.stopPropagation(),_.open3=!0},_.calender4=function(t){t.preventDefault(),t.stopPropagation(),_.open4=!0},_.dateOptions={formatYear:"yy",startingDay:1},_.formats=["dd-MM-yyyy"],_.format=_.formats[0],lockUI();var t="api/customer/customer";l.get(t).then(function(t){e.customer_list=t.data.customer_list});var t="api/documentation/getdocumentationdtlList";l.get(t).then(function(t){e.documentationdtl=t.data.documentationdtl});var t="api/newServiceTicket/employee";l.get(t).then(function(t){e.employee_list=t.data.employee_list});var a={customer2sanction_gid:localStorage.getItem("customer2sanction_gid")},t="api/sanction/getsanctiondetails";l.getparams(t,a).then(function(t){if(e.customer_gid=t.data.customer_gid,e.txteditsanctionRefNo=t.data.sanction_refno,e.txteditSanctionDate=t.data.sanctionDate,e.txteditSanctionAmount=t.data.sanction_amount,e.txteditSanctionLimit=t.data.sanction_limit,e.txtEditValidity=t.data.sanction_validity,e.txtEditExpiryDate=t.data.expiry_date,e.txtEditReviewDate=t.data.review_date,e.cboeditapproval_authority=t.data.approval_authority,e.cboEditnature_proposal=t.data.natureof_proposal,e.cboEditconstitution=t.data.constitution,e.cboEditauthorizedsignatory=t.data.authorized_signatory,e.txtEditRevisiedLimit=t.data.revisied_limit,e.txtEditexistingLimit=t.data.existing_limit,e.cboEditEscrowAccount=t.data.escrow_account,e.txtEditspecificcondition=t.data.specific_conditions,e.cboEditfacilitytype=t.data.facility_type,e.documentationEdit=t.data.documentationname,e.txtEdittenure_months=t.data.tenure_months,console.log(t),e.documentationEditData=[],null!=t.data.documentationname)for(var a=t.data.documentationname.length,o=0;o<a;o++){var n=e.documentationdtl.map(function(t){return t.customer2document_gid}).indexOf(t.data.documentationname[o].customer2document_gid);e.documentationEditData.push(e.documentationdtl[n])}}),unlockUI()}var _=this;_.title="sanctionEditcontroller",g(),e.amountschange=function(){var t,a=document.getElementById("txtInput").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txteditSanctionAmount=i},e.sanctionlimitchange=function(){var t,a=document.getElementById("txtSanctionLimit").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txteditSanctionLimit=i},e.revisedlimitchange=function(){var t,a=document.getElementById("txtRevisedLimit").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txtEditRevisiedLimit=i},e.existinglimitchange=function(){var t,a=document.getElementById("txtExistingLimit").value,o=a.split(",");for(t=0;t<o.length;t++){var n=a.replace(",","");a=n}var i=Number(n).toLocaleString("en-US");e.txtEditexistingLimit=i},e.sanctionformUpdate=function(){var t,o=e.txteditSanctionAmount,n=o.split(",");for(t=0;t<n.length;t++){var i=o.replace(",","");o=i}lockUI();var r={customer2sanction_gid:localStorage.getItem("customer2sanction_gid"),customer_gid:e.customer_gid,sanction_refno:e.txteditsanctionRefNo,sanction_date:e.txteditSanctionDate,sanction_amount:o,sanction_limit:e.txteditSanctionLimit,sanction_validity:e.txtEditValidity,expiry_date:e.txtEditExpiryDate,review_date:e.txtEditReviewDate,approval_authority:e.cboeditapproval_authority,natureof_proposal:e.cboEditnature_proposal,constitution:e.cboEditconstitution,authorized_signatory:e.cboEditauthorizedsignatory,revisied_limit:e.txtEditRevisiedLimit,tenure_months:e.txtEdittenure_months,existing_limit:e.txtEditexistingLimit,escrow_account:e.cboEditEscrowAccount,specific_conditions:e.txtEditspecificcondition,facility_type:e.cboEditfacilitytype,documentationname:e.documentationEditData},c="api/sanction/postsanctionupdate";l.post(c,r).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.sanctionManagement"),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.cancel=function(){a.go("app.sanctionManagement")}}angular.module("angle").controller("sanctionEditcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI(),e.totalDisplayed=100;var t="api/sanction/getsanctiondtlList";l.get(t).then(function(t){e.sanctionlist=t.data.sanctiondetails,null==e.sanctionlist?(e.total=0,e.totalDisplayed=0):(e.total=e.sanctionlist.length,e.sanctionlist.length<100&&(e.totalDisplayed=e.sanctionlist.length)),unlockUI()})}var _=this;_.title="sanctionManagementcontroller",g(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);if(null!=e.sanctionlist){if(!(e.totalDisplayed<e.sanctionlist.length))return unlockUI(),void s.alert(" Total Summary "+e.sanctionlist.length+" Records Only","warning");e.totalDisplayed+=a,unlockUI()}unlockUI()},e.selectedFile=null,e.msg="",e.importExcel=function(){e.test=!0,e.btnimport=!0},e.uploadcancel=function(){lockUI(),e.test=!1,e.btnimport=!1,unlockUI()},e.documetnchecklistsanction=function(t){localStorage.setItem("customer2sanction_gid",t),a.go("app.documentCheckList")},e.handleFile=function(t,a,o){for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=cmnfunctionService.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("project_flag","documentformatonly"),e.uploadfrm=n;var d="api/sanction/postexcelupload";l.postFile(d,e.uploadfrm).then(function(t){e.filename_list=t.data.filename_list,console.log(t),$("#addupload").val(""),1==t.data.status?s.alert("Document Uploaded Successfully..!!",{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.loadFile=function(t){e.$apply(function(){e.selectedFile=t[0]})},e.save=function(t){lockUI();var e="api/sanction/postexcelupload";l.post(e,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),$("#excelImport").val(""),g(),unlockUI()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.addSanction=function(){a.go("app.sanctionAdd")},e.editsanction=function(t){localStorage.setItem("customer2sanction_gid",t),a.go("app.sanctionEdit")},e.viewsanction=function(t){localStorage.setItem("customer2sanction_gid",t),a.go("app.sanctionView")},e.deletesanction=function(t){var e={customer2sanction_gid:t};u.swal({title:"Are you sure?",text:"Do You Want To Delete the Record ?",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t){var a="api/sanction/getsanctiondelete";l.getparams(a,e).then(function(t){1==t.data.status?(g(),u.swal("Deleted Successfully!")):s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3})})}})}}angular.module("angle").controller("sanctionManagementcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI();var t={customer2sanction_gid:localStorage.getItem("customer2sanction_gid")},a="api/sanction/getsanctiondetails";l.getparams(a,t).then(function(t){e.customer_name=t.data.customer_name,e.txteditsanctionRefNo=t.data.sanction_refno,e.txteditSanctionDate=t.data.sanction_date,e.txteditSanctionAmount=t.data.sanction_amount,e.txteditSanctionLimit=t.data.sanction_limit,e.txtEditValidity=t.data.sanction_validity,e.txtEditExpiryDate=t.data.expiry_date,e.txtEditReviewDate=t.data.review_date,e.cboeditapproval_authority=t.data.approval_authority,e.cboEditnature_proposal=t.data.natureof_proposal,e.cboEditconstitution=t.data.constitution,e.cboEditauthorizedsignatory=t.data.authorizedsignatoryname,e.txtEditRevisiedLimit=t.data.revisied_limit,e.txtEditexistingLimit=t.data.existing_limit,e.cboEditEscrowAccount=t.data.escrow_account,e.txtEditspecificcondition=t.data.specific_conditions,e.cboEditfacilitytype=t.data.facility_type,e.documentationname=t.data.documentationname,e.customer_urn=t.data.customer_urn}),unlockUI()}var _=this;_.title="sanctionViewcontroller",g(),e.back=function(){a.go("app.sanctionManagement")}}angular.module("angle").controller("sanctionViewcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","apiManage","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){var t={tier1format_gid:localStorage.getItem("tier1format_gid")};lockUI();var a="api/TierMeeting/GetTier1ApprovalDtl";l.getparams(a,t).then(function(t){e.customer_name=t.data.customer_name,e.customer_urn=t.data.customer_urn,e.tier1_observations=t.data.tier1_observations,e.tier1_code=t.data.tier1_code,e.tier1_justification=t.data.tier1_justification,e.tier1_processgap=t.data.tier1_processgap,e.tier1_processrecommendation=t.data.tier1_processrecommendation,e.tier1_managementcomments=t.data.tier1_managementcomments,e.tier1_reverts_actionplan=t.data.tier1_reverts_actionplan,e.tier1_atrdate=t.data.tier1_atrdate,e.tier1approvallog=t.data.tier1approvallog,e.txtcode_changereason=t.data.tier1code_changereason,e.tier1code_changeflag=t.data.tier1code_changeflag,e.tier3_status=t.data.tier3_status,e.uploaddocument_list=t.data.tier1doc,e.tier1rejectlog=t.data.tier1rejectlog,e.tier1_approvalstatus=t.data.tier1_approvalstatus,"Y"==e.tier1code_changeflag?e.disablecodechangereasonshow=!0:e.disablecodechangereasonshow=!1,"Approved"==e.tier1_approvalstatus?e.editdisable=!0:e.editenable=!0,null==t.data.tier1approvallog?e.nohistoryapproval=!0:e.historyapproval=!0,null==t.data.tier1rejectlog?e.rejecthistory=!1:e.rejecthistory=!0,unlockUI()})}var g=this;g.title="tier1Approvalcontroller",
p(),e.viewcustomerdtl=function(){var t=location.protocol+"//"+location.hostname+"/v1/#/app/tierCustomer360";window.open(t,"_blank")},e.tier1approve=function(){var t={tier1format_gid:localStorage.getItem("tier1format_gid"),approval_remarks:e.txttier1_approvalremarks};lockUI();var o="api/TierMeeting/PostTier1Approved";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.tier1Summary")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.downloads=function(t,e){m.Downloaddocument(t,e)},e.tier1reject=function(){var t={tier1format_gid:localStorage.getItem("tier1format_gid"),approval_remarks:e.txttier1_approvalremarks};lockUI();var o="api/TierMeeting/PostTier1Rejected";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.tier1Summary")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}angular.module("angle").controller("tier1Approvalcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){e.totalDisplayed=100;var t="api/TierMeeting/GetTier1formatlist";l.get(t).then(function(t){e.count_pending=t.data.count_pending,e.count_approved=t.data.count_approved,e.count_rejected=t.data.count_rejected,e.tier1format=t.data.tier1format,null==e.tier1format?(e.total=0,e.totalDisplayed=0):(e.total=e.tier1format.length,e.tier1format.length<100&&(e.totalDisplayed=e.tier1format.length))})}var p=this;p.title="tier1Summarycontroller",m(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.viewtier1format=function(t,e){localStorage.setItem("tier1format_gid",t),localStorage.setItem("allocationdtl_gid",e),a.go("app.tier1Approval")}}angular.module("angle").controller("tier1Summarycontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){var t={tier2preparation_gid:localStorage.getItem("tier2preparation_gid")},a="api/TierMeeting/GetTier2ViewDtl";l.getparams(a,t).then(function(t){e.zonal_name=t.data.zonal_name,e.cbomonth=t.data.tier2_monthname,e.vertical=t.data.vertical,e.cbovertical_gid=t.data.vertical_gid,e.cboemployeegid=t.data.headRMD_gid,e.headRMD_name=t.data.headRMD_name,e.txttier2_remarks=t.data.tier2_remarks,e.tier2_approval_status=t.data.tier2_approval_status,console.log(e.tier2_approval_status),e.created_date=t.data.created_date,e.created_by=t.data.created_by,e.uploaddocument_list=t.data.tier2document,e.tier2approvallog=t.data.tier2approvallog,e.tierallocationdtl=t.data.tierallocationdtl,e.tier3_status=t.data.tier3_status,"Approved"==e.tier2_approval_status?e.editdisable=!0:e.editenable=!0,null==t.data.tier2approvallog?e.nohistoryapproval=!0:e.historyapproval=!0,unlockUI()})}var g=this;g.title="tier2Approval",p(),e.viewcustomerdtl=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e);var a=location.protocol+"//"+location.hostname+"/v1/#/app/tierCustomer360";window.open(a,"_blank")},e.tier2Approve=function(){var t={tier2preparation_gid:localStorage.getItem("tier2preparation_gid"),approval_remarks:e.txttier2_approvalremarks};lockUI();var o="api/TierMeeting/PostTier2Approved";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.tier2ApprovalSummary")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.tier2Reject=function(){var t={tier2preparation_gid:localStorage.getItem("tier2preparation_gid"),approval_remarks:e.txttier2_approvalremarks};lockUI();var o="api/TierMeeting/PostTier2Rejected";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.tier2ApprovalSummary")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.riskcodechange=function(t,e,a,o){function i(n,i){n.customer_name=e,n.customer_urn=a,n.cboriskcode=o,n.ok=function(){i.close("closed")};var r={allocationdtl_gid:t},s="api/TierMeeting/GetTierColorDetails";l.getparams(s,r).then(function(t){n.tiercodedtl=t.data.tiercodedtl})}n.open({templateUrl:"/riskcodechangeModal.html",controller:i,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.downloads=function(t,e){m.Downloaddocument(t,e)}}angular.module("angle").controller("tier2Approval",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){lockUI();var t="api/TierMeeting/GetTier2ApprovalSummary";l.get(t).then(function(t){e.tier2preparation_list=t.data.tier2preparation,e.count_pending=t.data.count_pending,e.count_approved=t.data.count_approved,e.count_rejected=t.data.count_rejected,null==e.tier2preparation_list?(e.total=0,e.totalDisplayed=0):(e.total=e.tier2preparation_list.length,e.tier2preparation_list.length<100&&(e.totalDisplayed=e.tier2preparation_list.length)),unlockUI()})}var g=this;g.title="tier2ApprovalSummary",p(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalDisplayed<e.tier2preparation_list.length?(e.totalDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.tier2preparation_list.length+" Records Only","warning"))},e.viewtier2dtl=function(t){localStorage.setItem("tier2preparation_gid",t),a.go("app.tier2Approval")}}angular.module("angle").controller("tier2ApprovalSummary",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){var t="api/employee/employee";l.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/TierMeeting/GetTier2Monthdtl";l.get(t).then(function(t){e.monthname_list=t.data.monthname,e.zonal_name=t.data.zonal_name,e.zonalmapping_gid=t.data.zonalmapping_gid,unlockUI()})}var f=this;f.title="tier2Createcontroller",_(),e.viewcustomerdtl=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e);var a=location.protocol+"//"+location.hostname+"/v1/#/app/tierCustomer360";window.open(a,"_blank")},e.monthchange=function(t){var a={month:t,tier2:"Y",zonalmapping_gid:e.zonalmapping_gid},o="api/TierMeeting/GetVertical";l.getparams(o,a).then(function(t){e.vertical_list=t.data.tiervertical})},e.verticalchange=function(t){var a={vertical_gid:t,month:e.cbomonth,tier2_flag:"Y"};lockUI();var o="api/TierMeeting/GetVerticalAllocationdtl";l.getparams(o,a).then(function(t){e.tierallocationdtl=t.data.tierallocationdtl,e.tier2dtl=!0,unlockUI()})},e.riskcodechange=function(t,e,a,o,i){function r(n,r){n.customer_name=a,n.customer_urn=o,n.txtcode_changereason="",n.cboriskcode=i;var c={allocationdtl_gid:t},d="api/TierMeeting/GetTier2ColorDetails";l.getparams(d,c).then(function(t){n.tiercodedtl=t.data.tiercodedtl,n.tmptier_stage=t.data.tier_stage,n.tmptier_code=t.data.tier_code,n.tmptiercode_changereason=t.data.tiercode_changereason,n.tmptier2_codechange=t.data.tmptier2_codechange,null==t.data.tmptier2_codechange||void 0==t.data.tmptier2_codechange?(n.tmpcodevisible=!0,n.tmpdata=!1):(n.tmpcodevisible=!1,n.tmpdata=!0)}),n.ok=function(){r.close("closed")},n.cboriskcodechange=function(t){i==t?n.codechangereasonshow=!1:(n.codechangereasonshow=!0,n.txtcode_changereason="")},n.riskcodechangecancel=function(e){var a={tmptier2_codechange:e};lockUI();var o="api/TierMeeting/GetTier2ColorDelete";l.getparams(o,a).then(function(e){if(1==e.data.status){s.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),n.tmpdata=!1,n.tmpcodevisible=!0;var a={allocationdtl_gid:t},o="api/TierMeeting/GetTier2ColorDetails";l.getparams(o,a).then(function(t){n.tiercodedtl=t.data.tiercodedtl,n.cboriskcode=i})}else s.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},n.riskcodechangesubmit=function(){var a={tier1format_gid:e,allocationdtl_gid:t,tier2_code:n.cboriskcode,tier2code_changereason:n.txtcode_changereason};lockUI();var o="api/TierMeeting/PostTier2codeChange";l.post(o,a).then(function(e){if(1==e.data.status){s.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.txtcode_changereason="",n.codechangereasonshow=!1,n.tmpcodevisible=!1,n.tmpdata=!0;var a={allocationdtl_gid:t},o="api/TierMeeting/GetTier2ColorDetails";l.getparams(o,a).then(function(t){n.tiercodedtl=t.data.tiercodedtl,""!=t.data.tier_code?(n.tmptier_stage=t.data.tier_stage,n.tmptier_code=t.data.tier_code,n.tmptiercode_changereason=t.data.tiercode_changereason,n.tmptier2_codechange=t.data.tmptier2_codechange):n.tmpdata=!1}),unlockUI()}else s.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}}n.open({templateUrl:"/riskcodechangeModal.html",controller:r,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.uploaddocument=function(t,a,o){if(void 0==e.txtdocument_title||""==e.txtdocument_title)return alert("Enter the Document Title to Upload Document"),$("#addExternalupload").val(""),!1;for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=g.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_title",e.txtdocument_title),n.append("project_flag","documentformatonly"),e.uploadfrm=n,lockUI();var d="api/TierMeeting/PostTier2Upload";l.postFile(d,e.uploadfrm).then(function(t){e.uploaddocument_list=t.data.tier2document,$("#addExternalupload").val(""),e.txtdocument_title="",unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.uploadflag="Y"):(s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),e.uploadflag="N")})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/TierMeeting/GetTier2UploadCancel";l.getparams(o,a).then(function(t){e.uploaddocument_list=t.data.upload_list})},e.submittier2=function(){if(lockUI(),"Y"!=e.uploadflag)s.alert("Atleast Upload One Document to Submit..!",{status:"warning",pos:"top-center",timeout:3e3}),unlockUI();else{var t=$("#cboverticalname :selected").text(),o=$("#cboemployeename :selected").text(),n={zonalmapping_gid:e.zonalmapping_gid,zonal_name:e.zonal_name,tier2_month:e.cbomonth,vertical_gid:e.cbovertical_gid,vertical:t,headRMD_gid:e.cboemployeegid,headRMD_name:o,tier2_remarks:e.txttier2_remarks},i="api/TierMeeting/PostTier2Preparation";l.post(i,n).then(function(t){1==t.data.status?(e.txttier2_remarks="",s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.tier2Preparation")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}}angular.module("angle").controller("tier2Createcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){e.totalDisplayed=100;var t="api/TierMeeting/GetTier2Summary";l.get(t).then(function(t){e.tier2preparation_list=t.data.tier2preparation,e.count_pending=t.data.count_pending,e.count_approved=t.data.count_approved,e.count_rejected=t.data.count_rejected,null==e.tier2preparation_list?(e.total=0,e.totalDisplayed=0):(e.total=e.tier2preparation_list.length,e.tier2preparation_list.length<100&&(e.totalDisplayed=e.tier2preparation_list.length))})}var p=this;p.title="tier2Preparation",m(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.createtier2preparation=function(){a.go("app.tier2Create")},e.viewtier2details=function(t){localStorage.setItem("tier2preparation_gid",t),a.go("app.tier2PreparationView")}}angular.module("angle").controller("tier2Preparation",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI();var t="api/employee/employee";l.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/TierMeeting/GetTier2Monthdtl";l.get(t).then(function(t){e.monthname_list=t.data.monthname});var t="api/vertical/vertical";l.get(t).then(function(t){e.vertical_list=t.data.vertical_list});var a={tier2preparation_gid:localStorage.getItem("tier2preparation_gid")},t="api/TierMeeting/GetTier2ViewDtl";l.getparams(t,a).then(function(t){e.zonal_name=t.data.zonal_name,e.cbomonth=t.data.tier2_month,e.monthname=t.data.tier2_monthname,e.vertical=t.data.vertical,e.cbovertical_gid=t.data.vertical_gid,e.cboemployeegid=t.data.headRMD_gid,e.headRMD_name=t.data.headRMD_name,e.txttier2_remarks=t.data.tier2_remarks,e.tier2_approval_status=t.data.tier2_approval_status,e.created_date=t.data.created_date,e.created_by=t.data.created_by,e.uploaddocument_list=t.data.tier2document,e.tier2approvallog=t.data.tier2approvallog,e.tierallocationdtl=t.data.tierallocationdtl,e.zonalmapping_gid=t.data.zonalmapping_gid,null==t.data.tier2approvallog||(e.historyapproval=!0),"Pending"==e.tier2_approval_status||"Rejected"==e.tier2_approval_status?(e.edittier2dtl=!0,e.viewtier2dtl=!1):(e.edittier2dtl=!1,e.viewtier2dtl=!0),unlockUI()})}var _=this;_.title="tier2PreparationView",g(),e.viewcustomerdtl=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e);var a=location.protocol+"//"+location.hostname+"/v1/#/app/tierCustomer360";window.open(a,"_blank")},e.riskcodehistory=function(t,e,a,o){function i(n,i){n.customer_name=e,n.customer_urn=a,n.cboriskcode=o,n.ok=function(){i.close("closed")};var r={allocationdtl_gid:t},s="api/TierMeeting/GetTierColorDetails";l.getparams(s,r).then(function(t){n.tiercodedtl=t.data.tiercodedtl})}n.open({templateUrl:"/riskcodeHistoryModal.html",controller:i,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.riskcodechange=function(t,e,a,o,i,r){function c(n,c){n.customer_name=o,n.customer_urn=i,n.cboriskcode=r,n.ok=function(){n.txtcode_changereason="",c.close("closed")},n.cboriskcodechange=function(t){r==t?n.codechangereasonshow=!1:(n.txtcode_changereason="",n.codechangereasonshow=!0)};var d={allocationdtl_gid:t},u="api/TierMeeting/GetTierColorDetails";l.getparams(u,d).then(function(t){n.tiercodedtl=t.data.tiercodedtl}),n.riskcodechangecancel=function(e){var a={tmptier2_codechange:e};lockUI();var o="api/TierMeeting/GetTier2ColorDelete";l.post(o,a).then(function(e){if(1==e.data.status){s.alert(e.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.txtcode_changereason="",unlockUI();var a={allocationdtl_gid:t},o="api/TierMeeting/GetTierColorDetails";l.getparams(o,a).then(function(t){n.tiercodedtl=t.data.tiercodedtl})}else s.alert(e.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},n.riskcodechangesubmit=function(){var o={tierallocation_gid:e,allocationdtl_gid:t,tier2preparation_gid:a,tier_code:n.cboriskcode,tiercode_changereason:n.txtcode_changereason,tier3_flag:"N"};lockUI();var i="api/TierMeeting/PostTierColorUpdate";l.post(i,o).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),c.close("closed"),g(),unlockUI()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/riskcodechangeModal.html",controller:c,size:"lg"});c.$inject=["$scope","$modalInstance"]},e.verticalchange=function(t){var a={vertical_gid:t,month:e.cbomonth,tier2_flag:"Y"},o="api/TierMeeting/GetVerticalAllocationdtl";l.getparams(o,a).then(function(t){e.tierallocationdtl=t.data.tierallocationdtl,e.tier2dtl=!0})},e.uploaddocument=function(t,a,o){if(void 0==e.txtdocument_title||""==e.txtdocument_title)return alert("Enter the Document Title to Upload Document"),$("#addExternalupload").val(""),!1;for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=p.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_title",e.txtdocument_title),n.append("tier2preparartion_gid",localStorage.getItem("tier2preparation_gid")),n.append("project_flag","documentformatonly"),e.uploadfrm=n,lockUI();var d="api/TierMeeting/PostTier2TrnUpload";l.postFile(d,e.uploadfrm).then(function(t){e.uploaddocument_list=t.data.tier2document,$("#addExternalupload").val(""),e.txtdocument_title="",unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tier2document_gid:t,tier2preparation_gid:localStorage.getItem("tier2preparation_gid")},o="api/TierMeeting/GetTier2TrnUploadCancel";l.getparams(o,a).then(function(t){e.uploaddocument_list=t.data.tier2document})},e.monthchange=function(t){var a={month:t,tier2:"Y",zonalmapping_gid:e.zonalmapping_gid},o="api/TierMeeting/GetVertical";l.getparams(o,a).then(function(t){e.vertical_list=t.data.tiervertical})},e.downloads=function(t,e){m.Downloaddocument(t,e)},e.updatetier2=function(){lockUI();var t=$("#cboverticalname :selected").text(),o=$("#cboemployeename :selected").text(),n={tier2preparation_gid:localStorage.getItem("tier2preparation_gid"),tier2_month:e.cbomonth,vertical_gid:e.cbovertical_gid,vertical:t,headRMD_gid:e.cboemployeegid,headRMD_name:o,tier2_remarks:e.txttier2_remarks},i="api/TierMeeting/PostUpdateTier2";l.post(i,n).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.tier2Preparation")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}angular.module("angle").controller("tier2PreparationView",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){f.formats=["dd-MM-yyyy"],f.format=f.formats[0],f.calender1=function(t){t.preventDefault(),t.stopPropagation(),f.open1=!0},lockUI();var t="api/employee/employee";l.get(t).then(function(t){e.employee_list=t.data.employee_list});var t="api/TierMeeting/GetTier3Monthdtl";l.get(t).then(function(t){e.monthname_list=t.data.monthname,unlockUI()})}var f=this;f.title="tier3Createcontroller",_(),e.monthchange=function(t){var a={month:t,tier2:"N",zonalmapping_gid:""},o="api/TierMeeting/GetVertical";l.getparams(o,a).then(function(t){e.vertical_list=t.data.tiervertical})},e.viewcustomerdtl=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e);var a=location.protocol+"//"+location.hostname+"/v1/#/app/tierCustomer360";window.open(a,"_blank")},e.verticalchange=function(t){var a={vertical_gid:t,month:e.cbomonth,tier2_flag:"N"};lockUI();var o="api/TierMeeting/GetVerticalAllocationdtl";l.getparams(o,a).then(function(t){e.tierallocationdtl=t.data.tierallocationdtl,e.tier2dtl=!0,unlockUI()})},e.uploaddocument=function(t,a,o){if(void 0==e.txtdocument_title||""==e.txtdocument_title)return alert("Enter the Document Title to Upload Document"),$("#addExternalupload").val(""),!1;for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=g.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_title",e.txtdocument_title),n.append("project_flag","documentformatonly"),e.uploadfrm=n,lockUI();var d="api/TierMeeting/PostTier3Upload";l.postFile(d,e.uploadfrm).then(function(t){e.uploaddocument_list=t.data.tier3document,$("#addExternalupload").val(""),e.txtdocument_title="",unlockUI(),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),e.uploadflag="Y"):(s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3}),e.uploadflag="N")})},e.uploadcancel=function(t){var a={tmp_documentGid:t},o="api/TierMeeting/GetTier3UploadCancel";l.getparams(o,a).then(function(t){e.uploaddocument_list=t.data.upload_list})},e.submittier3=function(){if(lockUI(),"Y"!=e.uploadflag)s.alert("Atleast Upload One Document to Submit..!",{status:"warning",pos:"top-center",timeout:3e3}),unlockUI();else{var t=$("#cboverticalname :selected").text(),o={MLRC_date:e.MLRCdate,tier3_month:e.cbomonth,vertical_gid:e.cbovertical_gid,vertical:t,follow_up:e.txttier3_followup},n="api/TierMeeting/PostTier3Preparation";l.post(n,o).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.tier3Preparation")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}},e.riskcodechange=function(t,e,a,o,i){function r(n,r){n.txtcode_changereason="",n.customer_name=a,n.customer_urn=o,n.cboriskcode=i,n.txtcode_changereason="",n.ok=function(){r.close("closed")},n.cboriskcodechange=function(t){i==t?(n.codechangereasonshow=!1,n.txtcode_changereason=""):(n.codechangereasonshow=!0,n.txtcode_changereason="")};var c={allocationdtl_gid:t},d="api/TierMeeting/GetTierColorDetails";l.getparams(d,c).then(function(t){n.tiercodedtl=t.data.tiercodedtl}),n.riskcodechangesubmit=function(){var a={tierallocation_gid:e,allocationdtl_gid:t,tier_code:n.cboriskcode,tiercode_changereason:n.txtcode_changereason,tier3_flag:"Y"};lockUI();var o="api/TierMeeting/PostTierColorUpdate";l.post(o,a).then(function(t){if(console.log(t.data.status),1==t.data.status){s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),n.txtcode_changereason="",r.close("closed");var e={vertical_gid:n.cbovertical_gid,month:n.cbomonth,tier2_flag:"N"};lockUI();var a="api/TierMeeting/GetVerticalAllocationdtl";l.getparams(a,e).then(function(t){n.tierallocationdtl=[],n.tierallocationdtl=t.data.tierallocationdtl,n.tier2dtl=!0,unlockUI()}),unlockUI()}else s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}}n.open({templateUrl:"/riskcodechangeModal.html",controller:r,size:"lg"});r.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("tier3Createcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){lockUI(),e.totalDisplayed=100;var t="api/TierMeeting/GetTier3Summary";l.get(t).then(function(t){e.tier3preparation_list=t.data.tier3preparation,e.count_pending=t.data.count_pending,e.count_completed=t.data.count_completed,null==e.tier3preparation_list?(e.total=0,e.totalDisplayed=0):(e.total=e.tier3preparation_list.length,e.tier3preparation_list.length<100&&(e.totalDisplayed=e.tier3preparation_list.length)),unlockUI()})}var p=this;p.title="tier3Preparation",m(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalDisplayed<e.tier3preparation_list.length?(e.totalDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.tier3preparation_list.length+" Records Only","warning"))},e.createtier3preparation=function(){a.go("app.tier3Create")},e.viewtier3completed=function(t){function e(e,a){e.ok=function(){a.close("closed")},e.close=function(){a.close("closed")},e.completetier3=function(){lockUI();var o={tier3preparation_gid:t,completed_remarks:e.txttier3_completedremarks},n="api/TierMeeting/PostTier3Complete";l.post(n,o).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.close("closed"),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/completetier3.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.viewtier3details=function(t){localStorage.setItem("tier3preparation_gid",t),a.go("app.tier3PreparationView")}}angular.module("angle").controller("tier3Preparation",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){_.formats=["dd-MM-yyyy"],_.format=_.formats[0],_.calender1=function(t){t.preventDefault(),t.stopPropagation(),_.open1=!0},lockUI();var t="api/TierMeeting/GetTier3Monthdtl";l.get(t).then(function(t){e.monthname_list=t.data.monthname});var t="api/Vertical/Vertical";l.get(t).then(function(t){e.vertical_list=t.data.vertical_list});var a={tier3preparation_gid:localStorage.getItem("tier3preparation_gid")},t="api/TierMeeting/GetTier3ViewDtl";l.getparams(t,a).then(function(t){e.mlrc_date=t.data.MLRC_date,e.txtMLRC_date=t.data.MLRC_Date,e.cbomonth=t.data.tier3_month,e.monthname=t.data.tier3_monthname,e.txttier3_followup=t.data.follow_up,e.tier3_status=t.data.tier3_status,e.created_date=t.data.created_date,e.created_by=t.data.created_by,e.uploaddocument_list=t.data.tier3document,e.completed_date=t.data.completed_date,e.completed_by=t.data.completed_by,e.completed_flag=t.data.completed_flag,e.completed_remarks=t.data.completed_remarks,e.vertical=t.data.vertical,e.cbovertical_gid=t.data.vertical_gid,e.tierallocationdtl=t.data.tierallocationdtl,"N"==e.completed_flag?(e.edittier3dtl=!0,e.viewtier3dtl=!1):(e.edittier3dtl=!1,e.viewtier3dtl=!0),unlockUI()})}var _=this;_.title="tier3PreparationView",g(),e.downloads=function(t,e){m.Downloaddocument(t,e)},e.viewcustomerdtl=function(t,e){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("tier1format_gid",e);var a=location.protocol+"//"+location.hostname+"/v1/#/app/tierCustomer360";window.open(a,"_blank")},e.riskcodechange=function(t,e,a,o,i){function r(n,r){n.customer_name=a,n.customer_urn=o,n.cboriskcode=i,n.txtcode_changereason="",n.ok=function(){r.close("closed")},n.cboriskcodechange=function(t){i==t?n.codechangereasonshow=!1:(n.codechangereasonshow=!0,n.txtcode_changereason="")};var c={allocationdtl_gid:t},d="api/TierMeeting/GetTierColorDetails";l.getparams(d,c).then(function(t){n.tiercodedtl=t.data.tiercodedtl}),n.riskcodechangesubmit=function(){var a={tierallocation_gid:e,allocationdtl_gid:t,tier_code:n.cboriskcode,tiercode_changereason:n.txtcode_changereason,tier3_flag:"Y"};lockUI();var o="api/TierMeeting/PostTierColorUpdate";l.post(o,a).then(function(t){console.log(t.data.status),1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),r.close("closed"),g(),unlockUI()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/riskcodechangeModal.html",controller:r,size:"lg"});r.$inject=["$scope","$modalInstance"]},e.riskcodehistory=function(t,e,a,o){function i(n,i){n.customer_name=e,n.customer_urn=a,n.cboriskcode=o,n.ok=function(){i.close("closed")};var r={allocationdtl_gid:t},s="api/TierMeeting/GetTierColorDetails";l.getparams(s,r).then(function(t){n.tiercodedtl=t.data.tiercodedtl})}n.open({templateUrl:"/riskcodeHistoryModal.html",controller:i,size:"lg"});i.$inject=["$scope","$modalInstance"]},e.monthchange=function(t){var a={month:t,tier2:"N",zonalmapping_gid:""},o="api/TierMeeting/GetVertical";l.getparams(o,a).then(function(t){e.vertical_list=t.data.tiervertical})},e.uploaddocument=function(t,a,o){if(void 0==e.txtdocument_title||""==e.txtdocument_title)return alert("Enter the Document Title to Upload Document"),$("#addExternalupload").val(""),!1;for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var c=p.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==c)return s.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_title",e.txtdocument_title),n.append("tier3preparation_gid",localStorage.getItem("tier3preparation_gid")),n.append("project_flag","documentformatonly"),e.uploadfrm=n,lockUI();var d="api/TierMeeting/PostTrnTier3Upload";l.postFile(d,e.uploadfrm).then(function(t){e.uploaddocument_list=t.data.tier3document,$("#addExternalupload").val(""),e.txtdocument_title="",unlockUI(),1==t.data.status?s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):s.alert("File Format Not Supported!",{status:"info",pos:"top-center",timeout:3e3})})},e.uploadcancel=function(t){var a={tier3document_gid:t,tier3preparation_gid:localStorage.getItem("tier3preparation_gid")},o="api/TierMeeting/GetTier3TrnUploadCancel";l.getparams(o,a).then(function(t){e.uploaddocument_list=t.data.tier3document})},e.updatetier3=function(){lockUI();var t=$("#cboverticalname :selected").text(),a={tier3preparation_gid:localStorage.getItem("tier3preparation_gid"),tier3_month:e.cbomonth,vertical_gid:e.cbovertical_gid,vertical:t,MLRC_date:e.txtMLRC_date,follow_up:e.txttier3_followup};console.log(a);var o="api/TierMeeting/PostUpdateTier3";l.post(o,a).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}angular.module("angle").controller("tier3PreparationView",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){
function g(){lockUI();var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},a="api/allocationManagement/getallocatedtls";l.getparams(a,t).then(function(t){e.zonal_name=t.data.zonal_name,e.state_name=t.data.state_name,e.district_name=t.data.district_name,e.assigned_RM=t.data.assigned_RM,e.customername=t.data.customername,e.customer_urn=t.data.customer_urn,e.ZonalRMname=t.data.ZonalRMname,e.clientName=t.data.customername});var a="api/visitReport/GetAllocationLogDetail";l.getparams(a,t).then(function(t){e.scheduleList=t.data.schedulelogdtl,e.calllogdtlList=t.data.calllogdtl});var a="api/allocationManagement/GetAllocationCustomerDtl";l.getparams(a,t).then(function(t){e.customerdetails=t.data,e.sanctiondetails=t.data.loandtl,e.customerCollateral=t.data.collateraldtl,e.holdallocationlist=t.data.holdallocation,e.customerguarantorlist=t.data.Guarantorsdtl,console.log("Gurantor",t),e.customerPromotorlist=t.data.Promoterdtl,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},o="api/allocationManagement/GetAllocateloanList";l.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var a="api/customerManagement/HistoryEscrowSummary";l.getparams(a,t).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)});var a="api/allocationManagement/getAllocationdocument";l.getparams(a,t).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(e.upload_list=t.data.upload_list,e.documentUpload=!0):e.documentNotUpload=!0});var a="api/visitReport/getvisitreportdtl";l.getparams(a,t).then(function(t){if(e.visitreport_generateGid=t.data.visitreport_generateGid,e.customer_gid=t.data.customer_gid,e.txtbusiness_vintage=t.data.business_vintage,e.cbotypeof_loan=t.data.typeof_loanvertical,e.txtbusiness_sector=t.data.business_sector,e.txtregister_address=t.data.registeredoffice_address,e.cboriskcode=t.data.risk_code,e.txtactual_address=t.data.present_address,e.txtcontact_dtl1=t.data.contact_details1,e.txtcontact_dtl2=t.data.contact_details2,e.cborisk_reviewtype=t.data.typeof_riskreview,e.txtlattitude=t.data.visit_latitude,e.txtlongitude=t.data.visit_longitude,e.txtbusiness_client=t.data.clientbusiness_vintage,e.txtprimary_chain=t.data.primarysecondary_valuechain,e.cbogenetic_code=t.data.geneticcode_complied,e.cboRMD_gid=t.data.RMD_visitedGid,e.RMD_visitedname=t.data.RMD_visitedname,e.txtPPA_name=t.data.PPA_name,e.cbovisit_done=t.data.visit_done,e.txtpurposeof_loan=t.data.purpose_ofloan,e.txtrequestedloan_byclient=t.data.requestedamount_byclient,e.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,e.txtdisbursement_amount=t.data.disbursement_amount,e.txttotalloan_oustanding=t.data.totalloan_outstanding,e.cborepayment_track=t.data.repayment_track,e.cbobasic_records=t.data.basicrecords_maintain,e.txtturnover_lastfy=t.data.turnover_lastFY,e.txtpresent_fysales=t.data.presentFY_sales,e.txtdeferral_pendency=t.data.deferral_pendency,e.txtadditional_funding=t.data.adequacy_additionalfunding,e.txtcbototal_groups=t.data.total_noofGroups,e.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,e.txtRMDvisit_groupcount=t.data.RMD_visitgroups,e.txtassetverification_comment=t.data.assetverification_createdoutofloan,e.txtsecurity_details=t.data.assetverification_securitydtls,e.txtassetverification_mortagged=t.data.assetverification_mortgaged,e.txtROCcreation=t.data.assetverification_ROCcreation,e.txtbasicrecord_remarks=t.data.basicrecords_remarks,e.txtpurpose_funding=t.data.purposeof_funding,e.txt_utilisationdtls=t.data.utilisation_details,e.txtadequacyloan_samunnati=t.data.adequacy_loanamount,e.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,e.txtportfolio_noofmember=t.data.portfolio_noofmembers,e.txtportfolio_activemembers=t.data.portfolio_activemembers,e.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,e.txtportfolio_outstandingdate=t.data.outstanding_ondate,e.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,e.txtportfolio_overdueAmount=t.data.overdue_amount,e.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtrepayment_trackremarks=t.data.repayment_trackremarks,e.txtoverdue=t.data.overdue,e.txtborrower_commitment=t.data.borrower_commitment,e.txtpending_documentation=t.data.pending_documentation,e.txtbriefdtls_client=t.data.briefdtls_client,e.txtenduse_loan=t.data.enduse_loan,e.txtoverall_remarks=t.data.overall_remarks,e.txtPDD_compliance=t.data.PDD_compliance,e.txtbriefrpt_financials=t.data.briefrpt_financials,e.txtbriefrpt_process=t.data.briefrpt_process,e.txtbriefrpt_customer=t.data.briefrpt_customer,e.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,e.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,e.txtbriefrpt_learnings=t.data.briefrpt_learnings,e.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,e.editvisittype=t.data.editvisittype,null!=t.data.RM_name&&(e.relationship_managername=t.data.RM_name),null!=t.data.constitution&&(e.constitution=t.data.constitution),null!=t.data.credit_managername&&(e.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var a=t.data.visit_date.split(/\D/g);e.visitdate=[a[2],a[1],a[0]].join("-")}if(null!=t.data.dealing_withsince){var a=t.data.dealing_withsince.split(/\D/g);e.txtincorporated_date=[a[2],a[1],a[0]].join("-")}if(null!=t.data.disbursement_date){var a=t.data.disbursement_date.split(/\D/g);e.txtdisbursement_date=[a[2],a[1],a[0]].join("-")}});var a="api/visitReport/getvisitReportDocument";l.getparams(a,t).then(function(t){e.visitreportdocument=t.data.visitreportdocument});var a="api/visitReport/getvisitReportPhoto";l.getparams(a,t).then(function(t){e.visitreportphoto=t.data.visitreportphoto});var a="api/TierMeeting/GetViewTierObservationdtl";l.getparams(a,t).then(function(t){e.customer_name=t.data.customer_name,e.dateof_RMDvisit=t.data.dateof_RMDvisit,e.report_pertainingto=t.data.report_pertainingto,e.vertical=t.data.vertical,e.disbursement_amount=t.data.disbursement_amount,e.approving_authority=t.data.approving_authority,e.loansanction_date=t.data.loansanction_date,e.relationship_manager_name=t.data.relationship_manager_name,e.PPA_name=t.data.PPA_name,e.RMDvisit_officialname=t.data.RMDvisit_officialname,e.loandisbursement_date=t.data.loandisbursement_date,e.people_accompaniedRMD=t.data.people_accompaniedRMD,e.sanction_amount=t.data.sanction_amount,e.outstanding_amount=t.data.outstanding_amount,e.current_DPD=t.data.current_DPD,e.contact_details1=t.data.contact_details1,e.contact_details2=t.data.contact_details2,e.observation_flag=t.data.observation_flag,e.cboriskcode=t.data.risk_code,e.criticalobservation=t.data.criticalTierobservation,e.tiercodedtl=t.data.tierReportdtl,unlockUI()});var o={tier1format_gid:localStorage.getItem("tier1format_gid")},a="api/TierMeeting/GetTier1Format360Dtl";l.getparams(a,o).then(function(t){e.txtobservations=t.data.tier1_observations,null==t.data.tier1_code||""==t.data.tier1_code||(e.cboriskcode=t.data.tier1_code),e.txtrationale_justification=t.data.tier1_justification,e.txtprocess_gap=t.data.tier1_processgap,e.txtcode_changereason=t.data.tier1code_changereason,e.tier1code_changeflag=t.data.tier1code_changeflag,e.txtimprovement_recommendation=t.data.tier1_processrecommendation,e.txtmanagement_comments=t.data.tier1_managementcomments,e.txtcheifheadreverts_actionplan=t.data.tier1_reverts_actionplan,e.txtATR_date=t.data.tier1_atrdate,e.tier1format_gid=t.data.tier1format_gid,e.tier1_approvalstatus=t.data.tier1_approvalstatus,e.tier1approvallog=t.data.tier1approvallog,e.uploaddocument_list=t.data.tier1doc,e.tier1rejectlog=t.data.tier1rejectlog,"Y"==e.tier1code_changeflag?e.disablecodechangereasonshow=!0:e.disablecodechangereasonshow=!1,null==t.data.tier1approvallog?e.nohistoryapproval=!0:e.historyapproval=!0,null==t.data.tier1rejectlog?e.rejecthistory=!1:e.rejecthistory=!0});var a="api/TierMeeting/GetTier2Report360Dtl";l.getparams(a,t).then(function(t){console.log(t),e.tier2zonal_name=t.data.zonal_name,e.tier2_monthname=t.data.tier2_monthname,e.vertical=t.data.vertical,e.headRMD_name=t.data.headRMD_name,e.txttier2_remarks=t.data.tier2_remarks,e.tier2_approval_status=t.data.tier2_approval_status,e.tier2_submitteddate=t.data.created_date,e.tier2_submittedby=t.data.created_by,e.uploaddocument2_list=t.data.tier2document,e.tier2approvallog=t.data.tier2approvallog,e.tier2_approveddate=t.data.tier2_approveddate,null==t.data.tier2approvallog?e.tier2nohistoryapproval=!0:e.tier2historyapproval=!0,unlockUI()});var a="api/TierMeeting/GetTier3Report360Dtl";l.getparams(a,t).then(function(t){e.mlrc_date=t.data.MLRC_date,e.monthname=t.data.tier3_month,e.txttier3_followup=t.data.follow_up,e.tier3_status=t.data.tier3_status,e.created_date=t.data.created_date,e.created_by=t.data.created_by,e.uploaddocument3_list=t.data.tier3document,e.completed_date=t.data.completed_date,e.completed_by=t.data.completed_by,e.completed_flag=t.data.completed_flag,e.completed_remarks=t.data.completed_remarks,e.vertical=t.data.vertical,unlockUI()})}var _=this;_.title="TierCustomer360controller",g(),e.close=function(){console.log("close"),window.close()},e.downloads=function(t,e){var a=t,o=a.split("StoryboardAPI"),n=o[1].replace("\\","/"),i=window.location.host,r=location.protocol+"//",l=r.concat(i,n),s=document.createElement("a");s.download=e;var c=l;s.href=c,s.click()},e.escrowInfoView=function(t){function e(e,a){var o={escrow_gid:t},n="api/customerManagement/HistoryEscrowView";l.getparams(n,o).then(function(t){e.escrowview=t.data}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"lg"});e.$inject=["$scope","$modalInstance"]},e.scheduleLoghistory=function(t){function e(e,a){var o={schedulelog_gid:t},n="api/visitReport/GetScheduleLogHistory";l.getparams(n,o).then(function(t){e.scheduleList=t.data.schedulelogdtl}),e.ok=function(){a.close("closed")}}n.open({templateUrl:"/SchedulehistoryModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.downloads=function(t,e){p.Downloaddocument(t,e)}}angular.module("angle").controller("TierCustomer360controller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){lockUI(),e.totalDisplayed=100;var t="api/TierMeeting/GetTier3CompletedSummary";l.get(t).then(function(t){e.tier3preparation_list=t.data.tier3preparation,null==e.tier3preparation_list?(e.total=0,e.totalDisplayed=0):(e.total=e.tier3preparation_list.length,e.tier3preparation_list.length<100&&(e.totalDisplayed=e.tier3preparation_list.length)),unlockUI()})}var p=this;p.title="tierReportcontroller",m(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);return e.totalDisplayed<e.tier3preparation_list.length?(e.totalDisplayed+=a,void unlockUI()):(unlockUI(),void s.alert(" Total Summary "+e.tier3preparation_list.length+" Records Only","warning"))},e.viewtier3details=function(t){localStorage.setItem("tier3preparation_gid",t),a.go("app.tierReportView")}}angular.module("angle").controller("tierReportcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p){function g(){lockUI(),e.MyApprovalPage=localStorage.getItem("MyApprovalPage");var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},a="api/allocationManagement/getallocatedtls";l.getparams(a,t).then(function(t){e.state_name=t.data.transferFrom_statename,e.district_name=t.data.transferFrom_districtname,e.assigned_RM=t.data.transferfrom_assignedRM,e.customername=t.data.customername,e.customer_urn=t.data.customer_urn,e.ZonalRMname=t.data.transferFrom_ZonalRMname,e.customer_gid=t.data.customer_gid,e.zonal_name=t.data.zonal_name});var a="api/allocationManagement/GetAllocationCustomerDtl";l.getparams(a,t).then(function(t){e.customerdetails=t.data,e.sanctiondetails=t.data.loandtl,e.customerCollateral=t.data.collateraldtl,e.customerguarantorlist=t.data.Guarantorsdtl,e.customerPromotorlist=t.data.Promoterdtl,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},o="api/allocationManagement/GetAllocateloanList";l.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var o={allocation_transfergid:localStorage.getItem("allocation_transfergid")},a="api/allocationTransfer/getviewtransapprovaldtl";l.getparams(a,o).then(function(t){e.transapprovaldtl=t.data});var a="api/allocationManagement/getAllocationdocument";l.getparams(a,t).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length&&(e.upload_list=t.data.upload_list)});var n={customer_gid:localStorage.getItem("allocation_customer_gid")},a="api/raiseLegalSR/GetDemandNoticedtl";l.getparams(a,n).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status}),"Y"==localStorage.getItem("MyAllocation")?e.MyAllocationView=!0:e.AllocationSummary=!0,unlockUI()}var _=this;_.title="transferApproval360controller",g(),e.tranferApprove=function(){lockUI();var t={transferapproval_gid:localStorage.getItem("transferapproval_gid"),approval_Remarks:e.textapprovalRemarks};if(console.log(t),"Y"==localStorage.getItem("TransferFromApproval"))var o="api/allocationTransfer/posttransferFromApprove";else if("Y"==localStorage.getItem("ZonalApprovalToFlag"))var o="api/allocationTransfer/postransferToApprove";else var o="api/allocationTransfer/posttransferFromApprove";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.transferApproval")):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})},e.tranferReject=function(){lockUI();var t={transferapproval_gid:localStorage.getItem("transferapproval_gid"),approval_Remarks:e.textapprovalRemarks};if("Y"==localStorage.getItem("TransferFromApproval"))var o="api/allocationTransfer/posttransferFromReject";else if("Y"==localStorage.getItem("ZonalApprovalToFlag"))var o="api/allocationTransfer/posttransferToReject";else var o="api/allocationTransfer/posttransferFromReject";l.post(o,t).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.transferApproval"),g()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.transferApproval"),g())})},e.downloads=function(t,e){p.Downloaddocument(t,e)}}angular.module("angle").controller("transferApproval360controller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m){function p(){lockUI(),e.totalDisplayedCrossZonal=100,e.totalDisplayedWithinZonal=100,e.totalDisplayedHistory=100;var t="api/allocationTransfer/gettransferApprovalSummary";l.get(t).then(function(t){e.allocationtransferList=t.data.allocationtransferdtl,null==e.allocationtransferList?(e.totalCrossZonal=0,e.totalDisplayedCrossZonal=0):(e.totalCrossZonal=e.allocationtransferList.length,e.allocationtransferList.length<100&&(e.totalDisplayedCrossZonal=e.allocationtransferList.length)),e.zonalapproval=t.data.zonalapproval,null==e.zonalapproval?(e.totalWithinZonal=0,e.totalDisplayedWithinZonal=0):(e.totalWithinZonal=e.zonalapproval.length,e.zonalapproval.length<100&&(e.totalDisplayedWithinZonal=e.zonalapproval.length)),e.count_myapproval=t.data.count_myapproval,e.count_mypendingApproval=t.data.count_mypendingApproval,e.count_myApproved=t.data.count_myApproved,e.count_myrejected=t.data.count_myrejected,e.count_mywithinzonalApproval=t.data.count_mywithinzonalApproval,e.count_mycrosszonalApproval=t.data.count_mycrosszonalApproval}),unlockUI()}var g=this;g.title="transferApprovalcontroller",p(),e.approvalhistoryclick=function(){lockUI();var t="api/allocationTransfer/getApprovalHistorySummary";l.get(t).then(function(t){e.allocationHistoryList=t.data.allocationtransferdtl,null==e.allocationHistoryList?(e.totalHistory=0,e.totalDisplayedHistory=0):(e.totalHistory=e.allocationHistoryList.length,e.allocationHistoryList.length<100&&(e.totalDisplayedHistory=e.allocationHistoryList.length)),unlockUI()})},e.loadMoreWithin=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayedWithinZonal+=a,unlockUI()},e.loadMoreCross=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayedCrossZonal+=a,unlockUI()},e.loadMoreHistory=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayedHistory+=a,unlockUI()},e.TransferFromAllocationView=function(t,e,o,n){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("transferapproval_gid",o),localStorage.setItem("allocation_transfergid",n),localStorage.setItem("TransferFromApproval","Y"),localStorage.setItem("MyApprovalPage","Y"),a.go("app.transferApproval360")},e.TransferToAllocationView=function(t,e,o,n,i){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("transferapproval_gid",o),localStorage.setItem("ZonalApprovalToFlag",n),localStorage.setItem("allocation_transfergid",i),localStorage.setItem("TransferFromApproval","N"),localStorage.setItem("MyApprovalPage","Y"),a.go("app.transferApproval360")},e.TransferApprovalHistory=function(t,e,o){localStorage.setItem("allocationdtl_gid",t),localStorage.setItem("allocation_customer_gid",e),localStorage.setItem("allocation_transfergid",o),a.go("app.transferApprovalHistory")}}angular.module("angle").controller("transferApprovalcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","SweetAlert","$route","ngTableParams"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g,_){function f(){lockUI(),h.formats=["dd-MM-yyyy"],h.format=h.formats[0],h.calender1=function(t){t.preventDefault(),t.stopPropagation(),h.open1=!0},h.calender2=function(t){t.preventDefault(),t.stopPropagation(),h.open2=!0},h.calender3=function(t){t.preventDefault(),t.stopPropagation(),h.open3=!0},h.calender4=function(t){t.preventDefault(),t.stopPropagation(),h.open4=!0},h.calender5=function(t){t.preventDefault(),t.stopPropagation(),h.open5=!0},h.dateOptions={formatYear:"yy",startingDay:1};var t={allocationdtl_gid:y},a="api/allocationManagement/getallocatedtls";r.getparams(a,t).then(function(t){e.clientName=t.data.customername,e.customer_urn=t.data.customer_urn,e.relationship_managername=t.data.relationship_managername,e.credit_managername=t.data.credit_managername,e.creditmanager_gid=t.data.creditmanager_gid,e.relationship_managerGid=t.data.relationship_managerGid,e.assigned_RMD=t.data.assigned_RM,e.assignedRMD_gid=t.data.assignedRM_gid});var a="api/visitReport/getvisitreportdtl";r.getparams(a,t).then(function(t){if(e.visitreport_generateGid=t.data.visitreport_generateGid,e.customer_gid=t.data.customer_gid,e.visitdate=t.data.visit_date,e.txtlattitude=t.data.visit_latitude,e.txtlongitude=t.data.visit_longitude,null!=t.data.constitution&&(e.txtconstitution=t.data.constitution),"0001-01-01T00:00:00"!=t.data.dealing_withsince&&(e.txtfirstdisb_date=t.data.dealing_withsince),e.cboriskcode=t.data.risk_code,e.cborisk_reviewtype=t.data.typeof_riskreview,e.txtbusiness_vintage=t.data.business_vintage,e.cbotypeof_loan=t.data.typeof_loanvertical,e.txtbusiness_sector=t.data.business_sector,e.txtregister_address=t.data.registeredoffice_address,e.txtactual_address=t.data.present_address,e.txtcontact_dtl1=t.data.contact_details1,e.txtcontact_dtl2=t.data.contact_details2,e.txtbusiness_client=t.data.clientbusiness_vintage,e.txtprimary_chain=t.data.primarysecondary_valuechain,e.cbogenetic_code=t.data.geneticcode_complied,e.cboRMD_gid=t.data.RMD_visitedGid,e.RMD_visitedname=t.data.RMD_visitedname,null!=t.data.RM_name&&(e.relationship_managername=t.data.RM_name),""==e.txtPPA_name&&(e.txtPPA_name=t.data.PPA_name),null!=t.data.credit_managername&&(e.credit_managername=t.data.credit_managername),e.cbovisit_done=t.data.visit_done,e.txtpurposeof_loan=t.data.purpose_ofloan,e.txtrequestedloan_byclient=t.data.requestedamount_byclient,e.requestedloan_byclient=t.data.requestedamount_byclient,"0001-01-01T00:00:00"!=t.data.disbursement_date&&(e.txtdisbursement_date=t.data.disbursement_date),e.changedisbursement_amount=t.data.disbursement_amount,e.txttotalloan_oustanding=t.data.totalloan_outstanding,e.totalloan_oustanding=t.data.totalloan_outstanding,e.cborepayment_track=t.data.repayment_track,e.cbobasic_records=t.data.basicrecords_maintain,e.txtturnover_lastfy=t.data.turnover_lastFY,e.turnover_lastfy=t.data.turnover_lastFY,e.txtpresent_fysales=t.data.presentFY_sales,e.present_fysales=t.data.presentFY_sales,e.txtdeferral_pendency=t.data.deferral_pendency,e.txtcbototal_groups=t.data.total_noofGroups,e.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,e.txtRMDvisit_groupcount=t.data.RMD_visitgroups,e.txtassetverification_comment=t.data.assetverification_createdoutofloan,e.txtsecurity_details=t.data.assetverification_securitydtls,e.txtassetverification_mortagged=t.data.assetverification_mortgaged,e.txtROCcreation=t.data.assetverification_ROCcreation,e.txtpurpose_funding=t.data.purposeof_funding,e.txt_utilisationdtls=t.data.utilisation_details,e.txtadequacyloan_samunnati=t.data.adequacy_loanamount,e.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,e.txtadditional_funding=t.data.adequacy_additionalfunding,e.txtbasicrecord_remarks=t.data.basicrecords_remarks,e.txtportfolio_noofmember=t.data.portfolio_noofmembers,e.txtportfolio_activemembers=t.data.portfolio_activemembers,e.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,e.portfoliototal_loandisbursement=t.data.total_disbursementamount,e.txtportfolio_outstandingdate=t.data.outstanding_ondate,e.portfolio_outstandingdate=t.data.outstanding_ondate,e.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,e.portfolio_overduebeneficary=t.data.overdue_beneficiary,e.txtportfolio_overdueAmount=t.data.overdue_amount,e.portfolio_overdueAmount=t.data.overdue_amount,e.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,e.portfolio_fundingoverdue=t.data.overdueaccount_funding,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtoverdue=t.data.overdue,e.txtborrower_commitment=t.data.borrower_commitment,e.txtpending_documentation=t.data.pending_documentation,e.txtbriefdtls_client=t.data.briefdtls_client,e.txtenduse_loan=t.data.enduse_loan,e.txtoverall_remarks=t.data.overall_remarks,e.txtPDD_compliance=t.data.PDD_compliance,e.txtbriefrpt_financials=t.data.briefrpt_financials,e.txtbriefrpt_process=t.data.briefrpt_process,e.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,e.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,e.txtbriefrpt_customer=t.data.briefrpt_customer,e.txtbriefrpt_learnings=t.data.briefrpt_learnings,e.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,e.visittypedtl=t.data.visittype,e.txtrepayment_borrowings=t.data.repayment_trackremarks,e.editvisittype=t.data.editvisittype,e.cbovisit_done=[],null!=t.data.editvisittype)for(var a=t.data.editvisittype.length,o=0;o<a;o++){var n=e.visittypedtl.map(function(t){return t.vistdone_gid}).indexOf(t.data.editvisittype[o].vistdone_gid);e.cbovisit_done.push(e.visittypedtl[n])}if(""!=t.data.requestedamount_byclient&&null!=t.data.requestedamount_byclient){var i=t.data.requestedamount_byclient.replace(/,/g,"");e.txtrequestedloan_byclient=Number(i).toLocaleString("en-IN"),document.getElementById("words_requestedloan").innerHTML=v(i)}if(""!=t.data.disbursement_amount&&null!=t.data.disbursement_amount){var i=t.data.disbursement_amount.replace(/,/g,""),i=i.split(".")[0];e.txtdisbursement_amount=Number(i).toLocaleString("en-IN"),document.getElementById("words_disbursementamount").innerHTML=v(i)}if(""!=t.data.totalloan_outstanding&&null!=t.data.totalloan_outstanding){var i=t.data.totalloan_outstanding.replace(/,/g,"");e.txttotalloan_oustanding=Number(i).toLocaleString("en-IN"),document.getElementById("words_totalloan").innerHTML=v(i)}if(""!=t.data.presentFY_sales&&null!=t.data.presentFY_sales){var i=t.data.presentFY_sales.replace(/,/g,"");e.txtpresent_fysales=Number(i).toLocaleString("en-IN"),document.getElementById("words_presentFY").innerHTML=v(i)}if(""!=t.data.turnover_lastFY&&null!=t.data.turnover_lastFY){var i=t.data.turnover_lastFY.replace(/,/g,"");e.txtturnover_lastfy=Number(i).toLocaleString("en-IN"),document.getElementById("words_turnoverFY").innerHTML=v(i)}if(""!=t.data.total_disbursementamount&&null!=t.data.total_disbursementamount){var i=t.data.total_disbursementamount.replace(/,/g,"");e.txtportfoliototal_loandisbursement=Number(i).toLocaleString("en-IN"),document.getElementById("words_totalamount").innerHTML=v(i)}if(""!=t.data.outstanding_ondate&&null!=t.data.outstanding_ondate){var i=t.data.outstanding_ondate.replace(/,/g,"");e.txtportfolio_outstandingdate=Number(i).toLocaleString("en-IN"),document.getElementById("words_outstandingdate").innerHTML=v(i)}if(""!=t.data.overdue_beneficiary&&null!=t.data.overdue_beneficiary){var i=t.data.overdue_beneficiary.replace(/,/g,"");e.txtportfolio_overduebeneficary=Number(i).toLocaleString("en-IN"),document.getElementById("words_overduebeneficary").innerHTML=v(i)}if(""!=t.data.overdue_amount&&null!=t.data.overdue_amount){var i=t.data.overdue_amount.replace(/,/g,"");e.txtportfolio_overdueAmount=Number(i).toLocaleString("en-IN"),document.getElementById("words_overdueAmount").innerHTML=v(i)}if(""!=t.data.overdueaccount_funding&&null!=t.data.overdueaccount_funding){var i=t.data.overdueaccount_funding.replace(/,/g,"");e.txtportfolio_fundingoverdue=Number(i).toLocaleString("en-IN"),document.getElementById("words_fundingoverdue").innerHTML=v(i)}});var a="api/visitReport/GetSanctionTenurePeriod";r.getparams(a,t).then(function(t){e.sanctiondetails=t.data.loandtl,e.txtsantionloan_bycredit=t.data.totalsanction_amount,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:y},o="api/allocationManagement/GetAllocateloanList";r.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var a="api/visitReport/getvisitReportDocument";r.getparams(a,t).then(function(t){e.visitreportdocument=t.data.visitreportdocument});var a="api/newServiceTicket/employee";r.get(a).then(function(t){e.employee_list=t.data.employee_list});var a="api/visitReport/getvisitReportPhoto";r.getparams(a,t).then(function(t){e.visitreportphoto=t.data.visitreportphoto,unlockUI()})}function v(t){var e=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],a=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],o=t.toString();if(o=o.replace(/[\, ]/g,""),o!=parseFloat(o))return"";if((t=t.toString()).length>9)return"Overflow";var n=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(n){var i="";return i+=0!=n[1]?(e[Number(n[1])]||a[n[1][0]]+" "+e[n[1][1]])+"Crore ":"",i+=0!=n[2]?(e[Number(n[2])]||a[n[2][0]]+" "+e[n[2][1]])+"Lakh ":"",i+=0!=n[3]?(e[Number(n[3])]||a[n[3][0]]+" "+e[n[3][1]])+"Thousand ":"",i+=0!=n[4]?(e[Number(n[4])]||a[n[4][0]]+" "+e[n[4][1]])+"Hundred ":"",i+=0!=n[5]?(""!=i?"and ":"")+(e[Number(n[5])]||a[n[5][0]]+" "+e[n[5][1]])+"only ":""}}var h=this;h.title="visitReportCancelcontroller";var y=s.search().allocationdtl_gid,b=s.search().allocation_customer_gid;f(),e.business_vintage=function(t){t.length>=64?e.messagebusiness_vintage="Allowed Only 64 Characters":e.messagebusiness_vintage=""},e.business_sector=function(t){t.length>=128?e.messagebusiness_sector="Allowed Only 128 Characters":e.messagebusiness_sector=""},e.register_address=function(t){t.length>=256?e.messageregister_address="Allowed Only 256 Characters":e.messageregister_address=""},e.actual_address=function(t){t.length>=256?e.messageactual_address="Allowed Only 256 Characters":e.messageactual_address=""},e.contact_dtl1=function(t){t.length>=256?e.messagecontact_dtl1="Allowed Only 256 Characters":e.messagecontact_dtl1=""},e.contact_dtl2=function(t){t.length>=256?e.messagecontact_dtl2="Allowed Only 256 Characters":e.messagecontact_dtl2=""},e.lattitude=function(t){t.length>=32?e.message_lattitude="Allowed Only 32 Characters":e.message_lattitude=""},e.longitude=function(t){t.length>=32?e.message_longitude="Allowed Only 32 Characters":e.message_longitude=""},e.primarychain=function(t){t.length>=128?e.message="Allowed Only 128 Characters":e.message=""},e.purposeof_loan=function(t){t.length>=128?e.message_loan="Allowed Only 128 Characters":e.message_loan=""},e.overdue=function(t){t.length>=128?e.message_overdue="Allowed Only 128 Characters":e.message_overdue=""},e.repayment_borrowings=function(t){t.length>=128?e.message_borrowings="Allowed Only 128 Characters":e.message_borrowings=""},e.basicrecord_remarks=function(t){t.length>=128?e.message_basicrecordremarks="Allowed Only 128 Characters":e.message_basicrecordremarks=""},e.deferral_pendency=function(t){t.length>=128?e.messagedeferral_pendency="Allowed Only 128 Characters":e.messagedeferral_pendency=""},e.cbototal_groups=function(t){t.length>=64?e.messagecbototal_groups="Allowed Only 64 Characters":e.messagecbototal_groups=""},e.CBOgroup_funded=function(t){t.length>=64?e.messageCBOgroup_funded="Allowed Only 64 Characters":e.messageCBOgroup_funded=""},e.RMDvisit_groupcount=function(t){t.length>=64?e.messageRMDvisit_groupcount="Allowed Only 64 Characters":e.messageRMDvisit_groupcount=""},e.borrower_commitment=function(t){t.length>=1024?e.messageborrower_commitment="Allowed Only 1024 Characters":e.messageborrower_commitment=""},e.pending_documentation=function(t){t.length>=1024?e.messagepending_documentation="Allowed Only 1024 Characters":e.messagepending_documentation=""},e.purpose_funding=function(t){t.length>=512?e.message_funding="Allowed Only 512 Characters":e.message_funding=""},e.utilisationdtls=function(t){t.length>=512?e.message_utilisationdtls="Allowed Only 512 Characters":e.message_utilisationdtls=""},e.adequacyloan_samunnati=function(t){t.length>=256?e.message_samunnati="Allowed Only 256 Characters":e.message_samunnati=""},e.adequacyloan_impactassessment=function(t){t.length>=256?e.message_impactassessment="Allowed Only 256 Characters":e.message_impactassessment=""},e.additional_funding=function(t){t.length>=1024?e.message_additionalfunding="Allowed Only 1024 Characters":e.message_additionalfunding=""},e.disbursementchange=function(){var t=document.getElementById("disbursement_amount").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",
timeout:3e3}),e.txtdisbursement_amount=e.changedisbursement_amount):(e.txtdisbursement_amount=o,document.getElementById("words_disbursementamount").innerHTML=n)},e.requestedloanamountChange=function(){var t=document.getElementById("requestloan_amount").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtrequestedloan_byclient=e.requestedloan_byclient):(e.txtrequestedloan_byclient=o,document.getElementById("words_requestedloan").innerHTML=n)},e.totalloanoustandingChange=function(){var t=document.getElementById("totalloan_oustanding").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txttotalloan_oustanding=e.totalloan_oustanding):(e.txttotalloan_oustanding=o,document.getElementById("words_totalloan").innerHTML=n)},e.turnover_lastfyChange=function(){var t=document.getElementById("turnover_lastfy").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtturnover_lastfy=e.turnover_lastfy):(e.txtturnover_lastfy=o,document.getElementById("words_turnoverFY").innerHTML=n)},e.present_fysalesChange=function(){var t=document.getElementById("present_fysales").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtpresent_fysales=e.present_fysales):(e.txtpresent_fysales=o,document.getElementById("words_presentFY").innerHTML=n)},e.portfoliototal_loandisbursementChange=function(){var t=document.getElementById("portfoliototal_loandisbursement").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfoliototal_loandisbursement=e.portfoliototal_loandisbursement):(e.txtportfoliototal_loandisbursement=o,document.getElementById("words_totalamount").innerHTML=n)},e.portfolio_outstandingdateChange=function(){var t=document.getElementById("portfolio_outstandingdate").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_outstandingdate=""):(e.txtportfolio_outstandingdate=o,document.getElementById("words_outstandingdate").innerHTML=n)},e.portfolio_overduebeneficaryChange=function(){var t=document.getElementById("portfolio_overduebeneficary").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_overduebeneficary=""):(e.txtportfolio_overduebeneficary=o,document.getElementById("words_overduebeneficary").innerHTML=n)},e.portfolio_overdueAmountChange=function(){var t=document.getElementById("portfolio_overdueAmount").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_overdueAmount=""):(e.txtportfolio_overdueAmount=o,document.getElementById("words_overdueAmount").innerHTML=n)},e.portfolio_fundingoverdueChange=function(){var t=document.getElementById("portfolio_fundingoverdue").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_fundingoverdue=""):(e.txtportfolio_fundingoverdue=o,document.getElementById("words_fundingoverdue").innerHTML=n)},e.VisitreportComplete=function(){var t=e.txtdisbursement_amount;lockUI();var o={allocationdtl_gid:y,customer_gid:b,customer_name:e.clientName,visit_date:e.visitdate,visitDate:e.visitdate,risk_code:e.cboriskcode,visit_latitude:e.txtlattitude,visit_longitude:e.txtlongitude,constitution:e.txtconstitution,dealing_withsince:e.txtfirstdisb_date,business_vintage:e.txtbusiness_vintage,typeof_loanvertical:e.cbotypeof_loan,typeof_riskreview:e.cborisk_reviewtype,business_sector:e.txtbusiness_sector,registeredoffice_address:e.txtregister_address,present_address:e.txtactual_address,contact_details1:e.txtcontact_dtl1,contact_details2:e.txtcontact_dtl2,relationship_Startedfrom:e.txtfirstdisb_date,clientbusiness_vintage:e.txtbusiness_client,primarysecondary_valuechain:e.txtprimary_chain,basicrecords_remarks:e.txtbasicrecord_remarks,geneticcode_complied:e.cbogenetic_code,RMD_visitedGid:e.assignedRMD_gid,RMD_visitedname:e.assigned_RMD,RM_name:e.relationship_managername,PPA_name:e.txtPPA_name,credit_managername:e.credit_managername,visittype:e.cbovisit_done,purpose_ofloan:e.txtpurposeof_loan,requestedamount_byclient:e.txtrequestedloan_byclient,sanctionedamount_byclient:e.txtsantionloan_bycredit,disbursement_Date:e.txtdisbursement_date,disbursement_amount:t,totalloan_outstanding:e.txttotalloan_oustanding,repayment_track:e.cborepayment_track,repayment_trackremarks:e.txtrepayment_borrowings,basicrecords_maintain:e.cbobasic_records,turnover_lastFY:e.txtturnover_lastfy,presentFY_sales:e.txtpresent_fysales,deferral_pendency:e.txtdeferral_pendency,total_noofGroups:e.txtcbototal_groups,CBOfunded_noofGroups:e.txtCBOgroup_funded,RMD_visitgroups:e.txtRMDvisit_groupcount,assetverification_createdoutofloan:e.txtassetverification_comment,assetverification_securitydtls:e.txtsecurity_details,assetverification_mortgaged:e.txtassetverification_mortagged,assetverification_ROCcreation:e.txtROCcreation,purposeof_funding:e.txtpurpose_funding,utilisation_details:e.txt_utilisationdtls,adequacy_loanamount:e.txtadequacyloan_samunnati,adequacy_impactassessment:e.txtadequacyloan_impactassessment,adequacy_additionalfunding:e.txtadditional_funding,portfolio_noofmembers:e.txtportfolio_noofmember,portfolio_activemembers:e.txtportfolio_activemembers,total_disbursementamount:e.txtportfoliototal_loandisbursement,outstanding_ondate:e.txtportfolio_outstandingdate,overdue_beneficiary:e.txtportfolio_overduebeneficary,overdue_amount:e.txtportfolio_overdueAmount,overdueaccount_funding:e.txtportfolio_fundingoverdue,sanctioned_limit:e.txtsanctioned_limit,tenure_period:e.txttenure_period,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,briefdtls_client:e.txtbriefdtls_client,overall_remarks:e.txtoverall_remarks,PDD_compliance:e.txtPDD_compliance,briefrpt_financials:e.txtbriefrpt_financials,briefrpt_process:e.txtbriefrpt_process,briefrpt_customer:e.txtbriefrpt_customer,briefrpt_learnings:e.txtbriefrpt_learnings,briefrpt_valuechain:e.txtbriefrpt_valuechain,valuechain_mapanalysis:e.txtvaluechain_mapanalysis,competitorbusiness_segment:e.txtcompetitorbusiness_segment,report_status:"Completed"},n="api/VisitReportCancel/PostCancelReportSubmit";r.post(n,o).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.rmVisitReport")):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportbasicdtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,visit_date:e.visitdate,visitDate:e.visitdate,risk_code:e.cboriskcode,visit_latitude:e.txtlattitude,visit_longitude:e.txtlongitude,customer_gid:b,customer_name:e.clientName,constitution:e.txtconstitution,dealing_withsince:e.txtfirstdisb_date,business_vintage:e.txtbusiness_vintage,typeof_loanvertical:e.cbotypeof_loan,typeof_riskreview:e.cborisk_reviewtype,business_sector:e.txtbusiness_sector,registeredoffice_address:e.txtregister_address,present_address:e.txtactual_address,contact_details1:e.txtcontact_dtl1,contact_details2:e.txtcontact_dtl2,relationship_Startedfrom:e.txtfirstdisb_date,clientbusiness_vintage:e.txtbusiness_client,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportvisitdtlSave=function(t){var a=e.txtdisbursement_amount,o=($("#cboRMD_name :selected").text(),{tab_name:t,allocationdtl_gid:y,primarysecondary_valuechain:e.txtprimary_chain,geneticcode_complied:e.cbogenetic_code,RMD_visitedGid:e.assignedRMD_gid,RMD_visitedname:e.assigned_RMD,RM_name:e.relationship_managername,PPA_name:e.txtPPA_name,credit_managername:e.credit_managername,visittype:e.cbovisit_done,purpose_ofloan:e.txtpurposeof_loan,requestedamount_byclient:e.txtrequestedloan_byclient,sanctionedamount_byclient:e.txtsantionloan_bycredit,disbursement_Date:e.txtdisbursement_date,disbursement_amount:a,totalloan_outstanding:e.txttotalloan_oustanding,repayment_track:e.cborepayment_track,repayment_trackremarks:e.txtrepayment_borrowings,basicrecords_maintain:e.cbobasic_records,basicrecords_remarks:e.txtbasicrecord_remarks,turnover_lastFY:e.txtturnover_lastfy,presentFY_sales:e.txtpresent_fysales,deferral_pendency:e.txtdeferral_pendency,total_noofGroups:e.txtcbototal_groups,CBOfunded_noofGroups:e.txtCBOgroup_funded,RMD_visitgroups:e.txtRMDvisit_groupcount,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,report_status:"Save"});lockUI();var n="api/visitReport/postVisitReportGenerate";r.post(n,o).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportassetdtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,assetverification_createdoutofloan:e.txtassetverification_comment,assetverification_securitydtls:e.txtsecurity_details,assetverification_mortgaged:e.txtassetverification_mortagged,assetverification_ROCcreation:e.txtROCcreation,purposeof_funding:e.txtpurpose_funding,utilisation_details:e.txt_utilisationdtls,adequacy_loanamount:e.txtadequacyloan_samunnati,adequacy_impactassessment:e.txtadequacyloan_impactassessment,adequacy_additionalfunding:e.txtadditional_funding,sanctioned_limit:e.txtsanctioned_limit,tenure_period:e.txttenure_period,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,briefdtls_client:e.txtbriefdtls_client,overall_remarks:e.txtoverall_remarks,PDD_compliance:e.txtPDD_compliance,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportportfoliodtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,portfolio_noofmembers:e.txtportfolio_noofmember,portfolio_activemembers:e.txtportfolio_activemembers,total_disbursementamount:e.txtportfoliototal_loandisbursement,outstanding_ondate:e.txtportfolio_outstandingdate,overdue_beneficiary:e.txtportfolio_overduebeneficary,overdue_amount:e.txtportfolio_overdueAmount,overdueaccount_funding:e.txtportfolio_fundingoverdue,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportbriefdtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,briefrpt_financials:e.txtbriefrpt_financials,briefrpt_process:e.txtbriefrpt_process,briefrpt_customer:e.txtbriefrpt_customer,briefrpt_learnings:e.txtbriefrpt_learnings,briefrpt_valuechain:e.txtbriefrpt_valuechain,valuechain_mapanalysis:e.txtvaluechain_mapanalysis,competitorbusiness_segment:e.txtcompetitorbusiness_segment,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportSave=function(){var t=e.txtdisbursement_amount,a=($("#cboRMD_name :selected").text(),{allocationdtl_gid:y,visit_date:e.visitdate,visitDate:e.visitdate,risk_code:e.cboriskcode,visit_latitude:e.txtlattitude,visit_longitude:e.txtlongitude,customer_gid:b,customer_name:e.clientName,constitution:e.txtconstitution,dealing_withsince:e.txtfirstdisb_date,business_vintage:e.txtbusiness_vintage,typeof_loanvertical:e.cbotypeof_loan,typeof_riskreview:e.cborisk_reviewtype,business_sector:e.txtbusiness_sector,registeredoffice_address:e.txtregister_address,present_address:e.txtactual_address,contact_details1:e.txtcontact_dtl1,contact_details2:e.txtcontact_dtl2,relationship_Startedfrom:e.txtfirstdisb_date,clientbusiness_vintage:e.txtbusiness_client,primarysecondary_valuechain:e.txtprimary_chain,geneticcode_complied:e.cbogenetic_code,RMD_visitedGid:e.assignedRMD_gid,RMD_visitedname:e.assigned_RMD,RM_name:e.relationship_managername,PPA_name:e.txtPPA_name,credit_managername:e.credit_managername,visittype:e.cbovisit_done,purpose_ofloan:e.txtpurposeof_loan,requestedamount_byclient:e.txtrequestedloan_byclient,sanctionedamount_byclient:e.txtsantionloan_bycredit,disbursement_Date:e.txtdisbursement_date,disbursement_amount:t,totalloan_outstanding:e.txttotalloan_oustanding,repayment_track:e.cborepayment_track,repayment_trackremarks:e.txtrepayment_borrowings,basicrecords_maintain:e.cbobasic_records,basicrecords_remarks:e.txtbasicrecord_remarks,turnover_lastFY:e.txtturnover_lastfy,presentFY_sales:e.txtpresent_fysales,deferral_pendency:e.txtdeferral_pendency,total_noofGroups:e.txtcbototal_groups,CBOfunded_noofGroups:e.txtCBOgroup_funded,RMD_visitgroups:e.txtRMDvisit_groupcount,assetverification_createdoutofloan:e.txtassetverification_comment,assetverification_securitydtls:e.txtsecurity_details,assetverification_mortgaged:e.txtassetverification_mortagged,assetverification_ROCcreation:e.txtROCcreation,purposeof_funding:e.txtpurpose_funding,utilisation_details:e.txt_utilisationdtls,adequacy_loanamount:e.txtadequacyloan_samunnati,adequacy_impactassessment:e.txtadequacyloan_impactassessment,adequacy_additionalfunding:e.txtadditional_funding,portfolio_noofmembers:e.txtportfolio_noofmember,portfolio_activemembers:e.txtportfolio_activemembers,total_disbursementamount:e.txtportfoliototal_loandisbursement,outstanding_ondate:e.txtportfolio_outstandingdate,overdue_beneficiary:e.txtportfolio_overduebeneficary,overdue_amount:e.txtportfolio_overdueAmount,overdueaccount_funding:e.txtportfolio_fundingoverdue,sanctioned_limit:e.txtsanctioned_limit,tenure_period:e.txttenure_period,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,briefdtls_client:e.txtbriefdtls_client,overall_remarks:e.txtoverall_remarks,PDD_compliance:e.txtPDD_compliance,briefrpt_financials:e.txtbriefrpt_financials,briefrpt_process:e.txtbriefrpt_process,briefrpt_customer:e.txtbriefrpt_customer,briefrpt_learnings:e.txtbriefrpt_learnings,briefrpt_valuechain:e.txtbriefrpt_valuechain,valuechain_mapanalysis:e.txtvaluechain_mapanalysis,competitorbusiness_segment:e.txtcompetitorbusiness_segment,report_status:"Save"});lockUI();var o="api/visitReport/postVisitReport";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.downloads=function(t,e){g.Downloaddocument(t,e)},e.uploadphoto=function(t,a,o){if(null==e.txtuploadphoto_title||""==e.txtuploadphoto_title||void 0==e.txtuploadphoto_title)$("#addPhotoupload").val(""),l.alert("Kindly Enter the Photo Title","warning");else{for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var s=_.fnCheckValidDocType(t[i].name,"photoformatonly");if(0==s)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("txtuploadphoto_title",e.txtuploadphoto_title),n.append("allocationdtl_gid",y),n.append("project_flag","photoformatonly"),e.uploadfrm=n}},e.VisitReportPhotoUpload=function(){if(void 0==e.uploadfrm)return void alert("Document is not Available..!");lockUI();var t="api/visitReport/visitReportPhotoUpload";r.postFile(t,e.uploadfrm).then(function(t){$("#addPhotoupload").val(""),e.txtuploadphoto_title="";var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportPhoto";r.getparams(o,a).then(function(t){e.visitreportphoto=t.data.visitreportphoto}),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI()})},e.uploaddocumentcancel=function(t){lockUI();var a={visitreport_documentGid:t},o="api/visitReport/visitReportUploadcancel";r.getparams(o,a).then(function(t){var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportDocument";r.getparams(o,a).then(function(t){e.visitreportdocument=t.data.visitreportdocument}),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},e.uploadvisitreport=function(t,a,o){if(null==e.txtdocument_title||""==e.txtdocument_title||void 0==e.txtdocument_title)$("#addExternalupload").val(""),l.alert("Kindly Enter the Document Title","warning");else{for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var s=_.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==s)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_title",e.txtdocument_title),n.append("allocationdtl_gid",y),n.append("project_flag","documentformatonly"),e.uploadfrm=n}},e.VisitReportDocumentUpload=function(){if(void 0==e.uploadfrm)return void alert("Document is not Available..!");lockUI();var t="api/visitReport/visitReportUpload";r.postFile(t,e.uploadfrm).then(function(t){var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportDocument";r.getparams(o,a).then(function(t){e.visitreportdocument=t.data.visitreportdocument}),$("#addExternalupload").val(""),e.txtdocument_title="",e.txtdocument_type="",e.uploadfrm=void 0,1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI()})},e.uploadphotocancel=function(t){lockUI();var a={visitreport_photoGid:t},o="api/visitReport/visitReportPhotocancel";r.getparams(o,a).then(function(t){var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportPhoto";r.getparams(o,a).then(function(t){e.visitreportphoto=t.data.visitreportphoto}),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})}}angular.module("angle").controller("visitReportCancelcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){lockUI();var t={allocationdtl_gid:v},a="api/allocationManagement/getallocatedtls";r.getparams(a,t).then(function(t){e.clientName=t.data.customername,e.customer_urn=t.data.customer_urn});var a="api/visitReport/getvisitreportdtl";r.getparams(a,t).then(function(t){if(e.visitreport_generateGid=t.data.visitreport_generateGid,e.customer_gid=t.data.customer_gid,e.txtbusiness_vintage=t.data.business_vintage,e.cbotypeof_loan=t.data.typeof_loanvertical,e.cboriskcode=t.data.risk_code,e.cborisk_reviewtype=t.data.typeof_riskreview,e.txtbusiness_sector=t.data.business_sector,e.txtregister_address=t.data.registeredoffice_address,e.txtactual_address=t.data.present_address,e.txtcontact_dtl1=t.data.contact_details1,e.txtcontact_dtl2=t.data.contact_details2,e.txtlattitude=t.data.visit_latitude,e.txtlongitude=t.data.visit_longitude,e.txtbusiness_client=t.data.clientbusiness_vintage,e.txtprimary_chain=t.data.primarysecondary_valuechain,e.cbogenetic_code=t.data.geneticcode_complied,e.cboRMD_gid=t.data.RMD_visitedGid,e.RMD_visitedname=t.data.RMD_visitedname,e.txtPPA_name=t.data.PPA_name,e.cbovisit_done=t.data.visit_done,e.txtpurposeof_loan=t.data.purpose_ofloan,e.txtrequestedloan_byclient=t.data.requestedamount_byclient,e.txtsantionloan_bycredit=t.data.sanctionedamount_byclient,e.txtbasicrecords_remarks=t.data.basicrecords_remarks,e.txtdisbursement_amount=t.data.disbursement_amount,e.txttotalloan_oustanding=t.data.totalloan_outstanding,e.cborepayment_track=t.data.repayment_track,e.cbobasic_records=t.data.basicrecords_maintain,e.txtturnover_lastfy=t.data.turnover_lastFY,e.txtpresent_fysales=t.data.presentFY_sales,e.txtdeferral_pendency=t.data.deferral_pendency,e.txtadditional_funding=t.data.adequacy_additionalfunding,e.txtcbototal_groups=t.data.total_noofGroups,e.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,e.txtRMDvisit_groupcount=t.data.RMD_visitgroups,e.txtassetverification_comment=t.data.assetverification_createdoutofloan,e.txtsecurity_details=t.data.assetverification_securitydtls,e.txtassetverification_mortagged=t.data.assetverification_mortgaged,e.txtROCcreation=t.data.assetverification_ROCcreation,e.txtpurpose_funding=t.data.purposeof_funding,e.txt_utilisationdtls=t.data.utilisation_details,e.txtadequacyloan_samunnati=t.data.adequacy_loanamount,e.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,e.txtportfolio_noofmember=t.data.portfolio_noofmembers,e.txtportfolio_activemembers=t.data.portfolio_activemembers,e.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,e.txtportfolio_outstandingdate=t.data.outstanding_ondate,e.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,e.txtportfolio_overdueAmount=t.data.overdue_amount,e.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtrepayment_trackremarks=t.data.repayment_trackremarks,e.txtoverdue=t.data.overdue,e.txtborrower_commitment=t.data.borrower_commitment,e.txtpending_documentation=t.data.pending_documentation,e.txtbriefdtls_client=t.data.briefdtls_client,e.txtenduse_loan=t.data.enduse_loan,e.txtoverall_remarks=t.data.overall_remarks,e.txtPDD_compliance=t.data.PDD_compliance,e.txtbriefrpt_financials=t.data.briefrpt_financials,e.txtbriefrpt_process=t.data.briefrpt_process,e.txtbriefrpt_customer=t.data.briefrpt_customer,e.txtbriefrpt_learnings=t.data.briefrpt_learnings,e.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,e.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,e.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,e.editvisittype=t.data.editvisittype,null!=t.data.constitution&&(e.constitution=t.data.constitution),null!=t.data.RM_name&&(e.relationship_managername=t.data.RM_name),null!=t.data.credit_managername&&(e.credit_managername=t.data.credit_managername),null!=t.data.visit_date){var a=t.data.visit_date.split(/\D/g);e.visitdate=[a[2],a[1],a[0]].join("-")}if(null!=t.data.dealing_withsince){var a=t.data.dealing_withsince.split(/\D/g);e.txtincorporated_date=[a[2],a[1],a[0]].join("-")}if(null!=t.data.disbursement_date){var a=t.data.disbursement_date.split(/\D/g);e.txtdisbursement_date=[a[2],a[1],a[0]].join("-")}});var a="api/visitReport/getvisitReportDocument";r.getparams(a,t).then(function(t){e.visitreportdocument=t.data.visitreportdocument});var a="api/visitReport/GetSanctionTenurePeriod";r.getparams(a,t).then(function(t){e.sanctiondetails=t.data.loandtl,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:v},o="api/allocationManagement/GetAllocateloanList";r.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var a="api/visitReport/getvisitReportPhoto",t={allocationdtl_gid:v};r.getparams(a,t).then(function(t){e.visitreportphoto=t.data.visitreportphoto});var a="api/VisitReportCancel/GetVisitCancelLog",t={allocationdtl_gid:v};r.getparams(a,t).then(function(t){e.visistreportcancel=t.data.visistreportcancel}),unlockUI()}var f=this;f.title="VisitReportDetailViewcontroller";var v=s.search().allocationdtl_gid;_(),e.downloads=function(t,e){g.Downloaddocument(t,e)},e.cancel=function(){a.go("app.rmVisitReport")}}angular.module("angle").controller("VisitReportDetailViewcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g,_){function f(){lockUI(),h.formats=["dd-MM-yyyy"],h.format=h.formats[0],h.calender1=function(t){t.preventDefault(),t.stopPropagation(),h.open1=!0},h.calender2=function(t){t.preventDefault(),t.stopPropagation(),h.open2=!0},h.calender3=function(t){t.preventDefault(),t.stopPropagation(),h.open3=!0},h.calender4=function(t){t.preventDefault(),t.stopPropagation(),h.open4=!0},h.calender5=function(t){t.preventDefault(),t.stopPropagation(),h.open5=!0},h.dateOptions={formatYear:"yy",startingDay:1};var t={allocationdtl_gid:y},a="api/allocationManagement/getallocatedtls";r.getparams(a,t).then(function(t){e.clientName=t.data.customername,e.customer_urn=t.data.customer_urn,e.txtconstitution=t.data.constitution,e.relationship_managername=t.data.relationship_managername,e.credit_managername=t.data.credit_managername,e.creditmanager_gid=t.data.creditmanager_gid,e.relationship_managerGid=t.data.relationship_managerGid,e.assigned_RMD=t.data.assigned_RM,e.assignedRMD_gid=t.data.assignedRM_gid,e.totaldisb_amount=t.data.totaldisb_amount,e.txtPPA_name=t.data.PPA_name,""!=e.totaldisb_amount&&(e.txtdisbursement_amount=t.data.totaldisb_amount),""!=t.data.last_disb_date&&(e.txtdisbursement_date=t.data.last_disb_date),""!=t.data.firstdisb_date&&(e.txtfirstdisb_date=t.data.firstdisb_date)});var a="api/visitReport/getvisitreportdtl";r.getparams(a,t).then(function(t){if(e.visitreport_generateGid=t.data.visitreport_generateGid,e.customer_gid=t.data.customer_gid,e.visitdate=t.data.visit_date,e.txtlattitude=t.data.visit_latitude,e.txtlongitude=t.data.visit_longitude,e.cborisk_reviewtype=t.data.typeof_riskreview,e.cboriskcode=t.data.risk_code,null!=t.data.constitution&&(e.txtconstitution=t.data.constitution),"0001-01-01T00:00:00"!=t.data.dealing_withsince&&(e.txtfirstdisb_date=t.data.dealing_withsince),e.txtbusiness_vintage=t.data.business_vintage,e.cbotypeof_loan=t.data.typeof_loanvertical,e.txtbusiness_sector=t.data.business_sector,e.txtregister_address=t.data.registeredoffice_address,e.txtactual_address=t.data.present_address,e.txtcontact_dtl1=t.data.contact_details1,e.txtcontact_dtl2=t.data.contact_details2,e.txtbusiness_client=t.data.clientbusiness_vintage,e.txtprimary_chain=t.data.primarysecondary_valuechain,e.cbogenetic_code=t.data.geneticcode_complied,e.cboRMD_gid=t.data.RMD_visitedGid,e.RMD_visitedname=t.data.RMD_visitedname,null!=t.data.RM_name&&(e.relationship_managername=t.data.RM_name),""==e.txtPPA_name&&(e.txtPPA_name=t.data.PPA_name),null!=t.data.credit_managername&&(e.credit_managername=t.data.credit_managername),e.cbovisit_done=t.data.visit_done,e.txtpurposeof_loan=t.data.purpose_ofloan,e.txtrequestedloan_byclient=t.data.requestedamount_byclient,"0001-01-01T00:00:00"!=t.data.disbursement_date&&(e.txtdisbursement_date=t.data.disbursement_date),""==e.txtdisbursement_date&&(e.txtdisbursement_amount=t.data.disbursement_amount),e.txttotalloan_oustanding=t.data.totalloan_outstanding,e.cborepayment_track=t.data.repayment_track,e.cbobasic_records=t.data.basicrecords_maintain,e.txtbasicrecord_remarks=t.data.basicrecords_remarks,e.txtturnover_lastfy=t.data.turnover_lastFY,e.txtpresent_fysales=t.data.presentFY_sales,e.txtdeferral_pendency=t.data.deferral_pendency,e.txtcbototal_groups=t.data.total_noofGroups,e.txtCBOgroup_funded=t.data.CBOfunded_noofGroups,e.txtRMDvisit_groupcount=t.data.RMD_visitgroups,e.txtassetverification_comment=t.data.assetverification_createdoutofloan,e.txtsecurity_details=t.data.assetverification_securitydtls,e.txtassetverification_mortagged=t.data.assetverification_mortgaged,e.txtROCcreation=t.data.assetverification_ROCcreation,e.txtpurpose_funding=t.data.purposeof_funding,e.txt_utilisationdtls=t.data.utilisation_details,e.txtadequacyloan_samunnati=t.data.adequacy_loanamount,e.txtadequacyloan_impactassessment=t.data.adequacy_impactassessment,e.txtadditional_funding=t.data.adequacy_additionalfunding,e.txtportfolio_noofmember=t.data.portfolio_noofmembers,e.txtportfolio_activemembers=t.data.portfolio_activemembers,e.txtportfoliototal_loandisbursement=t.data.total_disbursementamount,e.txtportfolio_outstandingdate=t.data.outstanding_ondate,e.txtportfolio_overduebeneficary=t.data.overdue_beneficiary,e.txtportfolio_overdueAmount=t.data.overdue_amount,e.txtportfolio_fundingoverdue=t.data.overdueaccount_funding,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtsanctioned_limit=t.data.sanctioned_limit,e.txttenure_period=t.data.tenure_period,e.txtoverdue=t.data.overdue,e.txtborrower_commitment=t.data.borrower_commitment,e.txtpending_documentation=t.data.pending_documentation,e.txtbriefdtls_client=t.data.briefdtls_client,e.txtenduse_loan=t.data.enduse_loan,e.txtoverall_remarks=t.data.overall_remarks,e.txtPDD_compliance=t.data.PDD_compliance,e.txtbriefrpt_financials=t.data.briefrpt_financials,e.txtbriefrpt_process=t.data.briefrpt_process,e.txtbriefrpt_customer=t.data.briefrpt_customer,e.txtbriefrpt_learnings=t.data.briefrpt_learnings,e.txtbriefrpt_valuechain=t.data.briefrpt_valuechain,e.txtvaluechain_mapanalysis=t.data.valuechain_mapanalysis,e.txtcompetitorbusiness_segment=t.data.competitorbusiness_segment,e.visittypedtl=t.data.visittype,e.txtrepayment_borrowings=t.data.repayment_trackremarks,e.editvisittype=t.data.editvisittype,e.cbovisit_done=[],null!=t.data.editvisittype)for(var a=t.data.editvisittype.length,o=0;o<a;o++){var n=e.visittypedtl.map(function(t){return t.vistdone_gid}).indexOf(t.data.editvisittype[o].vistdone_gid);e.cbovisit_done.push(e.visittypedtl[n])}if(null!=t.data.disbursement_amount){var i=t.data.disbursement_amount.replace(/,/g,""),i=i.split(".")[0];e.txtdisbursement_amount=Number(i).toLocaleString("en-IN"),document.getElementById("words_disbursementamount").innerHTML=v(i)}else{var i=e.txtdisbursement_amount.replace(/,/g,""),i=i.split(".")[0];e.txtdisbursement_amount=Number(i).toLocaleString("en-IN"),document.getElementById("words_disbursementamount").innerHTML=v(i)}});var a="api/visitReport/GetSanctionTenurePeriod";r.getparams(a,t).then(function(t){e.sanctiondetails=t.data.loandtl,e.txtsantionloan_bycredit=t.data.totalsanction_amount,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:y},o="api/allocationManagement/GetAllocateloanList";r.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var a="api/visitReport/getvisitReportDocument";r.getparams(a,t).then(function(t){e.visitreportdocument=t.data.visitreportdocument});var a="api/newServiceTicket/employee";r.get(a).then(function(t){e.employee_list=t.data.employee_list});var a="api/visitReport/getvisitReportPhoto";r.getparams(a,t).then(function(t){
e.visitreportphoto=t.data.visitreportphoto,unlockUI()})}function v(t){var e=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],a=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],o=t.toString();if(o=o.replace(/[\, ]/g,""),o!=parseFloat(o))return"";if((t=t.toString()).length>9)return"Overflow";var n=("000000000"+t).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);if(n){var i="";return i+=0!=n[1]?(e[Number(n[1])]||a[n[1][0]]+" "+e[n[1][1]])+"Crore ":"",i+=0!=n[2]?(e[Number(n[2])]||a[n[2][0]]+" "+e[n[2][1]])+"Lakh ":"",i+=0!=n[3]?(e[Number(n[3])]||a[n[3][0]]+" "+e[n[3][1]])+"Thousand ":"",i+=0!=n[4]?(e[Number(n[4])]||a[n[4][0]]+" "+e[n[4][1]])+"Hundred ":"",i+=0!=n[5]?(""!=i?"and ":"")+(e[Number(n[5])]||a[n[5][0]]+" "+e[n[5][1]])+"only ":""}}var h=this;h.title="visitReportGeneratecontroller";var y=s.search().allocationdtl_gid,b=s.search().allocation_customer_gid;f(),e.business_vintage=function(t){t.length>=64?e.messagebusiness_vintage="Allowed Only 64 Characters":e.messagebusiness_vintage=""},e.business_sector=function(t){t.length>=128?e.messagebusiness_sector="Allowed Only 128 Characters":e.messagebusiness_sector=""},e.register_address=function(t){t.length>=256?e.messageregister_address="Allowed Only 256 Characters":e.messageregister_address=""},e.actual_address=function(t){t.length>=256?e.messageactual_address="Allowed Only 256 Characters":e.messageactual_address=""},e.contact_dtl1=function(t){t.length>=256?e.messagecontact_dtl1="Allowed Only 256 Characters":e.messagecontact_dtl1=""},e.contact_dtl2=function(t){t.length>=256?e.messagecontact_dtl2="Allowed Only 256 Characters":e.messagecontact_dtl2=""},e.lattitude=function(t){t.length>=32?e.message_lattitude="Allowed Only 32 Characters":e.message_lattitude=""},e.longitude=function(t){t.length>=32?e.message_longitude="Allowed Only 32 Characters":e.message_longitude=""},e.primarychain=function(t){t.length>=128?e.message="Allowed Only 128 Characters":e.message=""},e.purposeof_loan=function(t){t.length>=128?e.message_loan="Allowed Only 128 Characters":e.message_loan=""},e.overdue=function(t){t.length>=128?e.message_overdue="Allowed Only 128 Characters":e.message_overdue=""},e.repayment_borrowings=function(t){t.length>=128?e.message_borrowings="Allowed Only 128 Characters":e.message_borrowings=""},e.basicrecord_remarks=function(t){t.length>=128?e.message_basicrecordremarks="Allowed Only 128 Characters":e.message_basicrecordremarks=""},e.deferral_pendency=function(t){t.length>=128?e.messagedeferral_pendency="Allowed Only 128 Characters":e.messagedeferral_pendency=""},e.cbototal_groups=function(t){t.length>=64?e.messagecbototal_groups="Allowed Only 64 Characters":e.messagecbototal_groups=""},e.CBOgroup_funded=function(t){t.length>=64?e.messageCBOgroup_funded="Allowed Only 64 Characters":e.messageCBOgroup_funded=""},e.RMDvisit_groupcount=function(t){t.length>=64?e.messageRMDvisit_groupcount="Allowed Only 64 Characters":e.messageRMDvisit_groupcount=""},e.borrower_commitment=function(t){t.length>=1024?e.messageborrower_commitment="Allowed Only 1024 Characters":e.messageborrower_commitment=""},e.pending_documentation=function(t){t.length>=1024?e.messagepending_documentation="Allowed Only 1024 Characters":e.messagepending_documentation=""},e.purpose_funding=function(t){t.length>=512?e.message_funding="Allowed Only 512 Characters":e.message_funding=""},e.utilisationdtls=function(t){t.length>=512?e.message_utilisationdtls="Allowed Only 512 Characters":e.message_utilisationdtls=""},e.adequacyloan_samunnati=function(t){t.length>=256?e.message_samunnati="Allowed Only 256 Characters":e.message_samunnati=""},e.adequacyloan_impactassessment=function(t){t.length>=256?e.message_impactassessment="Allowed Only 256 Characters":e.message_impactassessment=""},e.additional_funding=function(t){t.length>=1024?e.message_additionalfunding="Allowed Only 1024 Characters":e.message_additionalfunding=""},e.disbursementchange=function(){var t=document.getElementById("disbursement_amount").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtdisbursement_amount=e.totaldisb_amount):(e.txtdisbursement_amount=o,document.getElementById("words_disbursementamount").innerHTML=n)},e.requestedloanamountChange=function(){var t=document.getElementById("requestloan_amount").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtrequestedloan_byclient=""):(document.getElementById("words_requestedloan").innerHTML=n,e.txtrequestedloan_byclient=o)},e.totalloanoustandingChange=function(){var t=document.getElementById("totalloan_oustanding").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txttotalloan_oustanding=""):(e.txttotalloan_oustanding=o,document.getElementById("words_totalloan").innerHTML=n)},e.turnover_lastfyChange=function(){var t=document.getElementById("turnover_lastfy").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtturnover_lastfy=""):(e.txtturnover_lastfy=o,document.getElementById("words_turnoverFY").innerHTML=n)},e.present_fysalesChange=function(){var t=document.getElementById("present_fysales").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtpresent_fysales=""):(e.txtpresent_fysales=o,document.getElementById("words_presentFY").innerHTML=n)},e.portfoliototal_loandisbursementChange=function(){var t=document.getElementById("portfoliototal_loandisbursement").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfoliototal_loandisbursement=""):(e.txtportfoliototal_loandisbursement=o,document.getElementById("words_totalamount").innerHTML=n)},e.portfolio_outstandingdateChange=function(){var t=document.getElementById("portfolio_outstandingdate").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_outstandingdate=""):(e.txtportfolio_outstandingdate=o,document.getElementById("words_outstandingdate").innerHTML=n)},e.portfolio_overduebeneficaryChange=function(){var t=document.getElementById("portfolio_overduebeneficary").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_overduebeneficary=""):(e.txtportfolio_overduebeneficary=o,document.getElementById("words_overduebeneficary").innerHTML=n)},e.portfolio_overdueAmountChange=function(){var t=document.getElementById("portfolio_overdueAmount").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_overdueAmount=""):(e.txtportfolio_overdueAmount=o,document.getElementById("words_overdueAmount").innerHTML=n)},e.portfolio_fundingoverdueChange=function(){var t=document.getElementById("portfolio_fundingoverdue").value,a=t.replace(/,/g,""),o=Number(a).toLocaleString("en-IN"),n=v(a);"NaN"==o?(l.alert("Accept Number Format Only..!",{status:"danger",pos:"top-center",timeout:3e3}),e.txtportfolio_fundingoverdue=""):(e.txtportfolio_fundingoverdue=o,document.getElementById("words_fundingoverdue").innerHTML=n)},e.VisitreportbasicdtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,visit_date:e.visitdate,visitDate:e.visitdate,risk_code:e.cboriskcode,visit_latitude:e.txtlattitude,visit_longitude:e.txtlongitude,customer_gid:b,customer_name:e.clientName,constitution:e.txtconstitution,dealing_withsince:e.txtfirstdisb_date,business_vintage:e.txtbusiness_vintage,typeof_loanvertical:e.cbotypeof_loan,typeof_riskreview:e.cborisk_reviewtype,business_sector:e.txtbusiness_sector,registeredoffice_address:e.txtregister_address,present_address:e.txtactual_address,contact_details1:e.txtcontact_dtl1,contact_details2:e.txtcontact_dtl2,relationship_Startedfrom:e.txtfirstdisb_date,clientbusiness_vintage:e.txtbusiness_client,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportvisitdtlSave=function(t){var a=e.txtdisbursement_amount,o=($("#cboRMD_name :selected").text(),{tab_name:t,allocationdtl_gid:y,primarysecondary_valuechain:e.txtprimary_chain,geneticcode_complied:e.cbogenetic_code,RMD_visitedGid:e.assignedRMD_gid,RMD_visitedname:e.assigned_RMD,RM_name:e.relationship_managername,PPA_name:e.txtPPA_name,credit_managername:e.credit_managername,visittype:e.cbovisit_done,purpose_ofloan:e.txtpurposeof_loan,requestedamount_byclient:e.txtrequestedloan_byclient,sanctionedamount_byclient:e.txtsantionloan_bycredit,disbursement_Date:e.txtdisbursement_date,disbursement_amount:a,totalloan_outstanding:e.txttotalloan_oustanding,repayment_track:e.cborepayment_track,repayment_trackremarks:e.txtrepayment_borrowings,basicrecords_maintain:e.cbobasic_records,basicrecords_remarks:e.txtbasicrecord_remarks,turnover_lastFY:e.txtturnover_lastfy,presentFY_sales:e.txtpresent_fysales,deferral_pendency:e.txtdeferral_pendency,total_noofGroups:e.txtcbototal_groups,CBOfunded_noofGroups:e.txtCBOgroup_funded,RMD_visitgroups:e.txtRMDvisit_groupcount,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,report_status:"Save"});lockUI();var n="api/visitReport/postVisitReportGenerate";r.post(n,o).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportassetdtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,assetverification_createdoutofloan:e.txtassetverification_comment,assetverification_securitydtls:e.txtsecurity_details,assetverification_mortgaged:e.txtassetverification_mortagged,assetverification_ROCcreation:e.txtROCcreation,purposeof_funding:e.txtpurpose_funding,utilisation_details:e.txt_utilisationdtls,adequacy_loanamount:e.txtadequacyloan_samunnati,adequacy_impactassessment:e.txtadequacyloan_impactassessment,adequacy_additionalfunding:e.txtadditional_funding,sanctioned_limit:e.txtsanctioned_limit,tenure_period:e.txttenure_period,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,briefdtls_client:e.txtbriefdtls_client,overall_remarks:e.txtoverall_remarks,PDD_compliance:e.txtPDD_compliance,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportportfoliodtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,portfolio_noofmembers:e.txtportfolio_noofmember,portfolio_activemembers:e.txtportfolio_activemembers,total_disbursementamount:e.txtportfoliototal_loandisbursement,outstanding_ondate:e.txtportfolio_outstandingdate,overdue_beneficiary:e.txtportfolio_overduebeneficary,overdue_amount:e.txtportfolio_overdueAmount,overdueaccount_funding:e.txtportfolio_fundingoverdue,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportbriefdtlSave=function(t){var a={tab_name:t,allocationdtl_gid:y,briefrpt_financials:e.txtbriefrpt_financials,briefrpt_process:e.txtbriefrpt_process,briefrpt_customer:e.txtbriefrpt_customer,briefrpt_learnings:e.txtbriefrpt_learnings,briefrpt_valuechain:e.txtbriefrpt_valuechain,valuechain_mapanalysis:e.txtvaluechain_mapanalysis,competitorbusiness_segment:e.txtcompetitorbusiness_segment,report_status:"Save"};lockUI();var o="api/visitReport/postVisitReportGenerate";r.post(o,a).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportSave=function(t){var a=e.txtdisbursement_amount,o=($("#cboRMD_name :selected").text(),{allocationdtl_gid:y,visit_date:e.visitdate,visitDate:e.visitdate,risk_code:e.cboriskcode,visit_latitude:e.txtlattitude,visit_longitude:e.txtlongitude,customer_gid:b,customer_name:e.clientName,constitution:e.txtconstitution,dealing_withsince:e.txtfirstdisb_date,business_vintage:e.txtbusiness_vintage,typeof_loanvertical:e.cbotypeof_loan,typeof_riskreview:e.cborisk_reviewtype,business_sector:e.txtbusiness_sector,registeredoffice_address:e.txtregister_address,present_address:e.txtactual_address,contact_details1:e.txtcontact_dtl1,contact_details2:e.txtcontact_dtl2,relationship_Startedfrom:e.txtfirstdisb_date,clientbusiness_vintage:e.txtbusiness_client,primarysecondary_valuechain:e.txtprimary_chain,geneticcode_complied:e.cbogenetic_code,RMD_visitedGid:e.assignedRMD_gid,RMD_visitedname:e.assigned_RMD,RM_name:e.relationship_managername,PPA_name:e.txtPPA_name,credit_managername:e.credit_managername,visittype:e.cbovisit_done,purpose_ofloan:e.txtpurposeof_loan,requestedamount_byclient:e.txtrequestedloan_byclient,sanctionedamount_byclient:e.txtsantionloan_bycredit,disbursement_Date:e.txtdisbursement_date,disbursement_amount:a,totalloan_outstanding:e.txttotalloan_oustanding,repayment_track:e.cborepayment_track,repayment_trackremarks:e.txtrepayment_borrowings,basicrecords_maintain:e.cbobasic_records,basicrecords_remarks:e.txtbasicrecord_remarks,turnover_lastFY:e.txtturnover_lastfy,presentFY_sales:e.txtpresent_fysales,deferral_pendency:e.txtdeferral_pendency,total_noofGroups:e.txtcbototal_groups,CBOfunded_noofGroups:e.txtCBOgroup_funded,RMD_visitgroups:e.txtRMDvisit_groupcount,assetverification_createdoutofloan:e.txtassetverification_comment,assetverification_securitydtls:e.txtsecurity_details,assetverification_mortgaged:e.txtassetverification_mortagged,assetverification_ROCcreation:e.txtROCcreation,purposeof_funding:e.txtpurpose_funding,utilisation_details:e.txt_utilisationdtls,adequacy_loanamount:e.txtadequacyloan_samunnati,adequacy_impactassessment:e.txtadequacyloan_impactassessment,adequacy_additionalfunding:e.txtadditional_funding,portfolio_noofmembers:e.txtportfolio_noofmember,portfolio_activemembers:e.txtportfolio_activemembers,total_disbursementamount:e.txtportfoliototal_loandisbursement,outstanding_ondate:e.txtportfolio_outstandingdate,overdue_beneficiary:e.txtportfolio_overduebeneficary,overdue_amount:e.txtportfolio_overdueAmount,overdueaccount_funding:e.txtportfolio_fundingoverdue,sanctioned_limit:e.txtsanctioned_limit,tenure_period:e.txttenure_period,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,briefdtls_client:e.txtbriefdtls_client,overall_remarks:e.txtoverall_remarks,PDD_compliance:e.txtPDD_compliance,briefrpt_financials:e.txtbriefrpt_financials,briefrpt_process:e.txtbriefrpt_process,briefrpt_customer:e.txtbriefrpt_customer,briefrpt_learnings:e.txtbriefrpt_learnings,briefrpt_valuechain:e.txtbriefrpt_valuechain,valuechain_mapanalysis:e.txtvaluechain_mapanalysis,competitorbusiness_segment:e.txtcompetitorbusiness_segment,report_status:"Save"});lockUI();var n="api/visitReport/postVisitReport";r.post(n,o).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI()):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.VisitreportComplete=function(){var t=e.txtdisbursement_amount;lockUI();var o={allocationdtl_gid:y,customer_gid:b,customer_name:e.clientName,visit_date:e.visitdate,risk_code:e.cboriskcode,visitDate:e.visitdate,visit_latitude:e.txtlattitude,visit_longitude:e.txtlongitude,constitution:e.txtconstitution,dealing_withsince:e.txtfirstdisb_date,business_vintage:e.txtbusiness_vintage,typeof_loanvertical:e.cbotypeof_loan,typeof_riskreview:e.cborisk_reviewtype,business_sector:e.txtbusiness_sector,registeredoffice_address:e.txtregister_address,present_address:e.txtactual_address,contact_details1:e.txtcontact_dtl1,contact_details2:e.txtcontact_dtl2,relationship_Startedfrom:e.txtfirstdisb_date,clientbusiness_vintage:e.txtbusiness_client,primarysecondary_valuechain:e.txtprimary_chain,geneticcode_complied:e.cbogenetic_code,RMD_visitedGid:e.assignedRMD_gid,RMD_visitedname:e.assigned_RMD,RM_name:e.relationship_managername,PPA_name:e.txtPPA_name,credit_managername:e.credit_managername,visittype:e.cbovisit_done,purpose_ofloan:e.txtpurposeof_loan,requestedamount_byclient:e.txtrequestedloan_byclient,sanctionedamount_byclient:e.txtsantionloan_bycredit,disbursement_Date:e.txtdisbursement_date,disbursement_amount:t,totalloan_outstanding:e.txttotalloan_oustanding,repayment_track:e.cborepayment_track,repayment_trackremarks:e.txtrepayment_borrowings,basicrecords_maintain:e.cbobasic_records,basicrecords_remarks:e.txtbasicrecord_remarks,turnover_lastFY:e.txtturnover_lastfy,presentFY_sales:e.txtpresent_fysales,deferral_pendency:e.txtdeferral_pendency,total_noofGroups:e.txtcbototal_groups,CBOfunded_noofGroups:e.txtCBOgroup_funded,RMD_visitgroups:e.txtRMDvisit_groupcount,assetverification_createdoutofloan:e.txtassetverification_comment,assetverification_securitydtls:e.txtsecurity_details,assetverification_mortgaged:e.txtassetverification_mortagged,assetverification_ROCcreation:e.txtROCcreation,purposeof_funding:e.txtpurpose_funding,utilisation_details:e.txt_utilisationdtls,adequacy_loanamount:e.txtadequacyloan_samunnati,adequacy_impactassessment:e.txtadequacyloan_impactassessment,adequacy_additionalfunding:e.txtadditional_funding,portfolio_noofmembers:e.txtportfolio_noofmember,portfolio_activemembers:e.txtportfolio_activemembers,total_disbursementamount:e.txtportfoliototal_loandisbursement,outstanding_ondate:e.txtportfolio_outstandingdate,overdue_beneficiary:e.txtportfolio_overduebeneficary,overdue_amount:e.txtportfolio_overdueAmount,overdueaccount_funding:e.txtportfolio_fundingoverdue,sanctioned_limit:e.txtsanctioned_limit,tenure_period:e.txttenure_period,overdue:e.txtoverdue,borrower_commitment:e.txtborrower_commitment,pending_documentation:e.txtpending_documentation,briefdtls_client:e.txtbriefdtls_client,overall_remarks:e.txtoverall_remarks,PDD_compliance:e.txtPDD_compliance,briefrpt_financials:e.txtbriefrpt_financials,briefrpt_process:e.txtbriefrpt_process,briefrpt_customer:e.txtbriefrpt_customer,briefrpt_learnings:e.txtbriefrpt_learnings,briefrpt_valuechain:e.txtbriefrpt_valuechain,valuechain_mapanalysis:e.txtvaluechain_mapanalysis,competitorbusiness_segment:e.txtcompetitorbusiness_segment,report_status:"Completed"},n="api/visitReport/postVisitReport";r.post(n,o).then(function(t){1==t.data.status?(l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),a.go("app.rmVisitReport")):(l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())}),unlockUI()},e.uploadvisitreport=function(t,a,o){if(null==e.txtdocument_title||""==e.txtdocument_title||void 0==e.txtdocument_title)$("#addExternalupload").val(""),l.alert("Kindly Enter the Document Title","warning");else{for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var s=_.fnCheckValidDocType(t[i].name,"documentformatonly");if(0==s)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("document_title",e.txtdocument_title),n.append("allocationdtl_gid",y),n.append("project_flag","documentformatonly"),e.uploadfrm=n}},e.VisitReportDocumentUpload=function(){if(void 0==e.uploadfrm)return void alert("Document is not Available..!");lockUI();var t="api/visitReport/visitReportUpload";r.postFile(t,e.uploadfrm).then(function(t){var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportDocument";r.getparams(o,a).then(function(t){e.visitreportdocument=t.data.visitreportdocument}),$("#addExternalupload").val(""),e.txtdocument_title="",e.txtdocument_type="",e.uploadfrm=void 0,1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI()})},e.downloads=function(t,e){g.Downloaddocument(t,e)},e.uploadphoto=function(t,a,o){if(null==e.txtuploadphoto_title||""==e.txtuploadphoto_title||void 0==e.txtuploadphoto_title)$("#addPhotoupload").val(""),l.alert("Kindly Enter the Photo Title","warning");else{for(var n=new FormData,i=0;i<t.length;i++){var r={name:t[i].name,file:t[i]};n.append("fileupload",r.file),n.append("file_name",r.name);var s=_.fnCheckValidDocType(t[i].name,"photoformatonly");if(0==s)return l.alert("File format is not supported..!",{status:"danger",pos:"top-center",timeout:3e3}),!1}n.append("document_name",e.documentname),n.append("txtuploadphoto_title",e.txtuploadphoto_title),n.append("allocationdtl_gid",y),n.append("project_flag","photoformatonly"),e.uploadfrm=n}},e.VisitReportPhotoUpload=function(){if(void 0==e.uploadfrm)return void alert("Document is not Available..!");lockUI();var t="api/visitReport/visitReportPhotoUpload";r.postFile(t,e.uploadfrm).then(function(t){$("#addPhotoupload").val(""),e.txtuploadphoto_title="";var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportPhoto";r.getparams(o,a).then(function(t){e.visitreportphoto=t.data.visitreportphoto}),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"info",pos:"top-center",timeout:3e3}),unlockUI()})},e.uploaddocumentcancel=function(t){lockUI();var a={visitreport_documentGid:t},o="api/visitReport/visitReportUploadcancel";r.getparams(o,a).then(function(t){var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportDocument";r.getparams(o,a).then(function(t){e.visitreportdocument=t.data.visitreportdocument}),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},e.uploadphotocancel=function(t){lockUI();var a={visitreport_photoGid:t},o="api/visitReport/visitReportPhotocancel";r.getparams(o,a).then(function(t){var a={allocationdtl_gid:y},o="api/visitReport/getvisitReportPhoto";r.getparams(o,a).then(function(t){e.visitreportphoto=t.data.visitreportphoto}),1==t.data.status?l.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}):l.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI()})},e.cancel=function(){a.go("app.rmVisitReport")}}angular.module("angle").controller("visitReportGeneratecontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","DownloaddocumentService","cmnfunctionService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u,m,p,g){function _(){lockUI();var t={allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},a="api/allocationManagement/getallocatedtls";r.getparams(a,t).then(function(t){e.state_name=t.data.state_name,e.district_name=t.data.district_name,e.assigned_RM=t.data.assigned_RM,e.customername=t.data.customername,e.customer_urn=t.data.customer_urn,e.ZonalRMname=t.data.ZonalRMname,e.customer_gid=t.data.customer_gid,e.zonal_name=t.data.zonal_name});var a="api/allocationManagement/GetAllocationCustomerDtl";r.getparams(a,t).then(function(t){e.customerdetails=t.data,e.sanctiondetails=t.data.loandtl,e.customerCollateral=t.data.collateraldtl,e.holdallocationlist=t.data.holdallocation,e.U2CMovedallocation=t.data.U2CMovedallocation,e.customerguarantorlist=t.data.Guarantorsdtl,e.customerPromotorlist=t.data.Promoterdtl,angular.forEach(e.sanctiondetails,function(t,e){var a={sanction_gid:t.sanction_gid,allocationdtl_gid:localStorage.getItem("allocationdtl_gid")},o="api/allocationManagement/GetAllocateloanList";r.post(o,a).then(function(e){t.loandetails=e.data.loanList,t.expand=!1})})});var o={customer_gid:localStorage.getItem("allocation_customer_gid")},a="api/raiseLegalSR/GetDemandNoticedtl";r.getparams(a,o).then(function(t){e.demandnotice_list=t.data.demandnotice_list,e.demand_status=t.data.demand_status});var a="api/customerManagement/EscrowSummary";r.getparams(a,o).then(function(t){1==t.data.status&&(e.escrowlist=t.data.escrowSummary)});var a="api/allocationManagement/getAllocationdocument";r.getparams(a,t).then(function(t){Array.isArray(t.data.upload_list)&&t.data.upload_list.length?(e.upload_list=t.data.upload_list,e.documentUpload=!0):e.documentNotUpload=!0});var a="api/visitReport/GetAllocationLogDetail";r.getparams(a,t).then(function(t){e.scheduleList=t.data.schedulelogdtl,e.calllogdtlList=t.data.calllogdtl}),unlockUI()}var f=this;f.title="zonalAllocation360controller",_(),e.escrowInfoView=function(t){function e(t,e){t.ok=function(){e.close("closed")}}$modal.open({templateUrl:"/EscrowInfoModal.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]},e.downloads=function(t,e){g.Downloaddocument(t,e)}}angular.module("angle").controller("zonalAllocation360controller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","ScopeValueService","$http","SocketService","Notify","$location","$route","$cookies","$filter","ngTableParams","$timeout","DownloaddocumentService"]}(),function(){"use strict";function t(t,e,a,o,n,i,r,l,s,c,d,u){function m(){lockUI(),e.totalDisplayed=100;var t="api/zonalMapping/getzonalMappingdtl";l.get(t).then(function(t){e.zonalMappingList=t.data.zonalMapping,null==e.zonalMappingList?(e.total=0,e.totalDisplayed=0):(e.total=e.zonalMappingList.length,e.zonalMappingList.length<100&&(e.totalDisplayed=e.zonalMappingList.length)),unlockUI()})}var p=this;p.title="zonalMappingcontroller",e.statedtlList=[],m(),document.getElementById("pagecount").onkeyup=function(){if(null==e.pagecount){var t=document.getElementById("loadmore");t.style.backgroundColor="#DCDCDC"}else{var t=document.getElementById("loadmore");t.style.backgroundColor="#ffa"}},e.loadMore=function(t){if(void 0==t)return void s.alert("Enter the Total Summary Count","warning");lockUI();var a=parseInt(t);e.totalDisplayed+=a,unlockUI()},e.addzonalMapping=function(){function t(t,e){lockUI();var a="api/newServiceTicket/employee";l.get(a).then(function(e){t.employee_list=e.data.employee_list}),unlockUI(),t.ok=function(){e.close("closed")},t.submitzonalmapping=function(){lockUI();var a=$("#zonalriskmanager :selected").text(),o={zonal_name:t.txtzonalname,zonalrisk_managerGid:t.cboemployeegid,zonalrisk_managername:a},n="api/zonalMapping/postzonalMapping";l.post(n,o).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),e.close("closed"),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}n.open({templateUrl:"/addZonalMapping.html",controller:t,size:"md"});t.$inject=["$scope","$modalInstance"]},e.tagstatedtl=function(t){function e(e,o,n){lockUI();var i="api/rmMapping/getstatedtls";l.get(i).then(function(t){e.statedtllist=t.data.statedtl});var i="api/zonalMapping/getviewzonalmappingdtl";l.getparams(i,a).then(function(t){e.zonal_name=t.data.zonal_name,e.zonalrisk_managerGid=t.data.zonalrisk_managerGid,e.zonalrisk_managername=t.data.zonalrisk_managername,e.statelist=t.data.tagzonalmapping;for(var a=e.statelist.length,o=0;o<a;o++){var n=e.statedtllist.map(function(t){return t.state_gid}).indexOf(e.statelist[o].state_gid);e.statedtllist[n].checked=!0}}),unlockUI(),e.ok=function(){o.close("closed")},e.tagzonalmapping=function(){lockUI();var a=[];if(angular.forEach(e.statedtllist,function(t){if(1==t.checked){var e=t.state_gid;a.push(e)}}),0==a.length)return alert("Choose Atleast One State"),void unlockUI();var n={zonalmapping_gid:t,zonalrisk_managerGid:e.zonalrisk_managerGid,state_gid:a},i="api/zonalMapping/poststatetag2zonal";l.post(i,n).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.close("closed"),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={zonalmapping_gid:t};n.open({templateUrl:"/tagZonalstate.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance","ngTableParams"]},e.viewtagstatedtl=function(t){function e(t,e,o){lockUI();var n="api/zonalMapping/getviewzonalmappingdtl";l.getparams(n,a).then(function(e){t.zonal_name=e.data.zonal_name,t.zonalrisk_managerGid=e.data.zonalrisk_managerGid,t.zonalrisk_managername=e.data.zonalrisk_managername,t.statedtlList=e.data.tagzonalmapping}),unlockUI(),t.ok=function(){e.close("closed")}}var a={zonalmapping_gid:t};n.open({templateUrl:"/viewtaggedZonalstate.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance","ngTableParams"]},e.editstatedtl=function(t){function e(e,o){lockUI();var n="api/zonalMapping/employee";l.get(n).then(function(t){e.employee_list=t.data.employee_list});var n="api/zonalMapping/getviewzonalmappingdtl";l.getparams(n,a).then(function(t){e.zonal_name=t.data.zonal_name,e.zonalrisk_managerGid=t.data.zonalrisk_managerGid,e.zonalrisk_managername=t.data.zonalrisk_managername}),unlockUI(),e.ok=function(){o.close("closed")},e.updatezonalmapping=function(a){var n=$("#zonalrisk_managername :selected").text(),i={zonalmapping_gid:t,zonalrisk_managername:n,zonalrisk_managerGid:e.zonalrisk_managerGid},r="api/zonalMapping/updatezonalMapping";l.post(r,i).then(function(t){1==t.data.status?(s.alert(t.data.message,{status:"success",pos:"top-center",timeout:3e3}),unlockUI(),o.close("closed"),m()):(s.alert(t.data.message,{status:"danger",pos:"top-center",timeout:3e3}),unlockUI())})}}var a={zonalmapping_gid:t};n.open({templateUrl:"/edittaggedZonalstate.html",controller:e,size:"md"});e.$inject=["$scope","$modalInstance"]}}angular.module("angle").controller("zonalMappingcontroller",t),t.$inject=["$rootScope","$scope","$state","AuthenticationService","$modal","ScopeValueService","$http","SocketService","Notify","$location","$route","ngTableParams"]}();